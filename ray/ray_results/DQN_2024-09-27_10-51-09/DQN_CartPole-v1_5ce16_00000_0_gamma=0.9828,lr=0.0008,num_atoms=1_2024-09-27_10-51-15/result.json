{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 1000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1000, "num_agent_steps_trained": 0}, "env_runners": {"episode_reward_max": 56.0, "episode_reward_min": 10.0, "episode_reward_mean": 21.25531914893617, "episode_len_mean": 21.25531914893617, "episode_media": {}, "episodes_timesteps_total": 999, "policy_reward_min": {"default_policy": 10.0}, "policy_reward_max": {"default_policy": 56.0}, "policy_reward_mean": {"default_policy": 21.25531914893617}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.0, 28.0, 39.0, 32.0, 20.0, 15.0, 31.0, 21.0, 12.0, 11.0, 26.0, 17.0, 23.0, 15.0, 28.0, 26.0, 27.0, 33.0, 10.0, 11.0, 19.0, 19.0, 33.0, 16.0, 10.0, 15.0, 21.0, 13.0, 16.0, 19.0, 21.0, 19.0, 27.0, 15.0, 19.0, 19.0, 32.0, 11.0, 23.0, 10.0, 31.0, 20.0, 14.0, 23.0, 56.0, 21.0, 12.0], "episode_lengths": [20, 28, 39, 32, 20, 15, 31, 21, 12, 11, 26, 17, 23, 15, 28, 26, 27, 33, 10, 11, 19, 19, 33, 16, 10, 15, 21, 13, 16, 19, 21, 19, 27, 15, 19, 19, 32, 11, 23, 10, 31, 20, 14, 23, 56, 21, 12], "policy_default_policy_reward": [20.0, 28.0, 39.0, 32.0, 20.0, 15.0, 31.0, 21.0, 12.0, 11.0, 26.0, 17.0, 23.0, 15.0, 28.0, 26.0, 27.0, 33.0, 10.0, 11.0, 19.0, 19.0, 33.0, 16.0, 10.0, 15.0, 21.0, 13.0, 16.0, 19.0, 21.0, 19.0, 27.0, 15.0, 19.0, 19.0, 32.0, 11.0, 23.0, 10.0, 31.0, 20.0, 14.0, 23.0, 56.0, 21.0, 12.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.077440711525413, "mean_inference_ms": 2.1384969934240563, "mean_action_processing_ms": 0.22769307756757404, "mean_env_wait_ms": 0.08900182230489236, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016484362013796543, "StateBufferConnector_ms": 0.015321183711924452, "ViewRequirementAgentConnector_ms": 0.1686598392243081}, "num_episodes": 47, "episode_return_max": 56.0, "episode_return_min": 10.0, "episode_return_mean": 21.25531914893617, "episodes_this_iter": 47}, "num_healthy_workers": 0, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 1000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 219.24257233709494, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 1000, "num_env_steps_sampled_lifetime": 1000, "num_agent_steps_sampled_lifetime": 1000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1000, "timers": {"training_iteration_time_ms": 4561.239, "restore_workers_time_ms": 0.023, "training_step_time_ms": 4.146, "sample_time_ms": 3.765}, "counters": {"num_env_steps_sampled": 1000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1000, "num_agent_steps_trained": 0}, "done": false, "training_iteration": 1, "trial_id": "5ce16_00000", "date": "2024-09-27_10-51-34", "timestamp": 1727405494, "time_this_iter_s": 4.562861442565918, "time_total_s": 4.562861442565918, "pid": 39427, "hostname": "gpu2gate1", "node_ip": "10.64.32.126", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.9828407522030984, "lr": 0.0007583973879008875, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f52e4d75580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4.562861442565918, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 18.285714285714285, "ram_util_percent": 8.799999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.05819663032889366, "mean_q": 2.3126823902130127, "min_q": 1.5106054544448853, "max_q": 2.887422561645508, "cur_lr": 0.0007583973879008875}, "td_error": [0.07600212097167969, -0.5533394813537598, -0.14770793914794922, -0.34052109718322754, -0.4334986209869385, 0.7911449670791626, 0.9247622489929199, -0.21178436279296875, 0.5106054544448853, -0.014292240142822266, -0.1008908748626709, 0.2783684730529785, -0.18608641624450684, 0.18883514404296875, 0.9247622489929199, -0.12315511703491211, -0.22312426567077637, -0.08099913597106934, -0.3655061721801758, -0.18623709678649902, -0.1082768440246582, -0.34280824661254883, -0.4665989875793457, -0.9964900016784668, -0.12997055053710938, -0.24661684036254883, -0.6513144969940186, -0.06987810134887695, 0.10242843627929688, 1.3135936260223389, 1.089320182800293, -0.45255565643310547], "mean_td_error": -0.00724468007683754, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 1000.0, "diff_num_grad_updates_vs_sampler_policy": 646.15625}}, "num_env_steps_sampled": 2000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 2000, "num_agent_steps_trained": 32000, "last_target_update_ts": 1501, "num_target_updates": 2}, "env_runners": {"episode_reward_max": 56.0, "episode_reward_min": 8.0, "episode_reward_mean": 19.65, "episode_len_mean": 19.65, "episode_media": {}, "episodes_timesteps_total": 1965, "policy_reward_min": {"default_policy": 8.0}, "policy_reward_max": {"default_policy": 56.0}, "policy_reward_mean": {"default_policy": 19.65}, "custom_metrics": {}, "hist_stats": {"episode_reward": [28.0, 39.0, 32.0, 20.0, 15.0, 31.0, 21.0, 12.0, 11.0, 26.0, 17.0, 23.0, 15.0, 28.0, 26.0, 27.0, 33.0, 10.0, 11.0, 19.0, 19.0, 33.0, 16.0, 10.0, 15.0, 21.0, 13.0, 16.0, 19.0, 21.0, 19.0, 27.0, 15.0, 19.0, 19.0, 32.0, 11.0, 23.0, 10.0, 31.0, 20.0, 14.0, 23.0, 56.0, 21.0, 12.0, 21.0, 24.0, 14.0, 17.0, 18.0, 39.0, 37.0, 26.0, 19.0, 19.0, 23.0, 11.0, 15.0, 18.0, 19.0, 20.0, 13.0, 18.0, 11.0, 17.0, 15.0, 10.0, 24.0, 25.0, 53.0, 11.0, 30.0, 14.0, 11.0, 13.0, 17.0, 16.0, 20.0, 14.0, 22.0, 12.0, 13.0, 14.0, 8.0, 11.0, 21.0, 9.0, 14.0, 11.0, 13.0, 9.0, 16.0, 26.0, 32.0, 20.0, 13.0, 18.0, 19.0, 13.0], "episode_lengths": [28, 39, 32, 20, 15, 31, 21, 12, 11, 26, 17, 23, 15, 28, 26, 27, 33, 10, 11, 19, 19, 33, 16, 10, 15, 21, 13, 16, 19, 21, 19, 27, 15, 19, 19, 32, 11, 23, 10, 31, 20, 14, 23, 56, 21, 12, 21, 24, 14, 17, 18, 39, 37, 26, 19, 19, 23, 11, 15, 18, 19, 20, 13, 18, 11, 17, 15, 10, 24, 25, 53, 11, 30, 14, 11, 13, 17, 16, 20, 14, 22, 12, 13, 14, 8, 11, 21, 9, 14, 11, 13, 9, 16, 26, 32, 20, 13, 18, 19, 13], "policy_default_policy_reward": [28.0, 39.0, 32.0, 20.0, 15.0, 31.0, 21.0, 12.0, 11.0, 26.0, 17.0, 23.0, 15.0, 28.0, 26.0, 27.0, 33.0, 10.0, 11.0, 19.0, 19.0, 33.0, 16.0, 10.0, 15.0, 21.0, 13.0, 16.0, 19.0, 21.0, 19.0, 27.0, 15.0, 19.0, 19.0, 32.0, 11.0, 23.0, 10.0, 31.0, 20.0, 14.0, 23.0, 56.0, 21.0, 12.0, 21.0, 24.0, 14.0, 17.0, 18.0, 39.0, 37.0, 26.0, 19.0, 19.0, 23.0, 11.0, 15.0, 18.0, 19.0, 20.0, 13.0, 18.0, 11.0, 17.0, 15.0, 10.0, 24.0, 25.0, 53.0, 11.0, 30.0, 14.0, 11.0, 13.0, 17.0, 16.0, 20.0, 14.0, 22.0, 12.0, 13.0, 14.0, 8.0, 11.0, 21.0, 9.0, 14.0, 11.0, 13.0, 9.0, 16.0, 26.0, 32.0, 20.0, 13.0, 18.0, 19.0, 13.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0423439455309236, "mean_inference_ms": 2.084759422806129, "mean_action_processing_ms": 0.22505825648558414, "mean_env_wait_ms": 0.08993163121673853, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016342639923095703, "StateBufferConnector_ms": 0.015036582946777344, "ViewRequirementAgentConnector_ms": 0.16976547241210938}, "num_episodes": 54, "episode_return_max": 56.0, "episode_return_min": 8.0, "episode_return_mean": 19.65, "episodes_this_iter": 54}, "num_healthy_workers": 0, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 2000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 33.574422748495216, "num_env_steps_trained_throughput_per_sec": 1074.381527951847, "timesteps_total": 2000, "num_env_steps_sampled_lifetime": 2000, "num_agent_steps_sampled_lifetime": 2000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 2000, "timers": {"training_iteration_time_ms": 17172.937, "restore_workers_time_ms": 0.017, "training_step_time_ms": 65.053, "sample_time_ms": 14.08, "load_time_ms": 0.211, "load_throughput": 151744.181, "learn_time_ms": 14.04, "learn_throughput": 2279.261, "synch_weights_time_ms": 0.044}, "counters": {"num_env_steps_sampled": 2000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 2000, "num_agent_steps_trained": 32000, "last_target_update_ts": 1501, "num_target_updates": 2}, "done": false, "training_iteration": 2, "trial_id": "5ce16_00000", "date": "2024-09-27_10-52-04", "timestamp": 1727405524, "time_this_iter_s": 29.786272048950195, "time_total_s": 34.34913349151611, "pid": 39427, "hostname": "gpu2gate1", "node_ip": "10.64.32.126", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.9828407522030984, "lr": 0.0007583973879008875, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f52e4d75580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 34.34913349151611, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 12.485714285714288, "ram_util_percent": 8.890476190476189}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.17452000081539154, "mean_q": 4.00152063369751, "min_q": 1.5754063129425049, "max_q": 5.248227596282959, "cur_lr": 0.0007583973879008875}, "td_error": [-0.1139993667602539, 0.5754063129425049, 0.19551920890808105, -0.006262302398681641, 0.035454750061035156, -0.0761256217956543, -0.017659664154052734, 0.3019270896911621, 0.11606836318969727, -0.04642772674560547, 0.051629066467285156, -0.020221233367919922, 0.6740397214889526, 1.8022124767303467, 0.1672358512878418, 0.07137489318847656, 0.06992983818054199, 0.3064844608306885, 0.16876506805419922, -0.01898050308227539, 0.0045566558837890625, 0.1490478515625, 0.2730889320373535, 0.06713485717773438, 0.14408397674560547, 0.17612409591674805, 0.17723751068115234, 0.05794477462768555, 1.0555450916290283, 0.6320205926895142, -0.09141874313354492, 0.08648967742919922], "mean_td_error": 0.21775706112384796, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 2000.0, "diff_num_grad_updates_vs_sampler_policy": 1146.59375}}, "num_env_steps_sampled": 3000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 3000, "num_agent_steps_trained": 64000, "last_target_update_ts": 2501, "num_target_updates": 4}, "env_runners": {"episode_reward_max": 53.0, "episode_reward_min": 8.0, "episode_reward_mean": 17.44, "episode_len_mean": 17.44, "episode_media": {}, "episodes_timesteps_total": 1744, "policy_reward_min": {"default_policy": 8.0}, "policy_reward_max": {"default_policy": 53.0}, "policy_reward_mean": {"default_policy": 17.44}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11.0, 15.0, 18.0, 19.0, 20.0, 13.0, 18.0, 11.0, 17.0, 15.0, 10.0, 24.0, 25.0, 53.0, 11.0, 30.0, 14.0, 11.0, 13.0, 17.0, 16.0, 20.0, 14.0, 22.0, 12.0, 13.0, 14.0, 8.0, 11.0, 21.0, 9.0, 14.0, 11.0, 13.0, 9.0, 16.0, 26.0, 32.0, 20.0, 13.0, 18.0, 19.0, 13.0, 26.0, 11.0, 14.0, 13.0, 17.0, 35.0, 22.0, 28.0, 21.0, 15.0, 15.0, 20.0, 13.0, 15.0, 27.0, 28.0, 15.0, 35.0, 11.0, 20.0, 11.0, 27.0, 46.0, 17.0, 18.0, 17.0, 11.0, 15.0, 17.0, 12.0, 16.0, 14.0, 10.0, 17.0, 10.0, 11.0, 17.0, 17.0, 13.0, 15.0, 14.0, 12.0, 45.0, 9.0, 9.0, 15.0, 13.0, 29.0, 25.0, 11.0, 14.0, 14.0, 11.0, 12.0, 17.0, 15.0, 18.0], "episode_lengths": [11, 15, 18, 19, 20, 13, 18, 11, 17, 15, 10, 24, 25, 53, 11, 30, 14, 11, 13, 17, 16, 20, 14, 22, 12, 13, 14, 8, 11, 21, 9, 14, 11, 13, 9, 16, 26, 32, 20, 13, 18, 19, 13, 26, 11, 14, 13, 17, 35, 22, 28, 21, 15, 15, 20, 13, 15, 27, 28, 15, 35, 11, 20, 11, 27, 46, 17, 18, 17, 11, 15, 17, 12, 16, 14, 10, 17, 10, 11, 17, 17, 13, 15, 14, 12, 45, 9, 9, 15, 13, 29, 25, 11, 14, 14, 11, 12, 17, 15, 18], "policy_default_policy_reward": [11.0, 15.0, 18.0, 19.0, 20.0, 13.0, 18.0, 11.0, 17.0, 15.0, 10.0, 24.0, 25.0, 53.0, 11.0, 30.0, 14.0, 11.0, 13.0, 17.0, 16.0, 20.0, 14.0, 22.0, 12.0, 13.0, 14.0, 8.0, 11.0, 21.0, 9.0, 14.0, 11.0, 13.0, 9.0, 16.0, 26.0, 32.0, 20.0, 13.0, 18.0, 19.0, 13.0, 26.0, 11.0, 14.0, 13.0, 17.0, 35.0, 22.0, 28.0, 21.0, 15.0, 15.0, 20.0, 13.0, 15.0, 27.0, 28.0, 15.0, 35.0, 11.0, 20.0, 11.0, 27.0, 46.0, 17.0, 18.0, 17.0, 11.0, 15.0, 17.0, 12.0, 16.0, 14.0, 10.0, 17.0, 10.0, 11.0, 17.0, 17.0, 13.0, 15.0, 14.0, 12.0, 45.0, 9.0, 9.0, 15.0, 13.0, 29.0, 25.0, 11.0, 14.0, 14.0, 11.0, 12.0, 17.0, 15.0, 18.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0105196554564861, "mean_inference_ms": 2.0427667399792866, "mean_action_processing_ms": 0.22365218772557585, "mean_env_wait_ms": 0.09156164568539057, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01660752296447754, "StateBufferConnector_ms": 0.014536380767822266, "ViewRequirementAgentConnector_ms": 0.17021632194519043}, "num_episodes": 57, "episode_return_max": 53.0, "episode_return_min": 8.0, "episode_return_mean": 17.44, "episodes_this_iter": 57}, "num_healthy_workers": 0, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 3000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 32.06006541506792, "num_env_steps_trained_throughput_per_sec": 1025.9220932821734, "timesteps_total": 3000, "num_env_steps_sampled_lifetime": 3000, "num_agent_steps_sampled_lifetime": 3000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 3000, "timers": {"training_iteration_time_ms": 21845.796, "restore_workers_time_ms": 0.018, "training_step_time_ms": 29.841, "sample_time_ms": 3.609, "load_time_ms": 0.21, "load_throughput": 152554.817, "learn_time_ms": 12.466, "learn_throughput": 2567.016, "synch_weights_time_ms": 0.039}, "counters": {"num_env_steps_sampled": 3000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 3000, "num_agent_steps_trained": 64000, "last_target_update_ts": 2501, "num_target_updates": 4}, "done": false, "training_iteration": 3, "trial_id": "5ce16_00000", "date": "2024-09-27_10-52-35", "timestamp": 1727405555, "time_this_iter_s": 31.192925214767456, "time_total_s": 65.54205870628357, "pid": 39427, "hostname": "gpu2gate1", "node_ip": "10.64.32.126", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.9828407522030984, "lr": 0.0007583973879008875, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f52e4d75580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 65.54205870628357, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 12.031818181818183, "ram_util_percent": 8.899999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.07611542195081711, "mean_q": 5.386263370513916, "min_q": 1.2428441047668457, "max_q": 6.924315929412842, "cur_lr": 0.0007583973879008875}, "td_error": [-0.5935850143432617, 0.2428441047668457, 0.13687467575073242, -0.0475001335144043, -0.1845703125, -0.10965776443481445, 0.0009167194366455078, -0.04650306701660156, 0.38073253631591797, 0.3957810401916504, 1.7350058555603027, 0.0732259750366211, 0.11684656143188477, 0.11508035659790039, 0.25935792922973633, 0.09192895889282227, 0.12453031539916992, -0.19945526123046875, -0.010385751724243164, -0.031262874603271484, 0.07242393493652344, -0.014830589294433594, -0.9557816982269287, 0.07456016540527344, -0.2127399444580078, 0.16313695907592773, -0.11407017707824707, -0.1768198013305664, 2.9042749404907227, -0.03876972198486328, 0.2283644676208496, -1.0260093212127686], "mean_td_error": 0.10481075197458267, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 3000.0, "diff_num_grad_updates_vs_sampler_policy": 1879.3125}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 96000, "last_target_update_ts": 3501, "num_target_updates": 6}, "env_runners": {"episode_reward_max": 68.0, "episode_reward_min": 9.0, "episode_reward_mean": 21.64, "episode_len_mean": 21.64, "episode_media": {}, "episodes_timesteps_total": 2164, "policy_reward_min": {"default_policy": 9.0}, "policy_reward_max": {"default_policy": 68.0}, "policy_reward_mean": {"default_policy": 21.64}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.0, 26.0, 32.0, 20.0, 13.0, 18.0, 19.0, 13.0, 26.0, 11.0, 14.0, 13.0, 17.0, 35.0, 22.0, 28.0, 21.0, 15.0, 15.0, 20.0, 13.0, 15.0, 27.0, 28.0, 15.0, 35.0, 11.0, 20.0, 11.0, 27.0, 46.0, 17.0, 18.0, 17.0, 11.0, 15.0, 17.0, 12.0, 16.0, 14.0, 10.0, 17.0, 10.0, 11.0, 17.0, 17.0, 13.0, 15.0, 14.0, 12.0, 45.0, 9.0, 9.0, 15.0, 13.0, 29.0, 25.0, 11.0, 14.0, 14.0, 11.0, 12.0, 17.0, 15.0, 18.0, 15.0, 15.0, 15.0, 11.0, 9.0, 11.0, 14.0, 19.0, 33.0, 13.0, 12.0, 36.0, 64.0, 40.0, 27.0, 14.0, 12.0, 15.0, 18.0, 21.0, 19.0, 17.0, 20.0, 68.0, 20.0, 68.0, 68.0, 12.0, 21.0, 64.0, 59.0, 18.0, 47.0, 37.0, 40.0], "episode_lengths": [16, 26, 32, 20, 13, 18, 19, 13, 26, 11, 14, 13, 17, 35, 22, 28, 21, 15, 15, 20, 13, 15, 27, 28, 15, 35, 11, 20, 11, 27, 46, 17, 18, 17, 11, 15, 17, 12, 16, 14, 10, 17, 10, 11, 17, 17, 13, 15, 14, 12, 45, 9, 9, 15, 13, 29, 25, 11, 14, 14, 11, 12, 17, 15, 18, 15, 15, 15, 11, 9, 11, 14, 19, 33, 13, 12, 36, 64, 40, 27, 14, 12, 15, 18, 21, 19, 17, 20, 68, 20, 68, 68, 12, 21, 64, 59, 18, 47, 37, 40], "policy_default_policy_reward": [16.0, 26.0, 32.0, 20.0, 13.0, 18.0, 19.0, 13.0, 26.0, 11.0, 14.0, 13.0, 17.0, 35.0, 22.0, 28.0, 21.0, 15.0, 15.0, 20.0, 13.0, 15.0, 27.0, 28.0, 15.0, 35.0, 11.0, 20.0, 11.0, 27.0, 46.0, 17.0, 18.0, 17.0, 11.0, 15.0, 17.0, 12.0, 16.0, 14.0, 10.0, 17.0, 10.0, 11.0, 17.0, 17.0, 13.0, 15.0, 14.0, 12.0, 45.0, 9.0, 9.0, 15.0, 13.0, 29.0, 25.0, 11.0, 14.0, 14.0, 11.0, 12.0, 17.0, 15.0, 18.0, 15.0, 15.0, 15.0, 11.0, 9.0, 11.0, 14.0, 19.0, 33.0, 13.0, 12.0, 36.0, 64.0, 40.0, 27.0, 14.0, 12.0, 15.0, 18.0, 21.0, 19.0, 17.0, 20.0, 68.0, 20.0, 68.0, 68.0, 12.0, 21.0, 64.0, 59.0, 18.0, 47.0, 37.0, 40.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9931138852337952, "mean_inference_ms": 2.00470381211006, "mean_action_processing_ms": 0.2206197603536108, "mean_env_wait_ms": 0.09107094693645909, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015937089920043945, "StateBufferConnector_ms": 0.014000415802001953, "ViewRequirementAgentConnector_ms": 0.16562485694885254}, "num_episodes": 35, "episode_return_max": 68.0, "episode_return_min": 9.0, "episode_return_mean": 21.64, "episodes_this_iter": 35}, "num_healthy_workers": 0, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 40.327637440164814, "num_env_steps_trained_throughput_per_sec": 1290.484398085274, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 4000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 22583.584, "restore_workers_time_ms": 0.019, "training_step_time_ms": 26.245, "sample_time_ms": 3.293, "load_time_ms": 0.196, "load_throughput": 163680.156, "learn_time_ms": 10.59, "learn_throughput": 3021.588, "synch_weights_time_ms": 0.037}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 96000, "last_target_update_ts": 3501, "num_target_updates": 6}, "done": false, "training_iteration": 4, "trial_id": "5ce16_00000", "date": "2024-09-27_10-53-00", "timestamp": 1727405580, "time_this_iter_s": 24.798516511917114, "time_total_s": 90.34057521820068, "pid": 39427, "hostname": "gpu2gate1", "node_ip": "10.64.32.126", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.9828407522030984, "lr": 0.0007583973879008875, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f52e4d75580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 90.34057521820068, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 12.305555555555555, "ram_util_percent": 8.899999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.18968677520751953, "mean_q": 6.722379207611084, "min_q": 1.1064409017562866, "max_q": 8.81215763092041, "cur_lr": 0.0007583973879008875}, "td_error": [0.45748043060302734, 0.19994258880615234, -0.42165470123291016, -0.1733694076538086, 0.16257476806640625, 1.5533032417297363, -0.5198557376861572, 0.008644580841064453, 0.5596151351928711, 0.3968195915222168, -0.3412952423095703, -0.16815567016601562, 0.5858831405639648, 0.07261276245117188, 0.10644090175628662, -0.5688285827636719, -0.340604305267334, 0.556732177734375, 0.0075664520263671875, 0.5926885604858398, 0.18938064575195312, -0.34351539611816406, 0.02449798583984375, -0.8449850082397461, -0.3526620864868164, -0.113189697265625, -0.1251220703125, 0.03783011436462402, -0.21100115776062012, 0.2794628143310547, -0.08500480651855469, 0.0023441314697265625], "mean_td_error": 0.037018001079559326, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 4000.0, "diff_num_grad_updates_vs_sampler_policy": 2064.875}}, "num_env_steps_sampled": 5000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 5000, "num_agent_steps_trained": 128000, "last_target_update_ts": 4501, "num_target_updates": 8}, "env_runners": {"episode_reward_max": 108.0, "episode_reward_min": 9.0, "episode_reward_mean": 27.3, "episode_len_mean": 27.3, "episode_media": {}, "episodes_timesteps_total": 2730, "policy_reward_min": {"default_policy": 9.0}, "policy_reward_max": {"default_policy": 108.0}, "policy_reward_mean": {"default_policy": 27.3}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.0, 27.0, 28.0, 15.0, 35.0, 11.0, 20.0, 11.0, 27.0, 46.0, 17.0, 18.0, 17.0, 11.0, 15.0, 17.0, 12.0, 16.0, 14.0, 10.0, 17.0, 10.0, 11.0, 17.0, 17.0, 13.0, 15.0, 14.0, 12.0, 45.0, 9.0, 9.0, 15.0, 13.0, 29.0, 25.0, 11.0, 14.0, 14.0, 11.0, 12.0, 17.0, 15.0, 18.0, 15.0, 15.0, 15.0, 11.0, 9.0, 11.0, 14.0, 19.0, 33.0, 13.0, 12.0, 36.0, 64.0, 40.0, 27.0, 14.0, 12.0, 15.0, 18.0, 21.0, 19.0, 17.0, 20.0, 68.0, 20.0, 68.0, 68.0, 12.0, 21.0, 64.0, 59.0, 18.0, 47.0, 37.0, 40.0, 60.0, 61.0, 11.0, 22.0, 33.0, 60.0, 64.0, 26.0, 42.0, 27.0, 108.0, 10.0, 83.0, 42.0, 36.0, 52.0, 40.0, 46.0, 52.0, 41.0, 57.0], "episode_lengths": [15, 27, 28, 15, 35, 11, 20, 11, 27, 46, 17, 18, 17, 11, 15, 17, 12, 16, 14, 10, 17, 10, 11, 17, 17, 13, 15, 14, 12, 45, 9, 9, 15, 13, 29, 25, 11, 14, 14, 11, 12, 17, 15, 18, 15, 15, 15, 11, 9, 11, 14, 19, 33, 13, 12, 36, 64, 40, 27, 14, 12, 15, 18, 21, 19, 17, 20, 68, 20, 68, 68, 12, 21, 64, 59, 18, 47, 37, 40, 60, 61, 11, 22, 33, 60, 64, 26, 42, 27, 108, 10, 83, 42, 36, 52, 40, 46, 52, 41, 57], "policy_default_policy_reward": [15.0, 27.0, 28.0, 15.0, 35.0, 11.0, 20.0, 11.0, 27.0, 46.0, 17.0, 18.0, 17.0, 11.0, 15.0, 17.0, 12.0, 16.0, 14.0, 10.0, 17.0, 10.0, 11.0, 17.0, 17.0, 13.0, 15.0, 14.0, 12.0, 45.0, 9.0, 9.0, 15.0, 13.0, 29.0, 25.0, 11.0, 14.0, 14.0, 11.0, 12.0, 17.0, 15.0, 18.0, 15.0, 15.0, 15.0, 11.0, 9.0, 11.0, 14.0, 19.0, 33.0, 13.0, 12.0, 36.0, 64.0, 40.0, 27.0, 14.0, 12.0, 15.0, 18.0, 21.0, 19.0, 17.0, 20.0, 68.0, 20.0, 68.0, 68.0, 12.0, 21.0, 64.0, 59.0, 18.0, 47.0, 37.0, 40.0, 60.0, 61.0, 11.0, 22.0, 33.0, 60.0, 64.0, 26.0, 42.0, 27.0, 108.0, 10.0, 83.0, 42.0, 36.0, 52.0, 40.0, 46.0, 52.0, 41.0, 57.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9889292517213257, "mean_inference_ms": 1.9914441783278043, "mean_action_processing_ms": 0.2202891013598688, "mean_env_wait_ms": 0.09154818514999455, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016294479370117188, "StateBufferConnector_ms": 0.014221429824829102, "ViewRequirementAgentConnector_ms": 0.17102575302124023}, "num_episodes": 21, "episode_return_max": 108.0, "episode_return_min": 9.0, "episode_return_mean": 27.3, "episodes_this_iter": 21}, "num_healthy_workers": 0, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 5000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 29.443180381037056, "num_env_steps_trained_throughput_per_sec": 942.1817721931858, "timesteps_total": 5000, "num_env_steps_sampled_lifetime": 5000, "num_agent_steps_sampled_lifetime": 5000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 5000, "timers": {"training_iteration_time_ms": 24859.622, "restore_workers_time_ms": 0.02, "training_step_time_ms": 30.884, "sample_time_ms": 4.001, "load_time_ms": 0.211, "load_throughput": 151898.742, "learn_time_ms": 12.524, "learn_throughput": 2555.015, "synch_weights_time_ms": 0.045}, "counters": {"num_env_steps_sampled": 5000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 5000, "num_agent_steps_trained": 128000, "last_target_update_ts": 4501, "num_target_updates": 8}, "done": false, "training_iteration": 5, "trial_id": "5ce16_00000", "date": "2024-09-27_10-53-34", "timestamp": 1727405614, "time_this_iter_s": 33.96532368659973, "time_total_s": 124.30589890480042, "pid": 39427, "hostname": "gpu2gate1", "node_ip": "10.64.32.126", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.9828407522030984, "lr": 0.0007583973879008875, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f52e4d75580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 124.30589890480042, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 11.666666666666666, "ram_util_percent": 8.950000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.15266746282577515, "mean_q": 8.677166938781738, "min_q": 0.3576962947845459, "max_q": 11.197209358215332, "cur_lr": 0.0007583973879008875}, "td_error": [-0.12216567993164062, -1.50947904586792, -0.6423037052154541, 0.1625661849975586, -0.13852882385253906, 0.33989477157592773, 0.25240325927734375, -0.023822784423828125, 0.16019439697265625, -0.09078788757324219, -1.9127745628356934, 0.2702054977416992, 0.9827282428741455, 1.5498409271240234, 0.23542404174804688, -0.16934871673583984, 0.3611288070678711, -0.3343229293823242, -0.028458595275878906, -0.11910820007324219, -0.09923744201660156, -0.02717304229736328, -0.18553876876831055, -0.032276153564453125, -0.2692537307739258, 1.0149364471435547, 0.11915874481201172, -0.6406407356262207, 0.14882659912109375, -0.2055072784423828, 0.24803543090820312, -0.012188911437988281], "mean_td_error": -0.022424176335334778, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 5000.0, "diff_num_grad_updates_vs_sampler_policy": 2981.34375}}, "num_env_steps_sampled": 6000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 6000, "num_agent_steps_trained": 160000, "last_target_update_ts": 5501, "num_target_updates": 10}, "env_runners": {"episode_reward_max": 158.0, "episode_reward_min": 9.0, "episode_reward_mean": 32.83, "episode_len_mean": 32.83, "episode_media": {}, "episodes_timesteps_total": 3283, "policy_reward_min": {"default_policy": 9.0}, "policy_reward_max": {"default_policy": 158.0}, "policy_reward_mean": {"default_policy": 32.83}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.0, 11.0, 17.0, 17.0, 13.0, 15.0, 14.0, 12.0, 45.0, 9.0, 9.0, 15.0, 13.0, 29.0, 25.0, 11.0, 14.0, 14.0, 11.0, 12.0, 17.0, 15.0, 18.0, 15.0, 15.0, 15.0, 11.0, 9.0, 11.0, 14.0, 19.0, 33.0, 13.0, 12.0, 36.0, 64.0, 40.0, 27.0, 14.0, 12.0, 15.0, 18.0, 21.0, 19.0, 17.0, 20.0, 68.0, 20.0, 68.0, 68.0, 12.0, 21.0, 64.0, 59.0, 18.0, 47.0, 37.0, 40.0, 60.0, 61.0, 11.0, 22.0, 33.0, 60.0, 64.0, 26.0, 42.0, 27.0, 108.0, 10.0, 83.0, 42.0, 36.0, 52.0, 40.0, 46.0, 52.0, 41.0, 57.0, 45.0, 45.0, 92.0, 21.0, 158.0, 28.0, 86.0, 55.0, 13.0, 10.0, 19.0, 85.0, 44.0, 51.0, 21.0, 20.0, 80.0, 20.0, 15.0, 31.0, 13.0], "episode_lengths": [10, 11, 17, 17, 13, 15, 14, 12, 45, 9, 9, 15, 13, 29, 25, 11, 14, 14, 11, 12, 17, 15, 18, 15, 15, 15, 11, 9, 11, 14, 19, 33, 13, 12, 36, 64, 40, 27, 14, 12, 15, 18, 21, 19, 17, 20, 68, 20, 68, 68, 12, 21, 64, 59, 18, 47, 37, 40, 60, 61, 11, 22, 33, 60, 64, 26, 42, 27, 108, 10, 83, 42, 36, 52, 40, 46, 52, 41, 57, 45, 45, 92, 21, 158, 28, 86, 55, 13, 10, 19, 85, 44, 51, 21, 20, 80, 20, 15, 31, 13], "policy_default_policy_reward": [10.0, 11.0, 17.0, 17.0, 13.0, 15.0, 14.0, 12.0, 45.0, 9.0, 9.0, 15.0, 13.0, 29.0, 25.0, 11.0, 14.0, 14.0, 11.0, 12.0, 17.0, 15.0, 18.0, 15.0, 15.0, 15.0, 11.0, 9.0, 11.0, 14.0, 19.0, 33.0, 13.0, 12.0, 36.0, 64.0, 40.0, 27.0, 14.0, 12.0, 15.0, 18.0, 21.0, 19.0, 17.0, 20.0, 68.0, 20.0, 68.0, 68.0, 12.0, 21.0, 64.0, 59.0, 18.0, 47.0, 37.0, 40.0, 60.0, 61.0, 11.0, 22.0, 33.0, 60.0, 64.0, 26.0, 42.0, 27.0, 108.0, 10.0, 83.0, 42.0, 36.0, 52.0, 40.0, 46.0, 52.0, 41.0, 57.0, 45.0, 45.0, 92.0, 21.0, 158.0, 28.0, 86.0, 55.0, 13.0, 10.0, 19.0, 85.0, 44.0, 51.0, 21.0, 20.0, 80.0, 20.0, 15.0, 31.0, 13.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9849039236647724, "mean_inference_ms": 1.9773147508187876, "mean_action_processing_ms": 0.22027842797866504, "mean_env_wait_ms": 0.09208699860964273, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016366243362426758, "StateBufferConnector_ms": 0.014402627944946289, "ViewRequirementAgentConnector_ms": 0.17347168922424316}, "num_episodes": 21, "episode_return_max": 158.0, "episode_return_min": 9.0, "episode_return_mean": 32.83, "episodes_this_iter": 21}, "num_healthy_workers": 0, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 6000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 32.27326869252236, "num_env_steps_trained_throughput_per_sec": 1032.7445981607154, "timesteps_total": 6000, "num_env_steps_sampled_lifetime": 6000, "num_agent_steps_sampled_lifetime": 6000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 6000, "timers": {"training_iteration_time_ms": 25880.594, "restore_workers_time_ms": 0.019, "training_step_time_ms": 30.371, "sample_time_ms": 3.625, "load_time_ms": 0.222, "load_throughput": 144320.138, "learn_time_ms": 12.44, "learn_throughput": 2572.408, "synch_weights_time_ms": 0.043}, "counters": {"num_env_steps_sampled": 6000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 6000, "num_agent_steps_trained": 160000, "last_target_update_ts": 5501, "num_target_updates": 10}, "done": false, "training_iteration": 6, "trial_id": "5ce16_00000", "date": "2024-09-27_10-54-06", "timestamp": 1727405646, "time_this_iter_s": 30.98690128326416, "time_total_s": 155.29280018806458, "pid": 39427, "hostname": "gpu2gate1", "node_ip": "10.64.32.126", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.9828407522030984, "lr": 0.0007583973879008875, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f52e4d75580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 155.29280018806458, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 11.886363636363637, "ram_util_percent": 9.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.19270817935466766, "mean_q": 10.422534942626953, "min_q": 1.5853650569915771, "max_q": 12.283496856689453, "cur_lr": 0.0007583973879008875}, "td_error": [-0.47357177734375, -0.0061473846435546875, 0.07235383987426758, -0.212127685546875, 0.8434250354766846, 1.9372410774230957, -1.173346996307373, 0.0007410049438476562, 0.055278778076171875, 1.6996355056762695, -0.02030181884765625, 0.17810726165771484, -0.0749969482421875, 0.1277914047241211, -0.11098480224609375, 0.13769817352294922, 0.9444141387939453, -0.05063438415527344, -0.05252552032470703, 0.30698585510253906, 0.5853650569915771, 0.9936943054199219, 0.020849227905273438, -0.05896282196044922, -0.29384517669677734, 0.2918214797973633, 0.0722808837890625, 0.11580085754394531, -0.12818431854248047, 0.44051647186279297, -0.5574488639831543, -1.0441503524780273], "mean_td_error": 0.1427116096019745, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 6000.0, "diff_num_grad_updates_vs_sampler_policy": 3334.375}}, "num_env_steps_sampled": 7000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 7000, "num_agent_steps_trained": 192000, "last_target_update_ts": 6501, "num_target_updates": 12}, "env_runners": {"episode_reward_max": 158.0, "episode_reward_min": 9.0, "episode_reward_mean": 40.24, "episode_len_mean": 40.24, "episode_media": {}, "episodes_timesteps_total": 4024, "policy_reward_min": {"default_policy": 9.0}, "policy_reward_max": {"default_policy": 158.0}, "policy_reward_mean": {"default_policy": 40.24}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.0, 18.0, 15.0, 15.0, 15.0, 11.0, 9.0, 11.0, 14.0, 19.0, 33.0, 13.0, 12.0, 36.0, 64.0, 40.0, 27.0, 14.0, 12.0, 15.0, 18.0, 21.0, 19.0, 17.0, 20.0, 68.0, 20.0, 68.0, 68.0, 12.0, 21.0, 64.0, 59.0, 18.0, 47.0, 37.0, 40.0, 60.0, 61.0, 11.0, 22.0, 33.0, 60.0, 64.0, 26.0, 42.0, 27.0, 108.0, 10.0, 83.0, 42.0, 36.0, 52.0, 40.0, 46.0, 52.0, 41.0, 57.0, 45.0, 45.0, 92.0, 21.0, 158.0, 28.0, 86.0, 55.0, 13.0, 10.0, 19.0, 85.0, 44.0, 51.0, 21.0, 20.0, 80.0, 20.0, 15.0, 31.0, 13.0, 92.0, 29.0, 39.0, 50.0, 24.0, 33.0, 128.0, 120.0, 70.0, 31.0, 69.0, 20.0, 11.0, 86.0, 85.0, 12.0, 15.0, 11.0, 13.0, 49.0, 87.0], "episode_lengths": [15, 18, 15, 15, 15, 11, 9, 11, 14, 19, 33, 13, 12, 36, 64, 40, 27, 14, 12, 15, 18, 21, 19, 17, 20, 68, 20, 68, 68, 12, 21, 64, 59, 18, 47, 37, 40, 60, 61, 11, 22, 33, 60, 64, 26, 42, 27, 108, 10, 83, 42, 36, 52, 40, 46, 52, 41, 57, 45, 45, 92, 21, 158, 28, 86, 55, 13, 10, 19, 85, 44, 51, 21, 20, 80, 20, 15, 31, 13, 92, 29, 39, 50, 24, 33, 128, 120, 70, 31, 69, 20, 11, 86, 85, 12, 15, 11, 13, 49, 87], "policy_default_policy_reward": [15.0, 18.0, 15.0, 15.0, 15.0, 11.0, 9.0, 11.0, 14.0, 19.0, 33.0, 13.0, 12.0, 36.0, 64.0, 40.0, 27.0, 14.0, 12.0, 15.0, 18.0, 21.0, 19.0, 17.0, 20.0, 68.0, 20.0, 68.0, 68.0, 12.0, 21.0, 64.0, 59.0, 18.0, 47.0, 37.0, 40.0, 60.0, 61.0, 11.0, 22.0, 33.0, 60.0, 64.0, 26.0, 42.0, 27.0, 108.0, 10.0, 83.0, 42.0, 36.0, 52.0, 40.0, 46.0, 52.0, 41.0, 57.0, 45.0, 45.0, 92.0, 21.0, 158.0, 28.0, 86.0, 55.0, 13.0, 10.0, 19.0, 85.0, 44.0, 51.0, 21.0, 20.0, 80.0, 20.0, 15.0, 31.0, 13.0, 92.0, 29.0, 39.0, 50.0, 24.0, 33.0, 128.0, 120.0, 70.0, 31.0, 69.0, 20.0, 11.0, 86.0, 85.0, 12.0, 15.0, 11.0, 13.0, 49.0, 87.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9821515772295073, "mean_inference_ms": 1.966932465510795, "mean_action_processing_ms": 0.22066548070709666, "mean_env_wait_ms": 0.09284276516968663, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016892194747924805, "StateBufferConnector_ms": 0.01483297348022461, "ViewRequirementAgentConnector_ms": 0.1812279224395752}, "num_episodes": 21, "episode_return_max": 158.0, "episode_return_min": 9.0, "episode_return_mean": 40.24, "episodes_this_iter": 21}, "num_healthy_workers": 0, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 7000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 30.88899128830088, "num_env_steps_trained_throughput_per_sec": 988.4477212256281, "timesteps_total": 7000, "num_env_steps_sampled_lifetime": 7000, "num_agent_steps_sampled_lifetime": 7000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 7000, "timers": {"training_iteration_time_ms": 26808.23, "restore_workers_time_ms": 0.022, "training_step_time_ms": 31.641, "sample_time_ms": 4.035, "load_time_ms": 0.258, "load_throughput": 124000.118, "learn_time_ms": 12.671, "learn_throughput": 2525.496, "synch_weights_time_ms": 0.05}, "counters": {"num_env_steps_sampled": 7000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 7000, "num_agent_steps_trained": 192000, "last_target_update_ts": 6501, "num_target_updates": 12}, "done": false, "training_iteration": 7, "trial_id": "5ce16_00000", "date": "2024-09-27_10-54-38", "timestamp": 1727405678, "time_this_iter_s": 32.375787019729614, "time_total_s": 187.6685872077942, "pid": 39427, "hostname": "gpu2gate1", "node_ip": "10.64.32.126", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.9828407522030984, "lr": 0.0007583973879008875, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f52e4d75580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 187.6685872077942, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 11.81777777777778, "ram_util_percent": 9.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.584039568901062, "mean_q": 12.945035934448242, "min_q": 1.2785923480987549, "max_q": 14.216190338134766, "cur_lr": 0.0007583973879008875}, "td_error": [0.34558677673339844, 0.33806324005126953, 0.4253349304199219, 0.40145206451416016, 0.3591117858886719, 0.3484811782836914, 0.4209871292114258, 0.24407196044921875, 0.29388904571533203, -1.4943501949310303, 0.6065158843994141, 0.3596353530883789, -0.11015510559082031, 0.4349327087402344, 0.32532405853271484, 0.8620424270629883, 0.18497562408447266, 0.3019981384277344, 0.4480743408203125, 0.12418746948242188, 0.7372493743896484, 0.31336116790771484, 0.589085578918457, 0.01661396026611328, 0.49971771240234375, 0.11484718322753906, 0.20060348510742188, 0.0092315673828125, 0.3881034851074219, 0.4194936752319336, 0.7645063400268555, 0.3977823257446289], "mean_td_error": 0.30221107602119446, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 7000.0, "diff_num_grad_updates_vs_sampler_policy": 3846.96875}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 224000, "last_target_update_ts": 7501, "num_target_updates": 14}, "env_runners": {"episode_reward_max": 227.0, "episode_reward_min": 10.0, "episode_reward_mean": 47.41, "episode_len_mean": 47.41, "episode_media": {}, "episodes_timesteps_total": 4741, "policy_reward_min": {"default_policy": 10.0}, "policy_reward_max": {"default_policy": 227.0}, "policy_reward_mean": {"default_policy": 47.41}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12.0, 36.0, 64.0, 40.0, 27.0, 14.0, 12.0, 15.0, 18.0, 21.0, 19.0, 17.0, 20.0, 68.0, 20.0, 68.0, 68.0, 12.0, 21.0, 64.0, 59.0, 18.0, 47.0, 37.0, 40.0, 60.0, 61.0, 11.0, 22.0, 33.0, 60.0, 64.0, 26.0, 42.0, 27.0, 108.0, 10.0, 83.0, 42.0, 36.0, 52.0, 40.0, 46.0, 52.0, 41.0, 57.0, 45.0, 45.0, 92.0, 21.0, 158.0, 28.0, 86.0, 55.0, 13.0, 10.0, 19.0, 85.0, 44.0, 51.0, 21.0, 20.0, 80.0, 20.0, 15.0, 31.0, 13.0, 92.0, 29.0, 39.0, 50.0, 24.0, 33.0, 128.0, 120.0, 70.0, 31.0, 69.0, 20.0, 11.0, 86.0, 85.0, 12.0, 15.0, 11.0, 13.0, 49.0, 87.0, 11.0, 57.0, 114.0, 76.0, 14.0, 16.0, 98.0, 62.0, 17.0, 227.0, 93.0, 120.0], "episode_lengths": [12, 36, 64, 40, 27, 14, 12, 15, 18, 21, 19, 17, 20, 68, 20, 68, 68, 12, 21, 64, 59, 18, 47, 37, 40, 60, 61, 11, 22, 33, 60, 64, 26, 42, 27, 108, 10, 83, 42, 36, 52, 40, 46, 52, 41, 57, 45, 45, 92, 21, 158, 28, 86, 55, 13, 10, 19, 85, 44, 51, 21, 20, 80, 20, 15, 31, 13, 92, 29, 39, 50, 24, 33, 128, 120, 70, 31, 69, 20, 11, 86, 85, 12, 15, 11, 13, 49, 87, 11, 57, 114, 76, 14, 16, 98, 62, 17, 227, 93, 120], "policy_default_policy_reward": [12.0, 36.0, 64.0, 40.0, 27.0, 14.0, 12.0, 15.0, 18.0, 21.0, 19.0, 17.0, 20.0, 68.0, 20.0, 68.0, 68.0, 12.0, 21.0, 64.0, 59.0, 18.0, 47.0, 37.0, 40.0, 60.0, 61.0, 11.0, 22.0, 33.0, 60.0, 64.0, 26.0, 42.0, 27.0, 108.0, 10.0, 83.0, 42.0, 36.0, 52.0, 40.0, 46.0, 52.0, 41.0, 57.0, 45.0, 45.0, 92.0, 21.0, 158.0, 28.0, 86.0, 55.0, 13.0, 10.0, 19.0, 85.0, 44.0, 51.0, 21.0, 20.0, 80.0, 20.0, 15.0, 31.0, 13.0, 92.0, 29.0, 39.0, 50.0, 24.0, 33.0, 128.0, 120.0, 70.0, 31.0, 69.0, 20.0, 11.0, 86.0, 85.0, 12.0, 15.0, 11.0, 13.0, 49.0, 87.0, 11.0, 57.0, 114.0, 76.0, 14.0, 16.0, 98.0, 62.0, 17.0, 227.0, 93.0, 120.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9844442738753929, "mean_inference_ms": 1.9706168808179825, "mean_action_processing_ms": 0.22181237245258273, "mean_env_wait_ms": 0.09356142769700472, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01729273796081543, "StateBufferConnector_ms": 0.014964818954467773, "ViewRequirementAgentConnector_ms": 0.18556666374206543}, "num_episodes": 12, "episode_return_max": 227.0, "episode_return_min": 10.0, "episode_return_mean": 47.41, "episodes_this_iter": 12}, "num_healthy_workers": 0, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 224000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 224000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 34.18783633432798, "num_env_steps_trained_throughput_per_sec": 1094.0107626984955, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 8000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 27113.479, "restore_workers_time_ms": 0.026, "training_step_time_ms": 25.703, "sample_time_ms": 3.037, "load_time_ms": 0.244, "load_throughput": 131161.661, "learn_time_ms": 10.519, "learn_throughput": 3042.072, "synch_weights_time_ms": 0.036}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 224000, "last_target_update_ts": 7501, "num_target_updates": 14}, "done": false, "training_iteration": 8, "trial_id": "5ce16_00000", "date": "2024-09-27_10-55-07", "timestamp": 1727405707, "time_this_iter_s": 29.251704931259155, "time_total_s": 216.92029213905334, "pid": 39427, "hostname": "gpu2gate1", "node_ip": "10.64.32.126", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.9828407522030984, "lr": 0.0007583973879008875, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f52e4d75580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 216.92029213905334, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 12.540476190476191, "ram_util_percent": 9.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.34709668159484863, "mean_q": 11.004276275634766, "min_q": 1.0822285413742065, "max_q": 15.752681732177734, "cur_lr": 0.0007583973879008875}, "td_error": [-0.04051494598388672, -0.34813928604125977, 2.674419403076172, -0.044531822204589844, -0.1542978286743164, 1.589223861694336, -0.5061304569244385, -0.11895465850830078, -0.8234286308288574, -0.14703941345214844, -0.07592582702636719, 0.17005813121795654, 2.4405903816223145, -0.6331167221069336, 0.06547260284423828, -0.029542922973632812, 1.985167145729065, 0.3937339782714844, 0.25116825103759766, 0.05448627471923828, -0.03551483154296875, 0.04543495178222656, 0.4936647415161133, -1.763875961303711, -0.017194747924804688, -0.1723647117614746, -0.26062965393066406, 0.03864479064941406, 0.04256153106689453, -0.41025733947753906, -0.08070564270019531, -1.085555076599121], "mean_td_error": 0.10927829146385193, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 8000.0, "diff_num_grad_updates_vs_sampler_policy": 4288.875}}, "num_env_steps_sampled": 9000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 9000, "num_agent_steps_trained": 256000, "last_target_update_ts": 8501, "num_target_updates": 16}, "env_runners": {"episode_reward_max": 227.0, "episode_reward_min": 10.0, "episode_reward_mean": 55.95, "episode_len_mean": 55.95, "episode_media": {}, "episodes_timesteps_total": 5595, "policy_reward_min": {"default_policy": 10.0}, "policy_reward_max": {"default_policy": 227.0}, "policy_reward_mean": {"default_policy": 55.95}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18.0, 21.0, 19.0, 17.0, 20.0, 68.0, 20.0, 68.0, 68.0, 12.0, 21.0, 64.0, 59.0, 18.0, 47.0, 37.0, 40.0, 60.0, 61.0, 11.0, 22.0, 33.0, 60.0, 64.0, 26.0, 42.0, 27.0, 108.0, 10.0, 83.0, 42.0, 36.0, 52.0, 40.0, 46.0, 52.0, 41.0, 57.0, 45.0, 45.0, 92.0, 21.0, 158.0, 28.0, 86.0, 55.0, 13.0, 10.0, 19.0, 85.0, 44.0, 51.0, 21.0, 20.0, 80.0, 20.0, 15.0, 31.0, 13.0, 92.0, 29.0, 39.0, 50.0, 24.0, 33.0, 128.0, 120.0, 70.0, 31.0, 69.0, 20.0, 11.0, 86.0, 85.0, 12.0, 15.0, 11.0, 13.0, 49.0, 87.0, 11.0, 57.0, 114.0, 76.0, 14.0, 16.0, 98.0, 62.0, 17.0, 227.0, 93.0, 120.0, 127.0, 123.0, 137.0, 155.0, 156.0, 112.0, 121.0, 143.0], "episode_lengths": [18, 21, 19, 17, 20, 68, 20, 68, 68, 12, 21, 64, 59, 18, 47, 37, 40, 60, 61, 11, 22, 33, 60, 64, 26, 42, 27, 108, 10, 83, 42, 36, 52, 40, 46, 52, 41, 57, 45, 45, 92, 21, 158, 28, 86, 55, 13, 10, 19, 85, 44, 51, 21, 20, 80, 20, 15, 31, 13, 92, 29, 39, 50, 24, 33, 128, 120, 70, 31, 69, 20, 11, 86, 85, 12, 15, 11, 13, 49, 87, 11, 57, 114, 76, 14, 16, 98, 62, 17, 227, 93, 120, 127, 123, 137, 155, 156, 112, 121, 143], "policy_default_policy_reward": [18.0, 21.0, 19.0, 17.0, 20.0, 68.0, 20.0, 68.0, 68.0, 12.0, 21.0, 64.0, 59.0, 18.0, 47.0, 37.0, 40.0, 60.0, 61.0, 11.0, 22.0, 33.0, 60.0, 64.0, 26.0, 42.0, 27.0, 108.0, 10.0, 83.0, 42.0, 36.0, 52.0, 40.0, 46.0, 52.0, 41.0, 57.0, 45.0, 45.0, 92.0, 21.0, 158.0, 28.0, 86.0, 55.0, 13.0, 10.0, 19.0, 85.0, 44.0, 51.0, 21.0, 20.0, 80.0, 20.0, 15.0, 31.0, 13.0, 92.0, 29.0, 39.0, 50.0, 24.0, 33.0, 128.0, 120.0, 70.0, 31.0, 69.0, 20.0, 11.0, 86.0, 85.0, 12.0, 15.0, 11.0, 13.0, 49.0, 87.0, 11.0, 57.0, 114.0, 76.0, 14.0, 16.0, 98.0, 62.0, 17.0, 227.0, 93.0, 120.0, 127.0, 123.0, 137.0, 155.0, 156.0, 112.0, 121.0, 143.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9853197760433241, "mean_inference_ms": 1.9718050253544295, "mean_action_processing_ms": 0.2224659190964087, "mean_env_wait_ms": 0.09400389465518336, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01748347282409668, "StateBufferConnector_ms": 0.015037298202514648, "ViewRequirementAgentConnector_ms": 0.18645477294921875}, "num_episodes": 8, "episode_return_max": 227.0, "episode_return_min": 10.0, "episode_return_mean": 55.95, "episodes_this_iter": 8}, "num_healthy_workers": 0, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9000, "num_agent_steps_trained": 256000, "num_env_steps_sampled": 9000, "num_env_steps_trained": 256000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 37.58855275830601, "num_env_steps_trained_throughput_per_sec": 1202.8336882657923, "timesteps_total": 9000, "num_env_steps_sampled_lifetime": 9000, "num_agent_steps_sampled_lifetime": 9000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 9000, "timers": {"training_iteration_time_ms": 27056.859, "restore_workers_time_ms": 0.018, "training_step_time_ms": 27.33, "sample_time_ms": 3.356, "load_time_ms": 0.203, "load_throughput": 157977.552, "learn_time_ms": 10.886, "learn_throughput": 2939.555, "synch_weights_time_ms": 0.042}, "counters": {"num_env_steps_sampled": 9000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 9000, "num_agent_steps_trained": 256000, "last_target_update_ts": 8501, "num_target_updates": 16}, "done": false, "training_iteration": 9, "trial_id": "5ce16_00000", "date": "2024-09-27_10-55-34", "timestamp": 1727405734, "time_this_iter_s": 26.605241537094116, "time_total_s": 243.52553367614746, "pid": 39427, "hostname": "gpu2gate1", "node_ip": "10.64.32.126", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.9828407522030984, "lr": 0.0007583973879008875, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f52e4d75580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 243.52553367614746, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 11.956756756756759, "ram_util_percent": 9.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.22592736780643463, "mean_q": 12.812390327453613, "min_q": -0.8477339148521423, "max_q": 17.770702362060547, "cur_lr": 0.0007583973879008875}, "td_error": [11.678302764892578, 0.17560195922851562, 0.1998119354248047, 2.067824602127075, -0.3432455062866211, -0.15741443634033203, 1.632392406463623, 0.28729820251464844, 0.08404731750488281, 0.47203826904296875, 0.07769966125488281, 0.024105072021484375, 0.27300262451171875, -0.1434345245361328, -1.6565866470336914, 0.055080413818359375, 0.2715167999267578, -0.25716209411621094, -0.22936058044433594, -0.28708457946777344, 0.1928253173828125, -1.0291334390640259, -0.17997515201568604, 0.23457717895507812, -1.847733974456787, 0.08599853515625, 0.04995918273925781, -0.010791778564453125, -0.43334537744522095, -0.17461776733398438, -0.7711410522460938, -0.22350692749023438], "mean_td_error": 0.31617334485054016, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 9000.0, "diff_num_grad_updates_vs_sampler_policy": 5355.71875}}, "num_env_steps_sampled": 10000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 10000, "num_agent_steps_trained": 288000, "last_target_update_ts": 9501, "num_target_updates": 18}, "env_runners": {"episode_reward_max": 227.0, "episode_reward_min": 10.0, "episode_reward_mean": 64.03, "episode_len_mean": 64.03, "episode_media": {}, "episodes_timesteps_total": 6403, "policy_reward_min": {"default_policy": 10.0}, "policy_reward_max": {"default_policy": 227.0}, "policy_reward_mean": {"default_policy": 64.03}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.0, 68.0, 68.0, 12.0, 21.0, 64.0, 59.0, 18.0, 47.0, 37.0, 40.0, 60.0, 61.0, 11.0, 22.0, 33.0, 60.0, 64.0, 26.0, 42.0, 27.0, 108.0, 10.0, 83.0, 42.0, 36.0, 52.0, 40.0, 46.0, 52.0, 41.0, 57.0, 45.0, 45.0, 92.0, 21.0, 158.0, 28.0, 86.0, 55.0, 13.0, 10.0, 19.0, 85.0, 44.0, 51.0, 21.0, 20.0, 80.0, 20.0, 15.0, 31.0, 13.0, 92.0, 29.0, 39.0, 50.0, 24.0, 33.0, 128.0, 120.0, 70.0, 31.0, 69.0, 20.0, 11.0, 86.0, 85.0, 12.0, 15.0, 11.0, 13.0, 49.0, 87.0, 11.0, 57.0, 114.0, 76.0, 14.0, 16.0, 98.0, 62.0, 17.0, 227.0, 93.0, 120.0, 127.0, 123.0, 137.0, 155.0, 156.0, 112.0, 121.0, 143.0, 144.0, 138.0, 148.0, 155.0, 194.0, 192.0], "episode_lengths": [20, 68, 68, 12, 21, 64, 59, 18, 47, 37, 40, 60, 61, 11, 22, 33, 60, 64, 26, 42, 27, 108, 10, 83, 42, 36, 52, 40, 46, 52, 41, 57, 45, 45, 92, 21, 158, 28, 86, 55, 13, 10, 19, 85, 44, 51, 21, 20, 80, 20, 15, 31, 13, 92, 29, 39, 50, 24, 33, 128, 120, 70, 31, 69, 20, 11, 86, 85, 12, 15, 11, 13, 49, 87, 11, 57, 114, 76, 14, 16, 98, 62, 17, 227, 93, 120, 127, 123, 137, 155, 156, 112, 121, 143, 144, 138, 148, 155, 194, 192], "policy_default_policy_reward": [20.0, 68.0, 68.0, 12.0, 21.0, 64.0, 59.0, 18.0, 47.0, 37.0, 40.0, 60.0, 61.0, 11.0, 22.0, 33.0, 60.0, 64.0, 26.0, 42.0, 27.0, 108.0, 10.0, 83.0, 42.0, 36.0, 52.0, 40.0, 46.0, 52.0, 41.0, 57.0, 45.0, 45.0, 92.0, 21.0, 158.0, 28.0, 86.0, 55.0, 13.0, 10.0, 19.0, 85.0, 44.0, 51.0, 21.0, 20.0, 80.0, 20.0, 15.0, 31.0, 13.0, 92.0, 29.0, 39.0, 50.0, 24.0, 33.0, 128.0, 120.0, 70.0, 31.0, 69.0, 20.0, 11.0, 86.0, 85.0, 12.0, 15.0, 11.0, 13.0, 49.0, 87.0, 11.0, 57.0, 114.0, 76.0, 14.0, 16.0, 98.0, 62.0, 17.0, 227.0, 93.0, 120.0, 127.0, 123.0, 137.0, 155.0, 156.0, 112.0, 121.0, 143.0, 144.0, 138.0, 148.0, 155.0, 194.0, 192.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9866078877386658, "mean_inference_ms": 1.9738833527944741, "mean_action_processing_ms": 0.22317712447860605, "mean_env_wait_ms": 0.09443443407238697, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01776432991027832, "StateBufferConnector_ms": 0.015215873718261719, "ViewRequirementAgentConnector_ms": 0.19018220901489258}, "num_episodes": 6, "episode_return_max": 227.0, "episode_return_min": 10.0, "episode_return_mean": 64.03, "episodes_this_iter": 6}, "num_healthy_workers": 0, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10000, "num_agent_steps_trained": 288000, "num_env_steps_sampled": 10000, "num_env_steps_trained": 288000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 29.907745854923935, "num_env_steps_trained_throughput_per_sec": 957.0478673575659, "timesteps_total": 10000, "num_env_steps_sampled_lifetime": 10000, "num_agent_steps_sampled_lifetime": 10000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 10000, "timers": {"training_iteration_time_ms": 27694.792, "restore_workers_time_ms": 0.022, "training_step_time_ms": 34.225, "sample_time_ms": 4.247, "load_time_ms": 0.248, "load_throughput": 129130.006, "learn_time_ms": 13.641, "learn_throughput": 2345.947, "synch_weights_time_ms": 0.056}, "counters": {"num_env_steps_sampled": 10000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 10000, "num_agent_steps_trained": 288000, "last_target_update_ts": 9501, "num_target_updates": 18}, "done": false, "training_iteration": 10, "trial_id": "5ce16_00000", "date": "2024-09-27_10-56-08", "timestamp": 1727405768, "time_this_iter_s": 33.43791913986206, "time_total_s": 276.9634528160095, "pid": 39427, "hostname": "gpu2gate1", "node_ip": "10.64.32.126", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.9828407522030984, "lr": 0.0007583973879008875, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f52e4d75580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 276.9634528160095, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 11.825531914893617, "ram_util_percent": 9.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6164875626564026, "mean_q": 14.17231273651123, "min_q": -0.07751953601837158, "max_q": 18.8396053314209, "cur_lr": 0.0007583973879008875}, "td_error": [14.24112606048584, 12.425525665283203, -0.12183761596679688, 0.030551910400390625, -1.7345094680786133, -1.9889068603515625, -0.3984394073486328, -0.21196556091308594, 0.06421279907226562, -0.06664848327636719, 0.1994171142578125, -0.1735391616821289, -0.7158894538879395, -0.1484355926513672, -0.153961181640625, 0.11826896667480469, -0.004683494567871094, 0.2154855728149414, -0.0407257080078125, -0.3196887969970703, 0.44293880462646484, 1.7392268180847168, 0.23281478881835938, 0.49948883056640625, 0.8223261833190918, 14.619511604309082, -1.3122119903564453, -2.0651931762695312, -1.0775195360183716, 1.037156105041504, 0.13632965087890625, -0.36090660095214844], "mean_td_error": 1.122791051864624, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 10000.0, "diff_num_grad_updates_vs_sampler_policy": 5316.5625}}, "num_env_steps_sampled": 11000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 11000, "num_agent_steps_trained": 320000, "last_target_update_ts": 10501, "num_target_updates": 20}, "env_runners": {"episode_reward_max": 300.0, "episode_reward_min": 10.0, "episode_reward_mean": 71.06, "episode_len_mean": 71.06, "episode_media": {}, "episodes_timesteps_total": 7106, "policy_reward_min": {"default_policy": 10.0}, "policy_reward_max": {"default_policy": 300.0}, "policy_reward_mean": {"default_policy": 71.06}, "custom_metrics": {}, "hist_stats": {"episode_reward": [59.0, 18.0, 47.0, 37.0, 40.0, 60.0, 61.0, 11.0, 22.0, 33.0, 60.0, 64.0, 26.0, 42.0, 27.0, 108.0, 10.0, 83.0, 42.0, 36.0, 52.0, 40.0, 46.0, 52.0, 41.0, 57.0, 45.0, 45.0, 92.0, 21.0, 158.0, 28.0, 86.0, 55.0, 13.0, 10.0, 19.0, 85.0, 44.0, 51.0, 21.0, 20.0, 80.0, 20.0, 15.0, 31.0, 13.0, 92.0, 29.0, 39.0, 50.0, 24.0, 33.0, 128.0, 120.0, 70.0, 31.0, 69.0, 20.0, 11.0, 86.0, 85.0, 12.0, 15.0, 11.0, 13.0, 49.0, 87.0, 11.0, 57.0, 114.0, 76.0, 14.0, 16.0, 98.0, 62.0, 17.0, 227.0, 93.0, 120.0, 127.0, 123.0, 137.0, 155.0, 156.0, 112.0, 121.0, 143.0, 144.0, 138.0, 148.0, 155.0, 194.0, 192.0, 300.0, 152.0, 141.0, 130.0, 125.0, 108.0], "episode_lengths": [59, 18, 47, 37, 40, 60, 61, 11, 22, 33, 60, 64, 26, 42, 27, 108, 10, 83, 42, 36, 52, 40, 46, 52, 41, 57, 45, 45, 92, 21, 158, 28, 86, 55, 13, 10, 19, 85, 44, 51, 21, 20, 80, 20, 15, 31, 13, 92, 29, 39, 50, 24, 33, 128, 120, 70, 31, 69, 20, 11, 86, 85, 12, 15, 11, 13, 49, 87, 11, 57, 114, 76, 14, 16, 98, 62, 17, 227, 93, 120, 127, 123, 137, 155, 156, 112, 121, 143, 144, 138, 148, 155, 194, 192, 300, 152, 141, 130, 125, 108], "policy_default_policy_reward": [59.0, 18.0, 47.0, 37.0, 40.0, 60.0, 61.0, 11.0, 22.0, 33.0, 60.0, 64.0, 26.0, 42.0, 27.0, 108.0, 10.0, 83.0, 42.0, 36.0, 52.0, 40.0, 46.0, 52.0, 41.0, 57.0, 45.0, 45.0, 92.0, 21.0, 158.0, 28.0, 86.0, 55.0, 13.0, 10.0, 19.0, 85.0, 44.0, 51.0, 21.0, 20.0, 80.0, 20.0, 15.0, 31.0, 13.0, 92.0, 29.0, 39.0, 50.0, 24.0, 33.0, 128.0, 120.0, 70.0, 31.0, 69.0, 20.0, 11.0, 86.0, 85.0, 12.0, 15.0, 11.0, 13.0, 49.0, 87.0, 11.0, 57.0, 114.0, 76.0, 14.0, 16.0, 98.0, 62.0, 17.0, 227.0, 93.0, 120.0, 127.0, 123.0, 137.0, 155.0, 156.0, 112.0, 121.0, 143.0, 144.0, 138.0, 148.0, 155.0, 194.0, 192.0, 300.0, 152.0, 141.0, 130.0, 125.0, 108.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9883139285391402, "mean_inference_ms": 1.9768489128472782, "mean_action_processing_ms": 0.22399450212412433, "mean_env_wait_ms": 0.09493429858261809, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01798391342163086, "StateBufferConnector_ms": 0.015433311462402344, "ViewRequirementAgentConnector_ms": 0.19269824028015137}, "num_episodes": 6, "episode_return_max": 300.0, "episode_return_min": 10.0, "episode_return_mean": 71.06, "episodes_this_iter": 6}, "num_healthy_workers": 0, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11000, "num_agent_steps_trained": 320000, "num_env_steps_sampled": 11000, "num_env_steps_trained": 320000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 30.445372040741404, "num_env_steps_trained_throughput_per_sec": 974.2519053037249, "timesteps_total": 11000, "num_env_steps_sampled_lifetime": 11000, "num_agent_steps_sampled_lifetime": 11000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 11000, "timers": {"training_iteration_time_ms": 30523.244, "restore_workers_time_ms": 0.021, "training_step_time_ms": 31.089, "sample_time_ms": 3.996, "load_time_ms": 0.224, "load_throughput": 143074.009, "learn_time_ms": 12.311, "learn_throughput": 2599.295, "synch_weights_time_ms": 0.05}, "counters": {"num_env_steps_sampled": 11000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 11000, "num_agent_steps_trained": 320000, "last_target_update_ts": 10501, "num_target_updates": 20}, "done": false, "training_iteration": 11, "trial_id": "5ce16_00000", "date": "2024-09-27_10-56-41", "timestamp": 1727405801, "time_this_iter_s": 32.84737944602966, "time_total_s": 309.8108322620392, "pid": 39427, "hostname": "gpu2gate1", "node_ip": "10.64.32.126", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.9828407522030984, "lr": 0.0007583973879008875, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f52e4d75580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 309.8108322620392, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 11.85744680851064, "ram_util_percent": 9.097872340425535}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.27995091676712036, "mean_q": 15.123368263244629, "min_q": 1.6496639251708984, "max_q": 20.413127899169922, "cur_lr": 0.0007583973879008875}, "td_error": [-0.7785453796386719, 3.772268295288086, -0.18305397033691406, 11.992606163024902, -0.4153575897216797, 0.13327312469482422, -0.38332462310791016, -0.7718925476074219, -0.088958740234375, 0.4476795196533203, 0.5183773040771484, -0.13310623168945312, 1.6408727169036865, -0.6534233093261719, 0.43244361877441406, -0.1815814971923828, 0.0036220550537109375, -0.23670005798339844, 0.21599769592285156, 0.029859542846679688, 1.6045907735824585, -0.1407794952392578, 0.6620520353317261, -0.20268630981445312, 2.351623058319092, -0.212615966796875, -0.016725540161132812, -0.23485755920410156, -0.3450050354003906, 0.7988359928131104, -0.017446517944335938, -0.37480926513671875], "mean_td_error": 0.6010385155677795, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 11000.0, "diff_num_grad_updates_vs_sampler_policy": 6119.9375}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 352000, "last_target_update_ts": 11501, "num_target_updates": 22}, "env_runners": {"episode_reward_max": 300.0, "episode_reward_min": 10.0, "episode_reward_mean": 78.7, "episode_len_mean": 78.7, "episode_media": {}, "episodes_timesteps_total": 7870, "policy_reward_min": {"default_policy": 10.0}, "policy_reward_max": {"default_policy": 300.0}, "policy_reward_mean": {"default_policy": 78.7}, "custom_metrics": {}, "hist_stats": {"episode_reward": [61.0, 11.0, 22.0, 33.0, 60.0, 64.0, 26.0, 42.0, 27.0, 108.0, 10.0, 83.0, 42.0, 36.0, 52.0, 40.0, 46.0, 52.0, 41.0, 57.0, 45.0, 45.0, 92.0, 21.0, 158.0, 28.0, 86.0, 55.0, 13.0, 10.0, 19.0, 85.0, 44.0, 51.0, 21.0, 20.0, 80.0, 20.0, 15.0, 31.0, 13.0, 92.0, 29.0, 39.0, 50.0, 24.0, 33.0, 128.0, 120.0, 70.0, 31.0, 69.0, 20.0, 11.0, 86.0, 85.0, 12.0, 15.0, 11.0, 13.0, 49.0, 87.0, 11.0, 57.0, 114.0, 76.0, 14.0, 16.0, 98.0, 62.0, 17.0, 227.0, 93.0, 120.0, 127.0, 123.0, 137.0, 155.0, 156.0, 112.0, 121.0, 143.0, 144.0, 138.0, 148.0, 155.0, 194.0, 192.0, 300.0, 152.0, 141.0, 130.0, 125.0, 108.0, 114.0, 256.0, 233.0, 177.0, 125.0, 120.0], "episode_lengths": [61, 11, 22, 33, 60, 64, 26, 42, 27, 108, 10, 83, 42, 36, 52, 40, 46, 52, 41, 57, 45, 45, 92, 21, 158, 28, 86, 55, 13, 10, 19, 85, 44, 51, 21, 20, 80, 20, 15, 31, 13, 92, 29, 39, 50, 24, 33, 128, 120, 70, 31, 69, 20, 11, 86, 85, 12, 15, 11, 13, 49, 87, 11, 57, 114, 76, 14, 16, 98, 62, 17, 227, 93, 120, 127, 123, 137, 155, 156, 112, 121, 143, 144, 138, 148, 155, 194, 192, 300, 152, 141, 130, 125, 108, 114, 256, 233, 177, 125, 120], "policy_default_policy_reward": [61.0, 11.0, 22.0, 33.0, 60.0, 64.0, 26.0, 42.0, 27.0, 108.0, 10.0, 83.0, 42.0, 36.0, 52.0, 40.0, 46.0, 52.0, 41.0, 57.0, 45.0, 45.0, 92.0, 21.0, 158.0, 28.0, 86.0, 55.0, 13.0, 10.0, 19.0, 85.0, 44.0, 51.0, 21.0, 20.0, 80.0, 20.0, 15.0, 31.0, 13.0, 92.0, 29.0, 39.0, 50.0, 24.0, 33.0, 128.0, 120.0, 70.0, 31.0, 69.0, 20.0, 11.0, 86.0, 85.0, 12.0, 15.0, 11.0, 13.0, 49.0, 87.0, 11.0, 57.0, 114.0, 76.0, 14.0, 16.0, 98.0, 62.0, 17.0, 227.0, 93.0, 120.0, 127.0, 123.0, 137.0, 155.0, 156.0, 112.0, 121.0, 143.0, 144.0, 138.0, 148.0, 155.0, 194.0, 192.0, 300.0, 152.0, 141.0, 130.0, 125.0, 108.0, 114.0, 256.0, 233.0, 177.0, 125.0, 120.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9892184824786474, "mean_inference_ms": 1.9781507988219267, "mean_action_processing_ms": 0.2246351061968862, "mean_env_wait_ms": 0.09533788794373396, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018057584762573242, "StateBufferConnector_ms": 0.015478372573852539, "ViewRequirementAgentConnector_ms": 0.19382643699645996}, "num_episodes": 6, "episode_return_max": 300.0, "episode_return_min": 10.0, "episode_return_mean": 78.7, "episodes_this_iter": 6}, "num_healthy_workers": 0, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 352000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 352000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 35.511267016719955, "num_env_steps_trained_throughput_per_sec": 1136.3605445350386, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 12000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 30360.794, "restore_workers_time_ms": 0.016, "training_step_time_ms": 26.142, "sample_time_ms": 3.343, "load_time_ms": 0.19, "load_throughput": 168171.567, "learn_time_ms": 10.616, "learn_throughput": 3014.401, "synch_weights_time_ms": 0.036}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 352000, "last_target_update_ts": 11501, "num_target_updates": 22}, "done": false, "training_iteration": 12, "trial_id": "5ce16_00000", "date": "2024-09-27_10-57-09", "timestamp": 1727405829, "time_this_iter_s": 28.16145968437195, "time_total_s": 337.97229194641113, "pid": 39427, "hostname": "gpu2gate1", "node_ip": "10.64.32.126", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.9828407522030984, "lr": 0.0007583973879008875, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f52e4d75580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 337.97229194641113, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 11.8, "ram_util_percent": 9.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.43283405900001526, "mean_q": 18.999797821044922, "min_q": 1.2106726169586182, "max_q": 21.497560501098633, "cur_lr": 0.0007583973879008875}, "td_error": [-0.3814735412597656, 0.12641143798828125, -0.60894775390625, 0.21067261695861816, -1.6200518608093262, 0.17131996154785156, 0.07283782958984375, 0.2564964294433594, 0.3787250518798828, -0.12063980102539062, 0.10163688659667969, 0.10906028747558594, -1.090353012084961, 0.2111835479736328, -2.5847291946411133, 0.0072021484375, -0.25019073486328125, 0.2778358459472656, -0.11857223510742188, 0.015001296997070312, -0.0078029632568359375, 0.36841392517089844, -0.0002193450927734375, 0.26432037353515625, 0.16856956481933594, 0.15399169921875, -0.11468315124511719, -0.04465293884277344, 0.04312705993652344, -0.2015666961669922, -0.57354736328125, -0.08302688598632812], "mean_td_error": -0.15198910236358643, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 12000.0, "diff_num_grad_updates_vs_sampler_policy": 5317.3125}}, "num_env_steps_sampled": 13000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 13000, "num_agent_steps_trained": 384000, "last_target_update_ts": 12501, "num_target_updates": 24}, "env_runners": {"episode_reward_max": 300.0, "episode_reward_min": 10.0, "episode_reward_mean": 85.38, "episode_len_mean": 85.38, "episode_media": {}, "episodes_timesteps_total": 8538, "policy_reward_min": {"default_policy": 10.0}, "policy_reward_max": {"default_policy": 300.0}, "policy_reward_mean": {"default_policy": 85.38}, "custom_metrics": {}, "hist_stats": {"episode_reward": [27.0, 108.0, 10.0, 83.0, 42.0, 36.0, 52.0, 40.0, 46.0, 52.0, 41.0, 57.0, 45.0, 45.0, 92.0, 21.0, 158.0, 28.0, 86.0, 55.0, 13.0, 10.0, 19.0, 85.0, 44.0, 51.0, 21.0, 20.0, 80.0, 20.0, 15.0, 31.0, 13.0, 92.0, 29.0, 39.0, 50.0, 24.0, 33.0, 128.0, 120.0, 70.0, 31.0, 69.0, 20.0, 11.0, 86.0, 85.0, 12.0, 15.0, 11.0, 13.0, 49.0, 87.0, 11.0, 57.0, 114.0, 76.0, 14.0, 16.0, 98.0, 62.0, 17.0, 227.0, 93.0, 120.0, 127.0, 123.0, 137.0, 155.0, 156.0, 112.0, 121.0, 143.0, 144.0, 138.0, 148.0, 155.0, 194.0, 192.0, 300.0, 152.0, 141.0, 130.0, 125.0, 108.0, 114.0, 256.0, 233.0, 177.0, 125.0, 120.0, 109.0, 109.0, 115.0, 117.0, 153.0, 109.0, 110.0, 165.0], "episode_lengths": [27, 108, 10, 83, 42, 36, 52, 40, 46, 52, 41, 57, 45, 45, 92, 21, 158, 28, 86, 55, 13, 10, 19, 85, 44, 51, 21, 20, 80, 20, 15, 31, 13, 92, 29, 39, 50, 24, 33, 128, 120, 70, 31, 69, 20, 11, 86, 85, 12, 15, 11, 13, 49, 87, 11, 57, 114, 76, 14, 16, 98, 62, 17, 227, 93, 120, 127, 123, 137, 155, 156, 112, 121, 143, 144, 138, 148, 155, 194, 192, 300, 152, 141, 130, 125, 108, 114, 256, 233, 177, 125, 120, 109, 109, 115, 117, 153, 109, 110, 165], "policy_default_policy_reward": [27.0, 108.0, 10.0, 83.0, 42.0, 36.0, 52.0, 40.0, 46.0, 52.0, 41.0, 57.0, 45.0, 45.0, 92.0, 21.0, 158.0, 28.0, 86.0, 55.0, 13.0, 10.0, 19.0, 85.0, 44.0, 51.0, 21.0, 20.0, 80.0, 20.0, 15.0, 31.0, 13.0, 92.0, 29.0, 39.0, 50.0, 24.0, 33.0, 128.0, 120.0, 70.0, 31.0, 69.0, 20.0, 11.0, 86.0, 85.0, 12.0, 15.0, 11.0, 13.0, 49.0, 87.0, 11.0, 57.0, 114.0, 76.0, 14.0, 16.0, 98.0, 62.0, 17.0, 227.0, 93.0, 120.0, 127.0, 123.0, 137.0, 155.0, 156.0, 112.0, 121.0, 143.0, 144.0, 138.0, 148.0, 155.0, 194.0, 192.0, 300.0, 152.0, 141.0, 130.0, 125.0, 108.0, 114.0, 256.0, 233.0, 177.0, 125.0, 120.0, 109.0, 109.0, 115.0, 117.0, 153.0, 109.0, 110.0, 165.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9891246352969552, "mean_inference_ms": 1.9774793370293624, "mean_action_processing_ms": 0.2250803114162433, "mean_env_wait_ms": 0.09564505747661407, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017899036407470703, "StateBufferConnector_ms": 0.015501737594604492, "ViewRequirementAgentConnector_ms": 0.19386029243469238}, "num_episodes": 8, "episode_return_max": 300.0, "episode_return_min": 10.0, "episode_return_mean": 85.38, "episodes_this_iter": 8}, "num_healthy_workers": 0, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 13000, "num_agent_steps_trained": 384000, "num_env_steps_sampled": 13000, "num_env_steps_trained": 384000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 30.16514811305179, "num_env_steps_trained_throughput_per_sec": 965.2847396176572, "timesteps_total": 13000, "num_env_steps_sampled_lifetime": 13000, "num_agent_steps_sampled_lifetime": 13000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 13000, "timers": {"training_iteration_time_ms": 30556.733, "restore_workers_time_ms": 0.025, "training_step_time_ms": 32.594, "sample_time_ms": 4.156, "load_time_ms": 0.244, "load_throughput": 131354.206, "learn_time_ms": 12.977, "learn_throughput": 2465.937, "synch_weights_time_ms": 0.052}, "counters": {"num_env_steps_sampled": 13000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 13000, "num_agent_steps_trained": 384000, "last_target_update_ts": 12501, "num_target_updates": 24}, "done": false, "training_iteration": 13, "trial_id": "5ce16_00000", "date": "2024-09-27_10-57-42", "timestamp": 1727405862, "time_this_iter_s": 33.15278935432434, "time_total_s": 371.1250813007355, "pid": 39427, "hostname": "gpu2gate1", "node_ip": "10.64.32.126", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.9828407522030984, "lr": 0.0007583973879008875, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f52e4d75580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 371.1250813007355, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 11.75531914893617, "ram_util_percent": 9.100000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.42841294407844543, "mean_q": 18.836421966552734, "min_q": 1.8918341398239136, "max_q": 23.109525680541992, "cur_lr": 0.0007583973879008875}, "td_error": [0.0634002685546875, -0.49740028381347656, -0.07507896423339844, 0.42617225646972656, 0.07674980163574219, 0.01184844970703125, -0.11648368835449219, -0.10102653503417969, 0.09253120422363281, -0.1427764892578125, 0.18459510803222656, -0.014093399047851562, -0.026035308837890625, -1.0287151336669922, -0.07655143737792969, 0.07457923889160156, -0.7867207527160645, -0.028141021728515625, -0.0043125152587890625, 0.025054931640625, -0.3819465637207031, -0.05529022216796875, -1.0455036163330078, 0.07339286804199219, -0.06937789916992188, 0.09131813049316406, 1.3745594024658203, -2.048222064971924, -0.1944732666015625, 17.162384033203125, -0.06763410568237305, 0.04982948303222656], "mean_td_error": 0.40458226203918457, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 13000.0, "diff_num_grad_updates_vs_sampler_policy": 8236.78125}}, "num_env_steps_sampled": 14000, "num_env_steps_trained": 416000, "num_agent_steps_sampled": 14000, "num_agent_steps_trained": 416000, "last_target_update_ts": 13501, "num_target_updates": 26}, "env_runners": {"episode_reward_max": 300.0, "episode_reward_min": 10.0, "episode_reward_mean": 91.79, "episode_len_mean": 91.79, "episode_media": {}, "episodes_timesteps_total": 9179, "policy_reward_min": {"default_policy": 10.0}, "policy_reward_max": {"default_policy": 300.0}, "policy_reward_mean": {"default_policy": 91.79}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.0, 52.0, 41.0, 57.0, 45.0, 45.0, 92.0, 21.0, 158.0, 28.0, 86.0, 55.0, 13.0, 10.0, 19.0, 85.0, 44.0, 51.0, 21.0, 20.0, 80.0, 20.0, 15.0, 31.0, 13.0, 92.0, 29.0, 39.0, 50.0, 24.0, 33.0, 128.0, 120.0, 70.0, 31.0, 69.0, 20.0, 11.0, 86.0, 85.0, 12.0, 15.0, 11.0, 13.0, 49.0, 87.0, 11.0, 57.0, 114.0, 76.0, 14.0, 16.0, 98.0, 62.0, 17.0, 227.0, 93.0, 120.0, 127.0, 123.0, 137.0, 155.0, 156.0, 112.0, 121.0, 143.0, 144.0, 138.0, 148.0, 155.0, 194.0, 192.0, 300.0, 152.0, 141.0, 130.0, 125.0, 108.0, 114.0, 256.0, 233.0, 177.0, 125.0, 120.0, 109.0, 109.0, 115.0, 117.0, 153.0, 109.0, 110.0, 165.0, 107.0, 157.0, 103.0, 165.0, 124.0, 110.0, 164.0, 109.0], "episode_lengths": [46, 52, 41, 57, 45, 45, 92, 21, 158, 28, 86, 55, 13, 10, 19, 85, 44, 51, 21, 20, 80, 20, 15, 31, 13, 92, 29, 39, 50, 24, 33, 128, 120, 70, 31, 69, 20, 11, 86, 85, 12, 15, 11, 13, 49, 87, 11, 57, 114, 76, 14, 16, 98, 62, 17, 227, 93, 120, 127, 123, 137, 155, 156, 112, 121, 143, 144, 138, 148, 155, 194, 192, 300, 152, 141, 130, 125, 108, 114, 256, 233, 177, 125, 120, 109, 109, 115, 117, 153, 109, 110, 165, 107, 157, 103, 165, 124, 110, 164, 109], "policy_default_policy_reward": [46.0, 52.0, 41.0, 57.0, 45.0, 45.0, 92.0, 21.0, 158.0, 28.0, 86.0, 55.0, 13.0, 10.0, 19.0, 85.0, 44.0, 51.0, 21.0, 20.0, 80.0, 20.0, 15.0, 31.0, 13.0, 92.0, 29.0, 39.0, 50.0, 24.0, 33.0, 128.0, 120.0, 70.0, 31.0, 69.0, 20.0, 11.0, 86.0, 85.0, 12.0, 15.0, 11.0, 13.0, 49.0, 87.0, 11.0, 57.0, 114.0, 76.0, 14.0, 16.0, 98.0, 62.0, 17.0, 227.0, 93.0, 120.0, 127.0, 123.0, 137.0, 155.0, 156.0, 112.0, 121.0, 143.0, 144.0, 138.0, 148.0, 155.0, 194.0, 192.0, 300.0, 152.0, 141.0, 130.0, 125.0, 108.0, 114.0, 256.0, 233.0, 177.0, 125.0, 120.0, 109.0, 109.0, 115.0, 117.0, 153.0, 109.0, 110.0, 165.0, 107.0, 157.0, 103.0, 165.0, 124.0, 110.0, 164.0, 109.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9892228053411833, "mean_inference_ms": 1.9777203641725272, "mean_action_processing_ms": 0.22557380150112596, "mean_env_wait_ms": 0.09594638527827921, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017483949661254883, "StateBufferConnector_ms": 0.015441656112670898, "ViewRequirementAgentConnector_ms": 0.19193243980407715}, "num_episodes": 8, "episode_return_max": 300.0, "episode_return_min": 10.0, "episode_return_mean": 91.79, "episodes_this_iter": 8}, "num_healthy_workers": 0, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 14000, "num_agent_steps_trained": 416000, "num_env_steps_sampled": 14000, "num_env_steps_trained": 416000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 30.25940763819355, "num_env_steps_trained_throughput_per_sec": 968.3010444221936, "timesteps_total": 14000, "num_env_steps_sampled_lifetime": 14000, "num_agent_steps_sampled_lifetime": 14000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 14000, "timers": {"training_iteration_time_ms": 31381.801, "restore_workers_time_ms": 0.019, "training_step_time_ms": 31.562, "sample_time_ms": 3.822, "load_time_ms": 0.213, "load_throughput": 150350.317, "learn_time_ms": 13.231, "learn_throughput": 2418.59, "synch_weights_time_ms": 0.041}, "counters": {"num_env_steps_sampled": 14000, "num_env_steps_trained": 416000, "num_agent_steps_sampled": 14000, "num_agent_steps_trained": 416000, "last_target_update_ts": 13501, "num_target_updates": 26}, "done": false, "training_iteration": 14, "trial_id": "5ce16_00000", "date": "2024-09-27_10-58-15", "timestamp": 1727405895, "time_this_iter_s": 33.04908561706543, "time_total_s": 404.1741669178009, "pid": 39427, "hostname": "gpu2gate1", "node_ip": "10.64.32.126", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.9828407522030984, "lr": 0.0007583973879008875, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f52e4d75580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 404.1741669178009, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 11.529787234042553, "ram_util_percent": 9.100000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.26280298829078674, "mean_q": 19.437108993530273, "min_q": 0.8022043704986572, "max_q": 24.7974796295166, "cur_lr": 0.0007583973879008875}, "td_error": [0.10394668579101562, -0.11051177978515625, 0.050689697265625, -0.04775810241699219, 3.4094934463500977, -0.09569549560546875, 0.03527641296386719, -0.19779562950134277, -0.08292007446289062, 1.715414047241211, -0.11660194396972656, -0.17429161071777344, -0.061920166015625, -0.06631660461425781, -0.2839336395263672, -0.6091089248657227, -1.1464576721191406, -0.08899116516113281, -0.12516212463378906, -0.08650970458984375, -0.17258071899414062, 2.761272430419922, 0.06903839111328125, -0.06912803649902344, -0.041889190673828125, -0.061206817626953125, 0.025751113891601562, -0.15826797485351562, -0.07813072204589844, 0.24272918701171875, 0.04420661926269531, 1.1767725944519043], "mean_td_error": 0.17998164892196655, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 14000.0, "diff_num_grad_updates_vs_sampler_policy": 7232.65625}}, "num_env_steps_sampled": 15000, "num_env_steps_trained": 448000, "num_agent_steps_sampled": 15000, "num_agent_steps_trained": 448000, "last_target_update_ts": 14501, "num_target_updates": 28}, "env_runners": {"episode_reward_max": 300.0, "episode_reward_min": 10.0, "episode_reward_mean": 98.46, "episode_len_mean": 98.46, "episode_media": {}, "episodes_timesteps_total": 9846, "policy_reward_min": {"default_policy": 10.0}, "policy_reward_max": {"default_policy": 300.0}, "policy_reward_mean": {"default_policy": 98.46}, "custom_metrics": {}, "hist_stats": {"episode_reward": [92.0, 21.0, 158.0, 28.0, 86.0, 55.0, 13.0, 10.0, 19.0, 85.0, 44.0, 51.0, 21.0, 20.0, 80.0, 20.0, 15.0, 31.0, 13.0, 92.0, 29.0, 39.0, 50.0, 24.0, 33.0, 128.0, 120.0, 70.0, 31.0, 69.0, 20.0, 11.0, 86.0, 85.0, 12.0, 15.0, 11.0, 13.0, 49.0, 87.0, 11.0, 57.0, 114.0, 76.0, 14.0, 16.0, 98.0, 62.0, 17.0, 227.0, 93.0, 120.0, 127.0, 123.0, 137.0, 155.0, 156.0, 112.0, 121.0, 143.0, 144.0, 138.0, 148.0, 155.0, 194.0, 192.0, 300.0, 152.0, 141.0, 130.0, 125.0, 108.0, 114.0, 256.0, 233.0, 177.0, 125.0, 120.0, 109.0, 109.0, 115.0, 117.0, 153.0, 109.0, 110.0, 165.0, 107.0, 157.0, 103.0, 165.0, 124.0, 110.0, 164.0, 109.0, 119.0, 271.0, 138.0, 179.0, 128.0, 118.0], "episode_lengths": [92, 21, 158, 28, 86, 55, 13, 10, 19, 85, 44, 51, 21, 20, 80, 20, 15, 31, 13, 92, 29, 39, 50, 24, 33, 128, 120, 70, 31, 69, 20, 11, 86, 85, 12, 15, 11, 13, 49, 87, 11, 57, 114, 76, 14, 16, 98, 62, 17, 227, 93, 120, 127, 123, 137, 155, 156, 112, 121, 143, 144, 138, 148, 155, 194, 192, 300, 152, 141, 130, 125, 108, 114, 256, 233, 177, 125, 120, 109, 109, 115, 117, 153, 109, 110, 165, 107, 157, 103, 165, 124, 110, 164, 109, 119, 271, 138, 179, 128, 118], "policy_default_policy_reward": [92.0, 21.0, 158.0, 28.0, 86.0, 55.0, 13.0, 10.0, 19.0, 85.0, 44.0, 51.0, 21.0, 20.0, 80.0, 20.0, 15.0, 31.0, 13.0, 92.0, 29.0, 39.0, 50.0, 24.0, 33.0, 128.0, 120.0, 70.0, 31.0, 69.0, 20.0, 11.0, 86.0, 85.0, 12.0, 15.0, 11.0, 13.0, 49.0, 87.0, 11.0, 57.0, 114.0, 76.0, 14.0, 16.0, 98.0, 62.0, 17.0, 227.0, 93.0, 120.0, 127.0, 123.0, 137.0, 155.0, 156.0, 112.0, 121.0, 143.0, 144.0, 138.0, 148.0, 155.0, 194.0, 192.0, 300.0, 152.0, 141.0, 130.0, 125.0, 108.0, 114.0, 256.0, 233.0, 177.0, 125.0, 120.0, 109.0, 109.0, 115.0, 117.0, 153.0, 109.0, 110.0, 165.0, 107.0, 157.0, 103.0, 165.0, 124.0, 110.0, 164.0, 109.0, 119.0, 271.0, 138.0, 179.0, 128.0, 118.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9890855222690271, "mean_inference_ms": 1.977789924575994, "mean_action_processing_ms": 0.22586307385625426, "mean_env_wait_ms": 0.09612609089018902, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017261028289794922, "StateBufferConnector_ms": 0.015319347381591797, "ViewRequirementAgentConnector_ms": 0.18974041938781738}, "num_episodes": 6, "episode_return_max": 300.0, "episode_return_min": 10.0, "episode_return_mean": 98.46, "episodes_this_iter": 6}, "num_healthy_workers": 0, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 15000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 15000, "num_env_steps_trained": 448000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 32.97063701995846, "num_env_steps_trained_throughput_per_sec": 1055.0603846386707, "timesteps_total": 15000, "num_env_steps_sampled_lifetime": 15000, "num_agent_steps_sampled_lifetime": 15000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 15000, "timers": {"training_iteration_time_ms": 31018.432, "restore_workers_time_ms": 0.019, "training_step_time_ms": 28.227, "sample_time_ms": 3.665, "load_time_ms": 0.186, "load_throughput": 171611.978, "learn_time_ms": 11.925, "learn_throughput": 2683.464, "synch_weights_time_ms": 0.037}, "counters": {"num_env_steps_sampled": 15000, "num_env_steps_trained": 448000, "num_agent_steps_sampled": 15000, "num_agent_steps_trained": 448000, "last_target_update_ts": 14501, "num_target_updates": 28}, "done": false, "training_iteration": 15, "trial_id": "5ce16_00000", "date": "2024-09-27_10-58-46", "timestamp": 1727405926, "time_this_iter_s": 30.332221269607544, "time_total_s": 434.50638818740845, "pid": 39427, "hostname": "gpu2gate1", "node_ip": "10.64.32.126", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.9828407522030984, "lr": 0.0007583973879008875, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f52e4d75580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 434.50638818740845, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 12.111627906976743, "ram_util_percent": 9.100000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3747303783893585, "mean_q": 21.059947967529297, "min_q": 1.1569693088531494, "max_q": 26.107603073120117, "cur_lr": 0.0007583973879008875}, "td_error": [-0.1713886260986328, 0.056385040283203125, -0.7854118347167969, -0.2645149230957031, -0.07192230224609375, 0.10045814514160156, -0.8186912536621094, -0.3164539337158203, -0.38797569274902344, -0.6048221588134766, -0.09980964660644531, -0.09626388549804688, -0.1661396026611328, -0.8481025695800781, -0.17936325073242188, -0.04404163360595703, 0.03400611877441406, -1.4402661323547363, -0.7079453468322754, 2.836301803588867, 0.15761184692382812, -0.10886001586914062, -0.3920249938964844, -0.2081584930419922, 0.09671211242675781, 0.44719886779785156, 0.5586452484130859, -0.13321495056152344, 0.2186126708984375, 1.066208839416504, 0.12194252014160156, -0.16406631469726562], "mean_td_error": -0.07235482335090637, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 15000.0, "diff_num_grad_updates_vs_sampler_policy": 7403.28125}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 480000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 480000, "last_target_update_ts": 15501, "num_target_updates": 30}, "env_runners": {"episode_reward_max": 465.0, "episode_reward_min": 10.0, "episode_reward_mean": 104.42, "episode_len_mean": 104.42, "episode_media": {}, "episodes_timesteps_total": 10442, "policy_reward_min": {"default_policy": 10.0}, "policy_reward_max": {"default_policy": 465.0}, "policy_reward_mean": {"default_policy": 104.42}, "custom_metrics": {}, "hist_stats": {"episode_reward": [13.0, 10.0, 19.0, 85.0, 44.0, 51.0, 21.0, 20.0, 80.0, 20.0, 15.0, 31.0, 13.0, 92.0, 29.0, 39.0, 50.0, 24.0, 33.0, 128.0, 120.0, 70.0, 31.0, 69.0, 20.0, 11.0, 86.0, 85.0, 12.0, 15.0, 11.0, 13.0, 49.0, 87.0, 11.0, 57.0, 114.0, 76.0, 14.0, 16.0, 98.0, 62.0, 17.0, 227.0, 93.0, 120.0, 127.0, 123.0, 137.0, 155.0, 156.0, 112.0, 121.0, 143.0, 144.0, 138.0, 148.0, 155.0, 194.0, 192.0, 300.0, 152.0, 141.0, 130.0, 125.0, 108.0, 114.0, 256.0, 233.0, 177.0, 125.0, 120.0, 109.0, 109.0, 115.0, 117.0, 153.0, 109.0, 110.0, 165.0, 107.0, 157.0, 103.0, 165.0, 124.0, 110.0, 164.0, 109.0, 119.0, 271.0, 138.0, 179.0, 128.0, 118.0, 123.0, 246.0, 137.0, 465.0, 24.0, 41.0], "episode_lengths": [13, 10, 19, 85, 44, 51, 21, 20, 80, 20, 15, 31, 13, 92, 29, 39, 50, 24, 33, 128, 120, 70, 31, 69, 20, 11, 86, 85, 12, 15, 11, 13, 49, 87, 11, 57, 114, 76, 14, 16, 98, 62, 17, 227, 93, 120, 127, 123, 137, 155, 156, 112, 121, 143, 144, 138, 148, 155, 194, 192, 300, 152, 141, 130, 125, 108, 114, 256, 233, 177, 125, 120, 109, 109, 115, 117, 153, 109, 110, 165, 107, 157, 103, 165, 124, 110, 164, 109, 119, 271, 138, 179, 128, 118, 123, 246, 137, 465, 24, 41], "policy_default_policy_reward": [13.0, 10.0, 19.0, 85.0, 44.0, 51.0, 21.0, 20.0, 80.0, 20.0, 15.0, 31.0, 13.0, 92.0, 29.0, 39.0, 50.0, 24.0, 33.0, 128.0, 120.0, 70.0, 31.0, 69.0, 20.0, 11.0, 86.0, 85.0, 12.0, 15.0, 11.0, 13.0, 49.0, 87.0, 11.0, 57.0, 114.0, 76.0, 14.0, 16.0, 98.0, 62.0, 17.0, 227.0, 93.0, 120.0, 127.0, 123.0, 137.0, 155.0, 156.0, 112.0, 121.0, 143.0, 144.0, 138.0, 148.0, 155.0, 194.0, 192.0, 300.0, 152.0, 141.0, 130.0, 125.0, 108.0, 114.0, 256.0, 233.0, 177.0, 125.0, 120.0, 109.0, 109.0, 115.0, 117.0, 153.0, 109.0, 110.0, 165.0, 107.0, 157.0, 103.0, 165.0, 124.0, 110.0, 164.0, 109.0, 119.0, 271.0, 138.0, 179.0, 128.0, 118.0, 123.0, 246.0, 137.0, 465.0, 24.0, 41.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9894502875442679, "mean_inference_ms": 1.9789361252873716, "mean_action_processing_ms": 0.22618445736993487, "mean_env_wait_ms": 0.09633319790324647, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017491817474365234, "StateBufferConnector_ms": 0.015423297882080078, "ViewRequirementAgentConnector_ms": 0.19217896461486816}, "num_episodes": 6, "episode_return_max": 465.0, "episode_return_min": 10.0, "episode_return_mean": 104.42, "episodes_this_iter": 6}, "num_healthy_workers": 0, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 480000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 480000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 28.705956258838683, "num_env_steps_trained_throughput_per_sec": 918.5906002828378, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 31403.497, "restore_workers_time_ms": 0.023, "training_step_time_ms": 36.408, "sample_time_ms": 4.45, "load_time_ms": 0.308, "load_throughput": 103811.376, "learn_time_ms": 14.499, "learn_throughput": 2207.024, "synch_weights_time_ms": 0.055}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 480000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 480000, "last_target_update_ts": 15501, "num_target_updates": 30}, "done": false, "training_iteration": 16, "trial_id": "5ce16_00000", "date": "2024-09-27_10-59-21", "timestamp": 1727405961, "time_this_iter_s": 34.83783173561096, "time_total_s": 469.3442199230194, "pid": 39427, "hostname": "gpu2gate1", "node_ip": "10.64.32.126", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.9828407522030984, "lr": 0.0007583973879008875, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f52e4d75580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 469.3442199230194, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 14.363265306122448, "ram_util_percent": 9.181632653061223}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.558866024017334, "mean_q": 22.816265106201172, "min_q": 2.909741163253784, "max_q": 27.35932159423828, "cur_lr": 0.0007583973879008875}, "td_error": [0.32568931579589844, 0.23233604431152344, -0.47859907150268555, -0.08693695068359375, -0.04058647155761719, 9.846006393432617, -0.017704010009765625, 1.6182613372802734, 0.08491897583007812, 0.09489250183105469, 0.11050796508789062, 0.15573883056640625, 0.1343231201171875, 0.365478515625, 0.12334823608398438, 0.030757904052734375, 0.13409996032714844, 0.24061965942382812, -1.9227237701416016, 1.9522275924682617, 17.418527603149414, 0.07084274291992188, 0.31310081481933594, 0.1495647430419922, 0.035961151123046875, 0.2528495788574219, 0.1913280487060547, 0.3081016540527344, 0.04152870178222656, -0.08837890625, 2.877293109893799, 0.3122119903564453], "mean_td_error": 1.0870497226715088, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 16000.0, "diff_num_grad_updates_vs_sampler_policy": 6850.5625}}, "num_env_steps_sampled": 17000, "num_env_steps_trained": 512000, "num_agent_steps_sampled": 17000, "num_agent_steps_trained": 512000, "last_target_update_ts": 16501, "num_target_updates": 32}, "env_runners": {"episode_reward_max": 465.0, "episode_reward_min": 11.0, "episode_reward_mean": 110.15, "episode_len_mean": 110.15, "episode_media": {}, "episodes_timesteps_total": 11015, "policy_reward_min": {"default_policy": 11.0}, "policy_reward_max": {"default_policy": 465.0}, "policy_reward_mean": {"default_policy": 110.15}, "custom_metrics": {}, "hist_stats": {"episode_reward": [13.0, 92.0, 29.0, 39.0, 50.0, 24.0, 33.0, 128.0, 120.0, 70.0, 31.0, 69.0, 20.0, 11.0, 86.0, 85.0, 12.0, 15.0, 11.0, 13.0, 49.0, 87.0, 11.0, 57.0, 114.0, 76.0, 14.0, 16.0, 98.0, 62.0, 17.0, 227.0, 93.0, 120.0, 127.0, 123.0, 137.0, 155.0, 156.0, 112.0, 121.0, 143.0, 144.0, 138.0, 148.0, 155.0, 194.0, 192.0, 300.0, 152.0, 141.0, 130.0, 125.0, 108.0, 114.0, 256.0, 233.0, 177.0, 125.0, 120.0, 109.0, 109.0, 115.0, 117.0, 153.0, 109.0, 110.0, 165.0, 107.0, 157.0, 103.0, 165.0, 124.0, 110.0, 164.0, 109.0, 119.0, 271.0, 138.0, 179.0, 128.0, 118.0, 123.0, 246.0, 137.0, 465.0, 24.0, 41.0, 70.0, 12.0, 96.0, 104.0, 102.0, 120.0, 104.0, 92.0, 99.0, 53.0, 43.0, 87.0], "episode_lengths": [13, 92, 29, 39, 50, 24, 33, 128, 120, 70, 31, 69, 20, 11, 86, 85, 12, 15, 11, 13, 49, 87, 11, 57, 114, 76, 14, 16, 98, 62, 17, 227, 93, 120, 127, 123, 137, 155, 156, 112, 121, 143, 144, 138, 148, 155, 194, 192, 300, 152, 141, 130, 125, 108, 114, 256, 233, 177, 125, 120, 109, 109, 115, 117, 153, 109, 110, 165, 107, 157, 103, 165, 124, 110, 164, 109, 119, 271, 138, 179, 128, 118, 123, 246, 137, 465, 24, 41, 70, 12, 96, 104, 102, 120, 104, 92, 99, 53, 43, 87], "policy_default_policy_reward": [13.0, 92.0, 29.0, 39.0, 50.0, 24.0, 33.0, 128.0, 120.0, 70.0, 31.0, 69.0, 20.0, 11.0, 86.0, 85.0, 12.0, 15.0, 11.0, 13.0, 49.0, 87.0, 11.0, 57.0, 114.0, 76.0, 14.0, 16.0, 98.0, 62.0, 17.0, 227.0, 93.0, 120.0, 127.0, 123.0, 137.0, 155.0, 156.0, 112.0, 121.0, 143.0, 144.0, 138.0, 148.0, 155.0, 194.0, 192.0, 300.0, 152.0, 141.0, 130.0, 125.0, 108.0, 114.0, 256.0, 233.0, 177.0, 125.0, 120.0, 109.0, 109.0, 115.0, 117.0, 153.0, 109.0, 110.0, 165.0, 107.0, 157.0, 103.0, 165.0, 124.0, 110.0, 164.0, 109.0, 119.0, 271.0, 138.0, 179.0, 128.0, 118.0, 123.0, 246.0, 137.0, 465.0, 24.0, 41.0, 70.0, 12.0, 96.0, 104.0, 102.0, 120.0, 104.0, 92.0, 99.0, 53.0, 43.0, 87.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.990778760256552, "mean_inference_ms": 1.9822611405132193, "mean_action_processing_ms": 0.22697986571556514, "mean_env_wait_ms": 0.0968426274757304, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017754793167114258, "StateBufferConnector_ms": 0.01563405990600586, "ViewRequirementAgentConnector_ms": 0.19686603546142578}, "num_episodes": 12, "episode_return_max": 465.0, "episode_return_min": 11.0, "episode_return_mean": 110.15, "episodes_this_iter": 12}, "num_healthy_workers": 0, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 17000, "num_agent_steps_trained": 512000, "num_env_steps_sampled": 17000, "num_env_steps_trained": 512000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 29.59675425746572, "num_env_steps_trained_throughput_per_sec": 947.096136238903, "timesteps_total": 17000, "num_env_steps_sampled_lifetime": 17000, "num_agent_steps_sampled_lifetime": 17000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 17000, "timers": {"training_iteration_time_ms": 31544.847, "restore_workers_time_ms": 0.025, "training_step_time_ms": 33.719, "sample_time_ms": 4.054, "load_time_ms": 0.327, "load_throughput": 97755.082, "learn_time_ms": 13.629, "learn_throughput": 2347.9, "synch_weights_time_ms": 0.055}, "counters": {"num_env_steps_sampled": 17000, "num_env_steps_trained": 512000, "num_agent_steps_sampled": 17000, "num_agent_steps_trained": 512000, "last_target_update_ts": 16501, "num_target_updates": 32}, "done": false, "training_iteration": 17, "trial_id": "5ce16_00000", "date": "2024-09-27_10-59-55", "timestamp": 1727405995, "time_this_iter_s": 33.789602518081665, "time_total_s": 503.1338224411011, "pid": 39427, "hostname": "gpu2gate1", "node_ip": "10.64.32.126", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.9828407522030984, "lr": 0.0007583973879008875, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f52e4d75580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 503.1338224411011, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 12.385416666666666, "ram_util_percent": 9.220833333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5747063755989075, "mean_q": 21.97052764892578, "min_q": 0.4710681438446045, "max_q": 28.464078903198242, "cur_lr": 0.0007583973879008875}, "td_error": [-0.32479286193847656, -0.4868335723876953, -0.3734893798828125, -0.5289318561553955, -0.1660175323486328, 0.5648956298828125, -0.15948867797851562, -0.4012184143066406, -0.1984424591064453, -0.28525352478027344, -0.2346668243408203, 0.6723284721374512, -0.01610565185546875, -0.4314613342285156, 22.604408264160156, -0.16307640075683594, 2.077707529067993, 0.25185394287109375, -0.045459747314453125, -0.17206954956054688, -1.1041679382324219, -0.6724853515625, 0.22240257263183594, 2.175096035003662, -0.2670440673828125, -0.10363578796386719, -0.1750812530517578, -0.08262825012207031, -0.8380799293518066, -1.5807933807373047, -0.124359130859375, -0.4927558898925781], "mean_td_error": 0.5981360673904419, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 17000.0, "diff_num_grad_updates_vs_sampler_policy": 7601.03125}}, "num_env_steps_sampled": 18000, "num_env_steps_trained": 544000, "num_agent_steps_sampled": 18000, "num_agent_steps_trained": 544000, "last_target_update_ts": 17501, "num_target_updates": 34}, "env_runners": {"episode_reward_max": 465.0, "episode_reward_min": 11.0, "episode_reward_mean": 113.63, "episode_len_mean": 113.63, "episode_media": {}, "episodes_timesteps_total": 11363, "policy_reward_min": {"default_policy": 11.0}, "policy_reward_max": {"default_policy": 465.0}, "policy_reward_mean": {"default_policy": 113.63}, "custom_metrics": {}, "hist_stats": {"episode_reward": [86.0, 85.0, 12.0, 15.0, 11.0, 13.0, 49.0, 87.0, 11.0, 57.0, 114.0, 76.0, 14.0, 16.0, 98.0, 62.0, 17.0, 227.0, 93.0, 120.0, 127.0, 123.0, 137.0, 155.0, 156.0, 112.0, 121.0, 143.0, 144.0, 138.0, 148.0, 155.0, 194.0, 192.0, 300.0, 152.0, 141.0, 130.0, 125.0, 108.0, 114.0, 256.0, 233.0, 177.0, 125.0, 120.0, 109.0, 109.0, 115.0, 117.0, 153.0, 109.0, 110.0, 165.0, 107.0, 157.0, 103.0, 165.0, 124.0, 110.0, 164.0, 109.0, 119.0, 271.0, 138.0, 179.0, 128.0, 118.0, 123.0, 246.0, 137.0, 465.0, 24.0, 41.0, 70.0, 12.0, 96.0, 104.0, 102.0, 120.0, 104.0, 92.0, 99.0, 53.0, 43.0, 87.0, 94.0, 88.0, 87.0, 90.0, 58.0, 88.0, 59.0, 11.0, 103.0, 95.0, 102.0, 95.0, 93.0, 14.0], "episode_lengths": [86, 85, 12, 15, 11, 13, 49, 87, 11, 57, 114, 76, 14, 16, 98, 62, 17, 227, 93, 120, 127, 123, 137, 155, 156, 112, 121, 143, 144, 138, 148, 155, 194, 192, 300, 152, 141, 130, 125, 108, 114, 256, 233, 177, 125, 120, 109, 109, 115, 117, 153, 109, 110, 165, 107, 157, 103, 165, 124, 110, 164, 109, 119, 271, 138, 179, 128, 118, 123, 246, 137, 465, 24, 41, 70, 12, 96, 104, 102, 120, 104, 92, 99, 53, 43, 87, 94, 88, 87, 90, 58, 88, 59, 11, 103, 95, 102, 95, 93, 14], "policy_default_policy_reward": [86.0, 85.0, 12.0, 15.0, 11.0, 13.0, 49.0, 87.0, 11.0, 57.0, 114.0, 76.0, 14.0, 16.0, 98.0, 62.0, 17.0, 227.0, 93.0, 120.0, 127.0, 123.0, 137.0, 155.0, 156.0, 112.0, 121.0, 143.0, 144.0, 138.0, 148.0, 155.0, 194.0, 192.0, 300.0, 152.0, 141.0, 130.0, 125.0, 108.0, 114.0, 256.0, 233.0, 177.0, 125.0, 120.0, 109.0, 109.0, 115.0, 117.0, 153.0, 109.0, 110.0, 165.0, 107.0, 157.0, 103.0, 165.0, 124.0, 110.0, 164.0, 109.0, 119.0, 271.0, 138.0, 179.0, 128.0, 118.0, 123.0, 246.0, 137.0, 465.0, 24.0, 41.0, 70.0, 12.0, 96.0, 104.0, 102.0, 120.0, 104.0, 92.0, 99.0, 53.0, 43.0, 87.0, 94.0, 88.0, 87.0, 90.0, 58.0, 88.0, 59.0, 11.0, 103.0, 95.0, 102.0, 95.0, 93.0, 14.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9922471717100169, "mean_inference_ms": 1.9849976919864856, "mean_action_processing_ms": 0.22782171588171443, "mean_env_wait_ms": 0.09740684638299489, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017879962921142578, "StateBufferConnector_ms": 0.015598535537719727, "ViewRequirementAgentConnector_ms": 0.20096874237060547}, "num_episodes": 14, "episode_return_max": 465.0, "episode_return_min": 11.0, "episode_return_mean": 113.63, "episodes_this_iter": 14}, "num_healthy_workers": 0, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18000, "num_agent_steps_trained": 544000, "num_env_steps_sampled": 18000, "num_env_steps_trained": 544000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 29.587448037812585, "num_env_steps_trained_throughput_per_sec": 946.7983372100027, "timesteps_total": 18000, "num_env_steps_sampled_lifetime": 18000, "num_agent_steps_sampled_lifetime": 18000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 18000, "timers": {"training_iteration_time_ms": 31999.642, "restore_workers_time_ms": 0.023, "training_step_time_ms": 33.204, "sample_time_ms": 4.125, "load_time_ms": 0.233, "load_throughput": 137096.76, "learn_time_ms": 13.356, "learn_throughput": 2396.009, "synch_weights_time_ms": 0.053}, "counters": {"num_env_steps_sampled": 18000, "num_env_steps_trained": 544000, "num_agent_steps_sampled": 18000, "num_agent_steps_trained": 544000, "last_target_update_ts": 17501, "num_target_updates": 34}, "done": false, "training_iteration": 18, "trial_id": "5ce16_00000", "date": "2024-09-27_11-00-29", "timestamp": 1727406029, "time_this_iter_s": 33.79994201660156, "time_total_s": 536.9337644577026, "pid": 39427, "hostname": "gpu2gate1", "node_ip": "10.64.32.126", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.9828407522030984, "lr": 0.0007583973879008875, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f52e4d75580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 536.9337644577026, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 13.148936170212766, "ram_util_percent": 9.272340425531917}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9457553029060364, "mean_q": 21.10716438293457, "min_q": 0.6113052368164062, "max_q": 30.207059860229492, "cur_lr": 0.0007583973879008875}, "td_error": [0.21260452270507812, 2.8101139068603516, 0.20493698120117188, -0.24464499950408936, 0.7245941162109375, 1.1876754760742188, 0.2649040222167969, 5.069846153259277, 0.18814468383789062, 0.0682830810546875, 0.7627902030944824, 0.28784751892089844, 20.530851364135742, -0.067657470703125, 1.7913427352905273, 0.15869665145874023, 0.07597160339355469, 1.4477508068084717, 0.7786848545074463, 1.5695133209228516, 0.5093212127685547, 2.288891315460205, 18.3331298828125, -0.010194778442382812, -0.10161781311035156, 0.5404758453369141, 4.497947692871094, 0.19580650329589844, 0.5730857849121094, 0.4492664337158203, 0.5293502807617188, 0.34576416015625], "mean_td_error": 2.061671257019043, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 18000.0, "diff_num_grad_updates_vs_sampler_policy": 10356.53125}}, "num_env_steps_sampled": 19000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 19000, "num_agent_steps_trained": 576000, "last_target_update_ts": 18501, "num_target_updates": 36}, "env_runners": {"episode_reward_max": 465.0, "episode_reward_min": 11.0, "episode_reward_mean": 118.79, "episode_len_mean": 118.79, "episode_media": {}, "episodes_timesteps_total": 11879, "policy_reward_min": {"default_policy": 11.0}, "policy_reward_max": {"default_policy": 465.0}, "policy_reward_mean": {"default_policy": 118.79}, "custom_metrics": {}, "hist_stats": {"episode_reward": [114.0, 76.0, 14.0, 16.0, 98.0, 62.0, 17.0, 227.0, 93.0, 120.0, 127.0, 123.0, 137.0, 155.0, 156.0, 112.0, 121.0, 143.0, 144.0, 138.0, 148.0, 155.0, 194.0, 192.0, 300.0, 152.0, 141.0, 130.0, 125.0, 108.0, 114.0, 256.0, 233.0, 177.0, 125.0, 120.0, 109.0, 109.0, 115.0, 117.0, 153.0, 109.0, 110.0, 165.0, 107.0, 157.0, 103.0, 165.0, 124.0, 110.0, 164.0, 109.0, 119.0, 271.0, 138.0, 179.0, 128.0, 118.0, 123.0, 246.0, 137.0, 465.0, 24.0, 41.0, 70.0, 12.0, 96.0, 104.0, 102.0, 120.0, 104.0, 92.0, 99.0, 53.0, 43.0, 87.0, 94.0, 88.0, 87.0, 90.0, 58.0, 88.0, 59.0, 11.0, 103.0, 95.0, 102.0, 95.0, 93.0, 14.0, 88.0, 87.0, 91.0, 89.0, 93.0, 96.0, 98.0, 100.0, 95.0, 105.0], "episode_lengths": [114, 76, 14, 16, 98, 62, 17, 227, 93, 120, 127, 123, 137, 155, 156, 112, 121, 143, 144, 138, 148, 155, 194, 192, 300, 152, 141, 130, 125, 108, 114, 256, 233, 177, 125, 120, 109, 109, 115, 117, 153, 109, 110, 165, 107, 157, 103, 165, 124, 110, 164, 109, 119, 271, 138, 179, 128, 118, 123, 246, 137, 465, 24, 41, 70, 12, 96, 104, 102, 120, 104, 92, 99, 53, 43, 87, 94, 88, 87, 90, 58, 88, 59, 11, 103, 95, 102, 95, 93, 14, 88, 87, 91, 89, 93, 96, 98, 100, 95, 105], "policy_default_policy_reward": [114.0, 76.0, 14.0, 16.0, 98.0, 62.0, 17.0, 227.0, 93.0, 120.0, 127.0, 123.0, 137.0, 155.0, 156.0, 112.0, 121.0, 143.0, 144.0, 138.0, 148.0, 155.0, 194.0, 192.0, 300.0, 152.0, 141.0, 130.0, 125.0, 108.0, 114.0, 256.0, 233.0, 177.0, 125.0, 120.0, 109.0, 109.0, 115.0, 117.0, 153.0, 109.0, 110.0, 165.0, 107.0, 157.0, 103.0, 165.0, 124.0, 110.0, 164.0, 109.0, 119.0, 271.0, 138.0, 179.0, 128.0, 118.0, 123.0, 246.0, 137.0, 465.0, 24.0, 41.0, 70.0, 12.0, 96.0, 104.0, 102.0, 120.0, 104.0, 92.0, 99.0, 53.0, 43.0, 87.0, 94.0, 88.0, 87.0, 90.0, 58.0, 88.0, 59.0, 11.0, 103.0, 95.0, 102.0, 95.0, 93.0, 14.0, 88.0, 87.0, 91.0, 89.0, 93.0, 96.0, 98.0, 100.0, 95.0, 105.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9939201271755111, "mean_inference_ms": 1.9881611204753062, "mean_action_processing_ms": 0.22855295045428398, "mean_env_wait_ms": 0.09787291471444538, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01801609992980957, "StateBufferConnector_ms": 0.01568436622619629, "ViewRequirementAgentConnector_ms": 0.20228099822998047}, "num_episodes": 10, "episode_return_max": 465.0, "episode_return_min": 11.0, "episode_return_mean": 118.79, "episodes_this_iter": 10}, "num_healthy_workers": 0, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 19000, "num_agent_steps_trained": 576000, "num_env_steps_sampled": 19000, "num_env_steps_trained": 576000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 28.93982901733577, "num_env_steps_trained_throughput_per_sec": 926.0745285547447, "timesteps_total": 19000, "num_env_steps_sampled_lifetime": 19000, "num_agent_steps_sampled_lifetime": 19000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 19000, "timers": {"training_iteration_time_ms": 32794.704, "restore_workers_time_ms": 0.019, "training_step_time_ms": 30.107, "sample_time_ms": 3.71, "load_time_ms": 0.214, "load_throughput": 149579.548, "learn_time_ms": 12.039, "learn_throughput": 2658.129, "synch_weights_time_ms": 0.042}, "counters": {"num_env_steps_sampled": 19000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 19000, "num_agent_steps_trained": 576000, "last_target_update_ts": 18501, "num_target_updates": 36}, "done": false, "training_iteration": 19, "trial_id": "5ce16_00000", "date": "2024-09-27_11-01-03", "timestamp": 1727406063, "time_this_iter_s": 34.55616021156311, "time_total_s": 571.4899246692657, "pid": 39427, "hostname": "gpu2gate1", "node_ip": "10.64.32.126", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.9828407522030984, "lr": 0.0007583973879008875, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f52e4d75580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 571.4899246692657, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 14.16530612244898, "ram_util_percent": 9.340816326530613}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.45527327060699463, "mean_q": 25.62273406982422, "min_q": -2.7449657917022705, "max_q": 30.924245834350586, "cur_lr": 0.0007583973879008875}, "td_error": [-0.1924114227294922, 0.30797767639160156, -0.2961273193359375, -0.34345245361328125, -0.8553409576416016, 0.08467864990234375, 0.1767406463623047, -0.6349849700927734, -0.1970539093017578, -0.20569801330566406, 2.6206984519958496, -0.04208946228027344, 1.4190242290496826, -3.7449657917022705, 0.07738494873046875, -0.5213375091552734, 0.029462814331054688, -0.5449142456054688, 0.27619361877441406, -0.3872509002685547, 0.0060577392578125, -0.12370109558105469, -0.0819854736328125, -0.2844676971435547, -0.016443252563476562, -0.16923904418945312, 0.06914901733398438, -0.3016319274902344, 0.015173912048339844, -0.2981090545654297, -0.5371074676513672, 0.3147106170654297], "mean_td_error": -0.13690811395645142, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 19000.0, "diff_num_grad_updates_vs_sampler_policy": 9380.15625}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 608000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 608000, "last_target_update_ts": 19501, "num_target_updates": 38}, "env_runners": {"episode_reward_max": 465.0, "episode_reward_min": 11.0, "episode_reward_mean": 116.94, "episode_len_mean": 116.94, "episode_media": {}, "episodes_timesteps_total": 11694, "policy_reward_min": {"default_policy": 11.0}, "policy_reward_max": {"default_policy": 465.0}, "policy_reward_mean": {"default_policy": 116.94}, "custom_metrics": {}, "hist_stats": {"episode_reward": [155.0, 156.0, 112.0, 121.0, 143.0, 144.0, 138.0, 148.0, 155.0, 194.0, 192.0, 300.0, 152.0, 141.0, 130.0, 125.0, 108.0, 114.0, 256.0, 233.0, 177.0, 125.0, 120.0, 109.0, 109.0, 115.0, 117.0, 153.0, 109.0, 110.0, 165.0, 107.0, 157.0, 103.0, 165.0, 124.0, 110.0, 164.0, 109.0, 119.0, 271.0, 138.0, 179.0, 128.0, 118.0, 123.0, 246.0, 137.0, 465.0, 24.0, 41.0, 70.0, 12.0, 96.0, 104.0, 102.0, 120.0, 104.0, 92.0, 99.0, 53.0, 43.0, 87.0, 94.0, 88.0, 87.0, 90.0, 58.0, 88.0, 59.0, 11.0, 103.0, 95.0, 102.0, 95.0, 93.0, 14.0, 88.0, 87.0, 91.0, 89.0, 93.0, 96.0, 98.0, 100.0, 95.0, 105.0, 95.0, 93.0, 96.0, 93.0, 93.0, 35.0, 47.0, 95.0, 94.0, 94.0, 12.0, 98.0, 94.0], "episode_lengths": [155, 156, 112, 121, 143, 144, 138, 148, 155, 194, 192, 300, 152, 141, 130, 125, 108, 114, 256, 233, 177, 125, 120, 109, 109, 115, 117, 153, 109, 110, 165, 107, 157, 103, 165, 124, 110, 164, 109, 119, 271, 138, 179, 128, 118, 123, 246, 137, 465, 24, 41, 70, 12, 96, 104, 102, 120, 104, 92, 99, 53, 43, 87, 94, 88, 87, 90, 58, 88, 59, 11, 103, 95, 102, 95, 93, 14, 88, 87, 91, 89, 93, 96, 98, 100, 95, 105, 95, 93, 96, 93, 93, 35, 47, 95, 94, 94, 12, 98, 94], "policy_default_policy_reward": [155.0, 156.0, 112.0, 121.0, 143.0, 144.0, 138.0, 148.0, 155.0, 194.0, 192.0, 300.0, 152.0, 141.0, 130.0, 125.0, 108.0, 114.0, 256.0, 233.0, 177.0, 125.0, 120.0, 109.0, 109.0, 115.0, 117.0, 153.0, 109.0, 110.0, 165.0, 107.0, 157.0, 103.0, 165.0, 124.0, 110.0, 164.0, 109.0, 119.0, 271.0, 138.0, 179.0, 128.0, 118.0, 123.0, 246.0, 137.0, 465.0, 24.0, 41.0, 70.0, 12.0, 96.0, 104.0, 102.0, 120.0, 104.0, 92.0, 99.0, 53.0, 43.0, 87.0, 94.0, 88.0, 87.0, 90.0, 58.0, 88.0, 59.0, 11.0, 103.0, 95.0, 102.0, 95.0, 93.0, 14.0, 88.0, 87.0, 91.0, 89.0, 93.0, 96.0, 98.0, 100.0, 95.0, 105.0, 95.0, 93.0, 96.0, 93.0, 93.0, 35.0, 47.0, 95.0, 94.0, 94.0, 12.0, 98.0, 94.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9971808909309212, "mean_inference_ms": 1.9945822627469647, "mean_action_processing_ms": 0.22969411497242045, "mean_env_wait_ms": 0.09852415229797394, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017871379852294922, "StateBufferConnector_ms": 0.01571202278137207, "ViewRequirementAgentConnector_ms": 0.20409893989562988}, "num_episodes": 13, "episode_return_max": 465.0, "episode_return_min": 11.0, "episode_return_mean": 116.94, "episodes_this_iter": 13}, "num_healthy_workers": 0, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 608000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 608000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 32.13653171369189, "num_env_steps_trained_throughput_per_sec": 1028.3690148381404, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 20000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 32562.814, "restore_workers_time_ms": 0.019, "training_step_time_ms": 31.062, "sample_time_ms": 3.75, "load_time_ms": 0.212, "load_throughput": 151163.113, "learn_time_ms": 12.623, "learn_throughput": 2535.122, "synch_weights_time_ms": 0.051}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 608000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 608000, "last_target_update_ts": 19501, "num_target_updates": 38}, "done": false, "training_iteration": 20, "trial_id": "5ce16_00000", "date": "2024-09-27_11-01-35", "timestamp": 1727406095, "time_this_iter_s": 31.119038343429565, "time_total_s": 602.6089630126953, "pid": 39427, "hostname": "gpu2gate1", "node_ip": "10.64.32.126", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.9828407522030984, "lr": 0.0007583973879008875, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f52e4d75580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 602.6089630126953, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 12.597727272727274, "ram_util_percent": 9.399999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6217829585075378, "mean_q": 26.12955093383789, "min_q": 3.6855037212371826, "max_q": 32.289180755615234, "cur_lr": 0.0007583973879008875}, "td_error": [-0.32059478759765625, 0.15804481506347656, -0.2036876678466797, 0.025875091552734375, -0.07096481323242188, -0.059604644775390625, 0.2607250213623047, -0.4856834411621094, -0.4028453826904297, 0.030332565307617188, 0.40604209899902344, 0.47098731994628906, -0.10100364685058594, 21.68816566467285, -3.4873924255371094, -0.24419403076171875, 0.18301963806152344, 0.10950851440429688, -0.0232086181640625, 2.823568820953369, -0.031047821044921875, 0.05812835693359375, -0.019329071044921875, -2.270554304122925, -0.022329330444335938, -0.026620864868164062, -0.22155380249023438, -0.7297024726867676, -1.5662860870361328, -0.3133583068847656, -0.15196800231933594, -0.9265975952148438], "mean_td_error": 0.4542459547519684, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 20000.0, "diff_num_grad_updates_vs_sampler_policy": 6905.375}}, "num_env_steps_sampled": 21000, "num_env_steps_trained": 640000, "num_agent_steps_sampled": 21000, "num_agent_steps_trained": 640000, "last_target_update_ts": 20501, "num_target_updates": 40}, "env_runners": {"episode_reward_max": 465.0, "episode_reward_min": 11.0, "episode_reward_mean": 111.55, "episode_len_mean": 111.55, "episode_media": {}, "episodes_timesteps_total": 11155, "policy_reward_min": {"default_policy": 11.0}, "policy_reward_max": {"default_policy": 465.0}, "policy_reward_mean": {"default_policy": 111.55}, "custom_metrics": {}, "hist_stats": {"episode_reward": [192.0, 300.0, 152.0, 141.0, 130.0, 125.0, 108.0, 114.0, 256.0, 233.0, 177.0, 125.0, 120.0, 109.0, 109.0, 115.0, 117.0, 153.0, 109.0, 110.0, 165.0, 107.0, 157.0, 103.0, 165.0, 124.0, 110.0, 164.0, 109.0, 119.0, 271.0, 138.0, 179.0, 128.0, 118.0, 123.0, 246.0, 137.0, 465.0, 24.0, 41.0, 70.0, 12.0, 96.0, 104.0, 102.0, 120.0, 104.0, 92.0, 99.0, 53.0, 43.0, 87.0, 94.0, 88.0, 87.0, 90.0, 58.0, 88.0, 59.0, 11.0, 103.0, 95.0, 102.0, 95.0, 93.0, 14.0, 88.0, 87.0, 91.0, 89.0, 93.0, 96.0, 98.0, 100.0, 95.0, 105.0, 95.0, 93.0, 96.0, 93.0, 93.0, 35.0, 47.0, 95.0, 94.0, 94.0, 12.0, 98.0, 94.0, 92.0, 104.0, 103.0, 103.0, 105.0, 96.0, 98.0, 99.0, 33.0, 94.0], "episode_lengths": [192, 300, 152, 141, 130, 125, 108, 114, 256, 233, 177, 125, 120, 109, 109, 115, 117, 153, 109, 110, 165, 107, 157, 103, 165, 124, 110, 164, 109, 119, 271, 138, 179, 128, 118, 123, 246, 137, 465, 24, 41, 70, 12, 96, 104, 102, 120, 104, 92, 99, 53, 43, 87, 94, 88, 87, 90, 58, 88, 59, 11, 103, 95, 102, 95, 93, 14, 88, 87, 91, 89, 93, 96, 98, 100, 95, 105, 95, 93, 96, 93, 93, 35, 47, 95, 94, 94, 12, 98, 94, 92, 104, 103, 103, 105, 96, 98, 99, 33, 94], "policy_default_policy_reward": [192.0, 300.0, 152.0, 141.0, 130.0, 125.0, 108.0, 114.0, 256.0, 233.0, 177.0, 125.0, 120.0, 109.0, 109.0, 115.0, 117.0, 153.0, 109.0, 110.0, 165.0, 107.0, 157.0, 103.0, 165.0, 124.0, 110.0, 164.0, 109.0, 119.0, 271.0, 138.0, 179.0, 128.0, 118.0, 123.0, 246.0, 137.0, 465.0, 24.0, 41.0, 70.0, 12.0, 96.0, 104.0, 102.0, 120.0, 104.0, 92.0, 99.0, 53.0, 43.0, 87.0, 94.0, 88.0, 87.0, 90.0, 58.0, 88.0, 59.0, 11.0, 103.0, 95.0, 102.0, 95.0, 93.0, 14.0, 88.0, 87.0, 91.0, 89.0, 93.0, 96.0, 98.0, 100.0, 95.0, 105.0, 95.0, 93.0, 96.0, 93.0, 93.0, 35.0, 47.0, 95.0, 94.0, 94.0, 12.0, 98.0, 94.0, 92.0, 104.0, 103.0, 103.0, 105.0, 96.0, 98.0, 99.0, 33.0, 94.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0004400111477036, "mean_inference_ms": 2.0013718734541466, "mean_action_processing_ms": 0.23064445258094907, "mean_env_wait_ms": 0.09901941509941022, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01779794692993164, "StateBufferConnector_ms": 0.01583695411682129, "ViewRequirementAgentConnector_ms": 0.20529961585998535}, "num_episodes": 10, "episode_return_max": 465.0, "episode_return_min": 11.0, "episode_return_mean": 111.55, "episodes_this_iter": 10}, "num_healthy_workers": 0, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 21000, "num_agent_steps_trained": 640000, "num_env_steps_sampled": 21000, "num_env_steps_trained": 640000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 30.36881300013046, "num_env_steps_trained_throughput_per_sec": 971.8020160041747, "timesteps_total": 21000, "num_env_steps_sampled_lifetime": 21000, "num_agent_steps_sampled_lifetime": 21000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 21000, "timers": {"training_iteration_time_ms": 32571.094, "restore_workers_time_ms": 0.02, "training_step_time_ms": 28.325, "sample_time_ms": 3.383, "load_time_ms": 0.196, "load_throughput": 162865.827, "learn_time_ms": 11.398, "learn_throughput": 2807.421, "synch_weights_time_ms": 0.04}, "counters": {"num_env_steps_sampled": 21000, "num_env_steps_trained": 640000, "num_agent_steps_sampled": 21000, "num_agent_steps_trained": 640000, "last_target_update_ts": 20501, "num_target_updates": 40}, "done": false, "training_iteration": 21, "trial_id": "5ce16_00000", "date": "2024-09-27_11-02-08", "timestamp": 1727406128, "time_this_iter_s": 32.929927110672, "time_total_s": 635.5388901233673, "pid": 39427, "hostname": "gpu2gate1", "node_ip": "10.64.32.126", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.9828407522030984, "lr": 0.0007583973879008875, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f52e4d75580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 635.5388901233673, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 12.848936170212765, "ram_util_percent": 9.399999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9201021194458008, "mean_q": 26.031173706054688, "min_q": 4.410891532897949, "max_q": 33.05272674560547, "cur_lr": 0.0007583973879008875}, "td_error": [-0.34186363220214844, -0.18177032470703125, -0.4679698944091797, -2.2118072509765625, -1.4238224029541016, -0.29085350036621094, -0.27034950256347656, -0.16147613525390625, -0.6061916351318359, 0.5147705078125, -0.1372547149658203, -0.10863113403320312, 22.312959671020508, -0.7591485977172852, -0.13088226318359375, -0.4079399108886719, -0.6433820724487305, -0.7069740295410156, -0.08410453796386719, -0.086822509765625, -0.3251190185546875, 5.516647815704346, -0.37419700622558594, -0.18891143798828125, -0.3334331512451172, -0.16754913330078125, -0.5525588989257812, -0.5922622680664062, -1.007035255432129, 0.0557098388671875, 1.9323959350585938, -0.6856040954589844], "mean_td_error": 0.533892810344696, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 21000.0, "diff_num_grad_updates_vs_sampler_policy": 10479.28125}}, "num_env_steps_sampled": 22000, "num_env_steps_trained": 672000, "num_agent_steps_sampled": 22000, "num_agent_steps_trained": 672000, "last_target_update_ts": 21501, "num_target_updates": 42}, "env_runners": {"episode_reward_max": 465.0, "episode_reward_min": 11.0, "episode_reward_mean": 101.3, "episode_len_mean": 101.3, "episode_media": {}, "episodes_timesteps_total": 10130, "policy_reward_min": {"default_policy": 11.0}, "policy_reward_max": {"default_policy": 465.0}, "policy_reward_mean": {"default_policy": 101.3}, "custom_metrics": {}, "hist_stats": {"episode_reward": [120.0, 109.0, 109.0, 115.0, 117.0, 153.0, 109.0, 110.0, 165.0, 107.0, 157.0, 103.0, 165.0, 124.0, 110.0, 164.0, 109.0, 119.0, 271.0, 138.0, 179.0, 128.0, 118.0, 123.0, 246.0, 137.0, 465.0, 24.0, 41.0, 70.0, 12.0, 96.0, 104.0, 102.0, 120.0, 104.0, 92.0, 99.0, 53.0, 43.0, 87.0, 94.0, 88.0, 87.0, 90.0, 58.0, 88.0, 59.0, 11.0, 103.0, 95.0, 102.0, 95.0, 93.0, 14.0, 88.0, 87.0, 91.0, 89.0, 93.0, 96.0, 98.0, 100.0, 95.0, 105.0, 95.0, 93.0, 96.0, 93.0, 93.0, 35.0, 47.0, 95.0, 94.0, 94.0, 12.0, 98.0, 94.0, 92.0, 104.0, 103.0, 103.0, 105.0, 96.0, 98.0, 99.0, 33.0, 94.0, 98.0, 104.0, 91.0, 97.0, 50.0, 95.0, 90.0, 97.0, 17.0, 99.0, 98.0, 92.0], "episode_lengths": [120, 109, 109, 115, 117, 153, 109, 110, 165, 107, 157, 103, 165, 124, 110, 164, 109, 119, 271, 138, 179, 128, 118, 123, 246, 137, 465, 24, 41, 70, 12, 96, 104, 102, 120, 104, 92, 99, 53, 43, 87, 94, 88, 87, 90, 58, 88, 59, 11, 103, 95, 102, 95, 93, 14, 88, 87, 91, 89, 93, 96, 98, 100, 95, 105, 95, 93, 96, 93, 93, 35, 47, 95, 94, 94, 12, 98, 94, 92, 104, 103, 103, 105, 96, 98, 99, 33, 94, 98, 104, 91, 97, 50, 95, 90, 97, 17, 99, 98, 92], "policy_default_policy_reward": [120.0, 109.0, 109.0, 115.0, 117.0, 153.0, 109.0, 110.0, 165.0, 107.0, 157.0, 103.0, 165.0, 124.0, 110.0, 164.0, 109.0, 119.0, 271.0, 138.0, 179.0, 128.0, 118.0, 123.0, 246.0, 137.0, 465.0, 24.0, 41.0, 70.0, 12.0, 96.0, 104.0, 102.0, 120.0, 104.0, 92.0, 99.0, 53.0, 43.0, 87.0, 94.0, 88.0, 87.0, 90.0, 58.0, 88.0, 59.0, 11.0, 103.0, 95.0, 102.0, 95.0, 93.0, 14.0, 88.0, 87.0, 91.0, 89.0, 93.0, 96.0, 98.0, 100.0, 95.0, 105.0, 95.0, 93.0, 96.0, 93.0, 93.0, 35.0, 47.0, 95.0, 94.0, 94.0, 12.0, 98.0, 94.0, 92.0, 104.0, 103.0, 103.0, 105.0, 96.0, 98.0, 99.0, 33.0, 94.0, 98.0, 104.0, 91.0, 97.0, 50.0, 95.0, 90.0, 97.0, 17.0, 99.0, 98.0, 92.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0029495222898475, "mean_inference_ms": 2.0066609302548186, "mean_action_processing_ms": 0.23136382345186013, "mean_env_wait_ms": 0.0993888666609915, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0176849365234375, "StateBufferConnector_ms": 0.015877962112426758, "ViewRequirementAgentConnector_ms": 0.20427894592285156}, "num_episodes": 12, "episode_return_max": 465.0, "episode_return_min": 11.0, "episode_return_mean": 101.3, "episodes_this_iter": 12}, "num_healthy_workers": 0, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 22000, "num_agent_steps_trained": 672000, "num_env_steps_sampled": 22000, "num_env_steps_trained": 672000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 34.24582339420488, "num_env_steps_trained_throughput_per_sec": 1095.8663486145563, "timesteps_total": 22000, "num_env_steps_sampled_lifetime": 22000, "num_agent_steps_sampled_lifetime": 22000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 22000, "timers": {"training_iteration_time_ms": 32675.151, "restore_workers_time_ms": 0.016, "training_step_time_ms": 26.345, "sample_time_ms": 3.129, "load_time_ms": 0.191, "load_throughput": 167124.552, "learn_time_ms": 10.503, "learn_throughput": 3046.816, "synch_weights_time_ms": 0.038}, "counters": {"num_env_steps_sampled": 22000, "num_env_steps_trained": 672000, "num_agent_steps_sampled": 22000, "num_agent_steps_trained": 672000, "last_target_update_ts": 21501, "num_target_updates": 42}, "done": false, "training_iteration": 22, "trial_id": "5ce16_00000", "date": "2024-09-27_11-02-37", "timestamp": 1727406157, "time_this_iter_s": 29.20207905769348, "time_total_s": 664.7409691810608, "pid": 39427, "hostname": "gpu2gate1", "node_ip": "10.64.32.126", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.9828407522030984, "lr": 0.0007583973879008875, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f52e4d75580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 664.7409691810608, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 12.790243902439023, "ram_util_percent": 9.399999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7759987115859985, "mean_q": 26.858802795410156, "min_q": 1.5398422479629517, "max_q": 34.75410842895508, "cur_lr": 0.0007583973879008875}, "td_error": [4.475160121917725, 2.27927303314209, 0.016544342041015625, 0.1862030029296875, 0.2364349365234375, 0.22348594665527344, 0.16351318359375, 0.35150909423828125, -0.0188751220703125, 0.17605209350585938, 0.8135786056518555, 0.01847076416015625, 2.3330435752868652, 2.4143881797790527, 0.36843109130859375, 0.20543670654296875, 0.15358352661132812, 0.17794418334960938, 0.22667694091796875, 1.8559694290161133, 0.5943183898925781, 0.24530792236328125, 0.2952094078063965, 0.5398422479629517, -0.10516357421875, 0.22843170166015625, 0.09911727905273438, -0.0498809814453125, 0.7518234252929688, 0.3627433776855469, 0.029003143310546875, 0.374908447265625], "mean_td_error": 0.6257026791572571, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 22000.0, "diff_num_grad_updates_vs_sampler_policy": 11887.84375}}, "num_env_steps_sampled": 23000, "num_env_steps_trained": 704000, "num_agent_steps_sampled": 23000, "num_agent_steps_trained": 704000, "last_target_update_ts": 22501, "num_target_updates": 44}, "env_runners": {"episode_reward_max": 465.0, "episode_reward_min": 11.0, "episode_reward_mean": 98.99, "episode_len_mean": 98.99, "episode_media": {}, "episodes_timesteps_total": 9899, "policy_reward_min": {"default_policy": 11.0}, "policy_reward_max": {"default_policy": 465.0}, "policy_reward_mean": {"default_policy": 98.99}, "custom_metrics": {}, "hist_stats": {"episode_reward": [157.0, 103.0, 165.0, 124.0, 110.0, 164.0, 109.0, 119.0, 271.0, 138.0, 179.0, 128.0, 118.0, 123.0, 246.0, 137.0, 465.0, 24.0, 41.0, 70.0, 12.0, 96.0, 104.0, 102.0, 120.0, 104.0, 92.0, 99.0, 53.0, 43.0, 87.0, 94.0, 88.0, 87.0, 90.0, 58.0, 88.0, 59.0, 11.0, 103.0, 95.0, 102.0, 95.0, 93.0, 14.0, 88.0, 87.0, 91.0, 89.0, 93.0, 96.0, 98.0, 100.0, 95.0, 105.0, 95.0, 93.0, 96.0, 93.0, 93.0, 35.0, 47.0, 95.0, 94.0, 94.0, 12.0, 98.0, 94.0, 92.0, 104.0, 103.0, 103.0, 105.0, 96.0, 98.0, 99.0, 33.0, 94.0, 98.0, 104.0, 91.0, 97.0, 50.0, 95.0, 90.0, 97.0, 17.0, 99.0, 98.0, 92.0, 102.0, 99.0, 97.0, 99.0, 96.0, 107.0, 97.0, 96.0, 93.0, 97.0], "episode_lengths": [157, 103, 165, 124, 110, 164, 109, 119, 271, 138, 179, 128, 118, 123, 246, 137, 465, 24, 41, 70, 12, 96, 104, 102, 120, 104, 92, 99, 53, 43, 87, 94, 88, 87, 90, 58, 88, 59, 11, 103, 95, 102, 95, 93, 14, 88, 87, 91, 89, 93, 96, 98, 100, 95, 105, 95, 93, 96, 93, 93, 35, 47, 95, 94, 94, 12, 98, 94, 92, 104, 103, 103, 105, 96, 98, 99, 33, 94, 98, 104, 91, 97, 50, 95, 90, 97, 17, 99, 98, 92, 102, 99, 97, 99, 96, 107, 97, 96, 93, 97], "policy_default_policy_reward": [157.0, 103.0, 165.0, 124.0, 110.0, 164.0, 109.0, 119.0, 271.0, 138.0, 179.0, 128.0, 118.0, 123.0, 246.0, 137.0, 465.0, 24.0, 41.0, 70.0, 12.0, 96.0, 104.0, 102.0, 120.0, 104.0, 92.0, 99.0, 53.0, 43.0, 87.0, 94.0, 88.0, 87.0, 90.0, 58.0, 88.0, 59.0, 11.0, 103.0, 95.0, 102.0, 95.0, 93.0, 14.0, 88.0, 87.0, 91.0, 89.0, 93.0, 96.0, 98.0, 100.0, 95.0, 105.0, 95.0, 93.0, 96.0, 93.0, 93.0, 35.0, 47.0, 95.0, 94.0, 94.0, 12.0, 98.0, 94.0, 92.0, 104.0, 103.0, 103.0, 105.0, 96.0, 98.0, 99.0, 33.0, 94.0, 98.0, 104.0, 91.0, 97.0, 50.0, 95.0, 90.0, 97.0, 17.0, 99.0, 98.0, 92.0, 102.0, 99.0, 97.0, 99.0, 96.0, 107.0, 97.0, 96.0, 93.0, 97.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0051944453463084, "mean_inference_ms": 2.011576010162535, "mean_action_processing_ms": 0.23198504798112643, "mean_env_wait_ms": 0.09971268003966852, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017632246017456055, "StateBufferConnector_ms": 0.015984535217285156, "ViewRequirementAgentConnector_ms": 0.2053391933441162}, "num_episodes": 10, "episode_return_max": 465.0, "episode_return_min": 11.0, "episode_return_mean": 98.99, "episodes_this_iter": 10}, "num_healthy_workers": 0, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 23000, "num_agent_steps_trained": 704000, "num_env_steps_sampled": 23000, "num_env_steps_trained": 704000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 29.59777973182982, "num_env_steps_trained_throughput_per_sec": 947.1289514185543, "timesteps_total": 23000, "num_env_steps_sampled_lifetime": 23000, "num_agent_steps_sampled_lifetime": 23000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 23000, "timers": {"training_iteration_time_ms": 32738.698, "restore_workers_time_ms": 0.027, "training_step_time_ms": 32.57, "sample_time_ms": 3.92, "load_time_ms": 0.238, "load_throughput": 134446.287, "learn_time_ms": 13.144, "learn_throughput": 2434.563, "synch_weights_time_ms": 0.048}, "counters": {"num_env_steps_sampled": 23000, "num_env_steps_trained": 704000, "num_agent_steps_sampled": 23000, "num_agent_steps_trained": 704000, "last_target_update_ts": 22501, "num_target_updates": 44}, "done": false, "training_iteration": 23, "trial_id": "5ce16_00000", "date": "2024-09-27_11-03-11", "timestamp": 1727406191, "time_this_iter_s": 33.78831481933594, "time_total_s": 698.5292840003967, "pid": 39427, "hostname": "gpu2gate1", "node_ip": "10.64.32.126", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.9828407522030984, "lr": 0.0007583973879008875, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f52e4d75580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 698.5292840003967, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 13.68125, "ram_util_percent": 9.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6269592046737671, "mean_q": 27.70966148376465, "min_q": 0.5500186681747437, "max_q": 35.99750518798828, "cur_lr": 0.0007583973879008875}, "td_error": [-0.6065673828125, -0.5546798706054688, 2.235095977783203, 0.13979339599609375, -0.5047492980957031, -0.8513126373291016, -0.17461013793945312, 0.3638681173324585, -0.5185661315917969, -0.3593788146972656, -0.26035118103027344, 0.8019676208496094, -0.8849811553955078, -0.5732994079589844, -0.3929710388183594, 1.3433594703674316, -0.44998133182525635, -0.25041961669921875, -0.13485336303710938, -4.540818214416504, -0.5413703918457031, -0.11971664428710938, -0.4688224792480469, -0.5409622192382812, -0.3443450927734375, 0.07341384887695312, -0.28087425231933594, -0.9531059265136719, -0.2969932556152344, -0.20402145385742188, 0.009288787841796875, -0.8342533111572266], "mean_td_error": -0.3336005210876465, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 23000.0, "diff_num_grad_updates_vs_sampler_policy": 11468.6875}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 736000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 736000, "last_target_update_ts": 23501, "num_target_updates": 46}, "env_runners": {"episode_reward_max": 465.0, "episode_reward_min": 11.0, "episode_reward_mean": 92.16, "episode_len_mean": 92.16, "episode_media": {}, "episodes_timesteps_total": 9216, "policy_reward_min": {"default_policy": 11.0}, "policy_reward_max": {"default_policy": 465.0}, "policy_reward_mean": {"default_policy": 92.16}, "custom_metrics": {}, "hist_stats": {"episode_reward": [118.0, 123.0, 246.0, 137.0, 465.0, 24.0, 41.0, 70.0, 12.0, 96.0, 104.0, 102.0, 120.0, 104.0, 92.0, 99.0, 53.0, 43.0, 87.0, 94.0, 88.0, 87.0, 90.0, 58.0, 88.0, 59.0, 11.0, 103.0, 95.0, 102.0, 95.0, 93.0, 14.0, 88.0, 87.0, 91.0, 89.0, 93.0, 96.0, 98.0, 100.0, 95.0, 105.0, 95.0, 93.0, 96.0, 93.0, 93.0, 35.0, 47.0, 95.0, 94.0, 94.0, 12.0, 98.0, 94.0, 92.0, 104.0, 103.0, 103.0, 105.0, 96.0, 98.0, 99.0, 33.0, 94.0, 98.0, 104.0, 91.0, 97.0, 50.0, 95.0, 90.0, 97.0, 17.0, 99.0, 98.0, 92.0, 102.0, 99.0, 97.0, 99.0, 96.0, 107.0, 97.0, 96.0, 93.0, 97.0, 103.0, 112.0, 108.0, 116.0, 109.0, 106.0, 92.0, 92.0, 96.0, 91.0, 29.0, 30.0], "episode_lengths": [118, 123, 246, 137, 465, 24, 41, 70, 12, 96, 104, 102, 120, 104, 92, 99, 53, 43, 87, 94, 88, 87, 90, 58, 88, 59, 11, 103, 95, 102, 95, 93, 14, 88, 87, 91, 89, 93, 96, 98, 100, 95, 105, 95, 93, 96, 93, 93, 35, 47, 95, 94, 94, 12, 98, 94, 92, 104, 103, 103, 105, 96, 98, 99, 33, 94, 98, 104, 91, 97, 50, 95, 90, 97, 17, 99, 98, 92, 102, 99, 97, 99, 96, 107, 97, 96, 93, 97, 103, 112, 108, 116, 109, 106, 92, 92, 96, 91, 29, 30], "policy_default_policy_reward": [118.0, 123.0, 246.0, 137.0, 465.0, 24.0, 41.0, 70.0, 12.0, 96.0, 104.0, 102.0, 120.0, 104.0, 92.0, 99.0, 53.0, 43.0, 87.0, 94.0, 88.0, 87.0, 90.0, 58.0, 88.0, 59.0, 11.0, 103.0, 95.0, 102.0, 95.0, 93.0, 14.0, 88.0, 87.0, 91.0, 89.0, 93.0, 96.0, 98.0, 100.0, 95.0, 105.0, 95.0, 93.0, 96.0, 93.0, 93.0, 35.0, 47.0, 95.0, 94.0, 94.0, 12.0, 98.0, 94.0, 92.0, 104.0, 103.0, 103.0, 105.0, 96.0, 98.0, 99.0, 33.0, 94.0, 98.0, 104.0, 91.0, 97.0, 50.0, 95.0, 90.0, 97.0, 17.0, 99.0, 98.0, 92.0, 102.0, 99.0, 97.0, 99.0, 96.0, 107.0, 97.0, 96.0, 93.0, 97.0, 103.0, 112.0, 108.0, 116.0, 109.0, 106.0, 92.0, 92.0, 96.0, 91.0, 29.0, 30.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0081075951478393, "mean_inference_ms": 2.016902214181585, "mean_action_processing_ms": 0.23277123156997143, "mean_env_wait_ms": 0.10018412829130822, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018055438995361328, "StateBufferConnector_ms": 0.016287803649902344, "ViewRequirementAgentConnector_ms": 0.21109414100646973}, "num_episodes": 12, "episode_return_max": 465.0, "episode_return_min": 11.0, "episode_return_mean": 92.16, "episodes_this_iter": 12}, "num_healthy_workers": 0, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 736000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 736000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 29.670219324771306, "num_env_steps_trained_throughput_per_sec": 949.4470183926818, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 24000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 32804.323, "restore_workers_time_ms": 0.024, "training_step_time_ms": 35.532, "sample_time_ms": 4.725, "load_time_ms": 0.271, "load_throughput": 118035.114, "learn_time_ms": 14.58, "learn_throughput": 2194.778, "synch_weights_time_ms": 0.059}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 736000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 736000, "last_target_update_ts": 23501, "num_target_updates": 46}, "done": false, "training_iteration": 24, "trial_id": "5ce16_00000", "date": "2024-09-27_11-03-45", "timestamp": 1727406225, "time_this_iter_s": 33.70590662956238, "time_total_s": 732.2351906299591, "pid": 39427, "hostname": "gpu2gate1", "node_ip": "10.64.32.126", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.9828407522030984, "lr": 0.0007583973879008875, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f52e4d75580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 732.2351906299591, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 12.625531914893617, "ram_util_percent": 9.480851063829787}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6712316870689392, "mean_q": 28.586944580078125, "min_q": 2.914973020553589, "max_q": 36.32694625854492, "cur_lr": 0.0007583973879008875}, "td_error": [-0.10162734985351562, -0.02512359619140625, -0.4197349548339844, -0.1896820068359375, -0.4454002380371094, 0.19041061401367188, -0.26151275634765625, -0.052303314208984375, -0.29570960998535156, -0.2870635986328125, 0.008060455322265625, -6.672460556030273, -0.879150390625, 0.6306371688842773, -0.20093059539794922, 3.6938228607177734, 27.505903244018555, -0.3076934814453125, -0.7306060791015625, -0.2659492492675781, -0.3752593994140625, -0.7601819038391113, -0.4842643737792969, -0.2504425048828125, -0.059993743896484375, -5.958305358886719, -0.00392913818359375, -0.27332305908203125, -0.2356719970703125, 1.9149730205535889, -0.3076934814453125, 0.503387451171875], "mean_td_error": 0.4563494324684143, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 24000.0, "diff_num_grad_updates_vs_sampler_policy": 10968.28125}}, "num_env_steps_sampled": 25000, "num_env_steps_trained": 768000, "num_agent_steps_sampled": 25000, "num_agent_steps_trained": 768000, "last_target_update_ts": 24501, "num_target_updates": 48}, "env_runners": {"episode_reward_max": 238.0, "episode_reward_min": 11.0, "episode_reward_mean": 88.56, "episode_len_mean": 88.56, "episode_media": {}, "episodes_timesteps_total": 8856, "policy_reward_min": {"default_policy": 11.0}, "policy_reward_max": {"default_policy": 238.0}, "policy_reward_mean": {"default_policy": 88.56}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12.0, 96.0, 104.0, 102.0, 120.0, 104.0, 92.0, 99.0, 53.0, 43.0, 87.0, 94.0, 88.0, 87.0, 90.0, 58.0, 88.0, 59.0, 11.0, 103.0, 95.0, 102.0, 95.0, 93.0, 14.0, 88.0, 87.0, 91.0, 89.0, 93.0, 96.0, 98.0, 100.0, 95.0, 105.0, 95.0, 93.0, 96.0, 93.0, 93.0, 35.0, 47.0, 95.0, 94.0, 94.0, 12.0, 98.0, 94.0, 92.0, 104.0, 103.0, 103.0, 105.0, 96.0, 98.0, 99.0, 33.0, 94.0, 98.0, 104.0, 91.0, 97.0, 50.0, 95.0, 90.0, 97.0, 17.0, 99.0, 98.0, 92.0, 102.0, 99.0, 97.0, 99.0, 96.0, 107.0, 97.0, 96.0, 93.0, 97.0, 103.0, 112.0, 108.0, 116.0, 109.0, 106.0, 92.0, 92.0, 96.0, 91.0, 29.0, 30.0, 93.0, 96.0, 96.0, 32.0, 98.0, 97.0, 114.0, 238.0], "episode_lengths": [12, 96, 104, 102, 120, 104, 92, 99, 53, 43, 87, 94, 88, 87, 90, 58, 88, 59, 11, 103, 95, 102, 95, 93, 14, 88, 87, 91, 89, 93, 96, 98, 100, 95, 105, 95, 93, 96, 93, 93, 35, 47, 95, 94, 94, 12, 98, 94, 92, 104, 103, 103, 105, 96, 98, 99, 33, 94, 98, 104, 91, 97, 50, 95, 90, 97, 17, 99, 98, 92, 102, 99, 97, 99, 96, 107, 97, 96, 93, 97, 103, 112, 108, 116, 109, 106, 92, 92, 96, 91, 29, 30, 93, 96, 96, 32, 98, 97, 114, 238], "policy_default_policy_reward": [12.0, 96.0, 104.0, 102.0, 120.0, 104.0, 92.0, 99.0, 53.0, 43.0, 87.0, 94.0, 88.0, 87.0, 90.0, 58.0, 88.0, 59.0, 11.0, 103.0, 95.0, 102.0, 95.0, 93.0, 14.0, 88.0, 87.0, 91.0, 89.0, 93.0, 96.0, 98.0, 100.0, 95.0, 105.0, 95.0, 93.0, 96.0, 93.0, 93.0, 35.0, 47.0, 95.0, 94.0, 94.0, 12.0, 98.0, 94.0, 92.0, 104.0, 103.0, 103.0, 105.0, 96.0, 98.0, 99.0, 33.0, 94.0, 98.0, 104.0, 91.0, 97.0, 50.0, 95.0, 90.0, 97.0, 17.0, 99.0, 98.0, 92.0, 102.0, 99.0, 97.0, 99.0, 96.0, 107.0, 97.0, 96.0, 93.0, 97.0, 103.0, 112.0, 108.0, 116.0, 109.0, 106.0, 92.0, 92.0, 96.0, 91.0, 29.0, 30.0, 93.0, 96.0, 96.0, 32.0, 98.0, 97.0, 114.0, 238.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0097097290405723, "mean_inference_ms": 2.019338303375991, "mean_action_processing_ms": 0.23319872251125326, "mean_env_wait_ms": 0.10045857296672267, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01816248893737793, "StateBufferConnector_ms": 0.016271352767944336, "ViewRequirementAgentConnector_ms": 0.2103278636932373}, "num_episodes": 8, "episode_return_max": 238.0, "episode_return_min": 11.0, "episode_return_mean": 88.56, "episodes_this_iter": 8}, "num_healthy_workers": 0, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 25000, "num_agent_steps_trained": 768000, "num_env_steps_sampled": 25000, "num_env_steps_trained": 768000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 30.899744705127922, "num_env_steps_trained_throughput_per_sec": 988.7918305640935, "timesteps_total": 25000, "num_env_steps_sampled_lifetime": 25000, "num_agent_steps_sampled_lifetime": 25000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 25000, "timers": {"training_iteration_time_ms": 33007.593, "restore_workers_time_ms": 0.019, "training_step_time_ms": 30.781, "sample_time_ms": 3.886, "load_time_ms": 0.214, "load_throughput": 149846.743, "learn_time_ms": 12.677, "learn_throughput": 2524.261, "synch_weights_time_ms": 0.046}, "counters": {"num_env_steps_sampled": 25000, "num_env_steps_trained": 768000, "num_agent_steps_sampled": 25000, "num_agent_steps_trained": 768000, "last_target_update_ts": 24501, "num_target_updates": 48}, "done": false, "training_iteration": 25, "trial_id": "5ce16_00000", "date": "2024-09-27_11-04-17", "timestamp": 1727406257, "time_this_iter_s": 32.36485052108765, "time_total_s": 764.6000411510468, "pid": 39427, "hostname": "gpu2gate1", "node_ip": "10.64.32.126", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.9828407522030984, "lr": 0.0007583973879008875, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f52e4d75580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 764.6000411510468, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 16.041304347826088, "ram_util_percent": 9.608695652173912}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.2917298376560211, "mean_q": 29.49505043029785, "min_q": 2.196216344833374, "max_q": 36.0160026550293, "cur_lr": 0.0007583973879008875}, "td_error": [-0.07135009765625, 0.038997650146484375, -0.43607521057128906, 1.0691680908203125, -0.19059371948242188, -0.07796478271484375, 0.015106201171875, -0.1676025390625, 0.2663917541503906, 0.14502716064453125, -0.09298324584960938, -0.19568538665771484, 14.443337440490723, -0.1883544921875, -0.8538820743560791, -0.11707305908203125, 0.024444580078125, -0.07581329345703125, 1.196216344833374, 0.04833221435546875, -0.3888397216796875, -0.5256431102752686, -0.07739639282226562, -0.1336212158203125, -0.28803253173828125, -0.008411407470703125, 0.08282852172851562, -0.04302978515625, -0.11547088623046875, 18.353729248046875, -0.3005809783935547, -0.5975990295410156], "mean_td_error": 0.9605492949485779, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 25000.0, "diff_num_grad_updates_vs_sampler_policy": 13124.71875}}, "num_env_steps_sampled": 26000, "num_env_steps_trained": 800000, "num_agent_steps_sampled": 26000, "num_agent_steps_trained": 800000, "last_target_update_ts": 25501, "num_target_updates": 50}, "env_runners": {"episode_reward_max": 250.0, "episode_reward_min": 11.0, "episode_reward_mean": 91.45, "episode_len_mean": 91.45, "episode_media": {}, "episodes_timesteps_total": 9145, "policy_reward_min": {"default_policy": 11.0}, "policy_reward_max": {"default_policy": 250.0}, "policy_reward_mean": {"default_policy": 91.45}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.0, 87.0, 94.0, 88.0, 87.0, 90.0, 58.0, 88.0, 59.0, 11.0, 103.0, 95.0, 102.0, 95.0, 93.0, 14.0, 88.0, 87.0, 91.0, 89.0, 93.0, 96.0, 98.0, 100.0, 95.0, 105.0, 95.0, 93.0, 96.0, 93.0, 93.0, 35.0, 47.0, 95.0, 94.0, 94.0, 12.0, 98.0, 94.0, 92.0, 104.0, 103.0, 103.0, 105.0, 96.0, 98.0, 99.0, 33.0, 94.0, 98.0, 104.0, 91.0, 97.0, 50.0, 95.0, 90.0, 97.0, 17.0, 99.0, 98.0, 92.0, 102.0, 99.0, 97.0, 99.0, 96.0, 107.0, 97.0, 96.0, 93.0, 97.0, 103.0, 112.0, 108.0, 116.0, 109.0, 106.0, 92.0, 92.0, 96.0, 91.0, 29.0, 30.0, 93.0, 96.0, 96.0, 32.0, 98.0, 97.0, 114.0, 238.0, 250.0, 120.0, 135.0, 133.0, 104.0, 87.0, 106.0, 107.0, 29.0], "episode_lengths": [43, 87, 94, 88, 87, 90, 58, 88, 59, 11, 103, 95, 102, 95, 93, 14, 88, 87, 91, 89, 93, 96, 98, 100, 95, 105, 95, 93, 96, 93, 93, 35, 47, 95, 94, 94, 12, 98, 94, 92, 104, 103, 103, 105, 96, 98, 99, 33, 94, 98, 104, 91, 97, 50, 95, 90, 97, 17, 99, 98, 92, 102, 99, 97, 99, 96, 107, 97, 96, 93, 97, 103, 112, 108, 116, 109, 106, 92, 92, 96, 91, 29, 30, 93, 96, 96, 32, 98, 97, 114, 238, 250, 120, 135, 133, 104, 87, 106, 107, 29], "policy_default_policy_reward": [43.0, 87.0, 94.0, 88.0, 87.0, 90.0, 58.0, 88.0, 59.0, 11.0, 103.0, 95.0, 102.0, 95.0, 93.0, 14.0, 88.0, 87.0, 91.0, 89.0, 93.0, 96.0, 98.0, 100.0, 95.0, 105.0, 95.0, 93.0, 96.0, 93.0, 93.0, 35.0, 47.0, 95.0, 94.0, 94.0, 12.0, 98.0, 94.0, 92.0, 104.0, 103.0, 103.0, 105.0, 96.0, 98.0, 99.0, 33.0, 94.0, 98.0, 104.0, 91.0, 97.0, 50.0, 95.0, 90.0, 97.0, 17.0, 99.0, 98.0, 92.0, 102.0, 99.0, 97.0, 99.0, 96.0, 107.0, 97.0, 96.0, 93.0, 97.0, 103.0, 112.0, 108.0, 116.0, 109.0, 106.0, 92.0, 92.0, 96.0, 91.0, 29.0, 30.0, 93.0, 96.0, 96.0, 32.0, 98.0, 97.0, 114.0, 238.0, 250.0, 120.0, 135.0, 133.0, 104.0, 87.0, 106.0, 107.0, 29.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0111043448748984, "mean_inference_ms": 2.0211954440417856, "mean_action_processing_ms": 0.23358069476290105, "mean_env_wait_ms": 0.10071255476514025, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018039703369140625, "StateBufferConnector_ms": 0.01644277572631836, "ViewRequirementAgentConnector_ms": 0.21033549308776855}, "num_episodes": 9, "episode_return_max": 250.0, "episode_return_min": 11.0, "episode_return_mean": 91.45, "episodes_this_iter": 9}, "num_healthy_workers": 0, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 26000, "num_agent_steps_trained": 800000, "num_env_steps_sampled": 26000, "num_env_steps_trained": 800000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 30.74322547106089, "num_env_steps_trained_throughput_per_sec": 983.7832150739484, "timesteps_total": 26000, "num_env_steps_sampled_lifetime": 26000, "num_agent_steps_sampled_lifetime": 26000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 26000, "timers": {"training_iteration_time_ms": 32776.739, "restore_workers_time_ms": 0.022, "training_step_time_ms": 32.631, "sample_time_ms": 4.106, "load_time_ms": 0.225, "load_throughput": 142194.86, "learn_time_ms": 12.918, "learn_throughput": 2477.197, "synch_weights_time_ms": 0.05}, "counters": {"num_env_steps_sampled": 26000, "num_env_steps_trained": 800000, "num_agent_steps_sampled": 26000, "num_agent_steps_trained": 800000, "last_target_update_ts": 25501, "num_target_updates": 50}, "done": false, "training_iteration": 26, "trial_id": "5ce16_00000", "date": "2024-09-27_11-04-50", "timestamp": 1727406290, "time_this_iter_s": 32.53007245063782, "time_total_s": 797.1301136016846, "pid": 39427, "hostname": "gpu2gate1", "node_ip": "10.64.32.126", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.9828407522030984, "lr": 0.0007583973879008875, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f52e4d75580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 797.1301136016846, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 11.71086956521739, "ram_util_percent": 9.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.15279310941696167, "mean_q": 31.559341430664062, "min_q": 2.258967638015747, "max_q": 38.048824310302734, "cur_lr": 0.0007583973879008875}, "td_error": [-0.01941680908203125, 0.05185413360595703, 0.024322509765625, 0.34491729736328125, 1.258967638015747, -4.060672760009766, 0.3901634216308594, -0.34790802001953125, 0.5183525085449219, -0.16012191772460938, -0.03281402587890625, 0.14075469970703125, 1.5943713188171387, 0.042694091796875, 0.7810859680175781, 0.013957977294921875, -0.3335113525390625, -0.059429168701171875, -0.3925437927246094, -0.20190048217773438, -0.08251571655273438, -2.5776901245117188, -0.98101806640625, 0.02297210693359375, -0.22702789306640625, 27.765565872192383, -0.06364822387695312, -0.1191864013671875, 29.803560256958008, 0.12474632263183594, 0.4951210021972656, -0.01633453369140625], "mean_td_error": 1.6780521869659424, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 26000.0, "diff_num_grad_updates_vs_sampler_policy": 13972.09375}}, "num_env_steps_sampled": 27000, "num_env_steps_trained": 832000, "num_agent_steps_sampled": 27000, "num_agent_steps_trained": 832000, "last_target_update_ts": 26501, "num_target_updates": 52}, "env_runners": {"episode_reward_max": 250.0, "episode_reward_min": 11.0, "episode_reward_mean": 94.28, "episode_len_mean": 94.28, "episode_media": {}, "episodes_timesteps_total": 9428, "policy_reward_min": {"default_policy": 11.0}, "policy_reward_max": {"default_policy": 250.0}, "policy_reward_mean": {"default_policy": 94.28}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11.0, 103.0, 95.0, 102.0, 95.0, 93.0, 14.0, 88.0, 87.0, 91.0, 89.0, 93.0, 96.0, 98.0, 100.0, 95.0, 105.0, 95.0, 93.0, 96.0, 93.0, 93.0, 35.0, 47.0, 95.0, 94.0, 94.0, 12.0, 98.0, 94.0, 92.0, 104.0, 103.0, 103.0, 105.0, 96.0, 98.0, 99.0, 33.0, 94.0, 98.0, 104.0, 91.0, 97.0, 50.0, 95.0, 90.0, 97.0, 17.0, 99.0, 98.0, 92.0, 102.0, 99.0, 97.0, 99.0, 96.0, 107.0, 97.0, 96.0, 93.0, 97.0, 103.0, 112.0, 108.0, 116.0, 109.0, 106.0, 92.0, 92.0, 96.0, 91.0, 29.0, 30.0, 93.0, 96.0, 96.0, 32.0, 98.0, 97.0, 114.0, 238.0, 250.0, 120.0, 135.0, 133.0, 104.0, 87.0, 106.0, 107.0, 29.0, 108.0, 108.0, 142.0, 120.0, 121.0, 97.0, 93.0, 90.0, 98.0], "episode_lengths": [11, 103, 95, 102, 95, 93, 14, 88, 87, 91, 89, 93, 96, 98, 100, 95, 105, 95, 93, 96, 93, 93, 35, 47, 95, 94, 94, 12, 98, 94, 92, 104, 103, 103, 105, 96, 98, 99, 33, 94, 98, 104, 91, 97, 50, 95, 90, 97, 17, 99, 98, 92, 102, 99, 97, 99, 96, 107, 97, 96, 93, 97, 103, 112, 108, 116, 109, 106, 92, 92, 96, 91, 29, 30, 93, 96, 96, 32, 98, 97, 114, 238, 250, 120, 135, 133, 104, 87, 106, 107, 29, 108, 108, 142, 120, 121, 97, 93, 90, 98], "policy_default_policy_reward": [11.0, 103.0, 95.0, 102.0, 95.0, 93.0, 14.0, 88.0, 87.0, 91.0, 89.0, 93.0, 96.0, 98.0, 100.0, 95.0, 105.0, 95.0, 93.0, 96.0, 93.0, 93.0, 35.0, 47.0, 95.0, 94.0, 94.0, 12.0, 98.0, 94.0, 92.0, 104.0, 103.0, 103.0, 105.0, 96.0, 98.0, 99.0, 33.0, 94.0, 98.0, 104.0, 91.0, 97.0, 50.0, 95.0, 90.0, 97.0, 17.0, 99.0, 98.0, 92.0, 102.0, 99.0, 97.0, 99.0, 96.0, 107.0, 97.0, 96.0, 93.0, 97.0, 103.0, 112.0, 108.0, 116.0, 109.0, 106.0, 92.0, 92.0, 96.0, 91.0, 29.0, 30.0, 93.0, 96.0, 96.0, 32.0, 98.0, 97.0, 114.0, 238.0, 250.0, 120.0, 135.0, 133.0, 104.0, 87.0, 106.0, 107.0, 29.0, 108.0, 108.0, 142.0, 120.0, 121.0, 97.0, 93.0, 90.0, 98.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.012199917383755, "mean_inference_ms": 2.0223476627779986, "mean_action_processing_ms": 0.23394580647317983, "mean_env_wait_ms": 0.10092722916731856, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017937421798706055, "StateBufferConnector_ms": 0.01634979248046875, "ViewRequirementAgentConnector_ms": 0.20879721641540527}, "num_episodes": 9, "episode_return_max": 250.0, "episode_return_min": 11.0, "episode_return_mean": 94.28, "episodes_this_iter": 9}, "num_healthy_workers": 0, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 27000, "num_agent_steps_trained": 832000, "num_env_steps_sampled": 27000, "num_env_steps_trained": 832000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 31.330724317056706, "num_env_steps_trained_throughput_per_sec": 1002.5831781458146, "timesteps_total": 27000, "num_env_steps_sampled_lifetime": 27000, "num_agent_steps_sampled_lifetime": 27000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 27000, "timers": {"training_iteration_time_ms": 32589.746, "restore_workers_time_ms": 0.026, "training_step_time_ms": 36.918, "sample_time_ms": 4.702, "load_time_ms": 0.276, "load_throughput": 115974.879, "learn_time_ms": 14.976, "learn_throughput": 2136.759, "synch_weights_time_ms": 0.061}, "counters": {"num_env_steps_sampled": 27000, "num_env_steps_trained": 832000, "num_agent_steps_sampled": 27000, "num_agent_steps_trained": 832000, "last_target_update_ts": 26501, "num_target_updates": 52}, "done": false, "training_iteration": 27, "trial_id": "5ce16_00000", "date": "2024-09-27_11-05-22", "timestamp": 1727406322, "time_this_iter_s": 31.91966414451599, "time_total_s": 829.0497777462006, "pid": 39427, "hostname": "gpu2gate1", "node_ip": "10.64.32.126", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.9828407522030984, "lr": 0.0007583973879008875, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f52e4d75580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 829.0497777462006, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 12.895555555555555, "ram_util_percent": 9.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.30578792095184326, "mean_q": 33.007057189941406, "min_q": 2.516176462173462, "max_q": 37.712974548339844, "cur_lr": 0.0007583973879008875}, "td_error": [-0.5152664184570312, -0.7614784240722656, -0.06317138671875, -0.09751129150390625, 0.13228607177734375, 0.016414642333984375, 0.1694183349609375, -0.44957733154296875, -2.296295166015625, 0.23382186889648438, 0.06435012817382812, 0.16131973266601562, -1.1289901733398438, 0.21112442016601562, -0.7330265045166016, 0.051761627197265625, -0.929412841796875, 0.147369384765625, 0.14563751220703125, 0.11719894409179688, -0.4433307647705078, -0.12697982788085938, 0.23360443115234375, 0.0827484130859375, 0.06615447998046875, -0.6698722839355469, 0.13633346557617188, -0.0496063232421875, 0.19701766967773438, 0.2715492248535156, 0.17729568481445312, -0.5282058715820312], "mean_td_error": -0.19304120540618896, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 27000.0, "diff_num_grad_updates_vs_sampler_policy": 11150.375}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 864000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 864000, "last_target_update_ts": 27501, "num_target_updates": 54}, "env_runners": {"episode_reward_max": 250.0, "episode_reward_min": 12.0, "episode_reward_mean": 95.64, "episode_len_mean": 95.64, "episode_media": {}, "episodes_timesteps_total": 9564, "policy_reward_min": {"default_policy": 12.0}, "policy_reward_max": {"default_policy": 250.0}, "policy_reward_mean": {"default_policy": 95.64}, "custom_metrics": {}, "hist_stats": {"episode_reward": [93.0, 96.0, 98.0, 100.0, 95.0, 105.0, 95.0, 93.0, 96.0, 93.0, 93.0, 35.0, 47.0, 95.0, 94.0, 94.0, 12.0, 98.0, 94.0, 92.0, 104.0, 103.0, 103.0, 105.0, 96.0, 98.0, 99.0, 33.0, 94.0, 98.0, 104.0, 91.0, 97.0, 50.0, 95.0, 90.0, 97.0, 17.0, 99.0, 98.0, 92.0, 102.0, 99.0, 97.0, 99.0, 96.0, 107.0, 97.0, 96.0, 93.0, 97.0, 103.0, 112.0, 108.0, 116.0, 109.0, 106.0, 92.0, 92.0, 96.0, 91.0, 29.0, 30.0, 93.0, 96.0, 96.0, 32.0, 98.0, 97.0, 114.0, 238.0, 250.0, 120.0, 135.0, 133.0, 104.0, 87.0, 106.0, 107.0, 29.0, 108.0, 108.0, 142.0, 120.0, 121.0, 97.0, 93.0, 90.0, 98.0, 92.0, 90.0, 91.0, 93.0, 90.0, 94.0, 94.0, 87.0, 95.0, 89.0, 89.0], "episode_lengths": [93, 96, 98, 100, 95, 105, 95, 93, 96, 93, 93, 35, 47, 95, 94, 94, 12, 98, 94, 92, 104, 103, 103, 105, 96, 98, 99, 33, 94, 98, 104, 91, 97, 50, 95, 90, 97, 17, 99, 98, 92, 102, 99, 97, 99, 96, 107, 97, 96, 93, 97, 103, 112, 108, 116, 109, 106, 92, 92, 96, 91, 29, 30, 93, 96, 96, 32, 98, 97, 114, 238, 250, 120, 135, 133, 104, 87, 106, 107, 29, 108, 108, 142, 120, 121, 97, 93, 90, 98, 92, 90, 91, 93, 90, 94, 94, 87, 95, 89, 89], "policy_default_policy_reward": [93.0, 96.0, 98.0, 100.0, 95.0, 105.0, 95.0, 93.0, 96.0, 93.0, 93.0, 35.0, 47.0, 95.0, 94.0, 94.0, 12.0, 98.0, 94.0, 92.0, 104.0, 103.0, 103.0, 105.0, 96.0, 98.0, 99.0, 33.0, 94.0, 98.0, 104.0, 91.0, 97.0, 50.0, 95.0, 90.0, 97.0, 17.0, 99.0, 98.0, 92.0, 102.0, 99.0, 97.0, 99.0, 96.0, 107.0, 97.0, 96.0, 93.0, 97.0, 103.0, 112.0, 108.0, 116.0, 109.0, 106.0, 92.0, 92.0, 96.0, 91.0, 29.0, 30.0, 93.0, 96.0, 96.0, 32.0, 98.0, 97.0, 114.0, 238.0, 250.0, 120.0, 135.0, 133.0, 104.0, 87.0, 106.0, 107.0, 29.0, 108.0, 108.0, 142.0, 120.0, 121.0, 97.0, 93.0, 90.0, 98.0, 92.0, 90.0, 91.0, 93.0, 90.0, 94.0, 94.0, 87.0, 95.0, 89.0, 89.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0132238071329995, "mean_inference_ms": 2.023020510909036, "mean_action_processing_ms": 0.23431813869825915, "mean_env_wait_ms": 0.10116337311362823, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01778721809387207, "StateBufferConnector_ms": 0.016359806060791016, "ViewRequirementAgentConnector_ms": 0.2062058448791504}, "num_episodes": 11, "episode_return_max": 250.0, "episode_return_min": 12.0, "episode_return_mean": 95.64, "episodes_this_iter": 11}, "num_healthy_workers": 0, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 864000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 864000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 31.573000176258518, "num_env_steps_trained_throughput_per_sec": 1010.3360056402726, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 28000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 32377.198, "restore_workers_time_ms": 0.021, "training_step_time_ms": 33.112, "sample_time_ms": 4.061, "load_time_ms": 0.242, "load_throughput": 132482.211, "learn_time_ms": 13.668, "learn_throughput": 2341.29, "synch_weights_time_ms": 0.049}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 864000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 864000, "last_target_update_ts": 27501, "num_target_updates": 54}, "done": false, "training_iteration": 28, "trial_id": "5ce16_00000", "date": "2024-09-27_11-05-54", "timestamp": 1727406354, "time_this_iter_s": 31.674766302108765, "time_total_s": 860.7245440483093, "pid": 39427, "hostname": "gpu2gate1", "node_ip": "10.64.32.126", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.9828407522030984, "lr": 0.0007583973879008875, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f52e4d75580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 860.7245440483093, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 12.373333333333333, "ram_util_percent": 9.600000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5011994242668152, "mean_q": 25.04555892944336, "min_q": -1.6245040893554688, "max_q": 38.52973937988281, "cur_lr": 0.0007583973879008875}, "td_error": [0.00373077392578125, -0.4429512023925781, 0.3599128723144531, -2.3456497192382812, 0.3720741271972656, 0.7994461059570312, 0.3377799987792969, -5.690361022949219, 0.23070716857910156, 0.3101806640625, -0.4056892395019531, 0.07061004638671875, -1.5865085124969482, 0.5376739501953125, -0.15197277069091797, -0.194244384765625, 0.4413566589355469, -0.6345839500427246, 0.5970726013183594, 3.4012279510498047, 17.86008071899414, -4.354743957519531, -0.39829254150390625, -0.4047393798828125, 0.9260101318359375, -2.6245040893554688, 0.3576207160949707, 0.3284187316894531, -0.3125572204589844, 4.455687046051025, 21.179658889770508, -0.22843551635742188], "mean_td_error": 1.0248130559921265, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 28000.0, "diff_num_grad_updates_vs_sampler_policy": 13935.59375}}, "num_env_steps_sampled": 29000, "num_env_steps_trained": 896000, "num_agent_steps_sampled": 29000, "num_agent_steps_trained": 896000, "last_target_update_ts": 28501, "num_target_updates": 56}, "env_runners": {"episode_reward_max": 250.0, "episode_reward_min": 12.0, "episode_reward_mean": 95.45, "episode_len_mean": 95.45, "episode_media": {}, "episodes_timesteps_total": 9545, "policy_reward_min": {"default_policy": 12.0}, "policy_reward_max": {"default_policy": 250.0}, "policy_reward_mean": {"default_policy": 95.45}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.0, 47.0, 95.0, 94.0, 94.0, 12.0, 98.0, 94.0, 92.0, 104.0, 103.0, 103.0, 105.0, 96.0, 98.0, 99.0, 33.0, 94.0, 98.0, 104.0, 91.0, 97.0, 50.0, 95.0, 90.0, 97.0, 17.0, 99.0, 98.0, 92.0, 102.0, 99.0, 97.0, 99.0, 96.0, 107.0, 97.0, 96.0, 93.0, 97.0, 103.0, 112.0, 108.0, 116.0, 109.0, 106.0, 92.0, 92.0, 96.0, 91.0, 29.0, 30.0, 93.0, 96.0, 96.0, 32.0, 98.0, 97.0, 114.0, 238.0, 250.0, 120.0, 135.0, 133.0, 104.0, 87.0, 106.0, 107.0, 29.0, 108.0, 108.0, 142.0, 120.0, 121.0, 97.0, 93.0, 90.0, 98.0, 92.0, 90.0, 91.0, 93.0, 90.0, 94.0, 94.0, 87.0, 95.0, 89.0, 89.0, 91.0, 94.0, 76.0, 100.0, 43.0, 99.0, 98.0, 105.0, 113.0, 114.0, 105.0], "episode_lengths": [35, 47, 95, 94, 94, 12, 98, 94, 92, 104, 103, 103, 105, 96, 98, 99, 33, 94, 98, 104, 91, 97, 50, 95, 90, 97, 17, 99, 98, 92, 102, 99, 97, 99, 96, 107, 97, 96, 93, 97, 103, 112, 108, 116, 109, 106, 92, 92, 96, 91, 29, 30, 93, 96, 96, 32, 98, 97, 114, 238, 250, 120, 135, 133, 104, 87, 106, 107, 29, 108, 108, 142, 120, 121, 97, 93, 90, 98, 92, 90, 91, 93, 90, 94, 94, 87, 95, 89, 89, 91, 94, 76, 100, 43, 99, 98, 105, 113, 114, 105], "policy_default_policy_reward": [35.0, 47.0, 95.0, 94.0, 94.0, 12.0, 98.0, 94.0, 92.0, 104.0, 103.0, 103.0, 105.0, 96.0, 98.0, 99.0, 33.0, 94.0, 98.0, 104.0, 91.0, 97.0, 50.0, 95.0, 90.0, 97.0, 17.0, 99.0, 98.0, 92.0, 102.0, 99.0, 97.0, 99.0, 96.0, 107.0, 97.0, 96.0, 93.0, 97.0, 103.0, 112.0, 108.0, 116.0, 109.0, 106.0, 92.0, 92.0, 96.0, 91.0, 29.0, 30.0, 93.0, 96.0, 96.0, 32.0, 98.0, 97.0, 114.0, 238.0, 250.0, 120.0, 135.0, 133.0, 104.0, 87.0, 106.0, 107.0, 29.0, 108.0, 108.0, 142.0, 120.0, 121.0, 97.0, 93.0, 90.0, 98.0, 92.0, 90.0, 91.0, 93.0, 90.0, 94.0, 94.0, 87.0, 95.0, 89.0, 89.0, 91.0, 94.0, 76.0, 100.0, 43.0, 99.0, 98.0, 105.0, 113.0, 114.0, 105.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.013883035614348, "mean_inference_ms": 2.0228427819611343, "mean_action_processing_ms": 0.23459531910638406, "mean_env_wait_ms": 0.10135256429841466, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017966747283935547, "StateBufferConnector_ms": 0.016391515731811523, "ViewRequirementAgentConnector_ms": 0.20627593994140625}, "num_episodes": 11, "episode_return_max": 250.0, "episode_return_min": 12.0, "episode_return_mean": 95.45, "episodes_this_iter": 11}, "num_healthy_workers": 0, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 29000, "num_agent_steps_trained": 896000, "num_env_steps_sampled": 29000, "num_env_steps_trained": 896000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 31.826183660040257, "num_env_steps_trained_throughput_per_sec": 1018.4378771212882, "timesteps_total": 29000, "num_env_steps_sampled_lifetime": 29000, "num_agent_steps_sampled_lifetime": 29000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 29000, "timers": {"training_iteration_time_ms": 32063.819, "restore_workers_time_ms": 0.023, "training_step_time_ms": 30.861, "sample_time_ms": 3.644, "load_time_ms": 0.238, "load_throughput": 134405.896, "learn_time_ms": 12.44, "learn_throughput": 2572.433, "synch_weights_time_ms": 0.047}, "counters": {"num_env_steps_sampled": 29000, "num_env_steps_trained": 896000, "num_agent_steps_sampled": 29000, "num_agent_steps_trained": 896000, "last_target_update_ts": 28501, "num_target_updates": 56}, "done": false, "training_iteration": 29, "trial_id": "5ce16_00000", "date": "2024-09-27_11-06-25", "timestamp": 1727406385, "time_this_iter_s": 31.42241859436035, "time_total_s": 892.1469626426697, "pid": 39427, "hostname": "gpu2gate1", "node_ip": "10.64.32.126", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.9828407522030984, "lr": 0.0007583973879008875, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f52e4d75580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 892.1469626426697, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 11.963636363636361, "ram_util_percent": 9.600000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.611035168170929, "mean_q": 27.181917190551758, "min_q": 0.16957470774650574, "max_q": 38.77164077758789, "cur_lr": 0.0007583973879008875}, "td_error": [-0.058071136474609375, 0.7499198913574219, 1.4202804565429688, -0.29805755615234375, 1.2302131652832031, -0.35174560546875, -0.7559034824371338, 0.6109466552734375, 12.477672576904297, -0.48882293701171875, -0.9827194213867188, -0.15272140502929688, -0.6709709167480469, -0.8304252624511719, 7.33662223815918, -0.20825958251953125, -1.4029486179351807, -0.07598876953125, -0.229644775390625, 0.07008218765258789, 0.42672157287597656, -0.11428070068359375, -1.5827560424804688, 0.3387889862060547, -0.08623886108398438, 0.05403900146484375, 1.3799304962158203, -0.0981292724609375, -0.9296469688415527, -0.6404533386230469, 0.9946784973144531, -0.3864784240722656], "mean_td_error": 0.5233010053634644, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 29000.0, "diff_num_grad_updates_vs_sampler_policy": 17037.78125}}, "num_env_steps_sampled": 30000, "num_env_steps_trained": 928000, "num_agent_steps_sampled": 30000, "num_agent_steps_trained": 928000, "last_target_update_ts": 29501, "num_target_updates": 58}, "env_runners": {"episode_reward_max": 250.0, "episode_reward_min": 12.0, "episode_reward_mean": 99.71, "episode_len_mean": 99.71, "episode_media": {}, "episodes_timesteps_total": 9971, "policy_reward_min": {"default_policy": 12.0}, "policy_reward_max": {"default_policy": 250.0}, "policy_reward_mean": {"default_policy": 99.71}, "custom_metrics": {}, "hist_stats": {"episode_reward": [94.0, 12.0, 98.0, 94.0, 92.0, 104.0, 103.0, 103.0, 105.0, 96.0, 98.0, 99.0, 33.0, 94.0, 98.0, 104.0, 91.0, 97.0, 50.0, 95.0, 90.0, 97.0, 17.0, 99.0, 98.0, 92.0, 102.0, 99.0, 97.0, 99.0, 96.0, 107.0, 97.0, 96.0, 93.0, 97.0, 103.0, 112.0, 108.0, 116.0, 109.0, 106.0, 92.0, 92.0, 96.0, 91.0, 29.0, 30.0, 93.0, 96.0, 96.0, 32.0, 98.0, 97.0, 114.0, 238.0, 250.0, 120.0, 135.0, 133.0, 104.0, 87.0, 106.0, 107.0, 29.0, 108.0, 108.0, 142.0, 120.0, 121.0, 97.0, 93.0, 90.0, 98.0, 92.0, 90.0, 91.0, 93.0, 90.0, 94.0, 94.0, 87.0, 95.0, 89.0, 89.0, 91.0, 94.0, 76.0, 100.0, 43.0, 99.0, 98.0, 105.0, 113.0, 114.0, 105.0, 182.0, 235.0, 132.0, 148.0], "episode_lengths": [94, 12, 98, 94, 92, 104, 103, 103, 105, 96, 98, 99, 33, 94, 98, 104, 91, 97, 50, 95, 90, 97, 17, 99, 98, 92, 102, 99, 97, 99, 96, 107, 97, 96, 93, 97, 103, 112, 108, 116, 109, 106, 92, 92, 96, 91, 29, 30, 93, 96, 96, 32, 98, 97, 114, 238, 250, 120, 135, 133, 104, 87, 106, 107, 29, 108, 108, 142, 120, 121, 97, 93, 90, 98, 92, 90, 91, 93, 90, 94, 94, 87, 95, 89, 89, 91, 94, 76, 100, 43, 99, 98, 105, 113, 114, 105, 182, 235, 132, 148], "policy_default_policy_reward": [94.0, 12.0, 98.0, 94.0, 92.0, 104.0, 103.0, 103.0, 105.0, 96.0, 98.0, 99.0, 33.0, 94.0, 98.0, 104.0, 91.0, 97.0, 50.0, 95.0, 90.0, 97.0, 17.0, 99.0, 98.0, 92.0, 102.0, 99.0, 97.0, 99.0, 96.0, 107.0, 97.0, 96.0, 93.0, 97.0, 103.0, 112.0, 108.0, 116.0, 109.0, 106.0, 92.0, 92.0, 96.0, 91.0, 29.0, 30.0, 93.0, 96.0, 96.0, 32.0, 98.0, 97.0, 114.0, 238.0, 250.0, 120.0, 135.0, 133.0, 104.0, 87.0, 106.0, 107.0, 29.0, 108.0, 108.0, 142.0, 120.0, 121.0, 97.0, 93.0, 90.0, 98.0, 92.0, 90.0, 91.0, 93.0, 90.0, 94.0, 94.0, 87.0, 95.0, 89.0, 89.0, 91.0, 94.0, 76.0, 100.0, 43.0, 99.0, 98.0, 105.0, 113.0, 114.0, 105.0, 182.0, 235.0, 132.0, 148.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.014132765075275, "mean_inference_ms": 2.022820841290495, "mean_action_processing_ms": 0.23469464498425613, "mean_env_wait_ms": 0.101421088739075, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01783275604248047, "StateBufferConnector_ms": 0.016388893127441406, "ViewRequirementAgentConnector_ms": 0.20601105690002441}, "num_episodes": 4, "episode_return_max": 250.0, "episode_return_min": 12.0, "episode_return_mean": 99.71, "episodes_this_iter": 4}, "num_healthy_workers": 0, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 30000, "num_agent_steps_trained": 928000, "num_env_steps_sampled": 30000, "num_env_steps_trained": 928000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 31.68362879461761, "num_env_steps_trained_throughput_per_sec": 1013.8761214277636, "timesteps_total": 30000, "num_env_steps_sampled_lifetime": 30000, "num_agent_steps_sampled_lifetime": 30000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 30000, "timers": {"training_iteration_time_ms": 32108.3, "restore_workers_time_ms": 0.021, "training_step_time_ms": 31.82, "sample_time_ms": 3.868, "load_time_ms": 0.224, "load_throughput": 142800.009, "learn_time_ms": 12.853, "learn_throughput": 2489.774, "synch_weights_time_ms": 0.047}, "counters": {"num_env_steps_sampled": 30000, "num_env_steps_trained": 928000, "num_agent_steps_sampled": 30000, "num_agent_steps_trained": 928000, "last_target_update_ts": 29501, "num_target_updates": 58}, "done": false, "training_iteration": 30, "trial_id": "5ce16_00000", "date": "2024-09-27_11-06-57", "timestamp": 1727406417, "time_this_iter_s": 31.564040184020996, "time_total_s": 923.7110028266907, "pid": 39427, "hostname": "gpu2gate1", "node_ip": "10.64.32.126", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.9828407522030984, "lr": 0.0007583973879008875, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f52e4d75580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 923.7110028266907, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 12.106666666666666, "ram_util_percent": 9.600000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.40023860335350037, "mean_q": 33.841514587402344, "min_q": 12.694093704223633, "max_q": 39.51067352294922, "cur_lr": 0.0007583973879008875}, "td_error": [2.139158248901367, 0.5501785278320312, 0.3868675231933594, 0.00371551513671875, 3.5511245727539062, 0.16780471801757812, 0.5353317260742188, 22.14688491821289, 0.1222381591796875, 0.3261833190917969, -0.24514007568359375, 0.6797962188720703, 0.22846603393554688, 0.2789154052734375, -2.744626998901367, -0.23033905029296875, 0.5186767578125, -0.13928985595703125, 0.059574127197265625, -0.07904434204101562, 0.5523033142089844, 0.5123977661132812, -0.058834075927734375, -0.14573287963867188, 0.18833160400390625, 0.2883033752441406, 0.313507080078125, 0.3172721862792969, -3.549619674682617, 1.067300796508789, 0.14094924926757812, -1.2312545776367188], "mean_td_error": 0.8328562378883362, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 30000.0, "diff_num_grad_updates_vs_sampler_policy": 14014.46875}}, "num_env_steps_sampled": 31000, "num_env_steps_trained": 960000, "num_agent_steps_sampled": 31000, "num_agent_steps_trained": 960000, "last_target_update_ts": 30501, "num_target_updates": 60}, "env_runners": {"episode_reward_max": 500.0, "episode_reward_min": 13.0, "episode_reward_mean": 106.15, "episode_len_mean": 106.15, "episode_media": {}, "episodes_timesteps_total": 10615, "policy_reward_min": {"default_policy": 13.0}, "policy_reward_max": {"default_policy": 500.0}, "policy_reward_mean": {"default_policy": 106.15}, "custom_metrics": {}, "hist_stats": {"episode_reward": [105.0, 96.0, 98.0, 99.0, 33.0, 94.0, 98.0, 104.0, 91.0, 97.0, 50.0, 95.0, 90.0, 97.0, 17.0, 99.0, 98.0, 92.0, 102.0, 99.0, 97.0, 99.0, 96.0, 107.0, 97.0, 96.0, 93.0, 97.0, 103.0, 112.0, 108.0, 116.0, 109.0, 106.0, 92.0, 92.0, 96.0, 91.0, 29.0, 30.0, 93.0, 96.0, 96.0, 32.0, 98.0, 97.0, 114.0, 238.0, 250.0, 120.0, 135.0, 133.0, 104.0, 87.0, 106.0, 107.0, 29.0, 108.0, 108.0, 142.0, 120.0, 121.0, 97.0, 93.0, 90.0, 98.0, 92.0, 90.0, 91.0, 93.0, 90.0, 94.0, 94.0, 87.0, 95.0, 89.0, 89.0, 91.0, 94.0, 76.0, 100.0, 43.0, 99.0, 98.0, 105.0, 113.0, 114.0, 105.0, 182.0, 235.0, 132.0, 148.0, 500.0, 13.0, 266.0, 113.0, 119.0, 112.0, 111.0, 110.0], "episode_lengths": [105, 96, 98, 99, 33, 94, 98, 104, 91, 97, 50, 95, 90, 97, 17, 99, 98, 92, 102, 99, 97, 99, 96, 107, 97, 96, 93, 97, 103, 112, 108, 116, 109, 106, 92, 92, 96, 91, 29, 30, 93, 96, 96, 32, 98, 97, 114, 238, 250, 120, 135, 133, 104, 87, 106, 107, 29, 108, 108, 142, 120, 121, 97, 93, 90, 98, 92, 90, 91, 93, 90, 94, 94, 87, 95, 89, 89, 91, 94, 76, 100, 43, 99, 98, 105, 113, 114, 105, 182, 235, 132, 148, 500, 13, 266, 113, 119, 112, 111, 110], "policy_default_policy_reward": [105.0, 96.0, 98.0, 99.0, 33.0, 94.0, 98.0, 104.0, 91.0, 97.0, 50.0, 95.0, 90.0, 97.0, 17.0, 99.0, 98.0, 92.0, 102.0, 99.0, 97.0, 99.0, 96.0, 107.0, 97.0, 96.0, 93.0, 97.0, 103.0, 112.0, 108.0, 116.0, 109.0, 106.0, 92.0, 92.0, 96.0, 91.0, 29.0, 30.0, 93.0, 96.0, 96.0, 32.0, 98.0, 97.0, 114.0, 238.0, 250.0, 120.0, 135.0, 133.0, 104.0, 87.0, 106.0, 107.0, 29.0, 108.0, 108.0, 142.0, 120.0, 121.0, 97.0, 93.0, 90.0, 98.0, 92.0, 90.0, 91.0, 93.0, 90.0, 94.0, 94.0, 87.0, 95.0, 89.0, 89.0, 91.0, 94.0, 76.0, 100.0, 43.0, 99.0, 98.0, 105.0, 113.0, 114.0, 105.0, 182.0, 235.0, 132.0, 148.0, 500.0, 13.0, 266.0, 113.0, 119.0, 112.0, 111.0, 110.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.014529778471936, "mean_inference_ms": 2.022676117208795, "mean_action_processing_ms": 0.23487675047488082, "mean_env_wait_ms": 0.1015421954163031, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017686128616333008, "StateBufferConnector_ms": 0.016284465789794922, "ViewRequirementAgentConnector_ms": 0.20391321182250977}, "num_episodes": 8, "episode_return_max": 500.0, "episode_return_min": 13.0, "episode_return_mean": 106.15, "episodes_this_iter": 8}, "num_healthy_workers": 0, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 31000, "num_agent_steps_trained": 960000, "num_env_steps_sampled": 31000, "num_env_steps_trained": 960000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 31.396507585565807, "num_env_steps_trained_throughput_per_sec": 1004.6882427381058, "timesteps_total": 31000, "num_env_steps_sampled_lifetime": 31000, "num_agent_steps_sampled_lifetime": 31000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 31000, "timers": {"training_iteration_time_ms": 32000.519, "restore_workers_time_ms": 0.02, "training_step_time_ms": 33.828, "sample_time_ms": 4.104, "load_time_ms": 0.258, "load_throughput": 124206.67, "learn_time_ms": 14.27, "learn_throughput": 2242.479, "synch_weights_time_ms": 0.051}, "counters": {"num_env_steps_sampled": 31000, "num_env_steps_trained": 960000, "num_agent_steps_sampled": 31000, "num_agent_steps_trained": 960000, "last_target_update_ts": 30501, "num_target_updates": 60}, "done": false, "training_iteration": 31, "trial_id": "5ce16_00000", "date": "2024-09-27_11-07-29", "timestamp": 1727406449, "time_this_iter_s": 31.85236930847168, "time_total_s": 955.5633721351624, "pid": 39427, "hostname": "gpu2gate1", "node_ip": "10.64.32.126", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.9828407522030984, "lr": 0.0007583973879008875, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f52e4d75580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 955.5633721351624, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 12.175555555555555, "ram_util_percent": 9.655555555555559}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3595726191997528, "mean_q": 30.732641220092773, "min_q": 0.6904175281524658, "max_q": 40.49738693237305, "cur_lr": 0.0007583973879008875}, "td_error": [-0.6977777481079102, -0.200469970703125, 0.3527984619140625, 0.4816131591796875, 0.19775390625, 0.1381378173828125, -0.27634239196777344, -0.7426719665527344, 0.28585052490234375, -1.5653343200683594, -0.1301116943359375, -0.13210296630859375, 0.23511505126953125, 0.26291656494140625, 0.5816726684570312, -0.12445831298828125, 0.20129776000976562, 0.3394622802734375, 0.019153594970703125, -1.6346111297607422, 0.0826416015625, -0.3095824718475342, 0.12611007690429688, 2.443561553955078, 0.5625762939453125, 0.285308837890625, 0.6705949306488037, 1.0082931518554688, -0.9379386901855469, -0.5827484130859375, -0.61004638671875, 0.6380958557128906], "mean_td_error": 0.0302736759185791, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 31000.0, "diff_num_grad_updates_vs_sampler_policy": 14525.75}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 992000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 992000, "last_target_update_ts": 31501, "num_target_updates": 62}, "env_runners": {"episode_reward_max": 500.0, "episode_reward_min": 13.0, "episode_reward_mean": 108.79, "episode_len_mean": 108.79, "episode_media": {}, "episodes_timesteps_total": 10879, "policy_reward_min": {"default_policy": 13.0}, "policy_reward_max": {"default_policy": 500.0}, "policy_reward_mean": {"default_policy": 108.79}, "custom_metrics": {}, "hist_stats": {"episode_reward": [104.0, 91.0, 97.0, 50.0, 95.0, 90.0, 97.0, 17.0, 99.0, 98.0, 92.0, 102.0, 99.0, 97.0, 99.0, 96.0, 107.0, 97.0, 96.0, 93.0, 97.0, 103.0, 112.0, 108.0, 116.0, 109.0, 106.0, 92.0, 92.0, 96.0, 91.0, 29.0, 30.0, 93.0, 96.0, 96.0, 32.0, 98.0, 97.0, 114.0, 238.0, 250.0, 120.0, 135.0, 133.0, 104.0, 87.0, 106.0, 107.0, 29.0, 108.0, 108.0, 142.0, 120.0, 121.0, 97.0, 93.0, 90.0, 98.0, 92.0, 90.0, 91.0, 93.0, 90.0, 94.0, 94.0, 87.0, 95.0, 89.0, 89.0, 91.0, 94.0, 76.0, 100.0, 43.0, 99.0, 98.0, 105.0, 113.0, 114.0, 105.0, 182.0, 235.0, 132.0, 148.0, 500.0, 13.0, 266.0, 113.0, 119.0, 112.0, 111.0, 110.0, 122.0, 108.0, 121.0, 93.0, 79.0, 185.0, 179.0], "episode_lengths": [104, 91, 97, 50, 95, 90, 97, 17, 99, 98, 92, 102, 99, 97, 99, 96, 107, 97, 96, 93, 97, 103, 112, 108, 116, 109, 106, 92, 92, 96, 91, 29, 30, 93, 96, 96, 32, 98, 97, 114, 238, 250, 120, 135, 133, 104, 87, 106, 107, 29, 108, 108, 142, 120, 121, 97, 93, 90, 98, 92, 90, 91, 93, 90, 94, 94, 87, 95, 89, 89, 91, 94, 76, 100, 43, 99, 98, 105, 113, 114, 105, 182, 235, 132, 148, 500, 13, 266, 113, 119, 112, 111, 110, 122, 108, 121, 93, 79, 185, 179], "policy_default_policy_reward": [104.0, 91.0, 97.0, 50.0, 95.0, 90.0, 97.0, 17.0, 99.0, 98.0, 92.0, 102.0, 99.0, 97.0, 99.0, 96.0, 107.0, 97.0, 96.0, 93.0, 97.0, 103.0, 112.0, 108.0, 116.0, 109.0, 106.0, 92.0, 92.0, 96.0, 91.0, 29.0, 30.0, 93.0, 96.0, 96.0, 32.0, 98.0, 97.0, 114.0, 238.0, 250.0, 120.0, 135.0, 133.0, 104.0, 87.0, 106.0, 107.0, 29.0, 108.0, 108.0, 142.0, 120.0, 121.0, 97.0, 93.0, 90.0, 98.0, 92.0, 90.0, 91.0, 93.0, 90.0, 94.0, 94.0, 87.0, 95.0, 89.0, 89.0, 91.0, 94.0, 76.0, 100.0, 43.0, 99.0, 98.0, 105.0, 113.0, 114.0, 105.0, 182.0, 235.0, 132.0, 148.0, 500.0, 13.0, 266.0, 113.0, 119.0, 112.0, 111.0, 110.0, 122.0, 108.0, 121.0, 93.0, 79.0, 185.0, 179.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0149273235540377, "mean_inference_ms": 2.022777937826071, "mean_action_processing_ms": 0.23504571175907285, "mean_env_wait_ms": 0.10164710522537242, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017781496047973633, "StateBufferConnector_ms": 0.01621079444885254, "ViewRequirementAgentConnector_ms": 0.20409727096557617}, "num_episodes": 7, "episode_return_max": 500.0, "episode_return_min": 13.0, "episode_return_mean": 108.79, "episodes_this_iter": 7}, "num_healthy_workers": 0, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 992000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 992000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 30.00730604195669, "num_env_steps_trained_throughput_per_sec": 960.233793342614, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 32412.977, "restore_workers_time_ms": 0.017, "training_step_time_ms": 27.757, "sample_time_ms": 3.237, "load_time_ms": 0.201, "load_throughput": 159138.876, "learn_time_ms": 11.431, "learn_throughput": 2799.369, "synch_weights_time_ms": 0.04}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 992000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 992000, "last_target_update_ts": 31501, "num_target_updates": 62}, "done": false, "training_iteration": 32, "trial_id": "5ce16_00000", "date": "2024-09-27_11-08-02", "timestamp": 1727406482, "time_this_iter_s": 33.32684302330017, "time_total_s": 988.8902151584625, "pid": 39427, "hostname": "gpu2gate1", "node_ip": "10.64.32.126", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.9828407522030984, "lr": 0.0007583973879008875, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f52e4d75580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 988.8902151584625, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 12.32978723404255, "ram_util_percent": 9.600000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.472044974565506, "mean_q": 33.003421783447266, "min_q": 1.3665621280670166, "max_q": 41.34715270996094, "cur_lr": 0.0007583973879008875}, "td_error": [-0.5020828247070312, -0.3225593566894531, 0.2545928955078125, -2.6824073791503906, 0.04205322265625, -0.40012168884277344, 0.016056060791015625, 0.7001380920410156, -0.3096752166748047, 1.2397375106811523, 0.3524360656738281, 0.17378997802734375, -0.3254680633544922, 0.4088783264160156, -0.20055007934570312, 0.3746185302734375, 0.38375329971313477, -0.07090377807617188, -0.2795295715332031, 0.026386260986328125, -0.3654747009277344, 0.9585514068603516, 0.18816757202148438, 1.2717633247375488, 0.7658805847167969, 6.266969203948975, 0.7374305725097656, 0.31801605224609375, 0.498321533203125, 0.12047576904296875, -0.13564682006835938, 0.01796722412109375], "mean_td_error": 0.29754889011383057, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 32000.0, "diff_num_grad_updates_vs_sampler_policy": 16274.1875}}, "num_env_steps_sampled": 33000, "num_env_steps_trained": 1024000, "num_agent_steps_sampled": 33000, "num_agent_steps_trained": 1024000, "last_target_update_ts": 32501, "num_target_updates": 64}, "env_runners": {"episode_reward_max": 500.0, "episode_reward_min": 13.0, "episode_reward_mean": 114.81, "episode_len_mean": 114.81, "episode_media": {}, "episodes_timesteps_total": 11481, "policy_reward_min": {"default_policy": 13.0}, "policy_reward_max": {"default_policy": 500.0}, "policy_reward_mean": {"default_policy": 114.81}, "custom_metrics": {}, "hist_stats": {"episode_reward": [50.0, 95.0, 90.0, 97.0, 17.0, 99.0, 98.0, 92.0, 102.0, 99.0, 97.0, 99.0, 96.0, 107.0, 97.0, 96.0, 93.0, 97.0, 103.0, 112.0, 108.0, 116.0, 109.0, 106.0, 92.0, 92.0, 96.0, 91.0, 29.0, 30.0, 93.0, 96.0, 96.0, 32.0, 98.0, 97.0, 114.0, 238.0, 250.0, 120.0, 135.0, 133.0, 104.0, 87.0, 106.0, 107.0, 29.0, 108.0, 108.0, 142.0, 120.0, 121.0, 97.0, 93.0, 90.0, 98.0, 92.0, 90.0, 91.0, 93.0, 90.0, 94.0, 94.0, 87.0, 95.0, 89.0, 89.0, 91.0, 94.0, 76.0, 100.0, 43.0, 99.0, 98.0, 105.0, 113.0, 114.0, 105.0, 182.0, 235.0, 132.0, 148.0, 500.0, 13.0, 266.0, 113.0, 119.0, 112.0, 111.0, 110.0, 122.0, 108.0, 121.0, 93.0, 79.0, 185.0, 179.0, 225.0, 500.0, 169.0], "episode_lengths": [50, 95, 90, 97, 17, 99, 98, 92, 102, 99, 97, 99, 96, 107, 97, 96, 93, 97, 103, 112, 108, 116, 109, 106, 92, 92, 96, 91, 29, 30, 93, 96, 96, 32, 98, 97, 114, 238, 250, 120, 135, 133, 104, 87, 106, 107, 29, 108, 108, 142, 120, 121, 97, 93, 90, 98, 92, 90, 91, 93, 90, 94, 94, 87, 95, 89, 89, 91, 94, 76, 100, 43, 99, 98, 105, 113, 114, 105, 182, 235, 132, 148, 500, 13, 266, 113, 119, 112, 111, 110, 122, 108, 121, 93, 79, 185, 179, 225, 500, 169], "policy_default_policy_reward": [50.0, 95.0, 90.0, 97.0, 17.0, 99.0, 98.0, 92.0, 102.0, 99.0, 97.0, 99.0, 96.0, 107.0, 97.0, 96.0, 93.0, 97.0, 103.0, 112.0, 108.0, 116.0, 109.0, 106.0, 92.0, 92.0, 96.0, 91.0, 29.0, 30.0, 93.0, 96.0, 96.0, 32.0, 98.0, 97.0, 114.0, 238.0, 250.0, 120.0, 135.0, 133.0, 104.0, 87.0, 106.0, 107.0, 29.0, 108.0, 108.0, 142.0, 120.0, 121.0, 97.0, 93.0, 90.0, 98.0, 92.0, 90.0, 91.0, 93.0, 90.0, 94.0, 94.0, 87.0, 95.0, 89.0, 89.0, 91.0, 94.0, 76.0, 100.0, 43.0, 99.0, 98.0, 105.0, 113.0, 114.0, 105.0, 182.0, 235.0, 132.0, 148.0, 500.0, 13.0, 266.0, 113.0, 119.0, 112.0, 111.0, 110.0, 122.0, 108.0, 121.0, 93.0, 79.0, 185.0, 179.0, 225.0, 500.0, 169.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.015162211317666, "mean_inference_ms": 2.0230431616809286, "mean_action_processing_ms": 0.2351346414759477, "mean_env_wait_ms": 0.10169660057409352, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017789602279663086, "StateBufferConnector_ms": 0.016218900680541992, "ViewRequirementAgentConnector_ms": 0.20406222343444824}, "num_episodes": 3, "episode_return_max": 500.0, "episode_return_min": 13.0, "episode_return_mean": 114.81, "episodes_this_iter": 3}, "num_healthy_workers": 0, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 33000, "num_agent_steps_trained": 1024000, "num_env_steps_sampled": 33000, "num_env_steps_trained": 1024000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 30.579128985366832, "num_env_steps_trained_throughput_per_sec": 978.5321275317386, "timesteps_total": 33000, "num_env_steps_sampled_lifetime": 33000, "num_agent_steps_sampled_lifetime": 33000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 33000, "timers": {"training_iteration_time_ms": 32304.55, "restore_workers_time_ms": 0.02, "training_step_time_ms": 31.255, "sample_time_ms": 3.791, "load_time_ms": 0.22, "load_throughput": 145619.755, "learn_time_ms": 13.106, "learn_throughput": 2441.672, "synch_weights_time_ms": 0.046}, "counters": {"num_env_steps_sampled": 33000, "num_env_steps_trained": 1024000, "num_agent_steps_sampled": 33000, "num_agent_steps_trained": 1024000, "last_target_update_ts": 32501, "num_target_updates": 64}, "done": false, "training_iteration": 33, "trial_id": "5ce16_00000", "date": "2024-09-27_11-08-35", "timestamp": 1727406515, "time_this_iter_s": 32.703521490097046, "time_total_s": 1021.5937366485596, "pid": 39427, "hostname": "gpu2gate1", "node_ip": "10.64.32.126", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.9828407522030984, "lr": 0.0007583973879008875, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f52e4d75580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1021.5937366485596, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 11.954347826086954, "ram_util_percent": 9.602173913043481}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7203676700592041, "mean_q": 32.123382568359375, "min_q": 1.4774055480957031, "max_q": 41.624664306640625, "cur_lr": 0.0007583973879008875}, "td_error": [0.3792304992675781, -0.3148956298828125, 0.19954299926757812, 4.3118181228637695, 1.5213661193847656, 0.150054931640625, -2.0687198638916016, 0.3466606140136719, 0.9209098815917969, 0.22344589233398438, 0.11487960815429688, 0.041034698486328125, -0.5533447265625, 1.2952070236206055, 1.2891273498535156, -0.8991584777832031, -1.1635236740112305, 0.16335487365722656, -0.6979904174804688, 0.19792556762695312, 0.5036125183105469, -0.3365297317504883, -2.707599639892578, 1.09698486328125, 0.2819061279296875, 0.46495819091796875, 0.9759941101074219, 1.0569381713867188, 0.10948467254638672, 0.29378509521484375, -0.9178428649902344, 0.7020263671875], "mean_td_error": 0.21814510226249695, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 33000.0, "diff_num_grad_updates_vs_sampler_policy": 14858.21875}}, "num_env_steps_sampled": 34000, "num_env_steps_trained": 1056000, "num_agent_steps_sampled": 34000, "num_agent_steps_trained": 1056000, "last_target_update_ts": 33501, "num_target_updates": 66}, "env_runners": {"episode_reward_max": 500.0, "episode_reward_min": 13.0, "episode_reward_mean": 121.98, "episode_len_mean": 121.98, "episode_media": {}, "episodes_timesteps_total": 12198, "policy_reward_min": {"default_policy": 13.0}, "policy_reward_max": {"default_policy": 500.0}, "policy_reward_mean": {"default_policy": 121.98}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17.0, 99.0, 98.0, 92.0, 102.0, 99.0, 97.0, 99.0, 96.0, 107.0, 97.0, 96.0, 93.0, 97.0, 103.0, 112.0, 108.0, 116.0, 109.0, 106.0, 92.0, 92.0, 96.0, 91.0, 29.0, 30.0, 93.0, 96.0, 96.0, 32.0, 98.0, 97.0, 114.0, 238.0, 250.0, 120.0, 135.0, 133.0, 104.0, 87.0, 106.0, 107.0, 29.0, 108.0, 108.0, 142.0, 120.0, 121.0, 97.0, 93.0, 90.0, 98.0, 92.0, 90.0, 91.0, 93.0, 90.0, 94.0, 94.0, 87.0, 95.0, 89.0, 89.0, 91.0, 94.0, 76.0, 100.0, 43.0, 99.0, 98.0, 105.0, 113.0, 114.0, 105.0, 182.0, 235.0, 132.0, 148.0, 500.0, 13.0, 266.0, 113.0, 119.0, 112.0, 111.0, 110.0, 122.0, 108.0, 121.0, 93.0, 79.0, 185.0, 179.0, 225.0, 500.0, 169.0, 281.0, 171.0, 304.0, 293.0], "episode_lengths": [17, 99, 98, 92, 102, 99, 97, 99, 96, 107, 97, 96, 93, 97, 103, 112, 108, 116, 109, 106, 92, 92, 96, 91, 29, 30, 93, 96, 96, 32, 98, 97, 114, 238, 250, 120, 135, 133, 104, 87, 106, 107, 29, 108, 108, 142, 120, 121, 97, 93, 90, 98, 92, 90, 91, 93, 90, 94, 94, 87, 95, 89, 89, 91, 94, 76, 100, 43, 99, 98, 105, 113, 114, 105, 182, 235, 132, 148, 500, 13, 266, 113, 119, 112, 111, 110, 122, 108, 121, 93, 79, 185, 179, 225, 500, 169, 281, 171, 304, 293], "policy_default_policy_reward": [17.0, 99.0, 98.0, 92.0, 102.0, 99.0, 97.0, 99.0, 96.0, 107.0, 97.0, 96.0, 93.0, 97.0, 103.0, 112.0, 108.0, 116.0, 109.0, 106.0, 92.0, 92.0, 96.0, 91.0, 29.0, 30.0, 93.0, 96.0, 96.0, 32.0, 98.0, 97.0, 114.0, 238.0, 250.0, 120.0, 135.0, 133.0, 104.0, 87.0, 106.0, 107.0, 29.0, 108.0, 108.0, 142.0, 120.0, 121.0, 97.0, 93.0, 90.0, 98.0, 92.0, 90.0, 91.0, 93.0, 90.0, 94.0, 94.0, 87.0, 95.0, 89.0, 89.0, 91.0, 94.0, 76.0, 100.0, 43.0, 99.0, 98.0, 105.0, 113.0, 114.0, 105.0, 182.0, 235.0, 132.0, 148.0, 500.0, 13.0, 266.0, 113.0, 119.0, 112.0, 111.0, 110.0, 122.0, 108.0, 121.0, 93.0, 79.0, 185.0, 179.0, 225.0, 500.0, 169.0, 281.0, 171.0, 304.0, 293.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0154071039855272, "mean_inference_ms": 2.023337354212191, "mean_action_processing_ms": 0.23523983963201262, "mean_env_wait_ms": 0.10175332383036582, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017722129821777344, "StateBufferConnector_ms": 0.01625823974609375, "ViewRequirementAgentConnector_ms": 0.2038745880126953}, "num_episodes": 4, "episode_return_max": 500.0, "episode_return_min": 13.0, "episode_return_mean": 121.98, "episodes_this_iter": 4}, "num_healthy_workers": 0, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 34000, "num_agent_steps_trained": 1056000, "num_env_steps_sampled": 34000, "num_env_steps_trained": 1056000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 32.22051034680084, "num_env_steps_trained_throughput_per_sec": 1031.056331097627, "timesteps_total": 34000, "num_env_steps_sampled_lifetime": 34000, "num_agent_steps_sampled_lifetime": 34000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 34000, "timers": {"training_iteration_time_ms": 32037.779, "restore_workers_time_ms": 0.019, "training_step_time_ms": 29.035, "sample_time_ms": 3.568, "load_time_ms": 0.197, "load_throughput": 162412.546, "learn_time_ms": 11.834, "learn_throughput": 2704.187, "synch_weights_time_ms": 0.043}, "counters": {"num_env_steps_sampled": 34000, "num_env_steps_trained": 1056000, "num_agent_steps_sampled": 34000, "num_agent_steps_trained": 1056000, "last_target_update_ts": 33501, "num_target_updates": 66}, "done": false, "training_iteration": 34, "trial_id": "5ce16_00000", "date": "2024-09-27_11-09-06", "timestamp": 1727406546, "time_this_iter_s": 31.03757071495056, "time_total_s": 1052.6313073635101, "pid": 39427, "hostname": "gpu2gate1", "node_ip": "10.64.32.126", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.9828407522030984, "lr": 0.0007583973879008875, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f52e4d75580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1052.6313073635101, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 11.786363636363637, "ram_util_percent": 9.695454545454545}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.46852272748947144, "mean_q": 36.47229766845703, "min_q": 6.967438697814941, "max_q": 42.657737731933594, "cur_lr": 0.0007583973879008875}, "td_error": [-1.1133298873901367, 0.24417495727539062, 0.5022506713867188, -0.01735687255859375, -0.014125823974609375, 0.3009834289550781, 0.4582862854003906, 2.7544994354248047, 0.3068389892578125, 0.00400543212890625, 0.09574508666992188, -0.08003616333007812, 0.23372268676757812, 0.3046150207519531, 0.13935470581054688, 0.16536331176757812, 0.1501617431640625, -0.8148374557495117, 32.6334342956543, -0.3257427215576172, 0.17715072631835938, 0.5588302612304688, 0.31110382080078125, 0.3099861145019531, 0.05100250244140625, 0.13408660888671875, 0.19890213012695312, 0.39429473876953125, 0.4154853820800781, -0.17834091186523438, 0.3550872802734375, 0.10545730590820312], "mean_td_error": 1.2112829685211182, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 34000.0, "diff_num_grad_updates_vs_sampler_policy": 14355.09375}}, "num_env_steps_sampled": 35000, "num_env_steps_trained": 1088000, "num_agent_steps_sampled": 35000, "num_agent_steps_trained": 1088000, "last_target_update_ts": 34501, "num_target_updates": 68}, "env_runners": {"episode_reward_max": 500.0, "episode_reward_min": 13.0, "episode_reward_mean": 128.73, "episode_len_mean": 128.73, "episode_media": {}, "episodes_timesteps_total": 12873, "policy_reward_min": {"default_policy": 13.0}, "policy_reward_max": {"default_policy": 500.0}, "policy_reward_mean": {"default_policy": 128.73}, "custom_metrics": {}, "hist_stats": {"episode_reward": [92.0, 102.0, 99.0, 97.0, 99.0, 96.0, 107.0, 97.0, 96.0, 93.0, 97.0, 103.0, 112.0, 108.0, 116.0, 109.0, 106.0, 92.0, 92.0, 96.0, 91.0, 29.0, 30.0, 93.0, 96.0, 96.0, 32.0, 98.0, 97.0, 114.0, 238.0, 250.0, 120.0, 135.0, 133.0, 104.0, 87.0, 106.0, 107.0, 29.0, 108.0, 108.0, 142.0, 120.0, 121.0, 97.0, 93.0, 90.0, 98.0, 92.0, 90.0, 91.0, 93.0, 90.0, 94.0, 94.0, 87.0, 95.0, 89.0, 89.0, 91.0, 94.0, 76.0, 100.0, 43.0, 99.0, 98.0, 105.0, 113.0, 114.0, 105.0, 182.0, 235.0, 132.0, 148.0, 500.0, 13.0, 266.0, 113.0, 119.0, 112.0, 111.0, 110.0, 122.0, 108.0, 121.0, 93.0, 79.0, 185.0, 179.0, 225.0, 500.0, 169.0, 281.0, 171.0, 304.0, 293.0, 213.0, 393.0, 283.0], "episode_lengths": [92, 102, 99, 97, 99, 96, 107, 97, 96, 93, 97, 103, 112, 108, 116, 109, 106, 92, 92, 96, 91, 29, 30, 93, 96, 96, 32, 98, 97, 114, 238, 250, 120, 135, 133, 104, 87, 106, 107, 29, 108, 108, 142, 120, 121, 97, 93, 90, 98, 92, 90, 91, 93, 90, 94, 94, 87, 95, 89, 89, 91, 94, 76, 100, 43, 99, 98, 105, 113, 114, 105, 182, 235, 132, 148, 500, 13, 266, 113, 119, 112, 111, 110, 122, 108, 121, 93, 79, 185, 179, 225, 500, 169, 281, 171, 304, 293, 213, 393, 283], "policy_default_policy_reward": [92.0, 102.0, 99.0, 97.0, 99.0, 96.0, 107.0, 97.0, 96.0, 93.0, 97.0, 103.0, 112.0, 108.0, 116.0, 109.0, 106.0, 92.0, 92.0, 96.0, 91.0, 29.0, 30.0, 93.0, 96.0, 96.0, 32.0, 98.0, 97.0, 114.0, 238.0, 250.0, 120.0, 135.0, 133.0, 104.0, 87.0, 106.0, 107.0, 29.0, 108.0, 108.0, 142.0, 120.0, 121.0, 97.0, 93.0, 90.0, 98.0, 92.0, 90.0, 91.0, 93.0, 90.0, 94.0, 94.0, 87.0, 95.0, 89.0, 89.0, 91.0, 94.0, 76.0, 100.0, 43.0, 99.0, 98.0, 105.0, 113.0, 114.0, 105.0, 182.0, 235.0, 132.0, 148.0, 500.0, 13.0, 266.0, 113.0, 119.0, 112.0, 111.0, 110.0, 122.0, 108.0, 121.0, 93.0, 79.0, 185.0, 179.0, 225.0, 500.0, 169.0, 281.0, 171.0, 304.0, 293.0, 213.0, 393.0, 283.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.015557644273285, "mean_inference_ms": 2.0235836667699387, "mean_action_processing_ms": 0.23531782310900984, "mean_env_wait_ms": 0.10179225232426631, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017871379852294922, "StateBufferConnector_ms": 0.016403913497924805, "ViewRequirementAgentConnector_ms": 0.20445489883422852}, "num_episodes": 3, "episode_return_max": 500.0, "episode_return_min": 13.0, "episode_return_mean": 128.73, "episodes_this_iter": 3}, "num_healthy_workers": 0, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 35000, "num_agent_steps_trained": 1088000, "num_env_steps_sampled": 35000, "num_env_steps_trained": 1088000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 31.407572177741454, "num_env_steps_trained_throughput_per_sec": 1005.0423096877265, "timesteps_total": 35000, "num_env_steps_sampled_lifetime": 35000, "num_agent_steps_sampled_lifetime": 35000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 35000, "timers": {"training_iteration_time_ms": 31985.449, "restore_workers_time_ms": 0.023, "training_step_time_ms": 30.9, "sample_time_ms": 3.729, "load_time_ms": 0.22, "load_throughput": 145730.432, "learn_time_ms": 12.515, "learn_throughput": 2556.957, "synch_weights_time_ms": 0.043}, "counters": {"num_env_steps_sampled": 35000, "num_env_steps_trained": 1088000, "num_agent_steps_sampled": 35000, "num_agent_steps_trained": 1088000, "last_target_update_ts": 34501, "num_target_updates": 68}, "done": false, "training_iteration": 35, "trial_id": "5ce16_00000", "date": "2024-09-27_11-09-38", "timestamp": 1727406578, "time_this_iter_s": 31.841086387634277, "time_total_s": 1084.4723937511444, "pid": 39427, "hostname": "gpu2gate1", "node_ip": "10.64.32.126", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.9828407522030984, "lr": 0.0007583973879008875, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f52e4d75580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1084.4723937511444, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 12.391111111111114, "ram_util_percent": 9.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4401785135269165, "mean_q": 31.634531021118164, "min_q": -1.1131439208984375, "max_q": 42.47484588623047, "cur_lr": 0.0007583973879008875}, "td_error": [-0.3368110656738281, 5.015859603881836, -0.5501213073730469, 0.07707977294921875, -0.074066162109375, 0.5520346760749817, -0.7745628356933594, -0.04814910888671875, -0.08977127075195312, 2.500814437866211, -0.2220001220703125, 0.25008392333984375, -0.18491363525390625, -0.09640884399414062, 1.6119661331176758, -0.215118408203125, 0.03563690185546875, -0.6483154296875, -0.21923065185546875, -0.19272994995117188, -1.6038970947265625, -0.5350141525268555, 0.35687255859375, -2.1131439208984375, -0.6020660400390625, -0.45081329345703125, 0.013629913330078125, 1.1525306701660156, -0.47870635986328125, 0.19916152954101562, -0.5029525756835938, -0.21850967407226562], "mean_td_error": 0.050261497497558594, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 35000.0, "diff_num_grad_updates_vs_sampler_policy": 16576.6875}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 1120000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 1120000, "last_target_update_ts": 35501, "num_target_updates": 70}, "env_runners": {"episode_reward_max": 500.0, "episode_reward_min": 13.0, "episode_reward_mean": 134.86, "episode_len_mean": 134.86, "episode_media": {}, "episodes_timesteps_total": 13486, "policy_reward_min": {"default_policy": 13.0}, "policy_reward_max": {"default_policy": 500.0}, "policy_reward_mean": {"default_policy": 134.86}, "custom_metrics": {}, "hist_stats": {"episode_reward": [99.0, 97.0, 99.0, 96.0, 107.0, 97.0, 96.0, 93.0, 97.0, 103.0, 112.0, 108.0, 116.0, 109.0, 106.0, 92.0, 92.0, 96.0, 91.0, 29.0, 30.0, 93.0, 96.0, 96.0, 32.0, 98.0, 97.0, 114.0, 238.0, 250.0, 120.0, 135.0, 133.0, 104.0, 87.0, 106.0, 107.0, 29.0, 108.0, 108.0, 142.0, 120.0, 121.0, 97.0, 93.0, 90.0, 98.0, 92.0, 90.0, 91.0, 93.0, 90.0, 94.0, 94.0, 87.0, 95.0, 89.0, 89.0, 91.0, 94.0, 76.0, 100.0, 43.0, 99.0, 98.0, 105.0, 113.0, 114.0, 105.0, 182.0, 235.0, 132.0, 148.0, 500.0, 13.0, 266.0, 113.0, 119.0, 112.0, 111.0, 110.0, 122.0, 108.0, 121.0, 93.0, 79.0, 185.0, 179.0, 225.0, 500.0, 169.0, 281.0, 171.0, 304.0, 293.0, 213.0, 393.0, 283.0, 307.0, 500.0], "episode_lengths": [99, 97, 99, 96, 107, 97, 96, 93, 97, 103, 112, 108, 116, 109, 106, 92, 92, 96, 91, 29, 30, 93, 96, 96, 32, 98, 97, 114, 238, 250, 120, 135, 133, 104, 87, 106, 107, 29, 108, 108, 142, 120, 121, 97, 93, 90, 98, 92, 90, 91, 93, 90, 94, 94, 87, 95, 89, 89, 91, 94, 76, 100, 43, 99, 98, 105, 113, 114, 105, 182, 235, 132, 148, 500, 13, 266, 113, 119, 112, 111, 110, 122, 108, 121, 93, 79, 185, 179, 225, 500, 169, 281, 171, 304, 293, 213, 393, 283, 307, 500], "policy_default_policy_reward": [99.0, 97.0, 99.0, 96.0, 107.0, 97.0, 96.0, 93.0, 97.0, 103.0, 112.0, 108.0, 116.0, 109.0, 106.0, 92.0, 92.0, 96.0, 91.0, 29.0, 30.0, 93.0, 96.0, 96.0, 32.0, 98.0, 97.0, 114.0, 238.0, 250.0, 120.0, 135.0, 133.0, 104.0, 87.0, 106.0, 107.0, 29.0, 108.0, 108.0, 142.0, 120.0, 121.0, 97.0, 93.0, 90.0, 98.0, 92.0, 90.0, 91.0, 93.0, 90.0, 94.0, 94.0, 87.0, 95.0, 89.0, 89.0, 91.0, 94.0, 76.0, 100.0, 43.0, 99.0, 98.0, 105.0, 113.0, 114.0, 105.0, 182.0, 235.0, 132.0, 148.0, 500.0, 13.0, 266.0, 113.0, 119.0, 112.0, 111.0, 110.0, 122.0, 108.0, 121.0, 93.0, 79.0, 185.0, 179.0, 225.0, 500.0, 169.0, 281.0, 171.0, 304.0, 293.0, 213.0, 393.0, 283.0, 307.0, 500.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0155764356209713, "mean_inference_ms": 2.023629471563395, "mean_action_processing_ms": 0.23535281873335556, "mean_env_wait_ms": 0.10180752870261822, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01786184310913086, "StateBufferConnector_ms": 0.01629948616027832, "ViewRequirementAgentConnector_ms": 0.20398163795471191}, "num_episodes": 2, "episode_return_max": 500.0, "episode_return_min": 13.0, "episode_return_mean": 134.86, "episodes_this_iter": 2}, "num_healthy_workers": 0, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 1120000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 1120000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 33.29243042709815, "num_env_steps_trained_throughput_per_sec": 1065.3577736671407, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 36000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 31736.387, "restore_workers_time_ms": 0.024, "training_step_time_ms": 29.637, "sample_time_ms": 3.673, "load_time_ms": 0.22, "load_throughput": 145131.626, "learn_time_ms": 11.936, "learn_throughput": 2680.885, "synch_weights_time_ms": 0.042}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 1120000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 1120000, "last_target_update_ts": 35501, "num_target_updates": 70}, "done": false, "training_iteration": 36, "trial_id": "5ce16_00000", "date": "2024-09-27_11-10-08", "timestamp": 1727406608, "time_this_iter_s": 30.038252353668213, "time_total_s": 1114.5106461048126, "pid": 39427, "hostname": "gpu2gate1", "node_ip": "10.64.32.126", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.9828407522030984, "lr": 0.0007583973879008875, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f52e4d75580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1114.5106461048126, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 11.81627906976744, "ram_util_percent": 9.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6156337261199951, "mean_q": 35.86855697631836, "min_q": 4.150186538696289, "max_q": 43.352420806884766, "cur_lr": 0.0007583973879008875}, "td_error": [0.28688621520996094, 0.5079069137573242, 0.23119735717773438, 0.3671455383300781, -0.8626174926757812, 0.16612815856933594, 0.1759185791015625, 0.19289016723632812, -1.2992439270019531, 0.02630615234375, 0.3546714782714844, 0.15466690063476562, 0.2430572509765625, 1.3627433776855469, 0.3203926086425781, 0.6936206817626953, 0.07990646362304688, -0.1517782211303711, 0.036602020263671875, 1.2079849243164062, -0.060703277587890625, 0.1402587890625, 0.3424196243286133, 0.12501907348632812, 0.3521003723144531, 0.878875732421875, 0.30138397216796875, 0.34893035888671875, -0.10991287231445312, 0.18994140625, 0.9371337890625, 0.22705459594726562], "mean_td_error": 0.24271520972251892, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 36000.0, "diff_num_grad_updates_vs_sampler_policy": 15870.21875}}, "num_env_steps_sampled": 37000, "num_env_steps_trained": 1152000, "num_agent_steps_sampled": 37000, "num_agent_steps_trained": 1152000, "last_target_update_ts": 36501, "num_target_updates": 72}, "env_runners": {"episode_reward_max": 500.0, "episode_reward_min": 13.0, "episode_reward_mean": 144.29, "episode_len_mean": 144.29, "episode_media": {}, "episodes_timesteps_total": 14429, "policy_reward_min": {"default_policy": 13.0}, "policy_reward_max": {"default_policy": 500.0}, "policy_reward_mean": {"default_policy": 144.29}, "custom_metrics": {}, "hist_stats": {"episode_reward": [96.0, 107.0, 97.0, 96.0, 93.0, 97.0, 103.0, 112.0, 108.0, 116.0, 109.0, 106.0, 92.0, 92.0, 96.0, 91.0, 29.0, 30.0, 93.0, 96.0, 96.0, 32.0, 98.0, 97.0, 114.0, 238.0, 250.0, 120.0, 135.0, 133.0, 104.0, 87.0, 106.0, 107.0, 29.0, 108.0, 108.0, 142.0, 120.0, 121.0, 97.0, 93.0, 90.0, 98.0, 92.0, 90.0, 91.0, 93.0, 90.0, 94.0, 94.0, 87.0, 95.0, 89.0, 89.0, 91.0, 94.0, 76.0, 100.0, 43.0, 99.0, 98.0, 105.0, 113.0, 114.0, 105.0, 182.0, 235.0, 132.0, 148.0, 500.0, 13.0, 266.0, 113.0, 119.0, 112.0, 111.0, 110.0, 122.0, 108.0, 121.0, 93.0, 79.0, 185.0, 179.0, 225.0, 500.0, 169.0, 281.0, 171.0, 304.0, 293.0, 213.0, 393.0, 283.0, 307.0, 500.0, 500.0, 500.0, 238.0], "episode_lengths": [96, 107, 97, 96, 93, 97, 103, 112, 108, 116, 109, 106, 92, 92, 96, 91, 29, 30, 93, 96, 96, 32, 98, 97, 114, 238, 250, 120, 135, 133, 104, 87, 106, 107, 29, 108, 108, 142, 120, 121, 97, 93, 90, 98, 92, 90, 91, 93, 90, 94, 94, 87, 95, 89, 89, 91, 94, 76, 100, 43, 99, 98, 105, 113, 114, 105, 182, 235, 132, 148, 500, 13, 266, 113, 119, 112, 111, 110, 122, 108, 121, 93, 79, 185, 179, 225, 500, 169, 281, 171, 304, 293, 213, 393, 283, 307, 500, 500, 500, 238], "policy_default_policy_reward": [96.0, 107.0, 97.0, 96.0, 93.0, 97.0, 103.0, 112.0, 108.0, 116.0, 109.0, 106.0, 92.0, 92.0, 96.0, 91.0, 29.0, 30.0, 93.0, 96.0, 96.0, 32.0, 98.0, 97.0, 114.0, 238.0, 250.0, 120.0, 135.0, 133.0, 104.0, 87.0, 106.0, 107.0, 29.0, 108.0, 108.0, 142.0, 120.0, 121.0, 97.0, 93.0, 90.0, 98.0, 92.0, 90.0, 91.0, 93.0, 90.0, 94.0, 94.0, 87.0, 95.0, 89.0, 89.0, 91.0, 94.0, 76.0, 100.0, 43.0, 99.0, 98.0, 105.0, 113.0, 114.0, 105.0, 182.0, 235.0, 132.0, 148.0, 500.0, 13.0, 266.0, 113.0, 119.0, 112.0, 111.0, 110.0, 122.0, 108.0, 121.0, 93.0, 79.0, 185.0, 179.0, 225.0, 500.0, 169.0, 281.0, 171.0, 304.0, 293.0, 213.0, 393.0, 283.0, 307.0, 500.0, 500.0, 500.0, 238.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0155308167871355, "mean_inference_ms": 2.02362472879728, "mean_action_processing_ms": 0.23538626887491274, "mean_env_wait_ms": 0.10181755205502849, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017815351486206055, "StateBufferConnector_ms": 0.01631474494934082, "ViewRequirementAgentConnector_ms": 0.20281767845153809}, "num_episodes": 3, "episode_return_max": 500.0, "episode_return_min": 13.0, "episode_return_mean": 144.29, "episodes_this_iter": 3}, "num_healthy_workers": 0, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 37000, "num_agent_steps_trained": 1152000, "num_env_steps_sampled": 37000, "num_env_steps_trained": 1152000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 31.23516246487742, "num_env_steps_trained_throughput_per_sec": 999.5251988760774, "timesteps_total": 37000, "num_env_steps_sampled_lifetime": 37000, "num_agent_steps_sampled_lifetime": 37000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 37000, "timers": {"training_iteration_time_ms": 31746.148, "restore_workers_time_ms": 0.018, "training_step_time_ms": 30.681, "sample_time_ms": 3.553, "load_time_ms": 0.215, "load_throughput": 148767.156, "learn_time_ms": 13.322, "learn_throughput": 2402.038, "synch_weights_time_ms": 0.039}, "counters": {"num_env_steps_sampled": 37000, "num_env_steps_trained": 1152000, "num_agent_steps_sampled": 37000, "num_agent_steps_trained": 1152000, "last_target_update_ts": 36501, "num_target_updates": 72}, "done": false, "training_iteration": 37, "trial_id": "5ce16_00000", "date": "2024-09-27_11-10-41", "timestamp": 1727406641, "time_this_iter_s": 32.01667642593384, "time_total_s": 1146.5273225307465, "pid": 39427, "hostname": "gpu2gate1", "node_ip": "10.64.32.126", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.9828407522030984, "lr": 0.0007583973879008875, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f52e4d75580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1146.5273225307465, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 11.606666666666667, "ram_util_percent": 9.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.364786297082901, "mean_q": 37.12727355957031, "min_q": -1.7299013137817383, "max_q": 44.45840072631836, "cur_lr": 0.0007583973879008875}, "td_error": [0.16501617431640625, 0.14296722412109375, 0.02716827392578125, -1.1014938354492188, -0.19317626953125, 0.18649673461914062, -2.054840087890625, -2.457895278930664, 0.2476654052734375, 0.037021636962890625, 0.5652065277099609, 0.049945831298828125, -0.15970993041992188, 0.5874824523925781, 0.1822357177734375, 0.1844940185546875, 0.2889213562011719, -0.052234649658203125, 0.5497665405273438, -0.11644744873046875, 0.0198822021484375, -0.5877857208251953, -0.12369537353515625, 0.27991485595703125, 0.23020172119140625, 0.15710067749023438, -0.02648162841796875, 0.16773605346679688, -0.6656312942504883, 0.325531005859375, 0.18586349487304688, -0.42093658447265625], "mean_td_error": -0.10561594367027283, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 37000.0, "diff_num_grad_updates_vs_sampler_policy": 17894.125}}, "num_env_steps_sampled": 38000, "num_env_steps_trained": 1184000, "num_agent_steps_sampled": 38000, "num_agent_steps_trained": 1184000, "last_target_update_ts": 37501, "num_target_updates": 74}, "env_runners": {"episode_reward_max": 500.0, "episode_reward_min": 13.0, "episode_reward_mean": 152.37, "episode_len_mean": 152.37, "episode_media": {}, "episodes_timesteps_total": 15237, "policy_reward_min": {"default_policy": 13.0}, "policy_reward_max": {"default_policy": 500.0}, "policy_reward_mean": {"default_policy": 152.37}, "custom_metrics": {}, "hist_stats": {"episode_reward": [93.0, 97.0, 103.0, 112.0, 108.0, 116.0, 109.0, 106.0, 92.0, 92.0, 96.0, 91.0, 29.0, 30.0, 93.0, 96.0, 96.0, 32.0, 98.0, 97.0, 114.0, 238.0, 250.0, 120.0, 135.0, 133.0, 104.0, 87.0, 106.0, 107.0, 29.0, 108.0, 108.0, 142.0, 120.0, 121.0, 97.0, 93.0, 90.0, 98.0, 92.0, 90.0, 91.0, 93.0, 90.0, 94.0, 94.0, 87.0, 95.0, 89.0, 89.0, 91.0, 94.0, 76.0, 100.0, 43.0, 99.0, 98.0, 105.0, 113.0, 114.0, 105.0, 182.0, 235.0, 132.0, 148.0, 500.0, 13.0, 266.0, 113.0, 119.0, 112.0, 111.0, 110.0, 122.0, 108.0, 121.0, 93.0, 79.0, 185.0, 179.0, 225.0, 500.0, 169.0, 281.0, 171.0, 304.0, 293.0, 213.0, 393.0, 283.0, 307.0, 500.0, 500.0, 500.0, 238.0, 259.0, 479.0, 323.0, 143.0], "episode_lengths": [93, 97, 103, 112, 108, 116, 109, 106, 92, 92, 96, 91, 29, 30, 93, 96, 96, 32, 98, 97, 114, 238, 250, 120, 135, 133, 104, 87, 106, 107, 29, 108, 108, 142, 120, 121, 97, 93, 90, 98, 92, 90, 91, 93, 90, 94, 94, 87, 95, 89, 89, 91, 94, 76, 100, 43, 99, 98, 105, 113, 114, 105, 182, 235, 132, 148, 500, 13, 266, 113, 119, 112, 111, 110, 122, 108, 121, 93, 79, 185, 179, 225, 500, 169, 281, 171, 304, 293, 213, 393, 283, 307, 500, 500, 500, 238, 259, 479, 323, 143], "policy_default_policy_reward": [93.0, 97.0, 103.0, 112.0, 108.0, 116.0, 109.0, 106.0, 92.0, 92.0, 96.0, 91.0, 29.0, 30.0, 93.0, 96.0, 96.0, 32.0, 98.0, 97.0, 114.0, 238.0, 250.0, 120.0, 135.0, 133.0, 104.0, 87.0, 106.0, 107.0, 29.0, 108.0, 108.0, 142.0, 120.0, 121.0, 97.0, 93.0, 90.0, 98.0, 92.0, 90.0, 91.0, 93.0, 90.0, 94.0, 94.0, 87.0, 95.0, 89.0, 89.0, 91.0, 94.0, 76.0, 100.0, 43.0, 99.0, 98.0, 105.0, 113.0, 114.0, 105.0, 182.0, 235.0, 132.0, 148.0, 500.0, 13.0, 266.0, 113.0, 119.0, 112.0, 111.0, 110.0, 122.0, 108.0, 121.0, 93.0, 79.0, 185.0, 179.0, 225.0, 500.0, 169.0, 281.0, 171.0, 304.0, 293.0, 213.0, 393.0, 283.0, 307.0, 500.0, 500.0, 500.0, 238.0, 259.0, 479.0, 323.0, 143.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0153601779851462, "mean_inference_ms": 2.0233979852131965, "mean_action_processing_ms": 0.23540556728096726, "mean_env_wait_ms": 0.10181868546859657, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01772761344909668, "StateBufferConnector_ms": 0.016165494918823242, "ViewRequirementAgentConnector_ms": 0.20197486877441406}, "num_episodes": 4, "episode_return_max": 500.0, "episode_return_min": 13.0, "episode_return_mean": 152.37, "episodes_this_iter": 4}, "num_healthy_workers": 0, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 38000, "num_agent_steps_trained": 1184000, "num_env_steps_sampled": 38000, "num_env_steps_trained": 1184000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 33.53674418452917, "num_env_steps_trained_throughput_per_sec": 1073.1758139049334, "timesteps_total": 38000, "num_env_steps_sampled_lifetime": 38000, "num_agent_steps_sampled_lifetime": 38000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 38000, "timers": {"training_iteration_time_ms": 31560.689, "restore_workers_time_ms": 0.017, "training_step_time_ms": 27.157, "sample_time_ms": 3.176, "load_time_ms": 0.183, "load_throughput": 174853.736, "learn_time_ms": 10.938, "learn_throughput": 2925.599, "synch_weights_time_ms": 0.038}, "counters": {"num_env_steps_sampled": 38000, "num_env_steps_trained": 1184000, "num_agent_steps_sampled": 38000, "num_agent_steps_trained": 1184000, "last_target_update_ts": 37501, "num_target_updates": 74}, "done": false, "training_iteration": 38, "trial_id": "5ce16_00000", "date": "2024-09-27_11-11-10", "timestamp": 1727406670, "time_this_iter_s": 29.819860696792603, "time_total_s": 1176.347183227539, "pid": 39427, "hostname": "gpu2gate1", "node_ip": "10.64.32.126", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.9828407522030984, "lr": 0.0007583973879008875, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f52e4d75580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1176.347183227539, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 11.633333333333335, "ram_util_percent": 9.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6168740391731262, "mean_q": 28.942768096923828, "min_q": -0.976749062538147, "max_q": 45.0549430847168, "cur_lr": 0.0007583973879008875}, "td_error": [0.4150276184082031, -0.6828346252441406, -0.11019182205200195, -0.7852325439453125, 2.744863510131836, -1.976749062538147, 0.2845649719238281, -0.2942924499511719, 0.1537303924560547, -0.4173126220703125, -0.47016143798828125, -0.15838623046875, -0.15084075927734375, -0.09232521057128906, -0.28326416015625, 0.039005279541015625, -0.48557567596435547, -0.1394500732421875, 0.5541185140609741, -1.627854824066162, 0.2972233295440674, 2.001342296600342, -0.4248695373535156, -0.47393798828125, -0.7036781311035156, -0.37680816650390625, -1.1777381896972656, -0.39667510986328125, -1.0417556762695312, -0.23006820678710938, 0.5529518127441406, 1.1544950008392334], "mean_td_error": -0.1344587206840515, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 38000.0, "diff_num_grad_updates_vs_sampler_policy": 19632.5}}, "num_env_steps_sampled": 39000, "num_env_steps_trained": 1216000, "num_agent_steps_sampled": 39000, "num_agent_steps_trained": 1216000, "last_target_update_ts": 38501, "num_target_updates": 76}, "env_runners": {"episode_reward_max": 500.0, "episode_reward_min": 13.0, "episode_reward_mean": 154.07, "episode_len_mean": 154.07, "episode_media": {}, "episodes_timesteps_total": 15407, "policy_reward_min": {"default_policy": 13.0}, "policy_reward_max": {"default_policy": 500.0}, "policy_reward_mean": {"default_policy": 154.07}, "custom_metrics": {}, "hist_stats": {"episode_reward": [92.0, 92.0, 96.0, 91.0, 29.0, 30.0, 93.0, 96.0, 96.0, 32.0, 98.0, 97.0, 114.0, 238.0, 250.0, 120.0, 135.0, 133.0, 104.0, 87.0, 106.0, 107.0, 29.0, 108.0, 108.0, 142.0, 120.0, 121.0, 97.0, 93.0, 90.0, 98.0, 92.0, 90.0, 91.0, 93.0, 90.0, 94.0, 94.0, 87.0, 95.0, 89.0, 89.0, 91.0, 94.0, 76.0, 100.0, 43.0, 99.0, 98.0, 105.0, 113.0, 114.0, 105.0, 182.0, 235.0, 132.0, 148.0, 500.0, 13.0, 266.0, 113.0, 119.0, 112.0, 111.0, 110.0, 122.0, 108.0, 121.0, 93.0, 79.0, 185.0, 179.0, 225.0, 500.0, 169.0, 281.0, 171.0, 304.0, 293.0, 213.0, 393.0, 283.0, 307.0, 500.0, 500.0, 500.0, 238.0, 259.0, 479.0, 323.0, 143.0, 123.0, 240.0, 139.0, 112.0, 100.0, 106.0, 87.0, 107.0], "episode_lengths": [92, 92, 96, 91, 29, 30, 93, 96, 96, 32, 98, 97, 114, 238, 250, 120, 135, 133, 104, 87, 106, 107, 29, 108, 108, 142, 120, 121, 97, 93, 90, 98, 92, 90, 91, 93, 90, 94, 94, 87, 95, 89, 89, 91, 94, 76, 100, 43, 99, 98, 105, 113, 114, 105, 182, 235, 132, 148, 500, 13, 266, 113, 119, 112, 111, 110, 122, 108, 121, 93, 79, 185, 179, 225, 500, 169, 281, 171, 304, 293, 213, 393, 283, 307, 500, 500, 500, 238, 259, 479, 323, 143, 123, 240, 139, 112, 100, 106, 87, 107], "policy_default_policy_reward": [92.0, 92.0, 96.0, 91.0, 29.0, 30.0, 93.0, 96.0, 96.0, 32.0, 98.0, 97.0, 114.0, 238.0, 250.0, 120.0, 135.0, 133.0, 104.0, 87.0, 106.0, 107.0, 29.0, 108.0, 108.0, 142.0, 120.0, 121.0, 97.0, 93.0, 90.0, 98.0, 92.0, 90.0, 91.0, 93.0, 90.0, 94.0, 94.0, 87.0, 95.0, 89.0, 89.0, 91.0, 94.0, 76.0, 100.0, 43.0, 99.0, 98.0, 105.0, 113.0, 114.0, 105.0, 182.0, 235.0, 132.0, 148.0, 500.0, 13.0, 266.0, 113.0, 119.0, 112.0, 111.0, 110.0, 122.0, 108.0, 121.0, 93.0, 79.0, 185.0, 179.0, 225.0, 500.0, 169.0, 281.0, 171.0, 304.0, 293.0, 213.0, 393.0, 283.0, 307.0, 500.0, 500.0, 500.0, 238.0, 259.0, 479.0, 323.0, 143.0, 123.0, 240.0, 139.0, 112.0, 100.0, 106.0, 87.0, 107.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.014538590656374, "mean_inference_ms": 2.0219812344405517, "mean_action_processing_ms": 0.2353253003301049, "mean_env_wait_ms": 0.1017576201001508, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01745128631591797, "StateBufferConnector_ms": 0.01596999168395996, "ViewRequirementAgentConnector_ms": 0.19844841957092285}, "num_episodes": 8, "episode_return_max": 500.0, "episode_return_min": 13.0, "episode_return_mean": 154.07, "episodes_this_iter": 8}, "num_healthy_workers": 0, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 39000, "num_agent_steps_trained": 1216000, "num_env_steps_sampled": 39000, "num_env_steps_trained": 1216000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 35.87941001929794, "num_env_steps_trained_throughput_per_sec": 1148.1411206175342, "timesteps_total": 39000, "num_env_steps_sampled_lifetime": 39000, "num_agent_steps_sampled_lifetime": 39000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 39000, "timers": {"training_iteration_time_ms": 31205.76, "restore_workers_time_ms": 0.018, "training_step_time_ms": 28.651, "sample_time_ms": 3.371, "load_time_ms": 0.215, "load_throughput": 148783.647, "learn_time_ms": 11.741, "learn_throughput": 2725.549, "synch_weights_time_ms": 0.04}, "counters": {"num_env_steps_sampled": 39000, "num_env_steps_trained": 1216000, "num_agent_steps_sampled": 39000, "num_agent_steps_trained": 1216000, "last_target_update_ts": 38501, "num_target_updates": 76}, "done": false, "training_iteration": 39, "trial_id": "5ce16_00000", "date": "2024-09-27_11-11-38", "timestamp": 1727406698, "time_this_iter_s": 27.873262643814087, "time_total_s": 1204.2204458713531, "pid": 39427, "hostname": "gpu2gate1", "node_ip": "10.64.32.126", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.9828407522030984, "lr": 0.0007583973879008875, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f52e4d75580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1204.2204458713531, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 12.1775, "ram_util_percent": 9.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5858857035636902, "mean_q": 30.190677642822266, "min_q": 0.6914482116699219, "max_q": 45.22058868408203, "cur_lr": 0.0007583973879008875}, "td_error": [0.2891273498535156, -1.1701524257659912, 0.6043243408203125, 0.17797470092773438, 0.539886474609375, 0.15819168090820312, -0.8684501647949219, 0.8702765703201294, 0.5739412307739258, -0.009998321533203125, 1.3946037292480469, 0.7353305816650391, -0.438079833984375, 0.380706787109375, 0.19588851928710938, 0.4371147155761719, -0.3847541809082031, -0.12263107299804688, 0.3392333984375, 2.076098918914795, -4.365211486816406, 1.056427001953125, -0.0725555419921875, -0.03415679931640625, -0.6883087158203125, -0.3085517883300781, -0.23814773559570312, 0.807281494140625, -0.23412823677062988, 1.218557357788086, 0.5981063842773438, -1.6624374389648438], "mean_td_error": 0.057984624058008194, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 39000.0, "diff_num_grad_updates_vs_sampler_policy": 18016.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 1248000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 1248000, "last_target_update_ts": 39501, "num_target_updates": 78}, "env_runners": {"episode_reward_max": 500.0, "episode_reward_min": 13.0, "episode_reward_mean": 160.08, "episode_len_mean": 160.08, "episode_media": {}, "episodes_timesteps_total": 16008, "policy_reward_min": {"default_policy": 13.0}, "policy_reward_max": {"default_policy": 500.0}, "policy_reward_mean": {"default_policy": 160.08}, "custom_metrics": {}, "hist_stats": {"episode_reward": [30.0, 93.0, 96.0, 96.0, 32.0, 98.0, 97.0, 114.0, 238.0, 250.0, 120.0, 135.0, 133.0, 104.0, 87.0, 106.0, 107.0, 29.0, 108.0, 108.0, 142.0, 120.0, 121.0, 97.0, 93.0, 90.0, 98.0, 92.0, 90.0, 91.0, 93.0, 90.0, 94.0, 94.0, 87.0, 95.0, 89.0, 89.0, 91.0, 94.0, 76.0, 100.0, 43.0, 99.0, 98.0, 105.0, 113.0, 114.0, 105.0, 182.0, 235.0, 132.0, 148.0, 500.0, 13.0, 266.0, 113.0, 119.0, 112.0, 111.0, 110.0, 122.0, 108.0, 121.0, 93.0, 79.0, 185.0, 179.0, 225.0, 500.0, 169.0, 281.0, 171.0, 304.0, 293.0, 213.0, 393.0, 283.0, 307.0, 500.0, 500.0, 500.0, 238.0, 259.0, 479.0, 323.0, 143.0, 123.0, 240.0, 139.0, 112.0, 100.0, 106.0, 87.0, 107.0, 124.0, 500.0, 119.0, 185.0, 73.0], "episode_lengths": [30, 93, 96, 96, 32, 98, 97, 114, 238, 250, 120, 135, 133, 104, 87, 106, 107, 29, 108, 108, 142, 120, 121, 97, 93, 90, 98, 92, 90, 91, 93, 90, 94, 94, 87, 95, 89, 89, 91, 94, 76, 100, 43, 99, 98, 105, 113, 114, 105, 182, 235, 132, 148, 500, 13, 266, 113, 119, 112, 111, 110, 122, 108, 121, 93, 79, 185, 179, 225, 500, 169, 281, 171, 304, 293, 213, 393, 283, 307, 500, 500, 500, 238, 259, 479, 323, 143, 123, 240, 139, 112, 100, 106, 87, 107, 124, 500, 119, 185, 73], "policy_default_policy_reward": [30.0, 93.0, 96.0, 96.0, 32.0, 98.0, 97.0, 114.0, 238.0, 250.0, 120.0, 135.0, 133.0, 104.0, 87.0, 106.0, 107.0, 29.0, 108.0, 108.0, 142.0, 120.0, 121.0, 97.0, 93.0, 90.0, 98.0, 92.0, 90.0, 91.0, 93.0, 90.0, 94.0, 94.0, 87.0, 95.0, 89.0, 89.0, 91.0, 94.0, 76.0, 100.0, 43.0, 99.0, 98.0, 105.0, 113.0, 114.0, 105.0, 182.0, 235.0, 132.0, 148.0, 500.0, 13.0, 266.0, 113.0, 119.0, 112.0, 111.0, 110.0, 122.0, 108.0, 121.0, 93.0, 79.0, 185.0, 179.0, 225.0, 500.0, 169.0, 281.0, 171.0, 304.0, 293.0, 213.0, 393.0, 283.0, 307.0, 500.0, 500.0, 500.0, 238.0, 259.0, 479.0, 323.0, 143.0, 123.0, 240.0, 139.0, 112.0, 100.0, 106.0, 87.0, 107.0, 124.0, 500.0, 119.0, 185.0, 73.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0139113357324423, "mean_inference_ms": 2.0208688128116257, "mean_action_processing_ms": 0.23524274488964028, "mean_env_wait_ms": 0.10170367682068207, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01728034019470215, "StateBufferConnector_ms": 0.015817642211914062, "ViewRequirementAgentConnector_ms": 0.1955409049987793}, "num_episodes": 5, "episode_return_max": 500.0, "episode_return_min": 13.0, "episode_return_mean": 160.08, "episodes_this_iter": 5}, "num_healthy_workers": 0, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 1248000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 1248000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 33.08094026758963, "num_env_steps_trained_throughput_per_sec": 1058.5900885628682, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 40000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 31072.444, "restore_workers_time_ms": 0.025, "training_step_time_ms": 26.975, "sample_time_ms": 3.251, "load_time_ms": 0.204, "load_throughput": 156686.584, "learn_time_ms": 11.118, "learn_throughput": 2878.183, "synch_weights_time_ms": 0.038}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 1248000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 1248000, "last_target_update_ts": 39501, "num_target_updates": 78}, "done": false, "training_iteration": 40, "trial_id": "5ce16_00000", "date": "2024-09-27_11-12-09", "timestamp": 1727406729, "time_this_iter_s": 30.230470657348633, "time_total_s": 1234.4509165287018, "pid": 39427, "hostname": "gpu2gate1", "node_ip": "10.64.32.126", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.9828407522030984, "lr": 0.0007583973879008875, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f52e4d75580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1234.4509165287018, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 13.148837209302327, "ram_util_percent": 9.753488372093024}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.41054123640060425, "mean_q": 34.26001739501953, "min_q": 2.4880149364471436, "max_q": 45.94097137451172, "cur_lr": 0.0007583973879008875}, "td_error": [-0.16172504425048828, -0.48107147216796875, 0.45328235626220703, -0.21932601928710938, 0.5795183181762695, 0.2610359191894531, 0.5788764953613281, -0.46903228759765625, -0.10422897338867188, 0.30892181396484375, 0.06505966186523438, 0.3390769958496094, 0.2911815643310547, -0.5481643676757812, -3.4370734691619873, 0.5334396362304688, 0.8820126056671143, -0.028873443603515625, 0.19543838500976562, -0.4522819519042969, -4.024440765380859, -2.5141448974609375, 0.5297069549560547, 0.4696846008300781, 0.3441352844238281, -0.7190322875976562, 0.2911567687988281, 3.559584379196167, 0.2203826904296875, 0.4290618896484375, 0.6714439392089844, 0.4778022766113281], "mean_td_error": -0.05245601385831833, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 40000.0, "diff_num_grad_updates_vs_sampler_policy": 23704.1875}}, "num_env_steps_sampled": 41000, "num_env_steps_trained": 1280000, "num_agent_steps_sampled": 41000, "num_agent_steps_trained": 1280000, "last_target_update_ts": 40501, "num_target_updates": 80}, "env_runners": {"episode_reward_max": 500.0, "episode_reward_min": 13.0, "episode_reward_mean": 167.07, "episode_len_mean": 167.07, "episode_media": {}, "episodes_timesteps_total": 16707, "policy_reward_min": {"default_policy": 13.0}, "policy_reward_max": {"default_policy": 500.0}, "policy_reward_mean": {"default_policy": 167.07}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.0, 98.0, 97.0, 114.0, 238.0, 250.0, 120.0, 135.0, 133.0, 104.0, 87.0, 106.0, 107.0, 29.0, 108.0, 108.0, 142.0, 120.0, 121.0, 97.0, 93.0, 90.0, 98.0, 92.0, 90.0, 91.0, 93.0, 90.0, 94.0, 94.0, 87.0, 95.0, 89.0, 89.0, 91.0, 94.0, 76.0, 100.0, 43.0, 99.0, 98.0, 105.0, 113.0, 114.0, 105.0, 182.0, 235.0, 132.0, 148.0, 500.0, 13.0, 266.0, 113.0, 119.0, 112.0, 111.0, 110.0, 122.0, 108.0, 121.0, 93.0, 79.0, 185.0, 179.0, 225.0, 500.0, 169.0, 281.0, 171.0, 304.0, 293.0, 213.0, 393.0, 283.0, 307.0, 500.0, 500.0, 500.0, 238.0, 259.0, 479.0, 323.0, 143.0, 123.0, 240.0, 139.0, 112.0, 100.0, 106.0, 87.0, 107.0, 124.0, 500.0, 119.0, 185.0, 73.0, 177.0, 178.0, 500.0, 159.0], "episode_lengths": [32, 98, 97, 114, 238, 250, 120, 135, 133, 104, 87, 106, 107, 29, 108, 108, 142, 120, 121, 97, 93, 90, 98, 92, 90, 91, 93, 90, 94, 94, 87, 95, 89, 89, 91, 94, 76, 100, 43, 99, 98, 105, 113, 114, 105, 182, 235, 132, 148, 500, 13, 266, 113, 119, 112, 111, 110, 122, 108, 121, 93, 79, 185, 179, 225, 500, 169, 281, 171, 304, 293, 213, 393, 283, 307, 500, 500, 500, 238, 259, 479, 323, 143, 123, 240, 139, 112, 100, 106, 87, 107, 124, 500, 119, 185, 73, 177, 178, 500, 159], "policy_default_policy_reward": [32.0, 98.0, 97.0, 114.0, 238.0, 250.0, 120.0, 135.0, 133.0, 104.0, 87.0, 106.0, 107.0, 29.0, 108.0, 108.0, 142.0, 120.0, 121.0, 97.0, 93.0, 90.0, 98.0, 92.0, 90.0, 91.0, 93.0, 90.0, 94.0, 94.0, 87.0, 95.0, 89.0, 89.0, 91.0, 94.0, 76.0, 100.0, 43.0, 99.0, 98.0, 105.0, 113.0, 114.0, 105.0, 182.0, 235.0, 132.0, 148.0, 500.0, 13.0, 266.0, 113.0, 119.0, 112.0, 111.0, 110.0, 122.0, 108.0, 121.0, 93.0, 79.0, 185.0, 179.0, 225.0, 500.0, 169.0, 281.0, 171.0, 304.0, 293.0, 213.0, 393.0, 283.0, 307.0, 500.0, 500.0, 500.0, 238.0, 259.0, 479.0, 323.0, 143.0, 123.0, 240.0, 139.0, 112.0, 100.0, 106.0, 87.0, 107.0, 124.0, 500.0, 119.0, 185.0, 73.0, 177.0, 178.0, 500.0, 159.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0132447339175803, "mean_inference_ms": 2.019708201772052, "mean_action_processing_ms": 0.23514073050187434, "mean_env_wait_ms": 0.10164010970307275, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0168306827545166, "StateBufferConnector_ms": 0.01567840576171875, "ViewRequirementAgentConnector_ms": 0.19313764572143555}, "num_episodes": 4, "episode_return_max": 500.0, "episode_return_min": 13.0, "episode_return_mean": 167.07, "episodes_this_iter": 4}, "num_healthy_workers": 0, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 41000, "num_agent_steps_trained": 1280000, "num_env_steps_sampled": 41000, "num_env_steps_trained": 1280000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 35.817373362504014, "num_env_steps_trained_throughput_per_sec": 1146.1559476001285, "timesteps_total": 41000, "num_env_steps_sampled_lifetime": 41000, "num_agent_steps_sampled_lifetime": 41000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 41000, "timers": {"training_iteration_time_ms": 30679.315, "restore_workers_time_ms": 0.017, "training_step_time_ms": 28.679, "sample_time_ms": 3.58, "load_time_ms": 0.2, "load_throughput": 159783.01, "learn_time_ms": 11.424, "learn_throughput": 2801.216, "synch_weights_time_ms": 0.038}, "counters": {"num_env_steps_sampled": 41000, "num_env_steps_trained": 1280000, "num_agent_steps_sampled": 41000, "num_agent_steps_trained": 1280000, "last_target_update_ts": 40501, "num_target_updates": 80}, "done": false, "training_iteration": 41, "trial_id": "5ce16_00000", "date": "2024-09-27_11-12-37", "timestamp": 1727406757, "time_this_iter_s": 27.920958280563354, "time_total_s": 1262.3718748092651, "pid": 39427, "hostname": "gpu2gate1", "node_ip": "10.64.32.126", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.9828407522030984, "lr": 0.0007583973879008875, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f52e4d75580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1262.3718748092651, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 12.038461538461537, "ram_util_percent": 9.800000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.36068275570869446, "mean_q": 35.44987487792969, "min_q": 0.04279965162277222, "max_q": 47.02468490600586, "cur_lr": 0.0007583973879008875}, "td_error": [-0.1950225830078125, -0.7523136138916016, 1.3445181846618652, 16.674102783203125, -0.0677642822265625, 0.6009330749511719, -0.010036468505859375, -0.9572003483772278, 0.8677434921264648, -0.3343925476074219, 0.6991786956787109, 0.050952911376953125, -0.039653778076171875, -0.14710235595703125, -0.263336181640625, 3.8175048828125, -0.30008697509765625, -0.15035629272460938, -0.12041854858398438, 0.5124702453613281, 0.21242904663085938, -0.06391525268554688, 0.7677478790283203, -0.1191558837890625, -0.2462310791015625, 0.1318817138671875, 0.4354705810546875, 1.139327049255371, 0.43788909912109375, -0.29840850830078125, -0.3214759826660156, 0.3923072814941406], "mean_td_error": 0.7405495643615723, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 41000.0, "diff_num_grad_updates_vs_sampler_policy": 20366.90625}}, "num_env_steps_sampled": 42000, "num_env_steps_trained": 1312000, "num_agent_steps_sampled": 42000, "num_agent_steps_trained": 1312000, "last_target_update_ts": 41501, "num_target_updates": 82}, "env_runners": {"episode_reward_max": 500.0, "episode_reward_min": 13.0, "episode_reward_mean": 167.27, "episode_len_mean": 167.27, "episode_media": {}, "episodes_timesteps_total": 16727, "policy_reward_min": {"default_policy": 13.0}, "policy_reward_max": {"default_policy": 500.0}, "policy_reward_mean": {"default_policy": 167.27}, "custom_metrics": {}, "hist_stats": {"episode_reward": [120.0, 135.0, 133.0, 104.0, 87.0, 106.0, 107.0, 29.0, 108.0, 108.0, 142.0, 120.0, 121.0, 97.0, 93.0, 90.0, 98.0, 92.0, 90.0, 91.0, 93.0, 90.0, 94.0, 94.0, 87.0, 95.0, 89.0, 89.0, 91.0, 94.0, 76.0, 100.0, 43.0, 99.0, 98.0, 105.0, 113.0, 114.0, 105.0, 182.0, 235.0, 132.0, 148.0, 500.0, 13.0, 266.0, 113.0, 119.0, 112.0, 111.0, 110.0, 122.0, 108.0, 121.0, 93.0, 79.0, 185.0, 179.0, 225.0, 500.0, 169.0, 281.0, 171.0, 304.0, 293.0, 213.0, 393.0, 283.0, 307.0, 500.0, 500.0, 500.0, 238.0, 259.0, 479.0, 323.0, 143.0, 123.0, 240.0, 139.0, 112.0, 100.0, 106.0, 87.0, 107.0, 124.0, 500.0, 119.0, 185.0, 73.0, 177.0, 178.0, 500.0, 159.0, 189.0, 139.0, 130.0, 114.0, 156.0, 121.0], "episode_lengths": [120, 135, 133, 104, 87, 106, 107, 29, 108, 108, 142, 120, 121, 97, 93, 90, 98, 92, 90, 91, 93, 90, 94, 94, 87, 95, 89, 89, 91, 94, 76, 100, 43, 99, 98, 105, 113, 114, 105, 182, 235, 132, 148, 500, 13, 266, 113, 119, 112, 111, 110, 122, 108, 121, 93, 79, 185, 179, 225, 500, 169, 281, 171, 304, 293, 213, 393, 283, 307, 500, 500, 500, 238, 259, 479, 323, 143, 123, 240, 139, 112, 100, 106, 87, 107, 124, 500, 119, 185, 73, 177, 178, 500, 159, 189, 139, 130, 114, 156, 121], "policy_default_policy_reward": [120.0, 135.0, 133.0, 104.0, 87.0, 106.0, 107.0, 29.0, 108.0, 108.0, 142.0, 120.0, 121.0, 97.0, 93.0, 90.0, 98.0, 92.0, 90.0, 91.0, 93.0, 90.0, 94.0, 94.0, 87.0, 95.0, 89.0, 89.0, 91.0, 94.0, 76.0, 100.0, 43.0, 99.0, 98.0, 105.0, 113.0, 114.0, 105.0, 182.0, 235.0, 132.0, 148.0, 500.0, 13.0, 266.0, 113.0, 119.0, 112.0, 111.0, 110.0, 122.0, 108.0, 121.0, 93.0, 79.0, 185.0, 179.0, 225.0, 500.0, 169.0, 281.0, 171.0, 304.0, 293.0, 213.0, 393.0, 283.0, 307.0, 500.0, 500.0, 500.0, 238.0, 259.0, 479.0, 323.0, 143.0, 123.0, 240.0, 139.0, 112.0, 100.0, 106.0, 87.0, 107.0, 124.0, 500.0, 119.0, 185.0, 73.0, 177.0, 178.0, 500.0, 159.0, 189.0, 139.0, 130.0, 114.0, 156.0, 121.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.012029441983687, "mean_inference_ms": 2.017581976223437, "mean_action_processing_ms": 0.2349376461991933, "mean_env_wait_ms": 0.10152041488249244, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016649961471557617, "StateBufferConnector_ms": 0.015455484390258789, "ViewRequirementAgentConnector_ms": 0.19066333770751953}, "num_episodes": 6, "episode_return_max": 500.0, "episode_return_min": 13.0, "episode_return_mean": 167.27, "episodes_this_iter": 6}, "num_healthy_workers": 0, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 42000, "num_agent_steps_trained": 1312000, "num_env_steps_sampled": 42000, "num_env_steps_trained": 1312000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 35.99413151099861, "num_env_steps_trained_throughput_per_sec": 1151.8122083519556, "timesteps_total": 42000, "num_env_steps_sampled_lifetime": 42000, "num_agent_steps_sampled_lifetime": 42000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 42000, "timers": {"training_iteration_time_ms": 30125.025, "restore_workers_time_ms": 0.021, "training_step_time_ms": 26.324, "sample_time_ms": 3.18, "load_time_ms": 0.187, "load_throughput": 171086.97, "learn_time_ms": 10.851, "learn_throughput": 2949.049, "synch_weights_time_ms": 0.038}, "counters": {"num_env_steps_sampled": 42000, "num_env_steps_trained": 1312000, "num_agent_steps_sampled": 42000, "num_agent_steps_trained": 1312000, "last_target_update_ts": 41501, "num_target_updates": 82}, "done": false, "training_iteration": 42, "trial_id": "5ce16_00000", "date": "2024-09-27_11-13-05", "timestamp": 1727406785, "time_this_iter_s": 27.7838773727417, "time_total_s": 1290.1557521820068, "pid": 39427, "hostname": "gpu2gate1", "node_ip": "10.64.32.126", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.9828407522030984, "lr": 0.0007583973879008875, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f52e4d75580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1290.1557521820068, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 12.465, "ram_util_percent": 9.780000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.2849036753177643, "mean_q": 36.06925582885742, "min_q": -0.06341850757598877, "max_q": 48.019081115722656, "cur_lr": 0.0007583973879008875}, "td_error": [-0.280426025390625, 0.12735366821289062, 0.16986846923828125, 0.057270050048828125, 0.09355926513671875, 0.21818923950195312, -4.375846862792969, 0.2542077302932739, 0.5544548034667969, -0.4604949951171875, 0.6356773376464844, 0.05278778076171875, 0.7138636112213135, 0.11125946044921875, -0.03504180908203125, 0.4113903045654297, 0.29705238342285156, 0.14969253540039062, -0.19005584716796875, -0.2961653470993042, -0.282806396484375, -0.117034912109375, 0.07899093627929688, 0.16968536376953125, 0.21719074249267578, 0.048213958740234375, -0.26467132568359375, 0.0765838623046875, -0.6656570434570312, 0.056140899658203125, 0.06949996948242188, -0.15887832641601562], "mean_td_error": -0.08012957870960236, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 42000.0, "diff_num_grad_updates_vs_sampler_policy": 26198.34375}}, "num_env_steps_sampled": 43000, "num_env_steps_trained": 1344000, "num_agent_steps_sampled": 43000, "num_agent_steps_trained": 1344000, "last_target_update_ts": 42501, "num_target_updates": 84}, "env_runners": {"episode_reward_max": 500.0, "episode_reward_min": 13.0, "episode_reward_mean": 165.84, "episode_len_mean": 165.84, "episode_media": {}, "episodes_timesteps_total": 16584, "policy_reward_min": {"default_policy": 13.0}, "policy_reward_max": {"default_policy": 500.0}, "policy_reward_mean": {"default_policy": 165.84}, "custom_metrics": {}, "hist_stats": {"episode_reward": [120.0, 121.0, 97.0, 93.0, 90.0, 98.0, 92.0, 90.0, 91.0, 93.0, 90.0, 94.0, 94.0, 87.0, 95.0, 89.0, 89.0, 91.0, 94.0, 76.0, 100.0, 43.0, 99.0, 98.0, 105.0, 113.0, 114.0, 105.0, 182.0, 235.0, 132.0, 148.0, 500.0, 13.0, 266.0, 113.0, 119.0, 112.0, 111.0, 110.0, 122.0, 108.0, 121.0, 93.0, 79.0, 185.0, 179.0, 225.0, 500.0, 169.0, 281.0, 171.0, 304.0, 293.0, 213.0, 393.0, 283.0, 307.0, 500.0, 500.0, 500.0, 238.0, 259.0, 479.0, 323.0, 143.0, 123.0, 240.0, 139.0, 112.0, 100.0, 106.0, 87.0, 107.0, 124.0, 500.0, 119.0, 185.0, 73.0, 177.0, 178.0, 500.0, 159.0, 189.0, 139.0, 130.0, 114.0, 156.0, 121.0, 181.0, 108.0, 52.0, 94.0, 89.0, 27.0, 99.0, 28.0, 104.0, 139.0, 115.0], "episode_lengths": [120, 121, 97, 93, 90, 98, 92, 90, 91, 93, 90, 94, 94, 87, 95, 89, 89, 91, 94, 76, 100, 43, 99, 98, 105, 113, 114, 105, 182, 235, 132, 148, 500, 13, 266, 113, 119, 112, 111, 110, 122, 108, 121, 93, 79, 185, 179, 225, 500, 169, 281, 171, 304, 293, 213, 393, 283, 307, 500, 500, 500, 238, 259, 479, 323, 143, 123, 240, 139, 112, 100, 106, 87, 107, 124, 500, 119, 185, 73, 177, 178, 500, 159, 189, 139, 130, 114, 156, 121, 181, 108, 52, 94, 89, 27, 99, 28, 104, 139, 115], "policy_default_policy_reward": [120.0, 121.0, 97.0, 93.0, 90.0, 98.0, 92.0, 90.0, 91.0, 93.0, 90.0, 94.0, 94.0, 87.0, 95.0, 89.0, 89.0, 91.0, 94.0, 76.0, 100.0, 43.0, 99.0, 98.0, 105.0, 113.0, 114.0, 105.0, 182.0, 235.0, 132.0, 148.0, 500.0, 13.0, 266.0, 113.0, 119.0, 112.0, 111.0, 110.0, 122.0, 108.0, 121.0, 93.0, 79.0, 185.0, 179.0, 225.0, 500.0, 169.0, 281.0, 171.0, 304.0, 293.0, 213.0, 393.0, 283.0, 307.0, 500.0, 500.0, 500.0, 238.0, 259.0, 479.0, 323.0, 143.0, 123.0, 240.0, 139.0, 112.0, 100.0, 106.0, 87.0, 107.0, 124.0, 500.0, 119.0, 185.0, 73.0, 177.0, 178.0, 500.0, 159.0, 189.0, 139.0, 130.0, 114.0, 156.0, 121.0, 181.0, 108.0, 52.0, 94.0, 89.0, 27.0, 99.0, 28.0, 104.0, 139.0, 115.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0094042688319502, "mean_inference_ms": 2.0130121894231308, "mean_action_processing_ms": 0.23443986321513183, "mean_env_wait_ms": 0.10124126201332061, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016463041305541992, "StateBufferConnector_ms": 0.014980077743530273, "ViewRequirementAgentConnector_ms": 0.18649029731750488}, "num_episodes": 11, "episode_return_max": 500.0, "episode_return_min": 13.0, "episode_return_mean": 165.84, "episodes_this_iter": 11}, "num_healthy_workers": 0, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 43000, "num_agent_steps_trained": 1344000, "num_env_steps_sampled": 43000, "num_env_steps_trained": 1344000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 36.11057821113912, "num_env_steps_trained_throughput_per_sec": 1155.5385027564519, "timesteps_total": 43000, "num_env_steps_sampled_lifetime": 43000, "num_agent_steps_sampled_lifetime": 43000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 43000, "timers": {"training_iteration_time_ms": 29624.092, "restore_workers_time_ms": 0.019, "training_step_time_ms": 29.787, "sample_time_ms": 3.808, "load_time_ms": 0.208, "load_throughput": 154166.929, "learn_time_ms": 12.549, "learn_throughput": 2549.908, "synch_weights_time_ms": 0.039}, "counters": {"num_env_steps_sampled": 43000, "num_env_steps_trained": 1344000, "num_agent_steps_sampled": 43000, "num_agent_steps_trained": 1344000, "last_target_update_ts": 42501, "num_target_updates": 84}, "done": false, "training_iteration": 43, "trial_id": "5ce16_00000", "date": "2024-09-27_11-13-33", "timestamp": 1727406813, "time_this_iter_s": 27.694406747817993, "time_total_s": 1317.8501589298248, "pid": 39427, "hostname": "gpu2gate1", "node_ip": "10.64.32.126", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.9828407522030984, "lr": 0.0007583973879008875, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f52e4d75580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1317.8501589298248, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 11.85897435897436, "ram_util_percent": 9.715384615384613}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.332204669713974, "mean_q": 41.53182601928711, "min_q": 9.300758361816406, "max_q": 47.74186706542969, "cur_lr": 0.0007583973879008875}, "td_error": [-0.14735794067382812, -0.34771728515625, 0.10176849365234375, -0.5616912841796875, -0.16663360595703125, -0.15047073364257812, -0.5851058959960938, 0.21020126342773438, 0.08106231689453125, 5.759683609008789, 0.3264122009277344, 28.312482833862305, -0.1657867431640625, -0.2949180603027344, 0.042217254638671875, 0.8239326477050781, -0.17248916625976562, -0.8994216918945312, -7.688301086425781, -1.6786136627197266, 0.0916748046875, -0.004428863525390625, -0.3366432189941406, 0.6797561645507812, 0.00162506103515625, 0.24316787719726562, 0.080108642578125, -0.144989013671875, -0.189178466796875, -0.6961555480957031, -0.6097412109375, -0.08521270751953125], "mean_td_error": 0.682163655757904, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 43000.0, "diff_num_grad_updates_vs_sampler_policy": 17340.59375}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 1376000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 1376000, "last_target_update_ts": 43501, "num_target_updates": 86}, "env_runners": {"episode_reward_max": 500.0, "episode_reward_min": 13.0, "episode_reward_mean": 156.74, "episode_len_mean": 156.74, "episode_media": {}, "episodes_timesteps_total": 15674, "policy_reward_min": {"default_policy": 13.0}, "policy_reward_max": {"default_policy": 500.0}, "policy_reward_mean": {"default_policy": 156.74}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.0, 99.0, 98.0, 105.0, 113.0, 114.0, 105.0, 182.0, 235.0, 132.0, 148.0, 500.0, 13.0, 266.0, 113.0, 119.0, 112.0, 111.0, 110.0, 122.0, 108.0, 121.0, 93.0, 79.0, 185.0, 179.0, 225.0, 500.0, 169.0, 281.0, 171.0, 304.0, 293.0, 213.0, 393.0, 283.0, 307.0, 500.0, 500.0, 500.0, 238.0, 259.0, 479.0, 323.0, 143.0, 123.0, 240.0, 139.0, 112.0, 100.0, 106.0, 87.0, 107.0, 124.0, 500.0, 119.0, 185.0, 73.0, 177.0, 178.0, 500.0, 159.0, 189.0, 139.0, 130.0, 114.0, 156.0, 121.0, 181.0, 108.0, 52.0, 94.0, 89.0, 27.0, 99.0, 28.0, 104.0, 139.0, 115.0, 132.0, 29.0, 14.0, 15.0, 21.0, 37.0, 21.0, 91.0, 89.0, 19.0, 90.0, 28.0, 42.0, 19.0, 89.0, 22.0, 17.0, 23.0, 90.0, 91.0, 95.0], "episode_lengths": [43, 99, 98, 105, 113, 114, 105, 182, 235, 132, 148, 500, 13, 266, 113, 119, 112, 111, 110, 122, 108, 121, 93, 79, 185, 179, 225, 500, 169, 281, 171, 304, 293, 213, 393, 283, 307, 500, 500, 500, 238, 259, 479, 323, 143, 123, 240, 139, 112, 100, 106, 87, 107, 124, 500, 119, 185, 73, 177, 178, 500, 159, 189, 139, 130, 114, 156, 121, 181, 108, 52, 94, 89, 27, 99, 28, 104, 139, 115, 132, 29, 14, 15, 21, 37, 21, 91, 89, 19, 90, 28, 42, 19, 89, 22, 17, 23, 90, 91, 95], "policy_default_policy_reward": [43.0, 99.0, 98.0, 105.0, 113.0, 114.0, 105.0, 182.0, 235.0, 132.0, 148.0, 500.0, 13.0, 266.0, 113.0, 119.0, 112.0, 111.0, 110.0, 122.0, 108.0, 121.0, 93.0, 79.0, 185.0, 179.0, 225.0, 500.0, 169.0, 281.0, 171.0, 304.0, 293.0, 213.0, 393.0, 283.0, 307.0, 500.0, 500.0, 500.0, 238.0, 259.0, 479.0, 323.0, 143.0, 123.0, 240.0, 139.0, 112.0, 100.0, 106.0, 87.0, 107.0, 124.0, 500.0, 119.0, 185.0, 73.0, 177.0, 178.0, 500.0, 159.0, 189.0, 139.0, 130.0, 114.0, 156.0, 121.0, 181.0, 108.0, 52.0, 94.0, 89.0, 27.0, 99.0, 28.0, 104.0, 139.0, 115.0, 132.0, 29.0, 14.0, 15.0, 21.0, 37.0, 21.0, 91.0, 89.0, 19.0, 90.0, 28.0, 42.0, 19.0, 89.0, 22.0, 17.0, 23.0, 90.0, 91.0, 95.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.003919710521196, "mean_inference_ms": 2.0039443840259183, "mean_action_processing_ms": 0.23329100831603455, "mean_env_wait_ms": 0.10061588797129811, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016274690628051758, "StateBufferConnector_ms": 0.014423847198486328, "ViewRequirementAgentConnector_ms": 0.17987704277038574}, "num_episodes": 21, "episode_return_max": 500.0, "episode_return_min": 13.0, "episode_return_mean": 156.74, "episodes_this_iter": 21}, "num_healthy_workers": 0, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 1376000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 1376000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 34.03897628276149, "num_env_steps_trained_throughput_per_sec": 1089.2472410483676, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 44000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 29458.29, "restore_workers_time_ms": 0.019, "training_step_time_ms": 31.783, "sample_time_ms": 3.838, "load_time_ms": 0.252, "load_throughput": 127100.121, "learn_time_ms": 13.195, "learn_throughput": 2425.233, "synch_weights_time_ms": 0.045}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 1376000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 1376000, "last_target_update_ts": 43501, "num_target_updates": 86}, "done": false, "training_iteration": 44, "trial_id": "5ce16_00000", "date": "2024-09-27_11-14-02", "timestamp": 1727406842, "time_this_iter_s": 29.37990975379944, "time_total_s": 1347.2300686836243, "pid": 39427, "hostname": "gpu2gate1", "node_ip": "10.64.32.126", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.9828407522030984, "lr": 0.0007583973879008875, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f52e4d75580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1347.2300686836243, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 11.857142857142858, "ram_util_percent": 9.707142857142856}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7367381453514099, "mean_q": 34.65766143798828, "min_q": 0.2550201416015625, "max_q": 49.202022552490234, "cur_lr": 0.0007583973879008875}, "td_error": [4.770395278930664, -0.6030750274658203, -0.30423736572265625, 1.4652605056762695, 0.422119140625, -0.3911094665527344, -0.5746955871582031, -0.3078269958496094, 0.7172632217407227, 0.08234786987304688, 1.4566516876220703, -0.053188323974609375, -1.0733280181884766, -0.2089080810546875, -0.4906959533691406, -0.3555412292480469, -0.11652755737304688, -0.4170074462890625, -14.340694427490234, 2.1716561317443848, -0.6290817260742188, -0.4979820251464844, -0.12537002563476562, 8.051325798034668, -0.3165130615234375, -0.5124740600585938, 0.031963348388671875, -0.40276336669921875, 0.0353546142578125, -0.2507133483886719, 1.0837125778198242, 0.056732177734375], "mean_td_error": -0.050842225551605225, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 44000.0, "diff_num_grad_updates_vs_sampler_policy": 24334.28125}}, "num_env_steps_sampled": 45000, "num_env_steps_trained": 1408000, "num_agent_steps_sampled": 45000, "num_agent_steps_trained": 1408000, "last_target_update_ts": 44501, "num_target_updates": 88}, "env_runners": {"episode_reward_max": 500.0, "episode_reward_min": 13.0, "episode_reward_mean": 153.91, "episode_len_mean": 153.91, "episode_media": {}, "episodes_timesteps_total": 15391, "policy_reward_min": {"default_policy": 13.0}, "policy_reward_max": {"default_policy": 500.0}, "policy_reward_mean": {"default_policy": 153.91}, "custom_metrics": {}, "hist_stats": {"episode_reward": [148.0, 500.0, 13.0, 266.0, 113.0, 119.0, 112.0, 111.0, 110.0, 122.0, 108.0, 121.0, 93.0, 79.0, 185.0, 179.0, 225.0, 500.0, 169.0, 281.0, 171.0, 304.0, 293.0, 213.0, 393.0, 283.0, 307.0, 500.0, 500.0, 500.0, 238.0, 259.0, 479.0, 323.0, 143.0, 123.0, 240.0, 139.0, 112.0, 100.0, 106.0, 87.0, 107.0, 124.0, 500.0, 119.0, 185.0, 73.0, 177.0, 178.0, 500.0, 159.0, 189.0, 139.0, 130.0, 114.0, 156.0, 121.0, 181.0, 108.0, 52.0, 94.0, 89.0, 27.0, 99.0, 28.0, 104.0, 139.0, 115.0, 132.0, 29.0, 14.0, 15.0, 21.0, 37.0, 21.0, 91.0, 89.0, 19.0, 90.0, 28.0, 42.0, 19.0, 89.0, 22.0, 17.0, 23.0, 90.0, 91.0, 95.0, 92.0, 91.0, 22.0, 103.0, 108.0, 102.0, 100.0, 104.0, 107.0, 114.0], "episode_lengths": [148, 500, 13, 266, 113, 119, 112, 111, 110, 122, 108, 121, 93, 79, 185, 179, 225, 500, 169, 281, 171, 304, 293, 213, 393, 283, 307, 500, 500, 500, 238, 259, 479, 323, 143, 123, 240, 139, 112, 100, 106, 87, 107, 124, 500, 119, 185, 73, 177, 178, 500, 159, 189, 139, 130, 114, 156, 121, 181, 108, 52, 94, 89, 27, 99, 28, 104, 139, 115, 132, 29, 14, 15, 21, 37, 21, 91, 89, 19, 90, 28, 42, 19, 89, 22, 17, 23, 90, 91, 95, 92, 91, 22, 103, 108, 102, 100, 104, 107, 114], "policy_default_policy_reward": [148.0, 500.0, 13.0, 266.0, 113.0, 119.0, 112.0, 111.0, 110.0, 122.0, 108.0, 121.0, 93.0, 79.0, 185.0, 179.0, 225.0, 500.0, 169.0, 281.0, 171.0, 304.0, 293.0, 213.0, 393.0, 283.0, 307.0, 500.0, 500.0, 500.0, 238.0, 259.0, 479.0, 323.0, 143.0, 123.0, 240.0, 139.0, 112.0, 100.0, 106.0, 87.0, 107.0, 124.0, 500.0, 119.0, 185.0, 73.0, 177.0, 178.0, 500.0, 159.0, 189.0, 139.0, 130.0, 114.0, 156.0, 121.0, 181.0, 108.0, 52.0, 94.0, 89.0, 27.0, 99.0, 28.0, 104.0, 139.0, 115.0, 132.0, 29.0, 14.0, 15.0, 21.0, 37.0, 21.0, 91.0, 89.0, 19.0, 90.0, 28.0, 42.0, 19.0, 89.0, 22.0, 17.0, 23.0, 90.0, 91.0, 95.0, 92.0, 91.0, 22.0, 103.0, 108.0, 102.0, 100.0, 104.0, 107.0, 114.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.001324434886577, "mean_inference_ms": 1.9997963451674234, "mean_action_processing_ms": 0.23274598042751904, "mean_env_wait_ms": 0.10031222646537902, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016169071197509766, "StateBufferConnector_ms": 0.014445304870605469, "ViewRequirementAgentConnector_ms": 0.17954421043395996}, "num_episodes": 10, "episode_return_max": 500.0, "episode_return_min": 13.0, "episode_return_mean": 153.91, "episodes_this_iter": 10}, "num_healthy_workers": 0, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 45000, "num_agent_steps_trained": 1408000, "num_env_steps_sampled": 45000, "num_env_steps_trained": 1408000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 31.77153062079374, "num_env_steps_trained_throughput_per_sec": 1016.6889798653997, "timesteps_total": 45000, "num_env_steps_sampled_lifetime": 45000, "num_agent_steps_sampled_lifetime": 45000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 45000, "timers": {"training_iteration_time_ms": 29421.817, "restore_workers_time_ms": 0.02, "training_step_time_ms": 30.9, "sample_time_ms": 3.805, "load_time_ms": 0.229, "load_throughput": 139490.468, "learn_time_ms": 12.703, "learn_throughput": 2519.045, "synch_weights_time_ms": 0.058}, "counters": {"num_env_steps_sampled": 45000, "num_env_steps_trained": 1408000, "num_agent_steps_sampled": 45000, "num_agent_steps_trained": 1408000, "last_target_update_ts": 44501, "num_target_updates": 88}, "done": false, "training_iteration": 45, "trial_id": "5ce16_00000", "date": "2024-09-27_11-14-34", "timestamp": 1727406874, "time_this_iter_s": 31.476430892944336, "time_total_s": 1378.7064995765686, "pid": 39427, "hostname": "gpu2gate1", "node_ip": "10.64.32.126", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.9828407522030984, "lr": 0.0007583973879008875, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f52e4d75580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1378.7064995765686, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 11.702272727272726, "ram_util_percent": 9.795454545454547}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5150040984153748, "mean_q": 38.08677673339844, "min_q": -0.06562793254852295, "max_q": 49.43406295776367, "cur_lr": 0.0007583973879008875}, "td_error": [-1.303110122680664, -6.544551849365234, 0.18955612182617188, 0.02738189697265625, 0.1085052490234375, 0.2726325988769531, -1.7931137084960938, -0.00579833984375, 0.3255271911621094, -0.09309005737304688, 0.006015777587890625, 0.15240859985351562, -1.065627932548523, -0.22322845458984375, 0.04279327392578125, 0.07732391357421875, 0.223236083984375, 0.24056625366210938, 0.26436614990234375, 0.16091156005859375, -0.22038841247558594, 0.2999687194824219, -0.11731719970703125, 0.353302001953125, 0.09073257446289062, 0.3300285339355469, 0.04920196533203125, -0.11546707153320312, 4.8543596267700195, -0.16162109375, -1.1074862480163574, 0.09166336059570312], "mean_td_error": -0.14344747364521027, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 45000.0, "diff_num_grad_updates_vs_sampler_policy": 22587.65625}}, "num_env_steps_sampled": 46000, "num_env_steps_trained": 1440000, "num_agent_steps_sampled": 46000, "num_agent_steps_trained": 1440000, "last_target_update_ts": 45501, "num_target_updates": 90}, "env_runners": {"episode_reward_max": 500.0, "episode_reward_min": 13.0, "episode_reward_mean": 153.52, "episode_len_mean": 153.52, "episode_media": {}, "episodes_timesteps_total": 15352, "policy_reward_min": {"default_policy": 13.0}, "policy_reward_max": {"default_policy": 500.0}, "policy_reward_mean": {"default_policy": 153.52}, "custom_metrics": {}, "hist_stats": {"episode_reward": [13.0, 266.0, 113.0, 119.0, 112.0, 111.0, 110.0, 122.0, 108.0, 121.0, 93.0, 79.0, 185.0, 179.0, 225.0, 500.0, 169.0, 281.0, 171.0, 304.0, 293.0, 213.0, 393.0, 283.0, 307.0, 500.0, 500.0, 500.0, 238.0, 259.0, 479.0, 323.0, 143.0, 123.0, 240.0, 139.0, 112.0, 100.0, 106.0, 87.0, 107.0, 124.0, 500.0, 119.0, 185.0, 73.0, 177.0, 178.0, 500.0, 159.0, 189.0, 139.0, 130.0, 114.0, 156.0, 121.0, 181.0, 108.0, 52.0, 94.0, 89.0, 27.0, 99.0, 28.0, 104.0, 139.0, 115.0, 132.0, 29.0, 14.0, 15.0, 21.0, 37.0, 21.0, 91.0, 89.0, 19.0, 90.0, 28.0, 42.0, 19.0, 89.0, 22.0, 17.0, 23.0, 90.0, 91.0, 95.0, 92.0, 91.0, 22.0, 103.0, 108.0, 102.0, 100.0, 104.0, 107.0, 114.0, 109.0, 500.0], "episode_lengths": [13, 266, 113, 119, 112, 111, 110, 122, 108, 121, 93, 79, 185, 179, 225, 500, 169, 281, 171, 304, 293, 213, 393, 283, 307, 500, 500, 500, 238, 259, 479, 323, 143, 123, 240, 139, 112, 100, 106, 87, 107, 124, 500, 119, 185, 73, 177, 178, 500, 159, 189, 139, 130, 114, 156, 121, 181, 108, 52, 94, 89, 27, 99, 28, 104, 139, 115, 132, 29, 14, 15, 21, 37, 21, 91, 89, 19, 90, 28, 42, 19, 89, 22, 17, 23, 90, 91, 95, 92, 91, 22, 103, 108, 102, 100, 104, 107, 114, 109, 500], "policy_default_policy_reward": [13.0, 266.0, 113.0, 119.0, 112.0, 111.0, 110.0, 122.0, 108.0, 121.0, 93.0, 79.0, 185.0, 179.0, 225.0, 500.0, 169.0, 281.0, 171.0, 304.0, 293.0, 213.0, 393.0, 283.0, 307.0, 500.0, 500.0, 500.0, 238.0, 259.0, 479.0, 323.0, 143.0, 123.0, 240.0, 139.0, 112.0, 100.0, 106.0, 87.0, 107.0, 124.0, 500.0, 119.0, 185.0, 73.0, 177.0, 178.0, 500.0, 159.0, 189.0, 139.0, 130.0, 114.0, 156.0, 121.0, 181.0, 108.0, 52.0, 94.0, 89.0, 27.0, 99.0, 28.0, 104.0, 139.0, 115.0, 132.0, 29.0, 14.0, 15.0, 21.0, 37.0, 21.0, 91.0, 89.0, 19.0, 90.0, 28.0, 42.0, 19.0, 89.0, 22.0, 17.0, 23.0, 90.0, 91.0, 95.0, 92.0, 91.0, 22.0, 103.0, 108.0, 102.0, 100.0, 104.0, 107.0, 114.0, 109.0, 500.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0008341469791178, "mean_inference_ms": 1.9990023840176065, "mean_action_processing_ms": 0.23264143847186133, "mean_env_wait_ms": 0.10025536079174302, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016227245330810547, "StateBufferConnector_ms": 0.014480829238891602, "ViewRequirementAgentConnector_ms": 0.18019771575927734}, "num_episodes": 2, "episode_return_max": 500.0, "episode_return_min": 13.0, "episode_return_mean": 153.52, "episodes_this_iter": 2}, "num_healthy_workers": 0, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 46000, "num_agent_steps_trained": 1440000, "num_env_steps_sampled": 46000, "num_env_steps_trained": 1440000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 29.874384823875417, "num_env_steps_trained_throughput_per_sec": 955.9803143640133, "timesteps_total": 46000, "num_env_steps_sampled_lifetime": 46000, "num_agent_steps_sampled_lifetime": 46000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 46000, "timers": {"training_iteration_time_ms": 29765.478, "restore_workers_time_ms": 0.021, "training_step_time_ms": 35.276, "sample_time_ms": 4.212, "load_time_ms": 0.237, "load_throughput": 135014.312, "learn_time_ms": 14.498, "learn_throughput": 2207.223, "synch_weights_time_ms": 0.051}, "counters": {"num_env_steps_sampled": 46000, "num_env_steps_trained": 1440000, "num_agent_steps_sampled": 46000, "num_agent_steps_trained": 1440000, "last_target_update_ts": 45501, "num_target_updates": 90}, "done": false, "training_iteration": 46, "trial_id": "5ce16_00000", "date": "2024-09-27_11-15-07", "timestamp": 1727406907, "time_this_iter_s": 33.475377798080444, "time_total_s": 1412.181877374649, "pid": 39427, "hostname": "gpu2gate1", "node_ip": "10.64.32.126", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.9828407522030984, "lr": 0.0007583973879008875, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f52e4d75580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1412.181877374649, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 11.826086956521737, "ram_util_percent": 9.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6416491866111755, "mean_q": 35.22731399536133, "min_q": 4.114779472351074, "max_q": 49.730037689208984, "cur_lr": 0.0007583973879008875}, "td_error": [-0.08763504028320312, -5.420299530029297, -0.177642822265625, 0.3628273010253906, -0.3294868469238281, -0.1997828483581543, 3.114779472351074, 3.5751001834869385, -0.9580612182617188, -0.16157150268554688, -0.272857666015625, -0.5567665100097656, 6.557588577270508, 0.00716400146484375, -0.115264892578125, 0.1319580078125, -5.3303375244140625, 0.2565765380859375, 34.3084831237793, -0.2914695739746094, 3.4759979248046875, -0.20546817779541016, -0.48366546630859375, -0.5848121643066406, 0.22387313842773438, 41.334320068359375, -0.4811820983886719, -0.5219535827636719, -2.2183265686035156, 0.22879409790039062, 0.730316162109375, -0.05748748779296875], "mean_td_error": 2.3704280853271484, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 46000.0, "diff_num_grad_updates_vs_sampler_policy": 22845.03125}}, "num_env_steps_sampled": 47000, "num_env_steps_trained": 1472000, "num_agent_steps_sampled": 47000, "num_agent_steps_trained": 1472000, "last_target_update_ts": 46501, "num_target_updates": 92}, "env_runners": {"episode_reward_max": 500.0, "episode_reward_min": 14.0, "episode_reward_mean": 160.5, "episode_len_mean": 160.5, "episode_media": {}, "episodes_timesteps_total": 16050, "policy_reward_min": {"default_policy": 14.0}, "policy_reward_max": {"default_policy": 500.0}, "policy_reward_mean": {"default_policy": 160.5}, "custom_metrics": {}, "hist_stats": {"episode_reward": [119.0, 112.0, 111.0, 110.0, 122.0, 108.0, 121.0, 93.0, 79.0, 185.0, 179.0, 225.0, 500.0, 169.0, 281.0, 171.0, 304.0, 293.0, 213.0, 393.0, 283.0, 307.0, 500.0, 500.0, 500.0, 238.0, 259.0, 479.0, 323.0, 143.0, 123.0, 240.0, 139.0, 112.0, 100.0, 106.0, 87.0, 107.0, 124.0, 500.0, 119.0, 185.0, 73.0, 177.0, 178.0, 500.0, 159.0, 189.0, 139.0, 130.0, 114.0, 156.0, 121.0, 181.0, 108.0, 52.0, 94.0, 89.0, 27.0, 99.0, 28.0, 104.0, 139.0, 115.0, 132.0, 29.0, 14.0, 15.0, 21.0, 37.0, 21.0, 91.0, 89.0, 19.0, 90.0, 28.0, 42.0, 19.0, 89.0, 22.0, 17.0, 23.0, 90.0, 91.0, 95.0, 92.0, 91.0, 22.0, 103.0, 108.0, 102.0, 100.0, 104.0, 107.0, 114.0, 109.0, 500.0, 500.0, 411.0, 179.0], "episode_lengths": [119, 112, 111, 110, 122, 108, 121, 93, 79, 185, 179, 225, 500, 169, 281, 171, 304, 293, 213, 393, 283, 307, 500, 500, 500, 238, 259, 479, 323, 143, 123, 240, 139, 112, 100, 106, 87, 107, 124, 500, 119, 185, 73, 177, 178, 500, 159, 189, 139, 130, 114, 156, 121, 181, 108, 52, 94, 89, 27, 99, 28, 104, 139, 115, 132, 29, 14, 15, 21, 37, 21, 91, 89, 19, 90, 28, 42, 19, 89, 22, 17, 23, 90, 91, 95, 92, 91, 22, 103, 108, 102, 100, 104, 107, 114, 109, 500, 500, 411, 179], "policy_default_policy_reward": [119.0, 112.0, 111.0, 110.0, 122.0, 108.0, 121.0, 93.0, 79.0, 185.0, 179.0, 225.0, 500.0, 169.0, 281.0, 171.0, 304.0, 293.0, 213.0, 393.0, 283.0, 307.0, 500.0, 500.0, 500.0, 238.0, 259.0, 479.0, 323.0, 143.0, 123.0, 240.0, 139.0, 112.0, 100.0, 106.0, 87.0, 107.0, 124.0, 500.0, 119.0, 185.0, 73.0, 177.0, 178.0, 500.0, 159.0, 189.0, 139.0, 130.0, 114.0, 156.0, 121.0, 181.0, 108.0, 52.0, 94.0, 89.0, 27.0, 99.0, 28.0, 104.0, 139.0, 115.0, 132.0, 29.0, 14.0, 15.0, 21.0, 37.0, 21.0, 91.0, 89.0, 19.0, 90.0, 28.0, 42.0, 19.0, 89.0, 22.0, 17.0, 23.0, 90.0, 91.0, 95.0, 92.0, 91.0, 22.0, 103.0, 108.0, 102.0, 100.0, 104.0, 107.0, 114.0, 109.0, 500.0, 500.0, 411.0, 179.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.000128860821303, "mean_inference_ms": 1.9978139579350886, "mean_action_processing_ms": 0.23249043114989096, "mean_env_wait_ms": 0.10017683845781594, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0162961483001709, "StateBufferConnector_ms": 0.014566898345947266, "ViewRequirementAgentConnector_ms": 0.18154358863830566}, "num_episodes": 3, "episode_return_max": 500.0, "episode_return_min": 14.0, "episode_return_mean": 160.5, "episodes_this_iter": 3}, "num_healthy_workers": 0, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 47000, "num_agent_steps_trained": 1472000, "num_env_steps_sampled": 47000, "num_env_steps_trained": 1472000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 31.216075491760265, "num_env_steps_trained_throughput_per_sec": 998.9144157363285, "timesteps_total": 47000, "num_env_steps_sampled_lifetime": 47000, "num_agent_steps_sampled_lifetime": 47000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 47000, "timers": {"training_iteration_time_ms": 29767.437, "restore_workers_time_ms": 0.023, "training_step_time_ms": 32.094, "sample_time_ms": 3.958, "load_time_ms": 0.242, "load_throughput": 132429.924, "learn_time_ms": 13.209, "learn_throughput": 2422.672, "synch_weights_time_ms": 0.054}, "counters": {"num_env_steps_sampled": 47000, "num_env_steps_trained": 1472000, "num_agent_steps_sampled": 47000, "num_agent_steps_trained": 1472000, "last_target_update_ts": 46501, "num_target_updates": 92}, "done": false, "training_iteration": 47, "trial_id": "5ce16_00000", "date": "2024-09-27_11-15-39", "timestamp": 1727406939, "time_this_iter_s": 32.036519289016724, "time_total_s": 1444.2183966636658, "pid": 39427, "hostname": "gpu2gate1", "node_ip": "10.64.32.126", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.9828407522030984, "lr": 0.0007583973879008875, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f52e4d75580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1444.2183966636658, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 11.591304347826087, "ram_util_percent": 9.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3346600830554962, "mean_q": 33.22217559814453, "min_q": 1.9082279205322266, "max_q": 50.241737365722656, "cur_lr": 0.0007583973879008875}, "td_error": [-0.33831787109375, 0.16076946258544922, -1.1011848449707031, -0.14459228515625, 0.2730140686035156, -0.3487739562988281, -0.9841175079345703, 0.6878490447998047, -0.2822380065917969, 0.20548248291015625, 0.11844635009765625, 1.53580904006958, -0.019390106201171875, -3.1965560913085938, 4.303553104400635, -0.09951019287109375, 1.2529399394989014, -0.2774314880371094, -0.07249832153320312, 0.018703460693359375, 0.056552886962890625, 0.0100250244140625, -0.38152503967285156, 0.07744216918945312, -0.3746757507324219, 0.17480850219726562, 0.24200439453125, -0.09648513793945312, 0.262603759765625, -0.49550819396972656, -0.05496549606323242, 0.30047035217285156], "mean_td_error": 0.04414699226617813, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 47000.0, "diff_num_grad_updates_vs_sampler_policy": 29828.03125}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 1504000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 1504000, "last_target_update_ts": 47501, "num_target_updates": 94}, "env_runners": {"episode_reward_max": 500.0, "episode_reward_min": 14.0, "episode_reward_mean": 165.62, "episode_len_mean": 165.62, "episode_media": {}, "episodes_timesteps_total": 16562, "policy_reward_min": {"default_policy": 14.0}, "policy_reward_max": {"default_policy": 500.0}, "policy_reward_mean": {"default_policy": 165.62}, "custom_metrics": {}, "hist_stats": {"episode_reward": [93.0, 79.0, 185.0, 179.0, 225.0, 500.0, 169.0, 281.0, 171.0, 304.0, 293.0, 213.0, 393.0, 283.0, 307.0, 500.0, 500.0, 500.0, 238.0, 259.0, 479.0, 323.0, 143.0, 123.0, 240.0, 139.0, 112.0, 100.0, 106.0, 87.0, 107.0, 124.0, 500.0, 119.0, 185.0, 73.0, 177.0, 178.0, 500.0, 159.0, 189.0, 139.0, 130.0, 114.0, 156.0, 121.0, 181.0, 108.0, 52.0, 94.0, 89.0, 27.0, 99.0, 28.0, 104.0, 139.0, 115.0, 132.0, 29.0, 14.0, 15.0, 21.0, 37.0, 21.0, 91.0, 89.0, 19.0, 90.0, 28.0, 42.0, 19.0, 89.0, 22.0, 17.0, 23.0, 90.0, 91.0, 95.0, 92.0, 91.0, 22.0, 103.0, 108.0, 102.0, 100.0, 104.0, 107.0, 114.0, 109.0, 500.0, 500.0, 411.0, 179.0, 427.0, 129.0, 122.0, 110.0, 136.0, 216.0, 175.0], "episode_lengths": [93, 79, 185, 179, 225, 500, 169, 281, 171, 304, 293, 213, 393, 283, 307, 500, 500, 500, 238, 259, 479, 323, 143, 123, 240, 139, 112, 100, 106, 87, 107, 124, 500, 119, 185, 73, 177, 178, 500, 159, 189, 139, 130, 114, 156, 121, 181, 108, 52, 94, 89, 27, 99, 28, 104, 139, 115, 132, 29, 14, 15, 21, 37, 21, 91, 89, 19, 90, 28, 42, 19, 89, 22, 17, 23, 90, 91, 95, 92, 91, 22, 103, 108, 102, 100, 104, 107, 114, 109, 500, 500, 411, 179, 427, 129, 122, 110, 136, 216, 175], "policy_default_policy_reward": [93.0, 79.0, 185.0, 179.0, 225.0, 500.0, 169.0, 281.0, 171.0, 304.0, 293.0, 213.0, 393.0, 283.0, 307.0, 500.0, 500.0, 500.0, 238.0, 259.0, 479.0, 323.0, 143.0, 123.0, 240.0, 139.0, 112.0, 100.0, 106.0, 87.0, 107.0, 124.0, 500.0, 119.0, 185.0, 73.0, 177.0, 178.0, 500.0, 159.0, 189.0, 139.0, 130.0, 114.0, 156.0, 121.0, 181.0, 108.0, 52.0, 94.0, 89.0, 27.0, 99.0, 28.0, 104.0, 139.0, 115.0, 132.0, 29.0, 14.0, 15.0, 21.0, 37.0, 21.0, 91.0, 89.0, 19.0, 90.0, 28.0, 42.0, 19.0, 89.0, 22.0, 17.0, 23.0, 90.0, 91.0, 95.0, 92.0, 91.0, 22.0, 103.0, 108.0, 102.0, 100.0, 104.0, 107.0, 114.0, 109.0, 500.0, 500.0, 411.0, 179.0, 427.0, 129.0, 122.0, 110.0, 136.0, 216.0, 175.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9985076976018599, "mean_inference_ms": 1.9949448016490736, "mean_action_processing_ms": 0.23215302187205375, "mean_env_wait_ms": 0.1000024184996244, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016605377197265625, "StateBufferConnector_ms": 0.014691591262817383, "ViewRequirementAgentConnector_ms": 0.18416595458984375}, "num_episodes": 7, "episode_return_max": 500.0, "episode_return_min": 14.0, "episode_return_mean": 165.62, "episodes_this_iter": 7}, "num_healthy_workers": 0, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 1504000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 1504000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 31.27692746221305, "num_env_steps_trained_throughput_per_sec": 1000.8616787908176, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 29982.883, "restore_workers_time_ms": 0.022, "training_step_time_ms": 30.705, "sample_time_ms": 3.607, "load_time_ms": 0.2, "load_throughput": 160183.468, "learn_time_ms": 12.724, "learn_throughput": 2514.882, "synch_weights_time_ms": 0.046}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 1504000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 1504000, "last_target_update_ts": 47501, "num_target_updates": 94}, "done": false, "training_iteration": 48, "trial_id": "5ce16_00000", "date": "2024-09-27_11-16-12", "timestamp": 1727406972, "time_this_iter_s": 31.97455620765686, "time_total_s": 1476.1929528713226, "pid": 39427, "hostname": "gpu2gate1", "node_ip": "10.64.32.126", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.9828407522030984, "lr": 0.0007583973879008875, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f52e4d75580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1476.1929528713226, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 11.693333333333332, "ram_util_percent": 9.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4948911964893341, "mean_q": 35.028812408447266, "min_q": 3.5850250720977783, "max_q": 50.57916259765625, "cur_lr": 0.0007583973879008875}, "td_error": [0.19294357299804688, 2.7406165599823, -0.12366485595703125, -0.948523998260498, 0.3109550476074219, -0.016620635986328125, -5.557929992675781, -0.053009033203125, 0.00676727294921875, -0.30103111267089844, -0.41124725341796875, 0.05007171630859375, -0.10142230987548828, -0.07150650024414062, 0.18598175048828125, 0.30572509765625, -1.0359220504760742, 0.30434417724609375, 0.14383316040039062, -0.035297393798828125, -0.18075180053710938, -0.3874835968017578, 0.4205207824707031, 3.065023422241211, 1.0106163024902344, -0.000179290771484375, -1.0491604804992676, 0.6607513427734375, 2.0383753776550293, 0.0402679443359375, 0.13581085205078125, 0.27567481994628906], "mean_td_error": 0.0504540279507637, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 48000.0, "diff_num_grad_updates_vs_sampler_policy": 22977.0}}, "num_env_steps_sampled": 49000, "num_env_steps_trained": 1536000, "num_agent_steps_sampled": 49000, "num_agent_steps_trained": 1536000, "last_target_update_ts": 48501, "num_target_updates": 96}, "env_runners": {"episode_reward_max": 500.0, "episode_reward_min": 14.0, "episode_reward_mean": 170.16, "episode_len_mean": 170.16, "episode_media": {}, "episodes_timesteps_total": 17016, "policy_reward_min": {"default_policy": 14.0}, "policy_reward_max": {"default_policy": 500.0}, "policy_reward_mean": {"default_policy": 170.16}, "custom_metrics": {}, "hist_stats": {"episode_reward": [179.0, 225.0, 500.0, 169.0, 281.0, 171.0, 304.0, 293.0, 213.0, 393.0, 283.0, 307.0, 500.0, 500.0, 500.0, 238.0, 259.0, 479.0, 323.0, 143.0, 123.0, 240.0, 139.0, 112.0, 100.0, 106.0, 87.0, 107.0, 124.0, 500.0, 119.0, 185.0, 73.0, 177.0, 178.0, 500.0, 159.0, 189.0, 139.0, 130.0, 114.0, 156.0, 121.0, 181.0, 108.0, 52.0, 94.0, 89.0, 27.0, 99.0, 28.0, 104.0, 139.0, 115.0, 132.0, 29.0, 14.0, 15.0, 21.0, 37.0, 21.0, 91.0, 89.0, 19.0, 90.0, 28.0, 42.0, 19.0, 89.0, 22.0, 17.0, 23.0, 90.0, 91.0, 95.0, 92.0, 91.0, 22.0, 103.0, 108.0, 102.0, 100.0, 104.0, 107.0, 114.0, 109.0, 500.0, 500.0, 411.0, 179.0, 427.0, 129.0, 122.0, 110.0, 136.0, 216.0, 175.0, 159.0, 499.0, 153.0], "episode_lengths": [179, 225, 500, 169, 281, 171, 304, 293, 213, 393, 283, 307, 500, 500, 500, 238, 259, 479, 323, 143, 123, 240, 139, 112, 100, 106, 87, 107, 124, 500, 119, 185, 73, 177, 178, 500, 159, 189, 139, 130, 114, 156, 121, 181, 108, 52, 94, 89, 27, 99, 28, 104, 139, 115, 132, 29, 14, 15, 21, 37, 21, 91, 89, 19, 90, 28, 42, 19, 89, 22, 17, 23, 90, 91, 95, 92, 91, 22, 103, 108, 102, 100, 104, 107, 114, 109, 500, 500, 411, 179, 427, 129, 122, 110, 136, 216, 175, 159, 499, 153], "policy_default_policy_reward": [179.0, 225.0, 500.0, 169.0, 281.0, 171.0, 304.0, 293.0, 213.0, 393.0, 283.0, 307.0, 500.0, 500.0, 500.0, 238.0, 259.0, 479.0, 323.0, 143.0, 123.0, 240.0, 139.0, 112.0, 100.0, 106.0, 87.0, 107.0, 124.0, 500.0, 119.0, 185.0, 73.0, 177.0, 178.0, 500.0, 159.0, 189.0, 139.0, 130.0, 114.0, 156.0, 121.0, 181.0, 108.0, 52.0, 94.0, 89.0, 27.0, 99.0, 28.0, 104.0, 139.0, 115.0, 132.0, 29.0, 14.0, 15.0, 21.0, 37.0, 21.0, 91.0, 89.0, 19.0, 90.0, 28.0, 42.0, 19.0, 89.0, 22.0, 17.0, 23.0, 90.0, 91.0, 95.0, 92.0, 91.0, 22.0, 103.0, 108.0, 102.0, 100.0, 104.0, 107.0, 114.0, 109.0, 500.0, 500.0, 411.0, 179.0, 427.0, 129.0, 122.0, 110.0, 136.0, 216.0, 175.0, 159.0, 499.0, 153.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9978198807299326, "mean_inference_ms": 1.9936583724536758, "mean_action_processing_ms": 0.2320106694751553, "mean_env_wait_ms": 0.09993179539070095, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01652836799621582, "StateBufferConnector_ms": 0.014643192291259766, "ViewRequirementAgentConnector_ms": 0.18410849571228027}, "num_episodes": 3, "episode_return_max": 500.0, "episode_return_min": 14.0, "episode_return_mean": 170.16, "episodes_this_iter": 3}, "num_healthy_workers": 0, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 49000, "num_agent_steps_trained": 1536000, "num_env_steps_sampled": 49000, "num_env_steps_trained": 1536000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 31.209790961122465, "num_env_steps_trained_throughput_per_sec": 998.7133107559189, "timesteps_total": 49000, "num_env_steps_sampled_lifetime": 49000, "num_agent_steps_sampled_lifetime": 49000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 49000, "timers": {"training_iteration_time_ms": 30399.869, "restore_workers_time_ms": 0.03, "training_step_time_ms": 33.499, "sample_time_ms": 4.046, "load_time_ms": 0.227, "load_throughput": 141088.75, "learn_time_ms": 13.995, "learn_throughput": 2286.542, "synch_weights_time_ms": 0.047}, "counters": {"num_env_steps_sampled": 49000, "num_env_steps_trained": 1536000, "num_agent_steps_sampled": 49000, "num_agent_steps_trained": 1536000, "last_target_update_ts": 48501, "num_target_updates": 96}, "done": false, "training_iteration": 49, "trial_id": "5ce16_00000", "date": "2024-09-27_11-16-44", "timestamp": 1727407004, "time_this_iter_s": 32.043049335479736, "time_total_s": 1508.2360022068024, "pid": 39427, "hostname": "gpu2gate1", "node_ip": "10.64.32.126", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.9828407522030984, "lr": 0.0007583973879008875, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f52e4d75580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1508.2360022068024, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 11.617777777777777, "ram_util_percent": 9.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6015498638153076, "mean_q": 39.47321701049805, "min_q": 1.305774211883545, "max_q": 52.750282287597656, "cur_lr": 0.0007583973879008875}, "td_error": [0.3057742118835449, -0.28919219970703125, 0.14703369140625, -0.13156890869140625, -0.15076446533203125, 0.037769317626953125, 1.5908622741699219, 5.782319068908691, 0.11895751953125, -0.5116539001464844, -0.23773193359375, -0.5886955261230469, 0.2865791320800781, 0.3652381896972656, 0.4376506805419922, -0.07754898071289062, 1.2731904983520508, -5.999565124511719, -0.2947540283203125, 8.636566162109375, 1.6754646301269531, 0.25914764404296875, 0.16951751708984375, 44.69841003417969, 0.9955182075500488, 1.2263717651367188, -0.19174575805664062, 0.014614105224609375, -0.1311492919921875, 7.990123748779297, -0.199920654296875, 1.5257911682128906], "mean_td_error": 2.1478939056396484, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 49000.0, "diff_num_grad_updates_vs_sampler_policy": 26163.53125}}, "num_env_steps_sampled": 50000, "num_env_steps_trained": 1568000, "num_agent_steps_sampled": 50000, "num_agent_steps_trained": 1568000, "last_target_update_ts": 49501, "num_target_updates": 98}, "env_runners": {"episode_reward_max": 500.0, "episode_reward_min": 14.0, "episode_reward_mean": 168.31, "episode_len_mean": 168.31, "episode_media": {}, "episodes_timesteps_total": 16831, "policy_reward_min": {"default_policy": 14.0}, "policy_reward_max": {"default_policy": 500.0}, "policy_reward_mean": {"default_policy": 168.31}, "custom_metrics": {}, "hist_stats": {"episode_reward": [281.0, 171.0, 304.0, 293.0, 213.0, 393.0, 283.0, 307.0, 500.0, 500.0, 500.0, 238.0, 259.0, 479.0, 323.0, 143.0, 123.0, 240.0, 139.0, 112.0, 100.0, 106.0, 87.0, 107.0, 124.0, 500.0, 119.0, 185.0, 73.0, 177.0, 178.0, 500.0, 159.0, 189.0, 139.0, 130.0, 114.0, 156.0, 121.0, 181.0, 108.0, 52.0, 94.0, 89.0, 27.0, 99.0, 28.0, 104.0, 139.0, 115.0, 132.0, 29.0, 14.0, 15.0, 21.0, 37.0, 21.0, 91.0, 89.0, 19.0, 90.0, 28.0, 42.0, 19.0, 89.0, 22.0, 17.0, 23.0, 90.0, 91.0, 95.0, 92.0, 91.0, 22.0, 103.0, 108.0, 102.0, 100.0, 104.0, 107.0, 114.0, 109.0, 500.0, 500.0, 411.0, 179.0, 427.0, 129.0, 122.0, 110.0, 136.0, 216.0, 175.0, 159.0, 499.0, 153.0, 500.0, 124.0, 132.0, 132.0], "episode_lengths": [281, 171, 304, 293, 213, 393, 283, 307, 500, 500, 500, 238, 259, 479, 323, 143, 123, 240, 139, 112, 100, 106, 87, 107, 124, 500, 119, 185, 73, 177, 178, 500, 159, 189, 139, 130, 114, 156, 121, 181, 108, 52, 94, 89, 27, 99, 28, 104, 139, 115, 132, 29, 14, 15, 21, 37, 21, 91, 89, 19, 90, 28, 42, 19, 89, 22, 17, 23, 90, 91, 95, 92, 91, 22, 103, 108, 102, 100, 104, 107, 114, 109, 500, 500, 411, 179, 427, 129, 122, 110, 136, 216, 175, 159, 499, 153, 500, 124, 132, 132], "policy_default_policy_reward": [281.0, 171.0, 304.0, 293.0, 213.0, 393.0, 283.0, 307.0, 500.0, 500.0, 500.0, 238.0, 259.0, 479.0, 323.0, 143.0, 123.0, 240.0, 139.0, 112.0, 100.0, 106.0, 87.0, 107.0, 124.0, 500.0, 119.0, 185.0, 73.0, 177.0, 178.0, 500.0, 159.0, 189.0, 139.0, 130.0, 114.0, 156.0, 121.0, 181.0, 108.0, 52.0, 94.0, 89.0, 27.0, 99.0, 28.0, 104.0, 139.0, 115.0, 132.0, 29.0, 14.0, 15.0, 21.0, 37.0, 21.0, 91.0, 89.0, 19.0, 90.0, 28.0, 42.0, 19.0, 89.0, 22.0, 17.0, 23.0, 90.0, 91.0, 95.0, 92.0, 91.0, 22.0, 103.0, 108.0, 102.0, 100.0, 104.0, 107.0, 114.0, 109.0, 500.0, 500.0, 411.0, 179.0, 427.0, 129.0, 122.0, 110.0, 136.0, 216.0, 175.0, 159.0, 499.0, 153.0, 500.0, 124.0, 132.0, 132.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9969584829106745, "mean_inference_ms": 1.9919579539475019, "mean_action_processing_ms": 0.23183154669397865, "mean_env_wait_ms": 0.09984799527934055, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016602039337158203, "StateBufferConnector_ms": 0.014699697494506836, "ViewRequirementAgentConnector_ms": 0.18486475944519043}, "num_episodes": 4, "episode_return_max": 500.0, "episode_return_min": 14.0, "episode_return_mean": 168.31, "episodes_this_iter": 4}, "num_healthy_workers": 0, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 50000, "num_agent_steps_trained": 1568000, "num_env_steps_sampled": 50000, "num_env_steps_trained": 1568000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 30.56587374572492, "num_env_steps_trained_throughput_per_sec": 978.1079598631975, "timesteps_total": 50000, "num_env_steps_sampled_lifetime": 50000, "num_agent_steps_sampled_lifetime": 50000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 50000, "timers": {"training_iteration_time_ms": 30648.605, "restore_workers_time_ms": 0.02, "training_step_time_ms": 32.195, "sample_time_ms": 3.875, "load_time_ms": 0.232, "load_throughput": 137942.166, "learn_time_ms": 13.222, "learn_throughput": 2420.282, "synch_weights_time_ms": 0.049}, "counters": {"num_env_steps_sampled": 50000, "num_env_steps_trained": 1568000, "num_agent_steps_sampled": 50000, "num_agent_steps_trained": 1568000, "last_target_update_ts": 49501, "num_target_updates": 98}, "done": false, "training_iteration": 50, "trial_id": "5ce16_00000", "date": "2024-09-27_11-17-17", "timestamp": 1727407037, "time_this_iter_s": 32.71808958053589, "time_total_s": 1540.9540917873383, "pid": 39427, "hostname": "gpu2gate1", "node_ip": "10.64.32.126", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.9828407522030984, "lr": 0.0007583973879008875, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f52e4d75580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1540.9540917873383, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 11.597872340425532, "ram_util_percent": 9.800000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.37432557344436646, "mean_q": 44.53903579711914, "min_q": 19.692550659179688, "max_q": 51.50053787231445, "cur_lr": 0.0007583973879008875}, "td_error": [-1.7329750061035156, -0.1341552734375, -0.16413497924804688, 17.54851531982422, 0.5432281494140625, -1.4047908782958984, -0.8712005615234375, -0.15336227416992188, 0.23230743408203125, 0.2000885009765625, 1.2201728820800781, -0.24454116821289062, -0.3401451110839844, -0.14996719360351562, 0.0977783203125, 0.176483154296875, -1.0925540924072266, 0.055328369140625, 0.1083984375, -0.182830810546875, 0.12958526611328125, 0.6427001953125, -0.174896240234375, 0.4261512756347656, 0.39948272705078125, -1.6734638214111328, 0.9695358276367188, 0.1111297607421875, -0.15728378295898438, -0.09381484985351562, -0.16915130615234375, -0.129058837890625], "mean_td_error": 0.4372674822807312, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 50000.0, "diff_num_grad_updates_vs_sampler_policy": 22082.75}}, "num_env_steps_sampled": 51000, "num_env_steps_trained": 1600000, "num_agent_steps_sampled": 51000, "num_agent_steps_trained": 1600000, "last_target_update_ts": 50501, "num_target_updates": 100}, "env_runners": {"episode_reward_max": 500.0, "episode_reward_min": 14.0, "episode_reward_mean": 158.81, "episode_len_mean": 158.81, "episode_media": {}, "episodes_timesteps_total": 15881, "policy_reward_min": {"default_policy": 14.0}, "policy_reward_max": {"default_policy": 500.0}, "policy_reward_mean": {"default_policy": 158.81}, "custom_metrics": {}, "hist_stats": {"episode_reward": [500.0, 500.0, 500.0, 238.0, 259.0, 479.0, 323.0, 143.0, 123.0, 240.0, 139.0, 112.0, 100.0, 106.0, 87.0, 107.0, 124.0, 500.0, 119.0, 185.0, 73.0, 177.0, 178.0, 500.0, 159.0, 189.0, 139.0, 130.0, 114.0, 156.0, 121.0, 181.0, 108.0, 52.0, 94.0, 89.0, 27.0, 99.0, 28.0, 104.0, 139.0, 115.0, 132.0, 29.0, 14.0, 15.0, 21.0, 37.0, 21.0, 91.0, 89.0, 19.0, 90.0, 28.0, 42.0, 19.0, 89.0, 22.0, 17.0, 23.0, 90.0, 91.0, 95.0, 92.0, 91.0, 22.0, 103.0, 108.0, 102.0, 100.0, 104.0, 107.0, 114.0, 109.0, 500.0, 500.0, 411.0, 179.0, 427.0, 129.0, 122.0, 110.0, 136.0, 216.0, 175.0, 159.0, 499.0, 153.0, 500.0, 124.0, 132.0, 132.0, 500.0, 121.0, 111.0, 116.0, 115.0, 115.0, 105.0, 112.0], "episode_lengths": [500, 500, 500, 238, 259, 479, 323, 143, 123, 240, 139, 112, 100, 106, 87, 107, 124, 500, 119, 185, 73, 177, 178, 500, 159, 189, 139, 130, 114, 156, 121, 181, 108, 52, 94, 89, 27, 99, 28, 104, 139, 115, 132, 29, 14, 15, 21, 37, 21, 91, 89, 19, 90, 28, 42, 19, 89, 22, 17, 23, 90, 91, 95, 92, 91, 22, 103, 108, 102, 100, 104, 107, 114, 109, 500, 500, 411, 179, 427, 129, 122, 110, 136, 216, 175, 159, 499, 153, 500, 124, 132, 132, 500, 121, 111, 116, 115, 115, 105, 112], "policy_default_policy_reward": [500.0, 500.0, 500.0, 238.0, 259.0, 479.0, 323.0, 143.0, 123.0, 240.0, 139.0, 112.0, 100.0, 106.0, 87.0, 107.0, 124.0, 500.0, 119.0, 185.0, 73.0, 177.0, 178.0, 500.0, 159.0, 189.0, 139.0, 130.0, 114.0, 156.0, 121.0, 181.0, 108.0, 52.0, 94.0, 89.0, 27.0, 99.0, 28.0, 104.0, 139.0, 115.0, 132.0, 29.0, 14.0, 15.0, 21.0, 37.0, 21.0, 91.0, 89.0, 19.0, 90.0, 28.0, 42.0, 19.0, 89.0, 22.0, 17.0, 23.0, 90.0, 91.0, 95.0, 92.0, 91.0, 22.0, 103.0, 108.0, 102.0, 100.0, 104.0, 107.0, 114.0, 109.0, 500.0, 500.0, 411.0, 179.0, 427.0, 129.0, 122.0, 110.0, 136.0, 216.0, 175.0, 159.0, 499.0, 153.0, 500.0, 124.0, 132.0, 132.0, 500.0, 121.0, 111.0, 116.0, 115.0, 115.0, 105.0, 112.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9955451355502924, "mean_inference_ms": 1.9887462597441763, "mean_action_processing_ms": 0.23152405536446313, "mean_env_wait_ms": 0.09972218862586342, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016686201095581055, "StateBufferConnector_ms": 0.014679908752441406, "ViewRequirementAgentConnector_ms": 0.1865525245666504}, "num_episodes": 8, "episode_return_max": 500.0, "episode_return_min": 14.0, "episode_return_mean": 158.81, "episodes_this_iter": 8}, "num_healthy_workers": 0, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51000, "num_agent_steps_trained": 1600000, "num_env_steps_sampled": 51000, "num_env_steps_trained": 1600000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 29.50355205391142, "num_env_steps_trained_throughput_per_sec": 944.1136657251654, "timesteps_total": 51000, "num_env_steps_sampled_lifetime": 51000, "num_agent_steps_sampled_lifetime": 51000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 51000, "timers": {"training_iteration_time_ms": 31246.088, "restore_workers_time_ms": 0.023, "training_step_time_ms": 35.281, "sample_time_ms": 4.124, "load_time_ms": 0.291, "load_throughput": 109807.517, "learn_time_ms": 14.708, "learn_throughput": 2175.73, "synch_weights_time_ms": 0.056}, "counters": {"num_env_steps_sampled": 51000, "num_env_steps_trained": 1600000, "num_agent_steps_sampled": 51000, "num_agent_steps_trained": 1600000, "last_target_update_ts": 50501, "num_target_updates": 100}, "done": false, "training_iteration": 51, "trial_id": "5ce16_00000", "date": "2024-09-27_11-17-51", "timestamp": 1727407071, "time_this_iter_s": 33.89682221412659, "time_total_s": 1574.8509140014648, "pid": 39427, "hostname": "gpu2gate1", "node_ip": "10.64.32.126", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.9828407522030984, "lr": 0.0007583973879008875, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f52e4d75580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1574.8509140014648, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 11.908333333333331, "ram_util_percent": 9.799999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6014017462730408, "mean_q": 38.239715576171875, "min_q": 8.517590522766113, "max_q": 52.059391021728516, "cur_lr": 0.0007583973879008875}, "td_error": [0.9789505004882812, -0.24526596069335938, 0.058380126953125, -0.06414413452148438, 0.052978515625, -0.23198318481445312, 0.403900146484375, 0.0317535400390625, 0.9746942520141602, 1.8630857467651367, 0.2222900390625, -0.060821533203125, -0.052082061767578125, 7.517590522766113, 0.8512430191040039, -0.06370925903320312, -0.16988754272460938, 0.7755661010742188, 0.19736862182617188, 0.027713775634765625, 6.9747161865234375, 0.14066314697265625, -0.19212055206298828, 10.281473159790039, 0.5741729736328125, 0.21310043334960938, -0.08407974243164062, -0.10416412353515625, 0.040019989013671875, 0.9674034118652344, 0.27988433837890625, -0.5725345611572266], "mean_td_error": 0.9870673418045044, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 51000.0, "diff_num_grad_updates_vs_sampler_policy": 20951.375}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 1632000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 1632000, "last_target_update_ts": 51501, "num_target_updates": 102}, "env_runners": {"episode_reward_max": 500.0, "episode_reward_min": 14.0, "episode_reward_mean": 138.1, "episode_len_mean": 138.1, "episode_media": {}, "episodes_timesteps_total": 13810, "policy_reward_min": {"default_policy": 14.0}, "policy_reward_max": {"default_policy": 500.0}, "policy_reward_mean": {"default_policy": 138.1}, "custom_metrics": {}, "hist_stats": {"episode_reward": [240.0, 139.0, 112.0, 100.0, 106.0, 87.0, 107.0, 124.0, 500.0, 119.0, 185.0, 73.0, 177.0, 178.0, 500.0, 159.0, 189.0, 139.0, 130.0, 114.0, 156.0, 121.0, 181.0, 108.0, 52.0, 94.0, 89.0, 27.0, 99.0, 28.0, 104.0, 139.0, 115.0, 132.0, 29.0, 14.0, 15.0, 21.0, 37.0, 21.0, 91.0, 89.0, 19.0, 90.0, 28.0, 42.0, 19.0, 89.0, 22.0, 17.0, 23.0, 90.0, 91.0, 95.0, 92.0, 91.0, 22.0, 103.0, 108.0, 102.0, 100.0, 104.0, 107.0, 114.0, 109.0, 500.0, 500.0, 411.0, 179.0, 427.0, 129.0, 122.0, 110.0, 136.0, 216.0, 175.0, 159.0, 499.0, 153.0, 500.0, 124.0, 132.0, 132.0, 500.0, 121.0, 111.0, 116.0, 115.0, 115.0, 105.0, 112.0, 117.0, 116.0, 105.0, 106.0, 113.0, 97.0, 117.0, 111.0, 112.0], "episode_lengths": [240, 139, 112, 100, 106, 87, 107, 124, 500, 119, 185, 73, 177, 178, 500, 159, 189, 139, 130, 114, 156, 121, 181, 108, 52, 94, 89, 27, 99, 28, 104, 139, 115, 132, 29, 14, 15, 21, 37, 21, 91, 89, 19, 90, 28, 42, 19, 89, 22, 17, 23, 90, 91, 95, 92, 91, 22, 103, 108, 102, 100, 104, 107, 114, 109, 500, 500, 411, 179, 427, 129, 122, 110, 136, 216, 175, 159, 499, 153, 500, 124, 132, 132, 500, 121, 111, 116, 115, 115, 105, 112, 117, 116, 105, 106, 113, 97, 117, 111, 112], "policy_default_policy_reward": [240.0, 139.0, 112.0, 100.0, 106.0, 87.0, 107.0, 124.0, 500.0, 119.0, 185.0, 73.0, 177.0, 178.0, 500.0, 159.0, 189.0, 139.0, 130.0, 114.0, 156.0, 121.0, 181.0, 108.0, 52.0, 94.0, 89.0, 27.0, 99.0, 28.0, 104.0, 139.0, 115.0, 132.0, 29.0, 14.0, 15.0, 21.0, 37.0, 21.0, 91.0, 89.0, 19.0, 90.0, 28.0, 42.0, 19.0, 89.0, 22.0, 17.0, 23.0, 90.0, 91.0, 95.0, 92.0, 91.0, 22.0, 103.0, 108.0, 102.0, 100.0, 104.0, 107.0, 114.0, 109.0, 500.0, 500.0, 411.0, 179.0, 427.0, 129.0, 122.0, 110.0, 136.0, 216.0, 175.0, 159.0, 499.0, 153.0, 500.0, 124.0, 132.0, 132.0, 500.0, 121.0, 111.0, 116.0, 115.0, 115.0, 105.0, 112.0, 117.0, 116.0, 105.0, 106.0, 113.0, 97.0, 117.0, 111.0, 112.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9945427333854334, "mean_inference_ms": 1.985790843776956, "mean_action_processing_ms": 0.2312903299798193, "mean_env_wait_ms": 0.09964822423138418, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01707601547241211, "StateBufferConnector_ms": 0.014853954315185547, "ViewRequirementAgentConnector_ms": 0.1889808177947998}, "num_episodes": 9, "episode_return_max": 500.0, "episode_return_min": 14.0, "episode_return_mean": 138.1, "episodes_this_iter": 9}, "num_healthy_workers": 0, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 1632000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 1632000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 29.298981991450248, "num_env_steps_trained_throughput_per_sec": 937.5674237264079, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 52000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 31880.948, "restore_workers_time_ms": 0.022, "training_step_time_ms": 34.11, "sample_time_ms": 3.941, "load_time_ms": 0.269, "load_throughput": 118987.348, "learn_time_ms": 14.222, "learn_throughput": 2249.974, "synch_weights_time_ms": 0.05}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 1632000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 1632000, "last_target_update_ts": 51501, "num_target_updates": 102}, "done": false, "training_iteration": 52, "trial_id": "5ce16_00000", "date": "2024-09-27_11-18-25", "timestamp": 1727407105, "time_this_iter_s": 34.13296103477478, "time_total_s": 1608.9838750362396, "pid": 39427, "hostname": "gpu2gate1", "node_ip": "10.64.32.126", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.9828407522030984, "lr": 0.0007583973879008875, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f52e4d75580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1608.9838750362396, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 11.708333333333334, "ram_util_percent": 9.799999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.24509389698505402, "mean_q": 37.62527084350586, "min_q": 0.9407899379730225, "max_q": 52.27347946166992, "cur_lr": 0.0007583973879008875}, "td_error": [-0.3675346374511719, -3.82206130027771, 0.06916427612304688, -0.048320770263671875, 0.330810546875, 0.16618728637695312, 13.205644607543945, -0.1491851806640625, -0.143096923828125, -0.5360984802246094, 2.696476459503174, -0.814422607421875, 0.5348507165908813, 0.22674179077148438, 0.31422996520996094, 0.07323074340820312, -0.22723770141601562, 0.21622848510742188, 7.019552230834961, -0.4819941520690918, 0.25760650634765625, -0.044818878173828125, 1.0684700012207031, -0.506805419921875, -0.06868743896484375, -0.41506004333496094, -1.0983409881591797, -0.2998476028442383, -0.046115875244140625, 0.05792999267578125, 0.27779579162597656, 0.20729446411132812], "mean_td_error": 0.5516432523727417, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 52000.0, "diff_num_grad_updates_vs_sampler_policy": 25864.1875}}, "num_env_steps_sampled": 53000, "num_env_steps_trained": 1664000, "num_agent_steps_sampled": 53000, "num_agent_steps_trained": 1664000, "last_target_update_ts": 52501, "num_target_updates": 104}, "env_runners": {"episode_reward_max": 500.0, "episode_reward_min": 8.0, "episode_reward_mean": 135.97, "episode_len_mean": 135.97, "episode_media": {}, "episodes_timesteps_total": 13597, "policy_reward_min": {"default_policy": 8.0}, "policy_reward_max": {"default_policy": 500.0}, "policy_reward_mean": {"default_policy": 135.97}, "custom_metrics": {}, "hist_stats": {"episode_reward": [500.0, 119.0, 185.0, 73.0, 177.0, 178.0, 500.0, 159.0, 189.0, 139.0, 130.0, 114.0, 156.0, 121.0, 181.0, 108.0, 52.0, 94.0, 89.0, 27.0, 99.0, 28.0, 104.0, 139.0, 115.0, 132.0, 29.0, 14.0, 15.0, 21.0, 37.0, 21.0, 91.0, 89.0, 19.0, 90.0, 28.0, 42.0, 19.0, 89.0, 22.0, 17.0, 23.0, 90.0, 91.0, 95.0, 92.0, 91.0, 22.0, 103.0, 108.0, 102.0, 100.0, 104.0, 107.0, 114.0, 109.0, 500.0, 500.0, 411.0, 179.0, 427.0, 129.0, 122.0, 110.0, 136.0, 216.0, 175.0, 159.0, 499.0, 153.0, 500.0, 124.0, 132.0, 132.0, 500.0, 121.0, 111.0, 116.0, 115.0, 115.0, 105.0, 112.0, 117.0, 116.0, 105.0, 106.0, 113.0, 97.0, 117.0, 111.0, 112.0, 113.0, 115.0, 112.0, 101.0, 8.0, 108.0, 101.0, 144.0], "episode_lengths": [500, 119, 185, 73, 177, 178, 500, 159, 189, 139, 130, 114, 156, 121, 181, 108, 52, 94, 89, 27, 99, 28, 104, 139, 115, 132, 29, 14, 15, 21, 37, 21, 91, 89, 19, 90, 28, 42, 19, 89, 22, 17, 23, 90, 91, 95, 92, 91, 22, 103, 108, 102, 100, 104, 107, 114, 109, 500, 500, 411, 179, 427, 129, 122, 110, 136, 216, 175, 159, 499, 153, 500, 124, 132, 132, 500, 121, 111, 116, 115, 115, 105, 112, 117, 116, 105, 106, 113, 97, 117, 111, 112, 113, 115, 112, 101, 8, 108, 101, 144], "policy_default_policy_reward": [500.0, 119.0, 185.0, 73.0, 177.0, 178.0, 500.0, 159.0, 189.0, 139.0, 130.0, 114.0, 156.0, 121.0, 181.0, 108.0, 52.0, 94.0, 89.0, 27.0, 99.0, 28.0, 104.0, 139.0, 115.0, 132.0, 29.0, 14.0, 15.0, 21.0, 37.0, 21.0, 91.0, 89.0, 19.0, 90.0, 28.0, 42.0, 19.0, 89.0, 22.0, 17.0, 23.0, 90.0, 91.0, 95.0, 92.0, 91.0, 22.0, 103.0, 108.0, 102.0, 100.0, 104.0, 107.0, 114.0, 109.0, 500.0, 500.0, 411.0, 179.0, 427.0, 129.0, 122.0, 110.0, 136.0, 216.0, 175.0, 159.0, 499.0, 153.0, 500.0, 124.0, 132.0, 132.0, 500.0, 121.0, 111.0, 116.0, 115.0, 115.0, 105.0, 112.0, 117.0, 116.0, 105.0, 106.0, 113.0, 97.0, 117.0, 111.0, 112.0, 113.0, 115.0, 112.0, 101.0, 8.0, 108.0, 101.0, 144.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9941536019213066, "mean_inference_ms": 1.984162350984618, "mean_action_processing_ms": 0.2312034498535055, "mean_env_wait_ms": 0.09964230586025852, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017351388931274414, "StateBufferConnector_ms": 0.015191793441772461, "ViewRequirementAgentConnector_ms": 0.1931135654449463}, "num_episodes": 8, "episode_return_max": 500.0, "episode_return_min": 8.0, "episode_return_mean": 135.97, "episodes_this_iter": 8}, "num_healthy_workers": 0, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 53000, "num_agent_steps_trained": 1664000, "num_env_steps_sampled": 53000, "num_env_steps_trained": 1664000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 29.030557091035057, "num_env_steps_trained_throughput_per_sec": 928.9778269131218, "timesteps_total": 53000, "num_env_steps_sampled_lifetime": 53000, "num_agent_steps_sampled_lifetime": 53000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 53000, "timers": {"training_iteration_time_ms": 32556.322, "restore_workers_time_ms": 0.022, "training_step_time_ms": 34.252, "sample_time_ms": 4.165, "load_time_ms": 0.249, "load_throughput": 128450.309, "learn_time_ms": 14.342, "learn_throughput": 2231.176, "synch_weights_time_ms": 0.051}, "counters": {"num_env_steps_sampled": 53000, "num_env_steps_trained": 1664000, "num_agent_steps_sampled": 53000, "num_agent_steps_trained": 1664000, "last_target_update_ts": 52501, "num_target_updates": 104}, "done": false, "training_iteration": 53, "trial_id": "5ce16_00000", "date": "2024-09-27_11-19-00", "timestamp": 1727407140, "time_this_iter_s": 34.44843125343323, "time_total_s": 1643.4323062896729, "pid": 39427, "hostname": "gpu2gate1", "node_ip": "10.64.32.126", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.9828407522030984, "lr": 0.0007583973879008875, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f52e4d75580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1643.4323062896729, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 11.65918367346939, "ram_util_percent": 9.799999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7457605600357056, "mean_q": 41.52937698364258, "min_q": 3.5282578468322754, "max_q": 52.267189025878906, "cur_lr": 0.0007583973879008875}, "td_error": [0.054080963134765625, 0.123565673828125, 0.036808013916015625, -1.0442085266113281, 0.8856773376464844, 0.04296875, -0.0926361083984375, -0.24805831909179688, -0.5707969665527344, -0.019283294677734375, -1.4269371032714844, -0.0268096923828125, -0.36444854736328125, -0.11227798461914062, -0.8556976318359375, 6.569843292236328, 0.11945724487304688, 2.5282578468322754, -0.6019630432128906, -0.3081321716308594, -0.08446502685546875, 0.22815704345703125, -1.0360965728759766, 0.14307022094726562, -0.13831329345703125, 0.8930778503417969, -0.7863998413085938, 9.72012710571289, -0.9059581756591797, -0.2635622024536133, -0.09062957763671875, -2.89324951171875], "mean_td_error": 0.2960989773273468, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 53000.0, "diff_num_grad_updates_vs_sampler_policy": 25365.5625}}, "num_env_steps_sampled": 54000, "num_env_steps_trained": 1696000, "num_agent_steps_sampled": 54000, "num_agent_steps_trained": 1696000, "last_target_update_ts": 53501, "num_target_updates": 106}, "env_runners": {"episode_reward_max": 500.0, "episode_reward_min": 8.0, "episode_reward_mean": 139.04, "episode_len_mean": 139.04, "episode_media": {}, "episodes_timesteps_total": 13904, "policy_reward_min": {"default_policy": 8.0}, "policy_reward_max": {"default_policy": 500.0}, "policy_reward_mean": {"default_policy": 139.04}, "custom_metrics": {}, "hist_stats": {"episode_reward": [177.0, 178.0, 500.0, 159.0, 189.0, 139.0, 130.0, 114.0, 156.0, 121.0, 181.0, 108.0, 52.0, 94.0, 89.0, 27.0, 99.0, 28.0, 104.0, 139.0, 115.0, 132.0, 29.0, 14.0, 15.0, 21.0, 37.0, 21.0, 91.0, 89.0, 19.0, 90.0, 28.0, 42.0, 19.0, 89.0, 22.0, 17.0, 23.0, 90.0, 91.0, 95.0, 92.0, 91.0, 22.0, 103.0, 108.0, 102.0, 100.0, 104.0, 107.0, 114.0, 109.0, 500.0, 500.0, 411.0, 179.0, 427.0, 129.0, 122.0, 110.0, 136.0, 216.0, 175.0, 159.0, 499.0, 153.0, 500.0, 124.0, 132.0, 132.0, 500.0, 121.0, 111.0, 116.0, 115.0, 115.0, 105.0, 112.0, 117.0, 116.0, 105.0, 106.0, 113.0, 97.0, 117.0, 111.0, 112.0, 113.0, 115.0, 112.0, 101.0, 8.0, 108.0, 101.0, 144.0, 500.0, 151.0, 393.0, 140.0], "episode_lengths": [177, 178, 500, 159, 189, 139, 130, 114, 156, 121, 181, 108, 52, 94, 89, 27, 99, 28, 104, 139, 115, 132, 29, 14, 15, 21, 37, 21, 91, 89, 19, 90, 28, 42, 19, 89, 22, 17, 23, 90, 91, 95, 92, 91, 22, 103, 108, 102, 100, 104, 107, 114, 109, 500, 500, 411, 179, 427, 129, 122, 110, 136, 216, 175, 159, 499, 153, 500, 124, 132, 132, 500, 121, 111, 116, 115, 115, 105, 112, 117, 116, 105, 106, 113, 97, 117, 111, 112, 113, 115, 112, 101, 8, 108, 101, 144, 500, 151, 393, 140], "policy_default_policy_reward": [177.0, 178.0, 500.0, 159.0, 189.0, 139.0, 130.0, 114.0, 156.0, 121.0, 181.0, 108.0, 52.0, 94.0, 89.0, 27.0, 99.0, 28.0, 104.0, 139.0, 115.0, 132.0, 29.0, 14.0, 15.0, 21.0, 37.0, 21.0, 91.0, 89.0, 19.0, 90.0, 28.0, 42.0, 19.0, 89.0, 22.0, 17.0, 23.0, 90.0, 91.0, 95.0, 92.0, 91.0, 22.0, 103.0, 108.0, 102.0, 100.0, 104.0, 107.0, 114.0, 109.0, 500.0, 500.0, 411.0, 179.0, 427.0, 129.0, 122.0, 110.0, 136.0, 216.0, 175.0, 159.0, 499.0, 153.0, 500.0, 124.0, 132.0, 132.0, 500.0, 121.0, 111.0, 116.0, 115.0, 115.0, 105.0, 112.0, 117.0, 116.0, 105.0, 106.0, 113.0, 97.0, 117.0, 111.0, 112.0, 113.0, 115.0, 112.0, 101.0, 8.0, 108.0, 101.0, 144.0, 500.0, 151.0, 393.0, 140.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9940910634344737, "mean_inference_ms": 1.9836284886441677, "mean_action_processing_ms": 0.23119253079693133, "mean_env_wait_ms": 0.09965580487378409, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01759481430053711, "StateBufferConnector_ms": 0.015264272689819336, "ViewRequirementAgentConnector_ms": 0.19496774673461914}, "num_episodes": 4, "episode_return_max": 500.0, "episode_return_min": 8.0, "episode_return_mean": 139.04, "episodes_this_iter": 4}, "num_healthy_workers": 0, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 54000, "num_agent_steps_trained": 1696000, "num_env_steps_sampled": 54000, "num_env_steps_trained": 1696000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 28.19520003108373, "num_env_steps_trained_throughput_per_sec": 902.2464009946793, "timesteps_total": 54000, "num_env_steps_sampled_lifetime": 54000, "num_agent_steps_sampled_lifetime": 54000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 54000, "timers": {"training_iteration_time_ms": 33165.216, "restore_workers_time_ms": 0.021, "training_step_time_ms": 32.948, "sample_time_ms": 4.017, "load_time_ms": 0.225, "load_throughput": 142149.68, "learn_time_ms": 13.626, "learn_throughput": 2348.467, "synch_weights_time_ms": 0.053}, "counters": {"num_env_steps_sampled": 54000, "num_env_steps_trained": 1696000, "num_agent_steps_sampled": 54000, "num_agent_steps_trained": 1696000, "last_target_update_ts": 53501, "num_target_updates": 106}, "done": false, "training_iteration": 54, "trial_id": "5ce16_00000", "date": "2024-09-27_11-19-35", "timestamp": 1727407175, "time_this_iter_s": 35.46883225440979, "time_total_s": 1678.9011385440826, "pid": 39427, "hostname": "gpu2gate1", "node_ip": "10.64.32.126", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.9828407522030984, "lr": 0.0007583973879008875, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f52e4d75580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1678.9011385440826, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 11.536000000000001, "ram_util_percent": 9.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.38181671500205994, "mean_q": 39.15030288696289, "min_q": -0.12967681884765625, "max_q": 53.18949508666992, "cur_lr": 0.0007583973879008875}, "td_error": [-1.3392586708068848, 0.0010128021240234375, -0.18888473510742188, -0.0870819091796875, -0.38166046142578125, 0.5011177062988281, -0.7690811157226562, 0.055675506591796875, -0.8929595947265625, 0.2384033203125, 0.06464767456054688, -0.3114662170410156, 0.091461181640625, -0.22506332397460938, -1.5455894470214844, -0.22417640686035156, 0.13305282592773438, 0.13201904296875, -0.11981582641601562, 0.3813133239746094, -1.1296768188476562, 0.23469924926757812, -0.3706169128417969, 0.2634124755859375, 0.06490325927734375, -0.2834014892578125, 1.7058792114257812, 0.4210700988769531, -0.0536346435546875, -0.13589859008789062, 0.14326858520507812, 0.016265869140625], "mean_td_error": -0.11281450092792511, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 54000.0, "diff_num_grad_updates_vs_sampler_policy": 20603.5625}}, "num_env_steps_sampled": 55000, "num_env_steps_trained": 1728000, "num_agent_steps_sampled": 55000, "num_agent_steps_trained": 1728000, "last_target_update_ts": 54501, "num_target_updates": 108}, "env_runners": {"episode_reward_max": 500.0, "episode_reward_min": 8.0, "episode_reward_mean": 139.71, "episode_len_mean": 139.71, "episode_media": {}, "episodes_timesteps_total": 13971, "policy_reward_min": {"default_policy": 8.0}, "policy_reward_max": {"default_policy": 500.0}, "policy_reward_mean": {"default_policy": 139.71}, "custom_metrics": {}, "hist_stats": {"episode_reward": [189.0, 139.0, 130.0, 114.0, 156.0, 121.0, 181.0, 108.0, 52.0, 94.0, 89.0, 27.0, 99.0, 28.0, 104.0, 139.0, 115.0, 132.0, 29.0, 14.0, 15.0, 21.0, 37.0, 21.0, 91.0, 89.0, 19.0, 90.0, 28.0, 42.0, 19.0, 89.0, 22.0, 17.0, 23.0, 90.0, 91.0, 95.0, 92.0, 91.0, 22.0, 103.0, 108.0, 102.0, 100.0, 104.0, 107.0, 114.0, 109.0, 500.0, 500.0, 411.0, 179.0, 427.0, 129.0, 122.0, 110.0, 136.0, 216.0, 175.0, 159.0, 499.0, 153.0, 500.0, 124.0, 132.0, 132.0, 500.0, 121.0, 111.0, 116.0, 115.0, 115.0, 105.0, 112.0, 117.0, 116.0, 105.0, 106.0, 113.0, 97.0, 117.0, 111.0, 112.0, 113.0, 115.0, 112.0, 101.0, 8.0, 108.0, 101.0, 144.0, 500.0, 151.0, 393.0, 140.0, 145.0, 500.0, 152.0, 284.0], "episode_lengths": [189, 139, 130, 114, 156, 121, 181, 108, 52, 94, 89, 27, 99, 28, 104, 139, 115, 132, 29, 14, 15, 21, 37, 21, 91, 89, 19, 90, 28, 42, 19, 89, 22, 17, 23, 90, 91, 95, 92, 91, 22, 103, 108, 102, 100, 104, 107, 114, 109, 500, 500, 411, 179, 427, 129, 122, 110, 136, 216, 175, 159, 499, 153, 500, 124, 132, 132, 500, 121, 111, 116, 115, 115, 105, 112, 117, 116, 105, 106, 113, 97, 117, 111, 112, 113, 115, 112, 101, 8, 108, 101, 144, 500, 151, 393, 140, 145, 500, 152, 284], "policy_default_policy_reward": [189.0, 139.0, 130.0, 114.0, 156.0, 121.0, 181.0, 108.0, 52.0, 94.0, 89.0, 27.0, 99.0, 28.0, 104.0, 139.0, 115.0, 132.0, 29.0, 14.0, 15.0, 21.0, 37.0, 21.0, 91.0, 89.0, 19.0, 90.0, 28.0, 42.0, 19.0, 89.0, 22.0, 17.0, 23.0, 90.0, 91.0, 95.0, 92.0, 91.0, 22.0, 103.0, 108.0, 102.0, 100.0, 104.0, 107.0, 114.0, 109.0, 500.0, 500.0, 411.0, 179.0, 427.0, 129.0, 122.0, 110.0, 136.0, 216.0, 175.0, 159.0, 499.0, 153.0, 500.0, 124.0, 132.0, 132.0, 500.0, 121.0, 111.0, 116.0, 115.0, 115.0, 105.0, 112.0, 117.0, 116.0, 105.0, 106.0, 113.0, 97.0, 117.0, 111.0, 112.0, 113.0, 115.0, 112.0, 101.0, 8.0, 108.0, 101.0, 144.0, 500.0, 151.0, 393.0, 140.0, 145.0, 500.0, 152.0, 284.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9941470008426198, "mean_inference_ms": 1.9833879408535033, "mean_action_processing_ms": 0.23120608178932525, "mean_env_wait_ms": 0.09967843636875676, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01760101318359375, "StateBufferConnector_ms": 0.015310287475585938, "ViewRequirementAgentConnector_ms": 0.19554710388183594}, "num_episodes": 4, "episode_return_max": 500.0, "episode_return_min": 8.0, "episode_return_mean": 139.71, "episodes_this_iter": 4}, "num_healthy_workers": 0, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 55000, "num_agent_steps_trained": 1728000, "num_env_steps_sampled": 55000, "num_env_steps_trained": 1728000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 30.82449873822365, "num_env_steps_trained_throughput_per_sec": 986.3839596231568, "timesteps_total": 55000, "num_env_steps_sampled_lifetime": 55000, "num_agent_steps_sampled_lifetime": 55000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 55000, "timers": {"training_iteration_time_ms": 33261.919, "restore_workers_time_ms": 0.021, "training_step_time_ms": 33.47, "sample_time_ms": 3.94, "load_time_ms": 0.218, "load_throughput": 146653.986, "learn_time_ms": 14.379, "learn_throughput": 2225.46, "synch_weights_time_ms": 0.043}, "counters": {"num_env_steps_sampled": 55000, "num_env_steps_trained": 1728000, "num_agent_steps_sampled": 55000, "num_agent_steps_trained": 1728000, "last_target_update_ts": 54501, "num_target_updates": 108}, "done": false, "training_iteration": 55, "trial_id": "5ce16_00000", "date": "2024-09-27_11-20-08", "timestamp": 1727407208, "time_this_iter_s": 32.443520307540894, "time_total_s": 1711.3446588516235, "pid": 39427, "hostname": "gpu2gate1", "node_ip": "10.64.32.126", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.9828407522030984, "lr": 0.0007583973879008875, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f52e4d75580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1711.3446588516235, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 11.591304347826085, "ram_util_percent": 9.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6438406109809875, "mean_q": 36.81374740600586, "min_q": 0.5278534889221191, "max_q": 53.10025405883789, "cur_lr": 0.0007583973879008875}, "td_error": [0.17484664916992188, -0.117340087890625, -0.015941619873046875, -0.6215324401855469, -2.0423505306243896, 0.8357410430908203, -0.18856239318847656, -0.6933250427246094, -1.5424165725708008, 0.11820220947265625, -0.07413864135742188, 0.9101600646972656, -0.470703125, -0.9294204711914062, -0.06237030029296875, -0.09634780883789062, -0.3269844055175781, -1.1029319763183594, -0.240478515625, -0.21091842651367188, 0.7523956298828125, 16.281723022460938, -0.5263252258300781, 0.17188644409179688, -0.22478103637695312, -0.05780029296875, -0.5263252258300781, 21.841533660888672, -0.5286903381347656, -0.32321929931640625, -0.15673255920410156, -0.12871551513671875], "mean_td_error": 0.9336917996406555, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 55000.0, "diff_num_grad_updates_vs_sampler_policy": 25459.1875}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 1760000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 1760000, "last_target_update_ts": 55501, "num_target_updates": 110}, "env_runners": {"episode_reward_max": 500.0, "episode_reward_min": 8.0, "episode_reward_mean": 144.01, "episode_len_mean": 144.01, "episode_media": {}, "episodes_timesteps_total": 14401, "policy_reward_min": {"default_policy": 8.0}, "policy_reward_max": {"default_policy": 500.0}, "policy_reward_mean": {"default_policy": 144.01}, "custom_metrics": {}, "hist_stats": {"episode_reward": [130.0, 114.0, 156.0, 121.0, 181.0, 108.0, 52.0, 94.0, 89.0, 27.0, 99.0, 28.0, 104.0, 139.0, 115.0, 132.0, 29.0, 14.0, 15.0, 21.0, 37.0, 21.0, 91.0, 89.0, 19.0, 90.0, 28.0, 42.0, 19.0, 89.0, 22.0, 17.0, 23.0, 90.0, 91.0, 95.0, 92.0, 91.0, 22.0, 103.0, 108.0, 102.0, 100.0, 104.0, 107.0, 114.0, 109.0, 500.0, 500.0, 411.0, 179.0, 427.0, 129.0, 122.0, 110.0, 136.0, 216.0, 175.0, 159.0, 499.0, 153.0, 500.0, 124.0, 132.0, 132.0, 500.0, 121.0, 111.0, 116.0, 115.0, 115.0, 105.0, 112.0, 117.0, 116.0, 105.0, 106.0, 113.0, 97.0, 117.0, 111.0, 112.0, 113.0, 115.0, 112.0, 101.0, 8.0, 108.0, 101.0, 144.0, 500.0, 151.0, 393.0, 140.0, 145.0, 500.0, 152.0, 284.0, 500.0, 258.0], "episode_lengths": [130, 114, 156, 121, 181, 108, 52, 94, 89, 27, 99, 28, 104, 139, 115, 132, 29, 14, 15, 21, 37, 21, 91, 89, 19, 90, 28, 42, 19, 89, 22, 17, 23, 90, 91, 95, 92, 91, 22, 103, 108, 102, 100, 104, 107, 114, 109, 500, 500, 411, 179, 427, 129, 122, 110, 136, 216, 175, 159, 499, 153, 500, 124, 132, 132, 500, 121, 111, 116, 115, 115, 105, 112, 117, 116, 105, 106, 113, 97, 117, 111, 112, 113, 115, 112, 101, 8, 108, 101, 144, 500, 151, 393, 140, 145, 500, 152, 284, 500, 258], "policy_default_policy_reward": [130.0, 114.0, 156.0, 121.0, 181.0, 108.0, 52.0, 94.0, 89.0, 27.0, 99.0, 28.0, 104.0, 139.0, 115.0, 132.0, 29.0, 14.0, 15.0, 21.0, 37.0, 21.0, 91.0, 89.0, 19.0, 90.0, 28.0, 42.0, 19.0, 89.0, 22.0, 17.0, 23.0, 90.0, 91.0, 95.0, 92.0, 91.0, 22.0, 103.0, 108.0, 102.0, 100.0, 104.0, 107.0, 114.0, 109.0, 500.0, 500.0, 411.0, 179.0, 427.0, 129.0, 122.0, 110.0, 136.0, 216.0, 175.0, 159.0, 499.0, 153.0, 500.0, 124.0, 132.0, 132.0, 500.0, 121.0, 111.0, 116.0, 115.0, 115.0, 105.0, 112.0, 117.0, 116.0, 105.0, 106.0, 113.0, 97.0, 117.0, 111.0, 112.0, 113.0, 115.0, 112.0, 101.0, 8.0, 108.0, 101.0, 144.0, 500.0, 151.0, 393.0, 140.0, 145.0, 500.0, 152.0, 284.0, 500.0, 258.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9942448233875875, "mean_inference_ms": 1.9834009189231196, "mean_action_processing_ms": 0.2312323337328527, "mean_env_wait_ms": 0.09969820088700942, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017641782760620117, "StateBufferConnector_ms": 0.015336275100708008, "ViewRequirementAgentConnector_ms": 0.19612503051757812}, "num_episodes": 2, "episode_return_max": 500.0, "episode_return_min": 8.0, "episode_return_mean": 144.01, "episodes_this_iter": 2}, "num_healthy_workers": 0, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 1760000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 1760000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 30.480751772073987, "num_env_steps_trained_throughput_per_sec": 975.3840567063676, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 56000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 33195.329, "restore_workers_time_ms": 0.023, "training_step_time_ms": 30.591, "sample_time_ms": 3.678, "load_time_ms": 0.213, "load_throughput": 150400.861, "learn_time_ms": 12.649, "learn_throughput": 2529.785, "synch_weights_time_ms": 0.049}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 1760000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 1760000, "last_target_update_ts": 55501, "num_target_updates": 110}, "done": false, "training_iteration": 56, "trial_id": "5ce16_00000", "date": "2024-09-27_11-20-41", "timestamp": 1727407241, "time_this_iter_s": 32.80941128730774, "time_total_s": 1744.1540701389313, "pid": 39427, "hostname": "gpu2gate1", "node_ip": "10.64.32.126", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.9828407522030984, "lr": 0.0007583973879008875, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f52e4d75580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1744.1540701389313, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 11.660869565217393, "ram_util_percent": 9.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3791733682155609, "mean_q": 39.31898880004883, "min_q": 6.715925216674805, "max_q": 53.262535095214844, "cur_lr": 0.0007583973879008875}, "td_error": [0.0785369873046875, 0.14330673217773438, -0.24306106567382812, -0.09383010864257812, 0.19742584228515625, -0.15114974975585938, -0.20255661010742188, 0.07057571411132812, 0.1435394287109375, -0.93096923828125, -0.21667098999023438, -0.20821380615234375, 0.056072235107421875, -0.2626495361328125, 0.39006614685058594, -0.23012542724609375, 0.022151947021484375, 0.10132789611816406, -0.377227783203125, 0.10541534423828125, 6.579285144805908, -1.5401802062988281, 0.12251663208007812, 0.2008819580078125, -0.9967584609985352, -0.166839599609375, 11.439123153686523, -0.48285675048828125, 0.46636199951171875, -0.17023086547851562, -0.114715576171875, 0.5550270080566406], "mean_td_error": 0.44636183977127075, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 56000.0, "diff_num_grad_updates_vs_sampler_policy": 24611.6875}}, "num_env_steps_sampled": 57000, "num_env_steps_trained": 1792000, "num_agent_steps_sampled": 57000, "num_agent_steps_trained": 1792000, "last_target_update_ts": 56501, "num_target_updates": 112}, "env_runners": {"episode_reward_max": 500.0, "episode_reward_min": 8.0, "episode_reward_mean": 151.57, "episode_len_mean": 151.57, "episode_media": {}, "episodes_timesteps_total": 15157, "policy_reward_min": {"default_policy": 8.0}, "policy_reward_max": {"default_policy": 500.0}, "policy_reward_mean": {"default_policy": 151.57}, "custom_metrics": {}, "hist_stats": {"episode_reward": [156.0, 121.0, 181.0, 108.0, 52.0, 94.0, 89.0, 27.0, 99.0, 28.0, 104.0, 139.0, 115.0, 132.0, 29.0, 14.0, 15.0, 21.0, 37.0, 21.0, 91.0, 89.0, 19.0, 90.0, 28.0, 42.0, 19.0, 89.0, 22.0, 17.0, 23.0, 90.0, 91.0, 95.0, 92.0, 91.0, 22.0, 103.0, 108.0, 102.0, 100.0, 104.0, 107.0, 114.0, 109.0, 500.0, 500.0, 411.0, 179.0, 427.0, 129.0, 122.0, 110.0, 136.0, 216.0, 175.0, 159.0, 499.0, 153.0, 500.0, 124.0, 132.0, 132.0, 500.0, 121.0, 111.0, 116.0, 115.0, 115.0, 105.0, 112.0, 117.0, 116.0, 105.0, 106.0, 113.0, 97.0, 117.0, 111.0, 112.0, 113.0, 115.0, 112.0, 101.0, 8.0, 108.0, 101.0, 144.0, 500.0, 151.0, 393.0, 140.0, 145.0, 500.0, 152.0, 284.0, 500.0, 258.0, 500.0, 500.0], "episode_lengths": [156, 121, 181, 108, 52, 94, 89, 27, 99, 28, 104, 139, 115, 132, 29, 14, 15, 21, 37, 21, 91, 89, 19, 90, 28, 42, 19, 89, 22, 17, 23, 90, 91, 95, 92, 91, 22, 103, 108, 102, 100, 104, 107, 114, 109, 500, 500, 411, 179, 427, 129, 122, 110, 136, 216, 175, 159, 499, 153, 500, 124, 132, 132, 500, 121, 111, 116, 115, 115, 105, 112, 117, 116, 105, 106, 113, 97, 117, 111, 112, 113, 115, 112, 101, 8, 108, 101, 144, 500, 151, 393, 140, 145, 500, 152, 284, 500, 258, 500, 500], "policy_default_policy_reward": [156.0, 121.0, 181.0, 108.0, 52.0, 94.0, 89.0, 27.0, 99.0, 28.0, 104.0, 139.0, 115.0, 132.0, 29.0, 14.0, 15.0, 21.0, 37.0, 21.0, 91.0, 89.0, 19.0, 90.0, 28.0, 42.0, 19.0, 89.0, 22.0, 17.0, 23.0, 90.0, 91.0, 95.0, 92.0, 91.0, 22.0, 103.0, 108.0, 102.0, 100.0, 104.0, 107.0, 114.0, 109.0, 500.0, 500.0, 411.0, 179.0, 427.0, 129.0, 122.0, 110.0, 136.0, 216.0, 175.0, 159.0, 499.0, 153.0, 500.0, 124.0, 132.0, 132.0, 500.0, 121.0, 111.0, 116.0, 115.0, 115.0, 105.0, 112.0, 117.0, 116.0, 105.0, 106.0, 113.0, 97.0, 117.0, 111.0, 112.0, 113.0, 115.0, 112.0, 101.0, 8.0, 108.0, 101.0, 144.0, 500.0, 151.0, 393.0, 140.0, 145.0, 500.0, 152.0, 284.0, 500.0, 258.0, 500.0, 500.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9943222915051133, "mean_inference_ms": 1.9833455105482078, "mean_action_processing_ms": 0.2312537291848779, "mean_env_wait_ms": 0.09971663726247978, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01766824722290039, "StateBufferConnector_ms": 0.015401840209960938, "ViewRequirementAgentConnector_ms": 0.19669795036315918}, "num_episodes": 2, "episode_return_max": 500.0, "episode_return_min": 8.0, "episode_return_mean": 151.57, "episodes_this_iter": 2}, "num_healthy_workers": 0, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 57000, "num_agent_steps_trained": 1792000, "num_env_steps_sampled": 57000, "num_env_steps_trained": 1792000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 33.346229613396936, "num_env_steps_trained_throughput_per_sec": 1067.079347628702, "timesteps_total": 57000, "num_env_steps_sampled_lifetime": 57000, "num_agent_steps_sampled_lifetime": 57000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 57000, "timers": {"training_iteration_time_ms": 32990.692, "restore_workers_time_ms": 0.023, "training_step_time_ms": 31.297, "sample_time_ms": 3.658, "load_time_ms": 0.219, "load_throughput": 146366.116, "learn_time_ms": 13.302, "learn_throughput": 2405.642, "synch_weights_time_ms": 0.05}, "counters": {"num_env_steps_sampled": 57000, "num_env_steps_trained": 1792000, "num_agent_steps_sampled": 57000, "num_agent_steps_trained": 1792000, "last_target_update_ts": 56501, "num_target_updates": 112}, "done": false, "training_iteration": 57, "trial_id": "5ce16_00000", "date": "2024-09-27_11-21-11", "timestamp": 1727407271, "time_this_iter_s": 29.990113496780396, "time_total_s": 1774.1441836357117, "pid": 39427, "hostname": "gpu2gate1", "node_ip": "10.64.32.126", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.9828407522030984, "lr": 0.0007583973879008875, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f52e4d75580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1774.1441836357117, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 11.809302325581397, "ram_util_percent": 9.80232558139535}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.38096433877944946, "mean_q": 39.910091400146484, "min_q": 2.449204206466675, "max_q": 53.225032806396484, "cur_lr": 0.0007583973879008875}, "td_error": [0.5361480712890625, -0.3000450134277344, 0.19287109375, 0.7770271301269531, 0.6025543212890625, -0.1079559326171875, -4.219123840332031, 0.0631418228149414, 0.19182968139648438, -0.2608146667480469, 0.3790473937988281, -0.041294097900390625, -0.15430736541748047, -0.07102584838867188, 0.25230979919433594, 0.21628570556640625, 0.6149330139160156, 0.2846717834472656, -0.2516212463378906, -0.16457366943359375, 0.2900810241699219, -0.3402976989746094, -0.4301605224609375, -0.20465087890625, 0.27489471435546875, -0.04141354560852051, 0.5083694458007812, -0.2698173522949219, -0.8853034973144531, -0.3848381042480469, -1.132589340209961, 2.8297181129455566], "mean_td_error": -0.038935914635658264, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 57000.0, "diff_num_grad_updates_vs_sampler_policy": 20485.59375}}, "num_env_steps_sampled": 58000, "num_env_steps_trained": 1824000, "num_agent_steps_sampled": 58000, "num_agent_steps_trained": 1824000, "last_target_update_ts": 57501, "num_target_updates": 114}, "env_runners": {"episode_reward_max": 500.0, "episode_reward_min": 8.0, "episode_reward_mean": 157.9, "episode_len_mean": 157.9, "episode_media": {}, "episodes_timesteps_total": 15790, "policy_reward_min": {"default_policy": 8.0}, "policy_reward_max": {"default_policy": 500.0}, "policy_reward_mean": {"default_policy": 157.9}, "custom_metrics": {}, "hist_stats": {"episode_reward": [108.0, 52.0, 94.0, 89.0, 27.0, 99.0, 28.0, 104.0, 139.0, 115.0, 132.0, 29.0, 14.0, 15.0, 21.0, 37.0, 21.0, 91.0, 89.0, 19.0, 90.0, 28.0, 42.0, 19.0, 89.0, 22.0, 17.0, 23.0, 90.0, 91.0, 95.0, 92.0, 91.0, 22.0, 103.0, 108.0, 102.0, 100.0, 104.0, 107.0, 114.0, 109.0, 500.0, 500.0, 411.0, 179.0, 427.0, 129.0, 122.0, 110.0, 136.0, 216.0, 175.0, 159.0, 499.0, 153.0, 500.0, 124.0, 132.0, 132.0, 500.0, 121.0, 111.0, 116.0, 115.0, 115.0, 105.0, 112.0, 117.0, 116.0, 105.0, 106.0, 113.0, 97.0, 117.0, 111.0, 112.0, 113.0, 115.0, 112.0, 101.0, 8.0, 108.0, 101.0, 144.0, 500.0, 151.0, 393.0, 140.0, 145.0, 500.0, 152.0, 284.0, 500.0, 258.0, 500.0, 500.0, 500.0, 500.0, 91.0], "episode_lengths": [108, 52, 94, 89, 27, 99, 28, 104, 139, 115, 132, 29, 14, 15, 21, 37, 21, 91, 89, 19, 90, 28, 42, 19, 89, 22, 17, 23, 90, 91, 95, 92, 91, 22, 103, 108, 102, 100, 104, 107, 114, 109, 500, 500, 411, 179, 427, 129, 122, 110, 136, 216, 175, 159, 499, 153, 500, 124, 132, 132, 500, 121, 111, 116, 115, 115, 105, 112, 117, 116, 105, 106, 113, 97, 117, 111, 112, 113, 115, 112, 101, 8, 108, 101, 144, 500, 151, 393, 140, 145, 500, 152, 284, 500, 258, 500, 500, 500, 500, 91], "policy_default_policy_reward": [108.0, 52.0, 94.0, 89.0, 27.0, 99.0, 28.0, 104.0, 139.0, 115.0, 132.0, 29.0, 14.0, 15.0, 21.0, 37.0, 21.0, 91.0, 89.0, 19.0, 90.0, 28.0, 42.0, 19.0, 89.0, 22.0, 17.0, 23.0, 90.0, 91.0, 95.0, 92.0, 91.0, 22.0, 103.0, 108.0, 102.0, 100.0, 104.0, 107.0, 114.0, 109.0, 500.0, 500.0, 411.0, 179.0, 427.0, 129.0, 122.0, 110.0, 136.0, 216.0, 175.0, 159.0, 499.0, 153.0, 500.0, 124.0, 132.0, 132.0, 500.0, 121.0, 111.0, 116.0, 115.0, 115.0, 105.0, 112.0, 117.0, 116.0, 105.0, 106.0, 113.0, 97.0, 117.0, 111.0, 112.0, 113.0, 115.0, 112.0, 101.0, 8.0, 108.0, 101.0, 144.0, 500.0, 151.0, 393.0, 140.0, 145.0, 500.0, 152.0, 284.0, 500.0, 258.0, 500.0, 500.0, 500.0, 500.0, 91.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9944874425530127, "mean_inference_ms": 1.983359322495733, "mean_action_processing_ms": 0.23129954715857248, "mean_env_wait_ms": 0.09975119585562618, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01776266098022461, "StateBufferConnector_ms": 0.015486717224121094, "ViewRequirementAgentConnector_ms": 0.19763827323913574}, "num_episodes": 3, "episode_return_max": 500.0, "episode_return_min": 8.0, "episode_return_mean": 157.9, "episodes_this_iter": 3}, "num_healthy_workers": 0, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 58000, "num_agent_steps_trained": 1824000, "num_env_steps_sampled": 58000, "num_env_steps_trained": 1824000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 29.804633771586026, "num_env_steps_trained_throughput_per_sec": 953.7482806907528, "timesteps_total": 58000, "num_env_steps_sampled_lifetime": 58000, "num_agent_steps_sampled_lifetime": 58000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 58000, "timers": {"training_iteration_time_ms": 33148.622, "restore_workers_time_ms": 0.027, "training_step_time_ms": 39.398, "sample_time_ms": 4.878, "load_time_ms": 0.285, "load_throughput": 112240.95, "learn_time_ms": 16.794, "learn_throughput": 1905.4, "synch_weights_time_ms": 0.064}, "counters": {"num_env_steps_sampled": 58000, "num_env_steps_trained": 1824000, "num_agent_steps_sampled": 58000, "num_agent_steps_trained": 1824000, "last_target_update_ts": 57501, "num_target_updates": 114}, "done": false, "training_iteration": 58, "trial_id": "5ce16_00000", "date": "2024-09-27_11-21-44", "timestamp": 1727407304, "time_this_iter_s": 33.553853034973145, "time_total_s": 1807.6980366706848, "pid": 39427, "hostname": "gpu2gate1", "node_ip": "10.64.32.126", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.9828407522030984, "lr": 0.0007583973879008875, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f52e4d75580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1807.6980366706848, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 17.074468085106382, "ram_util_percent": 9.891489361702128}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.2738940119743347, "mean_q": 43.81627655029297, "min_q": 10.501810073852539, "max_q": 54.12654495239258, "cur_lr": 0.0007583973879008875}, "td_error": [0.05011749267578125, -0.12203598022460938, 0.07888412475585938, 0.21052932739257812, 0.7021026611328125, 0.2760429382324219, -4.925567626953125, -0.2809410095214844, 1.416457176208496, 0.6030769348144531, -0.012424468994140625, 0.07301902770996094, -0.02710723876953125, 0.5852775573730469, -0.06392669677734375, 0.20612335205078125, 0.13219070434570312, 0.09374237060546875, -0.18184280395507812, 0.09601211547851562, 0.2745704650878906, -0.28273963928222656, -0.24267959594726562, -0.5207557678222656, -0.11136627197265625, 0.3697090148925781, -4.006919860839844, -0.2966423034667969, -0.49326324462890625, 0.568084716796875, -0.011852264404296875, 0.3765983581542969], "mean_td_error": -0.1708602011203766, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 58000.0, "diff_num_grad_updates_vs_sampler_policy": 20340.21875}}, "num_env_steps_sampled": 59000, "num_env_steps_trained": 1856000, "num_agent_steps_sampled": 59000, "num_agent_steps_trained": 1856000, "last_target_update_ts": 58501, "num_target_updates": 116}, "env_runners": {"episode_reward_max": 500.0, "episode_reward_min": 8.0, "episode_reward_mean": 165.64, "episode_len_mean": 165.64, "episode_media": {}, "episodes_timesteps_total": 16564, "policy_reward_min": {"default_policy": 8.0}, "policy_reward_max": {"default_policy": 500.0}, "policy_reward_mean": {"default_policy": 165.64}, "custom_metrics": {}, "hist_stats": {"episode_reward": [27.0, 99.0, 28.0, 104.0, 139.0, 115.0, 132.0, 29.0, 14.0, 15.0, 21.0, 37.0, 21.0, 91.0, 89.0, 19.0, 90.0, 28.0, 42.0, 19.0, 89.0, 22.0, 17.0, 23.0, 90.0, 91.0, 95.0, 92.0, 91.0, 22.0, 103.0, 108.0, 102.0, 100.0, 104.0, 107.0, 114.0, 109.0, 500.0, 500.0, 411.0, 179.0, 427.0, 129.0, 122.0, 110.0, 136.0, 216.0, 175.0, 159.0, 499.0, 153.0, 500.0, 124.0, 132.0, 132.0, 500.0, 121.0, 111.0, 116.0, 115.0, 115.0, 105.0, 112.0, 117.0, 116.0, 105.0, 106.0, 113.0, 97.0, 117.0, 111.0, 112.0, 113.0, 115.0, 112.0, 101.0, 8.0, 108.0, 101.0, 144.0, 500.0, 151.0, 393.0, 140.0, 145.0, 500.0, 152.0, 284.0, 500.0, 258.0, 500.0, 500.0, 500.0, 500.0, 91.0, 500.0, 500.0, 31.0, 86.0], "episode_lengths": [27, 99, 28, 104, 139, 115, 132, 29, 14, 15, 21, 37, 21, 91, 89, 19, 90, 28, 42, 19, 89, 22, 17, 23, 90, 91, 95, 92, 91, 22, 103, 108, 102, 100, 104, 107, 114, 109, 500, 500, 411, 179, 427, 129, 122, 110, 136, 216, 175, 159, 499, 153, 500, 124, 132, 132, 500, 121, 111, 116, 115, 115, 105, 112, 117, 116, 105, 106, 113, 97, 117, 111, 112, 113, 115, 112, 101, 8, 108, 101, 144, 500, 151, 393, 140, 145, 500, 152, 284, 500, 258, 500, 500, 500, 500, 91, 500, 500, 31, 86], "policy_default_policy_reward": [27.0, 99.0, 28.0, 104.0, 139.0, 115.0, 132.0, 29.0, 14.0, 15.0, 21.0, 37.0, 21.0, 91.0, 89.0, 19.0, 90.0, 28.0, 42.0, 19.0, 89.0, 22.0, 17.0, 23.0, 90.0, 91.0, 95.0, 92.0, 91.0, 22.0, 103.0, 108.0, 102.0, 100.0, 104.0, 107.0, 114.0, 109.0, 500.0, 500.0, 411.0, 179.0, 427.0, 129.0, 122.0, 110.0, 136.0, 216.0, 175.0, 159.0, 499.0, 153.0, 500.0, 124.0, 132.0, 132.0, 500.0, 121.0, 111.0, 116.0, 115.0, 115.0, 105.0, 112.0, 117.0, 116.0, 105.0, 106.0, 113.0, 97.0, 117.0, 111.0, 112.0, 113.0, 115.0, 112.0, 101.0, 8.0, 108.0, 101.0, 144.0, 500.0, 151.0, 393.0, 140.0, 145.0, 500.0, 152.0, 284.0, 500.0, 258.0, 500.0, 500.0, 500.0, 500.0, 91.0, 500.0, 500.0, 31.0, 86.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9949779427313821, "mean_inference_ms": 1.9839303034962474, "mean_action_processing_ms": 0.23140878637646517, "mean_env_wait_ms": 0.099821318237266, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0177915096282959, "StateBufferConnector_ms": 0.01564788818359375, "ViewRequirementAgentConnector_ms": 0.199751615524292}, "num_episodes": 4, "episode_return_max": 500.0, "episode_return_min": 8.0, "episode_return_mean": 165.64, "episodes_this_iter": 4}, "num_healthy_workers": 0, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 59000, "num_agent_steps_trained": 1856000, "num_env_steps_sampled": 59000, "num_env_steps_trained": 1856000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 25.55057653919705, "num_env_steps_trained_throughput_per_sec": 817.6184492543056, "timesteps_total": 59000, "num_env_steps_sampled_lifetime": 59000, "num_agent_steps_sampled_lifetime": 59000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 59000, "timers": {"training_iteration_time_ms": 33858.303, "restore_workers_time_ms": 0.02, "training_step_time_ms": 31.94, "sample_time_ms": 3.755, "load_time_ms": 0.254, "load_throughput": 126014.203, "learn_time_ms": 13.479, "learn_throughput": 2373.989, "synch_weights_time_ms": 0.044}, "counters": {"num_env_steps_sampled": 59000, "num_env_steps_trained": 1856000, "num_agent_steps_sampled": 59000, "num_agent_steps_trained": 1856000, "last_target_update_ts": 58501, "num_target_updates": 116}, "done": false, "training_iteration": 59, "trial_id": "5ce16_00000", "date": "2024-09-27_11-22-24", "timestamp": 1727407344, "time_this_iter_s": 39.140153646469116, "time_total_s": 1846.838190317154, "pid": 39427, "hostname": "gpu2gate1", "node_ip": "10.64.32.126", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.9828407522030984, "lr": 0.0007583973879008875, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f52e4d75580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1846.838190317154, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 25.619999999999997, "ram_util_percent": 11.052727272727278}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.2136182188987732, "mean_q": 43.97537612915039, "min_q": 13.27514934539795, "max_q": 54.4620246887207, "cur_lr": 0.0007583973879008875}, "td_error": [-0.3279876708984375, 0.18696975708007812, 0.9887828826904297, 0.18930435180664062, 0.3126792907714844, 0.07201099395751953, 0.175384521484375, -0.0985870361328125, -0.0986785888671875, 0.2619171142578125, -0.5699863433837891, 0.05780029296875, -0.0108184814453125, 0.015600204467773438, -0.7567825317382812, 0.18082046508789062, 0.3407859802246094, 0.2857513427734375, -0.9338455200195312, -0.2202587127685547, 0.16962814331054688, -0.42047691345214844, -0.09340286254882812, -0.26935577392578125, 1.6907424926757812, 0.12249374389648438, -0.2428150177001953, 0.022655487060546875, 0.6571617126464844, -0.15977096557617188, -0.21986770629882812, -0.6843605041503906], "mean_td_error": 0.01948419213294983, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 59000.0, "diff_num_grad_updates_vs_sampler_policy": 26454.53125}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 1888000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 1888000, "last_target_update_ts": 59501, "num_target_updates": 118}, "env_runners": {"episode_reward_max": 500.0, "episode_reward_min": 8.0, "episode_reward_mean": 174.38, "episode_len_mean": 174.38, "episode_media": {}, "episodes_timesteps_total": 17438, "policy_reward_min": {"default_policy": 8.0}, "policy_reward_max": {"default_policy": 500.0}, "policy_reward_mean": {"default_policy": 174.38}, "custom_metrics": {}, "hist_stats": {"episode_reward": [28.0, 104.0, 139.0, 115.0, 132.0, 29.0, 14.0, 15.0, 21.0, 37.0, 21.0, 91.0, 89.0, 19.0, 90.0, 28.0, 42.0, 19.0, 89.0, 22.0, 17.0, 23.0, 90.0, 91.0, 95.0, 92.0, 91.0, 22.0, 103.0, 108.0, 102.0, 100.0, 104.0, 107.0, 114.0, 109.0, 500.0, 500.0, 411.0, 179.0, 427.0, 129.0, 122.0, 110.0, 136.0, 216.0, 175.0, 159.0, 499.0, 153.0, 500.0, 124.0, 132.0, 132.0, 500.0, 121.0, 111.0, 116.0, 115.0, 115.0, 105.0, 112.0, 117.0, 116.0, 105.0, 106.0, 113.0, 97.0, 117.0, 111.0, 112.0, 113.0, 115.0, 112.0, 101.0, 8.0, 108.0, 101.0, 144.0, 500.0, 151.0, 393.0, 140.0, 145.0, 500.0, 152.0, 284.0, 500.0, 258.0, 500.0, 500.0, 500.0, 500.0, 91.0, 500.0, 500.0, 31.0, 86.0, 500.0, 500.0], "episode_lengths": [28, 104, 139, 115, 132, 29, 14, 15, 21, 37, 21, 91, 89, 19, 90, 28, 42, 19, 89, 22, 17, 23, 90, 91, 95, 92, 91, 22, 103, 108, 102, 100, 104, 107, 114, 109, 500, 500, 411, 179, 427, 129, 122, 110, 136, 216, 175, 159, 499, 153, 500, 124, 132, 132, 500, 121, 111, 116, 115, 115, 105, 112, 117, 116, 105, 106, 113, 97, 117, 111, 112, 113, 115, 112, 101, 8, 108, 101, 144, 500, 151, 393, 140, 145, 500, 152, 284, 500, 258, 500, 500, 500, 500, 91, 500, 500, 31, 86, 500, 500], "policy_default_policy_reward": [28.0, 104.0, 139.0, 115.0, 132.0, 29.0, 14.0, 15.0, 21.0, 37.0, 21.0, 91.0, 89.0, 19.0, 90.0, 28.0, 42.0, 19.0, 89.0, 22.0, 17.0, 23.0, 90.0, 91.0, 95.0, 92.0, 91.0, 22.0, 103.0, 108.0, 102.0, 100.0, 104.0, 107.0, 114.0, 109.0, 500.0, 500.0, 411.0, 179.0, 427.0, 129.0, 122.0, 110.0, 136.0, 216.0, 175.0, 159.0, 499.0, 153.0, 500.0, 124.0, 132.0, 132.0, 500.0, 121.0, 111.0, 116.0, 115.0, 115.0, 105.0, 112.0, 117.0, 116.0, 105.0, 106.0, 113.0, 97.0, 117.0, 111.0, 112.0, 113.0, 115.0, 112.0, 101.0, 8.0, 108.0, 101.0, 144.0, 500.0, 151.0, 393.0, 140.0, 145.0, 500.0, 152.0, 284.0, 500.0, 258.0, 500.0, 500.0, 500.0, 500.0, 91.0, 500.0, 500.0, 31.0, 86.0, 500.0, 500.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.99526378050467, "mean_inference_ms": 1.9843014830312315, "mean_action_processing_ms": 0.23147294950168515, "mean_env_wait_ms": 0.09986123617466046, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017918825149536133, "StateBufferConnector_ms": 0.01591777801513672, "ViewRequirementAgentConnector_ms": 0.2011394500732422}, "num_episodes": 2, "episode_return_max": 500.0, "episode_return_min": 8.0, "episode_return_mean": 174.38, "episodes_this_iter": 2}, "num_healthy_workers": 0, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 1888000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 1888000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 27.226008729542094, "num_env_steps_trained_throughput_per_sec": 871.232279345347, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 60000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 34259.634, "restore_workers_time_ms": 0.021, "training_step_time_ms": 34.412, "sample_time_ms": 3.93, "load_time_ms": 0.239, "load_throughput": 133949.828, "learn_time_ms": 14.667, "learn_throughput": 2181.799, "synch_weights_time_ms": 0.05}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 1888000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 1888000, "last_target_update_ts": 59501, "num_target_updates": 118}, "done": false, "training_iteration": 60, "trial_id": "5ce16_00000", "date": "2024-09-27_11-23-00", "timestamp": 1727407380, "time_this_iter_s": 36.73147225379944, "time_total_s": 1883.5696625709534, "pid": 39427, "hostname": "gpu2gate1", "node_ip": "10.64.32.126", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.9828407522030984, "lr": 0.0007583973879008875, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f52e4d75580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1883.5696625709534, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 15.971153846153848, "ram_util_percent": 11.096153846153847}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.2648559808731079, "mean_q": 42.549110412597656, "min_q": 3.1245553493499756, "max_q": 54.101409912109375, "cur_lr": 0.0007583973879008875}, "td_error": [0.16699600219726562, 0.1836566925048828, 0.13909912109375, 0.06851959228515625, 1.1089057922363281, -0.22038650512695312, -0.7008285522460938, -0.19625473022460938, -0.8172492980957031, -0.17066192626953125, 0.14191055297851562, -0.7155489921569824, 0.043560028076171875, 0.3650169372558594, 0.26946163177490234, -0.4303932189941406, 0.047817230224609375, -0.6524467468261719, 0.176666259765625, -0.03527069091796875, -0.5317459106445312, -0.06688690185546875, 0.20990371704101562, -0.7911739349365234, -0.4543266296386719, 3.9070167541503906, 0.4038581848144531, 0.049472808837890625, -0.3215827941894531, -0.017009735107421875, 0.20294189453125, 0.00090789794921875], "mean_td_error": 0.04262326657772064, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 60000.0, "diff_num_grad_updates_vs_sampler_policy": 23984.90625}}, "num_env_steps_sampled": 61000, "num_env_steps_trained": 1920000, "num_agent_steps_sampled": 61000, "num_agent_steps_trained": 1920000, "last_target_update_ts": 60501, "num_target_updates": 120}, "env_runners": {"episode_reward_max": 500.0, "episode_reward_min": 8.0, "episode_reward_mean": 183.06, "episode_len_mean": 183.06, "episode_media": {}, "episodes_timesteps_total": 18306, "policy_reward_min": {"default_policy": 8.0}, "policy_reward_max": {"default_policy": 500.0}, "policy_reward_mean": {"default_policy": 183.06}, "custom_metrics": {}, "hist_stats": {"episode_reward": [139.0, 115.0, 132.0, 29.0, 14.0, 15.0, 21.0, 37.0, 21.0, 91.0, 89.0, 19.0, 90.0, 28.0, 42.0, 19.0, 89.0, 22.0, 17.0, 23.0, 90.0, 91.0, 95.0, 92.0, 91.0, 22.0, 103.0, 108.0, 102.0, 100.0, 104.0, 107.0, 114.0, 109.0, 500.0, 500.0, 411.0, 179.0, 427.0, 129.0, 122.0, 110.0, 136.0, 216.0, 175.0, 159.0, 499.0, 153.0, 500.0, 124.0, 132.0, 132.0, 500.0, 121.0, 111.0, 116.0, 115.0, 115.0, 105.0, 112.0, 117.0, 116.0, 105.0, 106.0, 113.0, 97.0, 117.0, 111.0, 112.0, 113.0, 115.0, 112.0, 101.0, 8.0, 108.0, 101.0, 144.0, 500.0, 151.0, 393.0, 140.0, 145.0, 500.0, 152.0, 284.0, 500.0, 258.0, 500.0, 500.0, 500.0, 500.0, 91.0, 500.0, 500.0, 31.0, 86.0, 500.0, 500.0, 500.0, 500.0], "episode_lengths": [139, 115, 132, 29, 14, 15, 21, 37, 21, 91, 89, 19, 90, 28, 42, 19, 89, 22, 17, 23, 90, 91, 95, 92, 91, 22, 103, 108, 102, 100, 104, 107, 114, 109, 500, 500, 411, 179, 427, 129, 122, 110, 136, 216, 175, 159, 499, 153, 500, 124, 132, 132, 500, 121, 111, 116, 115, 115, 105, 112, 117, 116, 105, 106, 113, 97, 117, 111, 112, 113, 115, 112, 101, 8, 108, 101, 144, 500, 151, 393, 140, 145, 500, 152, 284, 500, 258, 500, 500, 500, 500, 91, 500, 500, 31, 86, 500, 500, 500, 500], "policy_default_policy_reward": [139.0, 115.0, 132.0, 29.0, 14.0, 15.0, 21.0, 37.0, 21.0, 91.0, 89.0, 19.0, 90.0, 28.0, 42.0, 19.0, 89.0, 22.0, 17.0, 23.0, 90.0, 91.0, 95.0, 92.0, 91.0, 22.0, 103.0, 108.0, 102.0, 100.0, 104.0, 107.0, 114.0, 109.0, 500.0, 500.0, 411.0, 179.0, 427.0, 129.0, 122.0, 110.0, 136.0, 216.0, 175.0, 159.0, 499.0, 153.0, 500.0, 124.0, 132.0, 132.0, 500.0, 121.0, 111.0, 116.0, 115.0, 115.0, 105.0, 112.0, 117.0, 116.0, 105.0, 106.0, 113.0, 97.0, 117.0, 111.0, 112.0, 113.0, 115.0, 112.0, 101.0, 8.0, 108.0, 101.0, 144.0, 500.0, 151.0, 393.0, 140.0, 145.0, 500.0, 152.0, 284.0, 500.0, 258.0, 500.0, 500.0, 500.0, 500.0, 91.0, 500.0, 500.0, 31.0, 86.0, 500.0, 500.0, 500.0, 500.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9956044308202863, "mean_inference_ms": 1.9847811656503855, "mean_action_processing_ms": 0.23154900817497193, "mean_env_wait_ms": 0.09990716431137332, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01804804801940918, "StateBufferConnector_ms": 0.016082763671875, "ViewRequirementAgentConnector_ms": 0.20270228385925293}, "num_episodes": 2, "episode_return_max": 500.0, "episode_return_min": 8.0, "episode_return_mean": 183.06, "episodes_this_iter": 2}, "num_healthy_workers": 0, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 61000, "num_agent_steps_trained": 1920000, "num_env_steps_sampled": 61000, "num_env_steps_trained": 1920000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 26.395044052174526, "num_env_steps_trained_throughput_per_sec": 844.6414096695848, "timesteps_total": 61000, "num_env_steps_sampled_lifetime": 61000, "num_agent_steps_sampled_lifetime": 61000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 61000, "timers": {"training_iteration_time_ms": 34658.802, "restore_workers_time_ms": 0.022, "training_step_time_ms": 36.072, "sample_time_ms": 4.082, "load_time_ms": 0.261, "load_throughput": 122427.919, "learn_time_ms": 14.964, "learn_throughput": 2138.413, "synch_weights_time_ms": 0.053}, "counters": {"num_env_steps_sampled": 61000, "num_env_steps_trained": 1920000, "num_agent_steps_sampled": 61000, "num_agent_steps_trained": 1920000, "last_target_update_ts": 60501, "num_target_updates": 120}, "done": false, "training_iteration": 61, "trial_id": "5ce16_00000", "date": "2024-09-27_11-23-39", "timestamp": 1727407419, "time_this_iter_s": 37.88788890838623, "time_total_s": 1921.4575514793396, "pid": 39427, "hostname": "gpu2gate1", "node_ip": "10.64.32.126", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.9828407522030984, "lr": 0.0007583973879008875, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f52e4d75580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1921.4575514793396, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 15.17037037037037, "ram_util_percent": 10.914814814814813}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.651459813117981, "mean_q": 38.66929244995117, "min_q": 1.9236738681793213, "max_q": 54.993003845214844, "cur_lr": 0.0007583973879008875}, "td_error": [0.6484413146972656, -0.4704437255859375, 0.6377067565917969, -0.6251487731933594, 0.7421073913574219, 1.467977523803711, -0.04449462890625, 0.36809825897216797, 0.16677474975585938, 0.3216285705566406, -0.5221977233886719, -0.2250213623046875, -0.13487625122070312, -0.05762481689453125, -0.029445648193359375, 0.38591957092285156, 0.4409637451171875, 16.25618553161621, -0.6871309280395508, -0.4087181091308594, -0.009517669677734375, 0.00011444091796875, 0.054653167724609375, 1.2868423461914062, -0.35715484619140625, -0.638946533203125, -0.12139511108398438, 1.05401611328125, 2.5827598571777344, -0.5371246337890625, -0.5697951316833496, 1.965494155883789], "mean_td_error": 0.7168952226638794, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 61000.0, "diff_num_grad_updates_vs_sampler_policy": 28699.40625}}, "num_env_steps_sampled": 62000, "num_env_steps_trained": 1952000, "num_agent_steps_sampled": 62000, "num_agent_steps_trained": 1952000, "last_target_update_ts": 61501, "num_target_updates": 122}, "env_runners": {"episode_reward_max": 500.0, "episode_reward_min": 8.0, "episode_reward_mean": 190.52, "episode_len_mean": 190.52, "episode_media": {}, "episodes_timesteps_total": 19052, "policy_reward_min": {"default_policy": 8.0}, "policy_reward_max": {"default_policy": 500.0}, "policy_reward_mean": {"default_policy": 190.52}, "custom_metrics": {}, "hist_stats": {"episode_reward": [132.0, 29.0, 14.0, 15.0, 21.0, 37.0, 21.0, 91.0, 89.0, 19.0, 90.0, 28.0, 42.0, 19.0, 89.0, 22.0, 17.0, 23.0, 90.0, 91.0, 95.0, 92.0, 91.0, 22.0, 103.0, 108.0, 102.0, 100.0, 104.0, 107.0, 114.0, 109.0, 500.0, 500.0, 411.0, 179.0, 427.0, 129.0, 122.0, 110.0, 136.0, 216.0, 175.0, 159.0, 499.0, 153.0, 500.0, 124.0, 132.0, 132.0, 500.0, 121.0, 111.0, 116.0, 115.0, 115.0, 105.0, 112.0, 117.0, 116.0, 105.0, 106.0, 113.0, 97.0, 117.0, 111.0, 112.0, 113.0, 115.0, 112.0, 101.0, 8.0, 108.0, 101.0, 144.0, 500.0, 151.0, 393.0, 140.0, 145.0, 500.0, 152.0, 284.0, 500.0, 258.0, 500.0, 500.0, 500.0, 500.0, 91.0, 500.0, 500.0, 31.0, 86.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0], "episode_lengths": [132, 29, 14, 15, 21, 37, 21, 91, 89, 19, 90, 28, 42, 19, 89, 22, 17, 23, 90, 91, 95, 92, 91, 22, 103, 108, 102, 100, 104, 107, 114, 109, 500, 500, 411, 179, 427, 129, 122, 110, 136, 216, 175, 159, 499, 153, 500, 124, 132, 132, 500, 121, 111, 116, 115, 115, 105, 112, 117, 116, 105, 106, 113, 97, 117, 111, 112, 113, 115, 112, 101, 8, 108, 101, 144, 500, 151, 393, 140, 145, 500, 152, 284, 500, 258, 500, 500, 500, 500, 91, 500, 500, 31, 86, 500, 500, 500, 500, 500, 500], "policy_default_policy_reward": [132.0, 29.0, 14.0, 15.0, 21.0, 37.0, 21.0, 91.0, 89.0, 19.0, 90.0, 28.0, 42.0, 19.0, 89.0, 22.0, 17.0, 23.0, 90.0, 91.0, 95.0, 92.0, 91.0, 22.0, 103.0, 108.0, 102.0, 100.0, 104.0, 107.0, 114.0, 109.0, 500.0, 500.0, 411.0, 179.0, 427.0, 129.0, 122.0, 110.0, 136.0, 216.0, 175.0, 159.0, 499.0, 153.0, 500.0, 124.0, 132.0, 132.0, 500.0, 121.0, 111.0, 116.0, 115.0, 115.0, 105.0, 112.0, 117.0, 116.0, 105.0, 106.0, 113.0, 97.0, 117.0, 111.0, 112.0, 113.0, 115.0, 112.0, 101.0, 8.0, 108.0, 101.0, 144.0, 500.0, 151.0, 393.0, 140.0, 145.0, 500.0, 152.0, 284.0, 500.0, 258.0, 500.0, 500.0, 500.0, 500.0, 91.0, 500.0, 500.0, 31.0, 86.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9959427883469104, "mean_inference_ms": 1.9852881527180386, "mean_action_processing_ms": 0.23162421171838055, "mean_env_wait_ms": 0.09995164435310631, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018156766891479492, "StateBufferConnector_ms": 0.01616811752319336, "ViewRequirementAgentConnector_ms": 0.20339560508728027}, "num_episodes": 2, "episode_return_max": 500.0, "episode_return_min": 8.0, "episode_return_mean": 190.52, "episodes_this_iter": 2}, "num_healthy_workers": 0, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 62000, "num_agent_steps_trained": 1952000, "num_env_steps_sampled": 62000, "num_env_steps_trained": 1952000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 29.77578147313357, "num_env_steps_trained_throughput_per_sec": 952.8250071402742, "timesteps_total": 62000, "num_env_steps_sampled_lifetime": 62000, "num_agent_steps_sampled_lifetime": 62000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 62000, "timers": {"training_iteration_time_ms": 34604.145, "restore_workers_time_ms": 0.019, "training_step_time_ms": 33.233, "sample_time_ms": 3.908, "load_time_ms": 0.231, "load_throughput": 138468.718, "learn_time_ms": 14.168, "learn_throughput": 2258.676, "synch_weights_time_ms": 0.044}, "counters": {"num_env_steps_sampled": 62000, "num_env_steps_trained": 1952000, "num_agent_steps_sampled": 62000, "num_agent_steps_trained": 1952000, "last_target_update_ts": 61501, "num_target_updates": 122}, "done": false, "training_iteration": 62, "trial_id": "5ce16_00000", "date": "2024-09-27_11-24-12", "timestamp": 1727407452, "time_this_iter_s": 33.58613348007202, "time_total_s": 1955.0436849594116, "pid": 39427, "hostname": "gpu2gate1", "node_ip": "10.64.32.126", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.9828407522030984, "lr": 0.0007583973879008875, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f52e4d75580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1955.0436849594116, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 15.07872340425532, "ram_util_percent": 10.899999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4077458083629608, "mean_q": 44.4306640625, "min_q": -0.6469516754150391, "max_q": 55.42369079589844, "cur_lr": 0.0007583973879008875}, "td_error": [-0.6102294921875, 0.017810821533203125, -1.8961763381958008, -0.0612640380859375, 0.3653755187988281, -0.3791351318359375, -0.43890380859375, -0.055988311767578125, -0.6858863830566406, -0.02440643310546875, -1.8961763381958008, -0.1070556640625, -0.18794631958007812, 0.1126708984375, 1.8922157287597656, -0.02648162841796875, 0.19035720825195312, -0.825958251953125, -0.40229034423828125, 0.2819366455078125, -0.00173187255859375, -0.07566070556640625, 0.8188915252685547, 0.5678596496582031, -0.18742752075195312, 0.0032806396484375, -0.13031387329101562, 0.3209381103515625, 0.070587158203125, -0.16948699951171875, -0.07789230346679688, 0.2967796325683594], "mean_td_error": -0.10317838191986084, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 62000.0, "diff_num_grad_updates_vs_sampler_policy": 19302.40625}}, "num_env_steps_sampled": 63000, "num_env_steps_trained": 1984000, "num_agent_steps_sampled": 63000, "num_agent_steps_trained": 1984000, "last_target_update_ts": 62501, "num_target_updates": 124}, "env_runners": {"episode_reward_max": 500.0, "episode_reward_min": 8.0, "episode_reward_mean": 198.91, "episode_len_mean": 198.91, "episode_media": {}, "episodes_timesteps_total": 19891, "policy_reward_min": {"default_policy": 8.0}, "policy_reward_max": {"default_policy": 500.0}, "policy_reward_mean": {"default_policy": 198.91}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.0, 15.0, 21.0, 37.0, 21.0, 91.0, 89.0, 19.0, 90.0, 28.0, 42.0, 19.0, 89.0, 22.0, 17.0, 23.0, 90.0, 91.0, 95.0, 92.0, 91.0, 22.0, 103.0, 108.0, 102.0, 100.0, 104.0, 107.0, 114.0, 109.0, 500.0, 500.0, 411.0, 179.0, 427.0, 129.0, 122.0, 110.0, 136.0, 216.0, 175.0, 159.0, 499.0, 153.0, 500.0, 124.0, 132.0, 132.0, 500.0, 121.0, 111.0, 116.0, 115.0, 115.0, 105.0, 112.0, 117.0, 116.0, 105.0, 106.0, 113.0, 97.0, 117.0, 111.0, 112.0, 113.0, 115.0, 112.0, 101.0, 8.0, 108.0, 101.0, 144.0, 500.0, 151.0, 393.0, 140.0, 145.0, 500.0, 152.0, 284.0, 500.0, 258.0, 500.0, 500.0, 500.0, 500.0, 91.0, 500.0, 500.0, 31.0, 86.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0], "episode_lengths": [14, 15, 21, 37, 21, 91, 89, 19, 90, 28, 42, 19, 89, 22, 17, 23, 90, 91, 95, 92, 91, 22, 103, 108, 102, 100, 104, 107, 114, 109, 500, 500, 411, 179, 427, 129, 122, 110, 136, 216, 175, 159, 499, 153, 500, 124, 132, 132, 500, 121, 111, 116, 115, 115, 105, 112, 117, 116, 105, 106, 113, 97, 117, 111, 112, 113, 115, 112, 101, 8, 108, 101, 144, 500, 151, 393, 140, 145, 500, 152, 284, 500, 258, 500, 500, 500, 500, 91, 500, 500, 31, 86, 500, 500, 500, 500, 500, 500, 500, 500], "policy_default_policy_reward": [14.0, 15.0, 21.0, 37.0, 21.0, 91.0, 89.0, 19.0, 90.0, 28.0, 42.0, 19.0, 89.0, 22.0, 17.0, 23.0, 90.0, 91.0, 95.0, 92.0, 91.0, 22.0, 103.0, 108.0, 102.0, 100.0, 104.0, 107.0, 114.0, 109.0, 500.0, 500.0, 411.0, 179.0, 427.0, 129.0, 122.0, 110.0, 136.0, 216.0, 175.0, 159.0, 499.0, 153.0, 500.0, 124.0, 132.0, 132.0, 500.0, 121.0, 111.0, 116.0, 115.0, 115.0, 105.0, 112.0, 117.0, 116.0, 105.0, 106.0, 113.0, 97.0, 117.0, 111.0, 112.0, 113.0, 115.0, 112.0, 101.0, 8.0, 108.0, 101.0, 144.0, 500.0, 151.0, 393.0, 140.0, 145.0, 500.0, 152.0, 284.0, 500.0, 258.0, 500.0, 500.0, 500.0, 500.0, 91.0, 500.0, 500.0, 31.0, 86.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9962810246752964, "mean_inference_ms": 1.9858031642180567, "mean_action_processing_ms": 0.2316996332003781, "mean_env_wait_ms": 0.0999961478312393, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018090486526489258, "StateBufferConnector_ms": 0.016136884689331055, "ViewRequirementAgentConnector_ms": 0.2027299404144287}, "num_episodes": 2, "episode_return_max": 500.0, "episode_return_min": 8.0, "episode_return_mean": 198.91, "episodes_this_iter": 2}, "num_healthy_workers": 0, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 63000, "num_agent_steps_trained": 1984000, "num_env_steps_sampled": 63000, "num_env_steps_trained": 1984000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 32.27569702815241, "num_env_steps_trained_throughput_per_sec": 1032.822304900877, "timesteps_total": 63000, "num_env_steps_sampled_lifetime": 63000, "num_agent_steps_sampled_lifetime": 63000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 63000, "timers": {"training_iteration_time_ms": 34257.805, "restore_workers_time_ms": 0.018, "training_step_time_ms": 30.789, "sample_time_ms": 3.481, "load_time_ms": 0.191, "load_throughput": 167709.269, "learn_time_ms": 13.119, "learn_throughput": 2439.293, "synch_weights_time_ms": 0.042}, "counters": {"num_env_steps_sampled": 63000, "num_env_steps_trained": 1984000, "num_agent_steps_sampled": 63000, "num_agent_steps_trained": 1984000, "last_target_update_ts": 62501, "num_target_updates": 124}, "done": false, "training_iteration": 63, "trial_id": "5ce16_00000", "date": "2024-09-27_11-24-43", "timestamp": 1727407483, "time_this_iter_s": 30.98545789718628, "time_total_s": 1986.029142856598, "pid": 39427, "hostname": "gpu2gate1", "node_ip": "10.64.32.126", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.9828407522030984, "lr": 0.0007583973879008875, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f52e4d75580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1986.029142856598, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 15.30681818181818, "ram_util_percent": 10.986363636363636}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3500913381576538, "mean_q": 42.97392654418945, "min_q": 2.727001905441284, "max_q": 55.28527069091797, "cur_lr": 0.0007583973879008875}, "td_error": [-0.4585447311401367, 0.15724945068359375, 0.10242462158203125, -0.6238040924072266, -0.08387374877929688, -1.8424291610717773, -1.276031494140625, 2.0490810871124268, 0.04615020751953125, -0.12862777709960938, -0.3002738952636719, 0.3307228088378906, 0.18654632568359375, -0.041568756103515625, -1.207146406173706, 0.4894866943359375, -0.8819568157196045, 0.053150177001953125, 0.07953643798828125, 0.0803985595703125, -0.2607307434082031, -0.00785064697265625, 0.0526885986328125, -0.09583282470703125, -0.09141159057617188, 1.0997314453125, -0.075042724609375, -0.16611480712890625, 0.12911224365234375, -0.34587860107421875, 0.2225360870361328, 0.3375129699707031], "mean_td_error": -0.07721222192049026, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 63000.0, "diff_num_grad_updates_vs_sampler_policy": 24264.53125}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 2016000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 2016000, "last_target_update_ts": 63501, "num_target_updates": 126}, "env_runners": {"episode_reward_max": 500.0, "episode_reward_min": 8.0, "episode_reward_mean": 208.62, "episode_len_mean": 208.62, "episode_media": {}, "episodes_timesteps_total": 20862, "policy_reward_min": {"default_policy": 8.0}, "policy_reward_max": {"default_policy": 500.0}, "policy_reward_mean": {"default_policy": 208.62}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.0, 37.0, 21.0, 91.0, 89.0, 19.0, 90.0, 28.0, 42.0, 19.0, 89.0, 22.0, 17.0, 23.0, 90.0, 91.0, 95.0, 92.0, 91.0, 22.0, 103.0, 108.0, 102.0, 100.0, 104.0, 107.0, 114.0, 109.0, 500.0, 500.0, 411.0, 179.0, 427.0, 129.0, 122.0, 110.0, 136.0, 216.0, 175.0, 159.0, 499.0, 153.0, 500.0, 124.0, 132.0, 132.0, 500.0, 121.0, 111.0, 116.0, 115.0, 115.0, 105.0, 112.0, 117.0, 116.0, 105.0, 106.0, 113.0, 97.0, 117.0, 111.0, 112.0, 113.0, 115.0, 112.0, 101.0, 8.0, 108.0, 101.0, 144.0, 500.0, 151.0, 393.0, 140.0, 145.0, 500.0, 152.0, 284.0, 500.0, 258.0, 500.0, 500.0, 500.0, 500.0, 91.0, 500.0, 500.0, 31.0, 86.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0], "episode_lengths": [21, 37, 21, 91, 89, 19, 90, 28, 42, 19, 89, 22, 17, 23, 90, 91, 95, 92, 91, 22, 103, 108, 102, 100, 104, 107, 114, 109, 500, 500, 411, 179, 427, 129, 122, 110, 136, 216, 175, 159, 499, 153, 500, 124, 132, 132, 500, 121, 111, 116, 115, 115, 105, 112, 117, 116, 105, 106, 113, 97, 117, 111, 112, 113, 115, 112, 101, 8, 108, 101, 144, 500, 151, 393, 140, 145, 500, 152, 284, 500, 258, 500, 500, 500, 500, 91, 500, 500, 31, 86, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_default_policy_reward": [21.0, 37.0, 21.0, 91.0, 89.0, 19.0, 90.0, 28.0, 42.0, 19.0, 89.0, 22.0, 17.0, 23.0, 90.0, 91.0, 95.0, 92.0, 91.0, 22.0, 103.0, 108.0, 102.0, 100.0, 104.0, 107.0, 114.0, 109.0, 500.0, 500.0, 411.0, 179.0, 427.0, 129.0, 122.0, 110.0, 136.0, 216.0, 175.0, 159.0, 499.0, 153.0, 500.0, 124.0, 132.0, 132.0, 500.0, 121.0, 111.0, 116.0, 115.0, 115.0, 105.0, 112.0, 117.0, 116.0, 105.0, 106.0, 113.0, 97.0, 117.0, 111.0, 112.0, 113.0, 115.0, 112.0, 101.0, 8.0, 108.0, 101.0, 144.0, 500.0, 151.0, 393.0, 140.0, 145.0, 500.0, 152.0, 284.0, 500.0, 258.0, 500.0, 500.0, 500.0, 500.0, 91.0, 500.0, 500.0, 31.0, 86.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9966279251802459, "mean_inference_ms": 1.9863553495211135, "mean_action_processing_ms": 0.23177758572343876, "mean_env_wait_ms": 0.10004058719534, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01810455322265625, "StateBufferConnector_ms": 0.01623988151550293, "ViewRequirementAgentConnector_ms": 0.2036418914794922}, "num_episodes": 2, "episode_return_max": 500.0, "episode_return_min": 8.0, "episode_return_mean": 208.62, "episodes_this_iter": 2}, "num_healthy_workers": 0, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 2016000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 2016000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 28.669018618043342, "num_env_steps_trained_throughput_per_sec": 917.408595777387, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 34199.199, "restore_workers_time_ms": 0.022, "training_step_time_ms": 38.682, "sample_time_ms": 4.541, "load_time_ms": 0.272, "load_throughput": 117590.44, "learn_time_ms": 16.562, "learn_throughput": 1932.152, "synch_weights_time_ms": 0.054}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 2016000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 2016000, "last_target_update_ts": 63501, "num_target_updates": 126}, "done": false, "training_iteration": 64, "trial_id": "5ce16_00000", "date": "2024-09-27_11-25-18", "timestamp": 1727407518, "time_this_iter_s": 34.88275337219238, "time_total_s": 2020.9118962287903, "pid": 39427, "hostname": "gpu2gate1", "node_ip": "10.64.32.126", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.9828407522030984, "lr": 0.0007583973879008875, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f52e4d75580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2020.9118962287903, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 15.277551020408163, "ram_util_percent": 11.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3792916238307953, "mean_q": 41.58650588989258, "min_q": 4.760686874389648, "max_q": 56.816184997558594, "cur_lr": 0.0007583973879008875}, "td_error": [-0.38820648193359375, -0.34796905517578125, -0.045436859130859375, -1.6592779159545898, 1.8061065673828125, 0.5512161254882812, 0.8066673278808594, -0.8879241943359375, 0.6289901733398438, 0.17980384826660156, -0.33652496337890625, -0.041187286376953125, -0.024662017822265625, -0.26337432861328125, -0.2676982879638672, -0.33245086669921875, -0.5783271789550781, -0.2297821044921875, 0.0440216064453125, 16.392398834228516, -0.15972137451171875, 0.1794586181640625, -0.20529556274414062, 0.25916290283203125, 0.14140701293945312, -18.525712966918945, 0.07818984985351562, -1.0299091339111328, 0.9207687377929688, -0.3944816589355469, 0.1827545166015625, -0.09307861328125], "mean_td_error": -0.1137523353099823, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 64000.0, "diff_num_grad_updates_vs_sampler_policy": 23160.625}}, "num_env_steps_sampled": 65000, "num_env_steps_trained": 2048000, "num_agent_steps_sampled": 65000, "num_agent_steps_trained": 2048000, "last_target_update_ts": 64501, "num_target_updates": 128}, "env_runners": {"episode_reward_max": 500.0, "episode_reward_min": 8.0, "episode_reward_mean": 218.04, "episode_len_mean": 218.04, "episode_media": {}, "episodes_timesteps_total": 21804, "policy_reward_min": {"default_policy": 8.0}, "policy_reward_max": {"default_policy": 500.0}, "policy_reward_mean": {"default_policy": 218.04}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.0, 91.0, 89.0, 19.0, 90.0, 28.0, 42.0, 19.0, 89.0, 22.0, 17.0, 23.0, 90.0, 91.0, 95.0, 92.0, 91.0, 22.0, 103.0, 108.0, 102.0, 100.0, 104.0, 107.0, 114.0, 109.0, 500.0, 500.0, 411.0, 179.0, 427.0, 129.0, 122.0, 110.0, 136.0, 216.0, 175.0, 159.0, 499.0, 153.0, 500.0, 124.0, 132.0, 132.0, 500.0, 121.0, 111.0, 116.0, 115.0, 115.0, 105.0, 112.0, 117.0, 116.0, 105.0, 106.0, 113.0, 97.0, 117.0, 111.0, 112.0, 113.0, 115.0, 112.0, 101.0, 8.0, 108.0, 101.0, 144.0, 500.0, 151.0, 393.0, 140.0, 145.0, 500.0, 152.0, 284.0, 500.0, 258.0, 500.0, 500.0, 500.0, 500.0, 91.0, 500.0, 500.0, 31.0, 86.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0], "episode_lengths": [21, 91, 89, 19, 90, 28, 42, 19, 89, 22, 17, 23, 90, 91, 95, 92, 91, 22, 103, 108, 102, 100, 104, 107, 114, 109, 500, 500, 411, 179, 427, 129, 122, 110, 136, 216, 175, 159, 499, 153, 500, 124, 132, 132, 500, 121, 111, 116, 115, 115, 105, 112, 117, 116, 105, 106, 113, 97, 117, 111, 112, 113, 115, 112, 101, 8, 108, 101, 144, 500, 151, 393, 140, 145, 500, 152, 284, 500, 258, 500, 500, 500, 500, 91, 500, 500, 31, 86, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_default_policy_reward": [21.0, 91.0, 89.0, 19.0, 90.0, 28.0, 42.0, 19.0, 89.0, 22.0, 17.0, 23.0, 90.0, 91.0, 95.0, 92.0, 91.0, 22.0, 103.0, 108.0, 102.0, 100.0, 104.0, 107.0, 114.0, 109.0, 500.0, 500.0, 411.0, 179.0, 427.0, 129.0, 122.0, 110.0, 136.0, 216.0, 175.0, 159.0, 499.0, 153.0, 500.0, 124.0, 132.0, 132.0, 500.0, 121.0, 111.0, 116.0, 115.0, 115.0, 105.0, 112.0, 117.0, 116.0, 105.0, 106.0, 113.0, 97.0, 117.0, 111.0, 112.0, 113.0, 115.0, 112.0, 101.0, 8.0, 108.0, 101.0, 144.0, 500.0, 151.0, 393.0, 140.0, 145.0, 500.0, 152.0, 284.0, 500.0, 258.0, 500.0, 500.0, 500.0, 500.0, 91.0, 500.0, 500.0, 31.0, 86.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9969676752491148, "mean_inference_ms": 1.9869067975882566, "mean_action_processing_ms": 0.23185493016311468, "mean_env_wait_ms": 0.10008379963289916, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0180513858795166, "StateBufferConnector_ms": 0.016284942626953125, "ViewRequirementAgentConnector_ms": 0.20470142364501953}, "num_episodes": 2, "episode_return_max": 500.0, "episode_return_min": 8.0, "episode_return_mean": 218.04, "episodes_this_iter": 2}, "num_healthy_workers": 0, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 65000, "num_agent_steps_trained": 2048000, "num_env_steps_sampled": 65000, "num_env_steps_trained": 2048000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 29.984312849858203, "num_env_steps_trained_throughput_per_sec": 959.4980111954625, "timesteps_total": 65000, "num_env_steps_sampled_lifetime": 65000, "num_agent_steps_sampled_lifetime": 65000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 65000, "timers": {"training_iteration_time_ms": 34290.104, "restore_workers_time_ms": 0.021, "training_step_time_ms": 33.227, "sample_time_ms": 3.817, "load_time_ms": 0.253, "load_throughput": 126668.297, "learn_time_ms": 14.183, "learn_throughput": 2256.158, "synch_weights_time_ms": 0.044}, "counters": {"num_env_steps_sampled": 65000, "num_env_steps_trained": 2048000, "num_agent_steps_sampled": 65000, "num_agent_steps_trained": 2048000, "last_target_update_ts": 64501, "num_target_updates": 128}, "done": false, "training_iteration": 65, "trial_id": "5ce16_00000", "date": "2024-09-27_11-25-52", "timestamp": 1727407552, "time_this_iter_s": 33.3525927066803, "time_total_s": 2054.2644889354706, "pid": 39427, "hostname": "gpu2gate1", "node_ip": "10.64.32.126", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.9828407522030984, "lr": 0.0007583973879008875, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f52e4d75580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2054.2644889354706, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 15.246808510638294, "ram_util_percent": 11.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.452143132686615, "mean_q": 46.76838684082031, "min_q": 1.0000195503234863, "max_q": 57.114707946777344, "cur_lr": 0.0007583973879008875}, "td_error": [-0.6228752136230469, -0.44388580322265625, -0.3713493347167969, -1.5572834014892578, -0.3568382263183594, 21.291749954223633, -0.1831817626953125, 0.0135955810546875, 21.579082489013672, -0.2759284973144531, 0.23443603515625, 0.07749176025390625, 0.2068939208984375, -1.2394905090332031, 0.18266677856445312, -0.149749755859375, -0.14827728271484375, 0.09398651123046875, -0.19513320922851562, -0.2032470703125, -0.19789505004882812, 1.5691337585449219, 0.09955978393554688, -0.21462631225585938, 0.6297950744628906, -0.0602264404296875, 1.9550323486328125e-05, -1.1399784088134766, -0.9701309204101562, -0.07577133178710938, -0.423065185546875, -0.36841583251953125], "mean_td_error": 1.149408221244812, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 65000.0, "diff_num_grad_updates_vs_sampler_policy": 26248.15625}}, "num_env_steps_sampled": 66000, "num_env_steps_trained": 2080000, "num_agent_steps_sampled": 66000, "num_agent_steps_trained": 2080000, "last_target_update_ts": 65501, "num_target_updates": 130}, "env_runners": {"episode_reward_max": 500.0, "episode_reward_min": 8.0, "episode_reward_mean": 226.92, "episode_len_mean": 226.92, "episode_media": {}, "episodes_timesteps_total": 22692, "policy_reward_min": {"default_policy": 8.0}, "policy_reward_max": {"default_policy": 500.0}, "policy_reward_mean": {"default_policy": 226.92}, "custom_metrics": {}, "hist_stats": {"episode_reward": [89.0, 19.0, 90.0, 28.0, 42.0, 19.0, 89.0, 22.0, 17.0, 23.0, 90.0, 91.0, 95.0, 92.0, 91.0, 22.0, 103.0, 108.0, 102.0, 100.0, 104.0, 107.0, 114.0, 109.0, 500.0, 500.0, 411.0, 179.0, 427.0, 129.0, 122.0, 110.0, 136.0, 216.0, 175.0, 159.0, 499.0, 153.0, 500.0, 124.0, 132.0, 132.0, 500.0, 121.0, 111.0, 116.0, 115.0, 115.0, 105.0, 112.0, 117.0, 116.0, 105.0, 106.0, 113.0, 97.0, 117.0, 111.0, 112.0, 113.0, 115.0, 112.0, 101.0, 8.0, 108.0, 101.0, 144.0, 500.0, 151.0, 393.0, 140.0, 145.0, 500.0, 152.0, 284.0, 500.0, 258.0, 500.0, 500.0, 500.0, 500.0, 91.0, 500.0, 500.0, 31.0, 86.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0], "episode_lengths": [89, 19, 90, 28, 42, 19, 89, 22, 17, 23, 90, 91, 95, 92, 91, 22, 103, 108, 102, 100, 104, 107, 114, 109, 500, 500, 411, 179, 427, 129, 122, 110, 136, 216, 175, 159, 499, 153, 500, 124, 132, 132, 500, 121, 111, 116, 115, 115, 105, 112, 117, 116, 105, 106, 113, 97, 117, 111, 112, 113, 115, 112, 101, 8, 108, 101, 144, 500, 151, 393, 140, 145, 500, 152, 284, 500, 258, 500, 500, 500, 500, 91, 500, 500, 31, 86, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_default_policy_reward": [89.0, 19.0, 90.0, 28.0, 42.0, 19.0, 89.0, 22.0, 17.0, 23.0, 90.0, 91.0, 95.0, 92.0, 91.0, 22.0, 103.0, 108.0, 102.0, 100.0, 104.0, 107.0, 114.0, 109.0, 500.0, 500.0, 411.0, 179.0, 427.0, 129.0, 122.0, 110.0, 136.0, 216.0, 175.0, 159.0, 499.0, 153.0, 500.0, 124.0, 132.0, 132.0, 500.0, 121.0, 111.0, 116.0, 115.0, 115.0, 105.0, 112.0, 117.0, 116.0, 105.0, 106.0, 113.0, 97.0, 117.0, 111.0, 112.0, 113.0, 115.0, 112.0, 101.0, 8.0, 108.0, 101.0, 144.0, 500.0, 151.0, 393.0, 140.0, 145.0, 500.0, 152.0, 284.0, 500.0, 258.0, 500.0, 500.0, 500.0, 500.0, 91.0, 500.0, 500.0, 31.0, 86.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9972982832579338, "mean_inference_ms": 1.987455532697714, "mean_action_processing_ms": 0.23193135658346428, "mean_env_wait_ms": 0.10012663257259781, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01818060874938965, "StateBufferConnector_ms": 0.016385316848754883, "ViewRequirementAgentConnector_ms": 0.20600342750549316}, "num_episodes": 2, "episode_return_max": 500.0, "episode_return_min": 8.0, "episode_return_mean": 226.92, "episodes_this_iter": 2}, "num_healthy_workers": 0, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 66000, "num_agent_steps_trained": 2080000, "num_env_steps_sampled": 66000, "num_env_steps_trained": 2080000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 30.269895521725395, "num_env_steps_trained_throughput_per_sec": 968.6366566952127, "timesteps_total": 66000, "num_env_steps_sampled_lifetime": 66000, "num_agent_steps_sampled_lifetime": 66000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 66000, "timers": {"training_iteration_time_ms": 34312.957, "restore_workers_time_ms": 0.019, "training_step_time_ms": 34.625, "sample_time_ms": 4.022, "load_time_ms": 0.281, "load_throughput": 113975.652, "learn_time_ms": 14.099, "learn_throughput": 2269.641, "synch_weights_time_ms": 0.045}, "counters": {"num_env_steps_sampled": 66000, "num_env_steps_trained": 2080000, "num_agent_steps_sampled": 66000, "num_agent_steps_trained": 2080000, "last_target_update_ts": 65501, "num_target_updates": 130}, "done": false, "training_iteration": 66, "trial_id": "5ce16_00000", "date": "2024-09-27_11-26-25", "timestamp": 1727407585, "time_this_iter_s": 33.03803467750549, "time_total_s": 2087.302523612976, "pid": 39427, "hostname": "gpu2gate1", "node_ip": "10.64.32.126", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.9828407522030984, "lr": 0.0007583973879008875, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f52e4d75580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2087.302523612976, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 15.525531914893616, "ram_util_percent": 11.03829787234043}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6145350337028503, "mean_q": 45.01851272583008, "min_q": 6.473263263702393, "max_q": 57.00563049316406, "cur_lr": 0.0007583973879008875}, "td_error": [-0.3413887023925781, 0.7125053405761719, -0.07091140747070312, -0.2689018249511719, 0.8191337585449219, -0.21571731567382812, 0.10175323486328125, -0.3006439208984375, 0.07793045043945312, -0.447784423828125, 0.12551498413085938, -0.37201881408691406, 0.031879425048828125, 6.111846923828125, 0.2556343078613281, 27.813026428222656, 0.2700958251953125, -0.055194854736328125, 0.2571372985839844, 0.2052001953125, -0.39251708984375, -0.15079116821289062, -0.01804351806640625, -0.3241386413574219, -0.60369873046875, 1.1952133178710938, 0.4131889343261719, -0.5483207702636719, 1.567474365234375, -0.16666030883789062, 0.3257484436035156, 5.473263263702393], "mean_td_error": 1.2962441444396973, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 66000.0, "diff_num_grad_updates_vs_sampler_policy": 28965.71875}}, "num_env_steps_sampled": 67000, "num_env_steps_trained": 2112000, "num_agent_steps_sampled": 67000, "num_agent_steps_trained": 2112000, "last_target_update_ts": 66501, "num_target_updates": 132}, "env_runners": {"episode_reward_max": 500.0, "episode_reward_min": 8.0, "episode_reward_mean": 233.32, "episode_len_mean": 233.32, "episode_media": {}, "episodes_timesteps_total": 23332, "policy_reward_min": {"default_policy": 8.0}, "policy_reward_max": {"default_policy": 500.0}, "policy_reward_mean": {"default_policy": 233.32}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.0, 19.0, 89.0, 22.0, 17.0, 23.0, 90.0, 91.0, 95.0, 92.0, 91.0, 22.0, 103.0, 108.0, 102.0, 100.0, 104.0, 107.0, 114.0, 109.0, 500.0, 500.0, 411.0, 179.0, 427.0, 129.0, 122.0, 110.0, 136.0, 216.0, 175.0, 159.0, 499.0, 153.0, 500.0, 124.0, 132.0, 132.0, 500.0, 121.0, 111.0, 116.0, 115.0, 115.0, 105.0, 112.0, 117.0, 116.0, 105.0, 106.0, 113.0, 97.0, 117.0, 111.0, 112.0, 113.0, 115.0, 112.0, 101.0, 8.0, 108.0, 101.0, 144.0, 500.0, 151.0, 393.0, 140.0, 145.0, 500.0, 152.0, 284.0, 500.0, 258.0, 500.0, 500.0, 500.0, 500.0, 91.0, 500.0, 500.0, 31.0, 86.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 331.0, 223.0, 235.0, 77.0], "episode_lengths": [42, 19, 89, 22, 17, 23, 90, 91, 95, 92, 91, 22, 103, 108, 102, 100, 104, 107, 114, 109, 500, 500, 411, 179, 427, 129, 122, 110, 136, 216, 175, 159, 499, 153, 500, 124, 132, 132, 500, 121, 111, 116, 115, 115, 105, 112, 117, 116, 105, 106, 113, 97, 117, 111, 112, 113, 115, 112, 101, 8, 108, 101, 144, 500, 151, 393, 140, 145, 500, 152, 284, 500, 258, 500, 500, 500, 500, 91, 500, 500, 31, 86, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 331, 223, 235, 77], "policy_default_policy_reward": [42.0, 19.0, 89.0, 22.0, 17.0, 23.0, 90.0, 91.0, 95.0, 92.0, 91.0, 22.0, 103.0, 108.0, 102.0, 100.0, 104.0, 107.0, 114.0, 109.0, 500.0, 500.0, 411.0, 179.0, 427.0, 129.0, 122.0, 110.0, 136.0, 216.0, 175.0, 159.0, 499.0, 153.0, 500.0, 124.0, 132.0, 132.0, 500.0, 121.0, 111.0, 116.0, 115.0, 115.0, 105.0, 112.0, 117.0, 116.0, 105.0, 106.0, 113.0, 97.0, 117.0, 111.0, 112.0, 113.0, 115.0, 112.0, 101.0, 8.0, 108.0, 101.0, 144.0, 500.0, 151.0, 393.0, 140.0, 145.0, 500.0, 152.0, 284.0, 500.0, 258.0, 500.0, 500.0, 500.0, 500.0, 91.0, 500.0, 500.0, 31.0, 86.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 331.0, 223.0, 235.0, 77.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9979354186753941, "mean_inference_ms": 1.9885165673767924, "mean_action_processing_ms": 0.23208666984412507, "mean_env_wait_ms": 0.10020980737797246, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018208980560302734, "StateBufferConnector_ms": 0.016506433486938477, "ViewRequirementAgentConnector_ms": 0.20723915100097656}, "num_episodes": 4, "episode_return_max": 500.0, "episode_return_min": 8.0, "episode_return_mean": 233.32, "episodes_this_iter": 4}, "num_healthy_workers": 0, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 67000, "num_agent_steps_trained": 2112000, "num_env_steps_sampled": 67000, "num_env_steps_trained": 2112000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 30.767792763286774, "num_env_steps_trained_throughput_per_sec": 984.5693684251768, "timesteps_total": 67000, "num_env_steps_sampled_lifetime": 67000, "num_agent_steps_sampled_lifetime": 67000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 67000, "timers": {"training_iteration_time_ms": 34564.27, "restore_workers_time_ms": 0.023, "training_step_time_ms": 32.069, "sample_time_ms": 3.904, "load_time_ms": 0.207, "load_throughput": 154593.098, "learn_time_ms": 14.049, "learn_throughput": 2277.776, "synch_weights_time_ms": 0.051}, "counters": {"num_env_steps_sampled": 67000, "num_env_steps_trained": 2112000, "num_agent_steps_sampled": 67000, "num_agent_steps_trained": 2112000, "last_target_update_ts": 66501, "num_target_updates": 132}, "done": false, "training_iteration": 67, "trial_id": "5ce16_00000", "date": "2024-09-27_11-26-58", "timestamp": 1727407618, "time_this_iter_s": 32.50306963920593, "time_total_s": 2119.805593252182, "pid": 39427, "hostname": "gpu2gate1", "node_ip": "10.64.32.126", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.9828407522030984, "lr": 0.0007583973879008875, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f52e4d75580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2119.805593252182, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 15.865217391304345, "ram_util_percent": 11.100000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4730027914047241, "mean_q": 49.33642578125, "min_q": 16.611770629882812, "max_q": 57.7256965637207, "cur_lr": 0.0007583973879008875}, "td_error": [1.439260482788086, -0.2547760009765625, 0.9912948608398438, 0.304229736328125, 0.10448455810546875, 0.04872894287109375, 0.6518287658691406, 0.4710121154785156, 0.011501312255859375, 0.3971214294433594, 0.25896453857421875, 0.46575927734375, 0.4287872314453125, 0.5970535278320312, 0.16996383666992188, 0.2949562072753906, 0.5765380859375, 0.475006103515625, 0.21689224243164062, 1.6949577331542969, -0.6303482055664062, 54.14288330078125, 0.251678466796875, 0.24353790283203125, 0.32137298583984375, 1.1104545593261719, 0.6068992614746094, 0.5704708099365234, 0.38176727294921875, 0.3105049133300781, 0.6531028747558594, 0.4678955078125], "mean_td_error": 2.1179308891296387, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 67000.0, "diff_num_grad_updates_vs_sampler_policy": 25004.4375}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 2144000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 2144000, "last_target_update_ts": 67501, "num_target_updates": 134}, "env_runners": {"episode_reward_max": 500.0, "episode_reward_min": 8.0, "episode_reward_mean": 239.57, "episode_len_mean": 239.57, "episode_media": {}, "episodes_timesteps_total": 23957, "policy_reward_min": {"default_policy": 8.0}, "policy_reward_max": {"default_policy": 500.0}, "policy_reward_mean": {"default_policy": 239.57}, "custom_metrics": {}, "hist_stats": {"episode_reward": [90.0, 91.0, 95.0, 92.0, 91.0, 22.0, 103.0, 108.0, 102.0, 100.0, 104.0, 107.0, 114.0, 109.0, 500.0, 500.0, 411.0, 179.0, 427.0, 129.0, 122.0, 110.0, 136.0, 216.0, 175.0, 159.0, 499.0, 153.0, 500.0, 124.0, 132.0, 132.0, 500.0, 121.0, 111.0, 116.0, 115.0, 115.0, 105.0, 112.0, 117.0, 116.0, 105.0, 106.0, 113.0, 97.0, 117.0, 111.0, 112.0, 113.0, 115.0, 112.0, 101.0, 8.0, 108.0, 101.0, 144.0, 500.0, 151.0, 393.0, 140.0, 145.0, 500.0, 152.0, 284.0, 500.0, 258.0, 500.0, 500.0, 500.0, 500.0, 91.0, 500.0, 500.0, 31.0, 86.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 331.0, 223.0, 235.0, 77.0, 222.0, 140.0, 117.0, 105.0, 114.0, 139.0], "episode_lengths": [90, 91, 95, 92, 91, 22, 103, 108, 102, 100, 104, 107, 114, 109, 500, 500, 411, 179, 427, 129, 122, 110, 136, 216, 175, 159, 499, 153, 500, 124, 132, 132, 500, 121, 111, 116, 115, 115, 105, 112, 117, 116, 105, 106, 113, 97, 117, 111, 112, 113, 115, 112, 101, 8, 108, 101, 144, 500, 151, 393, 140, 145, 500, 152, 284, 500, 258, 500, 500, 500, 500, 91, 500, 500, 31, 86, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 331, 223, 235, 77, 222, 140, 117, 105, 114, 139], "policy_default_policy_reward": [90.0, 91.0, 95.0, 92.0, 91.0, 22.0, 103.0, 108.0, 102.0, 100.0, 104.0, 107.0, 114.0, 109.0, 500.0, 500.0, 411.0, 179.0, 427.0, 129.0, 122.0, 110.0, 136.0, 216.0, 175.0, 159.0, 499.0, 153.0, 500.0, 124.0, 132.0, 132.0, 500.0, 121.0, 111.0, 116.0, 115.0, 115.0, 105.0, 112.0, 117.0, 116.0, 105.0, 106.0, 113.0, 97.0, 117.0, 111.0, 112.0, 113.0, 115.0, 112.0, 101.0, 8.0, 108.0, 101.0, 144.0, 500.0, 151.0, 393.0, 140.0, 145.0, 500.0, 152.0, 284.0, 500.0, 258.0, 500.0, 500.0, 500.0, 500.0, 91.0, 500.0, 500.0, 31.0, 86.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 331.0, 223.0, 235.0, 77.0, 222.0, 140.0, 117.0, 105.0, 114.0, 139.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9988691251153776, "mean_inference_ms": 1.9900883927901, "mean_action_processing_ms": 0.232318449029442, "mean_env_wait_ms": 0.10033381058630457, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01829361915588379, "StateBufferConnector_ms": 0.01647782325744629, "ViewRequirementAgentConnector_ms": 0.20807600021362305}, "num_episodes": 6, "episode_return_max": 500.0, "episode_return_min": 8.0, "episode_return_mean": 239.57, "episodes_this_iter": 6}, "num_healthy_workers": 0, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 2144000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 2144000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 30.617901184915223, "num_env_steps_trained_throughput_per_sec": 979.7728379172871, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 68000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 34475.15, "restore_workers_time_ms": 0.023, "training_step_time_ms": 33.865, "sample_time_ms": 4.114, "load_time_ms": 0.232, "load_throughput": 137729.839, "learn_time_ms": 14.301, "learn_throughput": 2237.533, "synch_weights_time_ms": 0.05}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 2144000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 2144000, "last_target_update_ts": 67501, "num_target_updates": 134}, "done": false, "training_iteration": 68, "trial_id": "5ce16_00000", "date": "2024-09-27_11-27-30", "timestamp": 1727407650, "time_this_iter_s": 32.66260528564453, "time_total_s": 2152.4681985378265, "pid": 39427, "hostname": "gpu2gate1", "node_ip": "10.64.32.126", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.9828407522030984, "lr": 0.0007583973879008875, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f52e4d75580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2152.4681985378265, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 15.917391304347827, "ram_util_percent": 11.130434782608694}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.2528981864452362, "mean_q": 44.30259704589844, "min_q": -2.1007659435272217, "max_q": 56.1103515625, "cur_lr": 0.0007583973879008875}, "td_error": [1.0190563201904297, 1.0862922668457031, 0.5463905334472656, -0.16247940063476562, 0.27411651611328125, -0.100067138671875, -0.7318382263183594, -2.0493664741516113, 0.008663177490234375, -0.2517585754394531, -1.2782835960388184, 0.2761726379394531, -0.06699371337890625, 0.5590705871582031, 0.20746231079101562, -0.024662017822265625, -0.06396484375, -0.012551307678222656, 0.060176849365234375, -0.07615280151367188, -1.2663650512695312, 0.11128997802734375, -0.4547996520996094, -0.5109825134277344, 4.3217597007751465, -0.1821441650390625, -0.6970596313476562, -0.21922683715820312, -0.034603118896484375, -0.24883270263671875, -0.412994384765625, -0.3877220153808594], "mean_td_error": -0.023824915289878845, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 68000.0, "diff_num_grad_updates_vs_sampler_policy": 21685.75}}, "num_env_steps_sampled": 69000, "num_env_steps_trained": 2176000, "num_agent_steps_sampled": 69000, "num_agent_steps_trained": 2176000, "last_target_update_ts": 68501, "num_target_updates": 136}, "env_runners": {"episode_reward_max": 500.0, "episode_reward_min": 8.0, "episode_reward_mean": 246.69, "episode_len_mean": 246.69, "episode_media": {}, "episodes_timesteps_total": 24669, "policy_reward_min": {"default_policy": 8.0}, "policy_reward_max": {"default_policy": 500.0}, "policy_reward_mean": {"default_policy": 246.69}, "custom_metrics": {}, "hist_stats": {"episode_reward": [95.0, 92.0, 91.0, 22.0, 103.0, 108.0, 102.0, 100.0, 104.0, 107.0, 114.0, 109.0, 500.0, 500.0, 411.0, 179.0, 427.0, 129.0, 122.0, 110.0, 136.0, 216.0, 175.0, 159.0, 499.0, 153.0, 500.0, 124.0, 132.0, 132.0, 500.0, 121.0, 111.0, 116.0, 115.0, 115.0, 105.0, 112.0, 117.0, 116.0, 105.0, 106.0, 113.0, 97.0, 117.0, 111.0, 112.0, 113.0, 115.0, 112.0, 101.0, 8.0, 108.0, 101.0, 144.0, 500.0, 151.0, 393.0, 140.0, 145.0, 500.0, 152.0, 284.0, 500.0, 258.0, 500.0, 500.0, 500.0, 500.0, 91.0, 500.0, 500.0, 31.0, 86.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 331.0, 223.0, 235.0, 77.0, 222.0, 140.0, 117.0, 105.0, 114.0, 139.0, 393.0, 500.0], "episode_lengths": [95, 92, 91, 22, 103, 108, 102, 100, 104, 107, 114, 109, 500, 500, 411, 179, 427, 129, 122, 110, 136, 216, 175, 159, 499, 153, 500, 124, 132, 132, 500, 121, 111, 116, 115, 115, 105, 112, 117, 116, 105, 106, 113, 97, 117, 111, 112, 113, 115, 112, 101, 8, 108, 101, 144, 500, 151, 393, 140, 145, 500, 152, 284, 500, 258, 500, 500, 500, 500, 91, 500, 500, 31, 86, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 331, 223, 235, 77, 222, 140, 117, 105, 114, 139, 393, 500], "policy_default_policy_reward": [95.0, 92.0, 91.0, 22.0, 103.0, 108.0, 102.0, 100.0, 104.0, 107.0, 114.0, 109.0, 500.0, 500.0, 411.0, 179.0, 427.0, 129.0, 122.0, 110.0, 136.0, 216.0, 175.0, 159.0, 499.0, 153.0, 500.0, 124.0, 132.0, 132.0, 500.0, 121.0, 111.0, 116.0, 115.0, 115.0, 105.0, 112.0, 117.0, 116.0, 105.0, 106.0, 113.0, 97.0, 117.0, 111.0, 112.0, 113.0, 115.0, 112.0, 101.0, 8.0, 108.0, 101.0, 144.0, 500.0, 151.0, 393.0, 140.0, 145.0, 500.0, 152.0, 284.0, 500.0, 258.0, 500.0, 500.0, 500.0, 500.0, 91.0, 500.0, 500.0, 31.0, 86.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 331.0, 223.0, 235.0, 77.0, 222.0, 140.0, 117.0, 105.0, 114.0, 139.0, 393.0, 500.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9991908314361834, "mean_inference_ms": 1.9906116923466115, "mean_action_processing_ms": 0.23239707512398602, "mean_env_wait_ms": 0.10037676718395627, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01823735237121582, "StateBufferConnector_ms": 0.016491174697875977, "ViewRequirementAgentConnector_ms": 0.20839595794677734}, "num_episodes": 2, "episode_return_max": 500.0, "episode_return_min": 8.0, "episode_return_mean": 246.69, "episodes_this_iter": 2}, "num_healthy_workers": 0, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 69000, "num_agent_steps_trained": 2176000, "num_env_steps_sampled": 69000, "num_env_steps_trained": 2176000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 29.995014780806613, "num_env_steps_trained_throughput_per_sec": 959.8404729858116, "timesteps_total": 69000, "num_env_steps_sampled_lifetime": 69000, "num_agent_steps_sampled_lifetime": 69000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 69000, "timers": {"training_iteration_time_ms": 33895.234, "restore_workers_time_ms": 0.021, "training_step_time_ms": 30.901, "sample_time_ms": 3.548, "load_time_ms": 0.198, "load_throughput": 161571.841, "learn_time_ms": 12.901, "learn_throughput": 2480.511, "synch_weights_time_ms": 0.047}, "counters": {"num_env_steps_sampled": 69000, "num_env_steps_trained": 2176000, "num_agent_steps_sampled": 69000, "num_agent_steps_trained": 2176000, "last_target_update_ts": 68501, "num_target_updates": 136}, "done": false, "training_iteration": 69, "trial_id": "5ce16_00000", "date": "2024-09-27_11-28-04", "timestamp": 1727407684, "time_this_iter_s": 33.340662240982056, "time_total_s": 2185.8088607788086, "pid": 39427, "hostname": "gpu2gate1", "node_ip": "10.64.32.126", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.9828407522030984, "lr": 0.0007583973879008875, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f52e4d75580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2185.8088607788086, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 15.395744680851069, "ram_util_percent": 11.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5696979761123657, "mean_q": 45.361412048339844, "min_q": 1.714591383934021, "max_q": 56.305850982666016, "cur_lr": 0.0007583973879008875}, "td_error": [-0.08351516723632812, -0.14873504638671875, -0.698822021484375, -0.10260009765625, -0.3025016784667969, -0.1797027587890625, -0.09519577026367188, 0.7839584350585938, 0.3953876495361328, -0.06566619873046875, -0.48846435546875, 0.05489349365234375, -0.39793360233306885, -0.20117950439453125, 0.2848014831542969, -0.14891815185546875, -0.8931045532226562, -0.21131134033203125, -0.1061849594116211, -0.5424652099609375, -0.5380210876464844, -0.08612823486328125, 0.007890701293945312, -0.7830085754394531, 0.43303680419921875, -0.7161178588867188, -0.061595916748046875, -0.0307464599609375, -0.2879180908203125, -0.6025285720825195, -0.266357421875, -0.13075637817382812], "mean_td_error": -0.19404719769954681, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 69000.0, "diff_num_grad_updates_vs_sampler_policy": 25753.625}}, "num_env_steps_sampled": 70000, "num_env_steps_trained": 2208000, "num_agent_steps_sampled": 70000, "num_agent_steps_trained": 2208000, "last_target_update_ts": 69501, "num_target_updates": 138}, "env_runners": {"episode_reward_max": 500.0, "episode_reward_min": 8.0, "episode_reward_mean": 254.27, "episode_len_mean": 254.27, "episode_media": {}, "episodes_timesteps_total": 25427, "policy_reward_min": {"default_policy": 8.0}, "policy_reward_max": {"default_policy": 500.0}, "policy_reward_mean": {"default_policy": 254.27}, "custom_metrics": {}, "hist_stats": {"episode_reward": [22.0, 103.0, 108.0, 102.0, 100.0, 104.0, 107.0, 114.0, 109.0, 500.0, 500.0, 411.0, 179.0, 427.0, 129.0, 122.0, 110.0, 136.0, 216.0, 175.0, 159.0, 499.0, 153.0, 500.0, 124.0, 132.0, 132.0, 500.0, 121.0, 111.0, 116.0, 115.0, 115.0, 105.0, 112.0, 117.0, 116.0, 105.0, 106.0, 113.0, 97.0, 117.0, 111.0, 112.0, 113.0, 115.0, 112.0, 101.0, 8.0, 108.0, 101.0, 144.0, 500.0, 151.0, 393.0, 140.0, 145.0, 500.0, 152.0, 284.0, 500.0, 258.0, 500.0, 500.0, 500.0, 500.0, 91.0, 500.0, 500.0, 31.0, 86.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 331.0, 223.0, 235.0, 77.0, 222.0, 140.0, 117.0, 105.0, 114.0, 139.0, 393.0, 500.0, 500.0, 500.0, 36.0], "episode_lengths": [22, 103, 108, 102, 100, 104, 107, 114, 109, 500, 500, 411, 179, 427, 129, 122, 110, 136, 216, 175, 159, 499, 153, 500, 124, 132, 132, 500, 121, 111, 116, 115, 115, 105, 112, 117, 116, 105, 106, 113, 97, 117, 111, 112, 113, 115, 112, 101, 8, 108, 101, 144, 500, 151, 393, 140, 145, 500, 152, 284, 500, 258, 500, 500, 500, 500, 91, 500, 500, 31, 86, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 331, 223, 235, 77, 222, 140, 117, 105, 114, 139, 393, 500, 500, 500, 36], "policy_default_policy_reward": [22.0, 103.0, 108.0, 102.0, 100.0, 104.0, 107.0, 114.0, 109.0, 500.0, 500.0, 411.0, 179.0, 427.0, 129.0, 122.0, 110.0, 136.0, 216.0, 175.0, 159.0, 499.0, 153.0, 500.0, 124.0, 132.0, 132.0, 500.0, 121.0, 111.0, 116.0, 115.0, 115.0, 105.0, 112.0, 117.0, 116.0, 105.0, 106.0, 113.0, 97.0, 117.0, 111.0, 112.0, 113.0, 115.0, 112.0, 101.0, 8.0, 108.0, 101.0, 144.0, 500.0, 151.0, 393.0, 140.0, 145.0, 500.0, 152.0, 284.0, 500.0, 258.0, 500.0, 500.0, 500.0, 500.0, 91.0, 500.0, 500.0, 31.0, 86.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 331.0, 223.0, 235.0, 77.0, 222.0, 140.0, 117.0, 105.0, 114.0, 139.0, 393.0, 500.0, 500.0, 500.0, 36.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.999671091754663, "mean_inference_ms": 1.9914656740439793, "mean_action_processing_ms": 0.23251384000406491, "mean_env_wait_ms": 0.1004381790863305, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018117427825927734, "StateBufferConnector_ms": 0.0165555477142334, "ViewRequirementAgentConnector_ms": 0.2093656063079834}, "num_episodes": 3, "episode_return_max": 500.0, "episode_return_min": 8.0, "episode_return_mean": 254.27, "episodes_this_iter": 3}, "num_healthy_workers": 0, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 70000, "num_agent_steps_trained": 2208000, "num_env_steps_sampled": 70000, "num_env_steps_trained": 2208000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 29.586906847910324, "num_env_steps_trained_throughput_per_sec": 946.7810191331304, "timesteps_total": 70000, "num_env_steps_sampled_lifetime": 70000, "num_agent_steps_sampled_lifetime": 70000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 70000, "timers": {"training_iteration_time_ms": 33602.152, "restore_workers_time_ms": 0.019, "training_step_time_ms": 31.281, "sample_time_ms": 3.775, "load_time_ms": 0.215, "load_throughput": 149163.956, "learn_time_ms": 13.639, "learn_throughput": 2346.156, "synch_weights_time_ms": 0.04}, "counters": {"num_env_steps_sampled": 70000, "num_env_steps_trained": 2208000, "num_agent_steps_sampled": 70000, "num_agent_steps_trained": 2208000, "last_target_update_ts": 69501, "num_target_updates": 138}, "done": false, "training_iteration": 70, "trial_id": "5ce16_00000", "date": "2024-09-27_11-28-38", "timestamp": 1727407718, "time_this_iter_s": 33.800477743148804, "time_total_s": 2219.6093385219574, "pid": 39427, "hostname": "gpu2gate1", "node_ip": "10.64.32.126", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.9828407522030984, "lr": 0.0007583973879008875, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f52e4d75580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2219.6093385219574, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 14.856250000000001, "ram_util_percent": 11.200000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9440913796424866, "mean_q": 47.619483947753906, "min_q": 5.643503189086914, "max_q": 57.082637786865234, "cur_lr": 0.0007583973879008875}, "td_error": [0.2991981506347656, 0.7368583679199219, 0.3624267578125, 0.5928192138671875, -0.10564804077148438, 0.20796585083007812, 0.28762054443359375, 0.13104248046875, 1.351593017578125, 0.969970703125, -0.031261444091796875, 0.2796592712402344, 0.5809783935546875, 0.36545372009277344, 0.5105552673339844, 0.16554641723632812, 0.24628448486328125, -0.3496818542480469, -0.29953765869140625, 0.4706153869628906, 0.2760467529296875, 1.7735137939453125, 0.010284423828125, 0.4441566467285156, 0.16982650756835938, 0.01662445068359375, -0.13257217407226562, 0.17809677124023438, 1.3974151611328125, -0.13047218322753906, -0.0500035285949707, 1.4262886047363281], "mean_td_error": 0.37973952293395996, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 70000.0, "diff_num_grad_updates_vs_sampler_policy": 21620.96875}}, "num_env_steps_sampled": 71000, "num_env_steps_trained": 2240000, "num_agent_steps_sampled": 71000, "num_agent_steps_trained": 2240000, "last_target_update_ts": 70501, "num_target_updates": 140}, "env_runners": {"episode_reward_max": 500.0, "episode_reward_min": 8.0, "episode_reward_mean": 263.02, "episode_len_mean": 263.02, "episode_media": {}, "episodes_timesteps_total": 26302, "policy_reward_min": {"default_policy": 8.0}, "policy_reward_max": {"default_policy": 500.0}, "policy_reward_mean": {"default_policy": 263.02}, "custom_metrics": {}, "hist_stats": {"episode_reward": [108.0, 102.0, 100.0, 104.0, 107.0, 114.0, 109.0, 500.0, 500.0, 411.0, 179.0, 427.0, 129.0, 122.0, 110.0, 136.0, 216.0, 175.0, 159.0, 499.0, 153.0, 500.0, 124.0, 132.0, 132.0, 500.0, 121.0, 111.0, 116.0, 115.0, 115.0, 105.0, 112.0, 117.0, 116.0, 105.0, 106.0, 113.0, 97.0, 117.0, 111.0, 112.0, 113.0, 115.0, 112.0, 101.0, 8.0, 108.0, 101.0, 144.0, 500.0, 151.0, 393.0, 140.0, 145.0, 500.0, 152.0, 284.0, 500.0, 258.0, 500.0, 500.0, 500.0, 500.0, 91.0, 500.0, 500.0, 31.0, 86.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 331.0, 223.0, 235.0, 77.0, 222.0, 140.0, 117.0, 105.0, 114.0, 139.0, 393.0, 500.0, 500.0, 500.0, 36.0, 500.0, 500.0], "episode_lengths": [108, 102, 100, 104, 107, 114, 109, 500, 500, 411, 179, 427, 129, 122, 110, 136, 216, 175, 159, 499, 153, 500, 124, 132, 132, 500, 121, 111, 116, 115, 115, 105, 112, 117, 116, 105, 106, 113, 97, 117, 111, 112, 113, 115, 112, 101, 8, 108, 101, 144, 500, 151, 393, 140, 145, 500, 152, 284, 500, 258, 500, 500, 500, 500, 91, 500, 500, 31, 86, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 331, 223, 235, 77, 222, 140, 117, 105, 114, 139, 393, 500, 500, 500, 36, 500, 500], "policy_default_policy_reward": [108.0, 102.0, 100.0, 104.0, 107.0, 114.0, 109.0, 500.0, 500.0, 411.0, 179.0, 427.0, 129.0, 122.0, 110.0, 136.0, 216.0, 175.0, 159.0, 499.0, 153.0, 500.0, 124.0, 132.0, 132.0, 500.0, 121.0, 111.0, 116.0, 115.0, 115.0, 105.0, 112.0, 117.0, 116.0, 105.0, 106.0, 113.0, 97.0, 117.0, 111.0, 112.0, 113.0, 115.0, 112.0, 101.0, 8.0, 108.0, 101.0, 144.0, 500.0, 151.0, 393.0, 140.0, 145.0, 500.0, 152.0, 284.0, 500.0, 258.0, 500.0, 500.0, 500.0, 500.0, 91.0, 500.0, 500.0, 31.0, 86.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 331.0, 223.0, 235.0, 77.0, 222.0, 140.0, 117.0, 105.0, 114.0, 139.0, 393.0, 500.0, 500.0, 500.0, 36.0, 500.0, 500.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9999779664140712, "mean_inference_ms": 1.9920213843521932, "mean_action_processing_ms": 0.23258782738973124, "mean_env_wait_ms": 0.1004768549773753, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018111467361450195, "StateBufferConnector_ms": 0.016515254974365234, "ViewRequirementAgentConnector_ms": 0.20916008949279785}, "num_episodes": 2, "episode_return_max": 500.0, "episode_return_min": 8.0, "episode_return_mean": 263.02, "episodes_this_iter": 2}, "num_healthy_workers": 0, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 71000, "num_agent_steps_trained": 2240000, "num_env_steps_sampled": 71000, "num_env_steps_trained": 2240000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 30.862105832132613, "num_env_steps_trained_throughput_per_sec": 987.5873866282436, "timesteps_total": 71000, "num_env_steps_sampled_lifetime": 71000, "num_agent_steps_sampled_lifetime": 71000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 71000, "timers": {"training_iteration_time_ms": 33053.782, "restore_workers_time_ms": 0.021, "training_step_time_ms": 37.37, "sample_time_ms": 4.338, "load_time_ms": 0.261, "load_throughput": 122797.555, "learn_time_ms": 15.354, "learn_throughput": 2084.175, "synch_weights_time_ms": 0.05}, "counters": {"num_env_steps_sampled": 71000, "num_env_steps_trained": 2240000, "num_agent_steps_sampled": 71000, "num_agent_steps_trained": 2240000, "last_target_update_ts": 70501, "num_target_updates": 140}, "done": false, "training_iteration": 71, "trial_id": "5ce16_00000", "date": "2024-09-27_11-29-10", "timestamp": 1727407750, "time_this_iter_s": 32.40382790565491, "time_total_s": 2252.0131664276123, "pid": 39427, "hostname": "gpu2gate1", "node_ip": "10.64.32.126", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.9828407522030984, "lr": 0.0007583973879008875, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f52e4d75580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2252.0131664276123, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 15.621739130434783, "ram_util_percent": 11.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5198548436164856, "mean_q": 47.66695022583008, "min_q": 14.438894271850586, "max_q": 57.34952163696289, "cur_lr": 0.0007583973879008875}, "td_error": [0.27162933349609375, 13.438894271850586, 0.186187744140625, 0.2744789123535156, -0.06674957275390625, 0.008235931396484375, -0.20814895629882812, 0.17630767822265625, -0.313751220703125, 0.2012939453125, 0.003871917724609375, -0.10395050048828125, 0.49204254150390625, -0.0185699462890625, 0.3466835021972656, 0.7149124145507812, 0.217987060546875, -0.04741668701171875, -0.040607452392578125, 0.13032150268554688, -1.0593605041503906, 2.0492820739746094, 0.10036468505859375, 0.0887908935546875, 0.9304904937744141, 0.05023956298828125, -0.0467071533203125, 0.446075439453125, 0.32109832763671875, 0.08279037475585938, 0.3926353454589844, 0.2606086730957031], "mean_td_error": 0.6024987697601318, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 71000.0, "diff_num_grad_updates_vs_sampler_policy": 23925.4375}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 2272000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 2272000, "last_target_update_ts": 71501, "num_target_updates": 142}, "env_runners": {"episode_reward_max": 500.0, "episode_reward_min": 8.0, "episode_reward_mean": 270.92, "episode_len_mean": 270.92, "episode_media": {}, "episodes_timesteps_total": 27092, "policy_reward_min": {"default_policy": 8.0}, "policy_reward_max": {"default_policy": 500.0}, "policy_reward_mean": {"default_policy": 270.92}, "custom_metrics": {}, "hist_stats": {"episode_reward": [100.0, 104.0, 107.0, 114.0, 109.0, 500.0, 500.0, 411.0, 179.0, 427.0, 129.0, 122.0, 110.0, 136.0, 216.0, 175.0, 159.0, 499.0, 153.0, 500.0, 124.0, 132.0, 132.0, 500.0, 121.0, 111.0, 116.0, 115.0, 115.0, 105.0, 112.0, 117.0, 116.0, 105.0, 106.0, 113.0, 97.0, 117.0, 111.0, 112.0, 113.0, 115.0, 112.0, 101.0, 8.0, 108.0, 101.0, 144.0, 500.0, 151.0, 393.0, 140.0, 145.0, 500.0, 152.0, 284.0, 500.0, 258.0, 500.0, 500.0, 500.0, 500.0, 91.0, 500.0, 500.0, 31.0, 86.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 331.0, 223.0, 235.0, 77.0, 222.0, 140.0, 117.0, 105.0, 114.0, 139.0, 393.0, 500.0, 500.0, 500.0, 36.0, 500.0, 500.0, 500.0, 500.0], "episode_lengths": [100, 104, 107, 114, 109, 500, 500, 411, 179, 427, 129, 122, 110, 136, 216, 175, 159, 499, 153, 500, 124, 132, 132, 500, 121, 111, 116, 115, 115, 105, 112, 117, 116, 105, 106, 113, 97, 117, 111, 112, 113, 115, 112, 101, 8, 108, 101, 144, 500, 151, 393, 140, 145, 500, 152, 284, 500, 258, 500, 500, 500, 500, 91, 500, 500, 31, 86, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 331, 223, 235, 77, 222, 140, 117, 105, 114, 139, 393, 500, 500, 500, 36, 500, 500, 500, 500], "policy_default_policy_reward": [100.0, 104.0, 107.0, 114.0, 109.0, 500.0, 500.0, 411.0, 179.0, 427.0, 129.0, 122.0, 110.0, 136.0, 216.0, 175.0, 159.0, 499.0, 153.0, 500.0, 124.0, 132.0, 132.0, 500.0, 121.0, 111.0, 116.0, 115.0, 115.0, 105.0, 112.0, 117.0, 116.0, 105.0, 106.0, 113.0, 97.0, 117.0, 111.0, 112.0, 113.0, 115.0, 112.0, 101.0, 8.0, 108.0, 101.0, 144.0, 500.0, 151.0, 393.0, 140.0, 145.0, 500.0, 152.0, 284.0, 500.0, 258.0, 500.0, 500.0, 500.0, 500.0, 91.0, 500.0, 500.0, 31.0, 86.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 331.0, 223.0, 235.0, 77.0, 222.0, 140.0, 117.0, 105.0, 114.0, 139.0, 393.0, 500.0, 500.0, 500.0, 36.0, 500.0, 500.0, 500.0, 500.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0002698531638514, "mean_inference_ms": 1.9925640869041705, "mean_action_processing_ms": 0.2326591199367758, "mean_env_wait_ms": 0.10051405338050555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018069982528686523, "StateBufferConnector_ms": 0.01653265953063965, "ViewRequirementAgentConnector_ms": 0.20912384986877441}, "num_episodes": 2, "episode_return_max": 500.0, "episode_return_min": 8.0, "episode_return_mean": 270.92, "episodes_this_iter": 2}, "num_healthy_workers": 0, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 2272000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 2272000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 31.44044489937418, "num_env_steps_trained_throughput_per_sec": 1006.0942367799738, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 72000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 32875.963, "restore_workers_time_ms": 0.022, "training_step_time_ms": 32.537, "sample_time_ms": 3.721, "load_time_ms": 0.22, "load_throughput": 145430.413, "learn_time_ms": 13.728, "learn_throughput": 2330.994, "synch_weights_time_ms": 0.046}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 2272000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 2272000, "last_target_update_ts": 71501, "num_target_updates": 142}, "done": false, "training_iteration": 72, "trial_id": "5ce16_00000", "date": "2024-09-27_11-29-42", "timestamp": 1727407782, "time_this_iter_s": 31.807961463928223, "time_total_s": 2283.8211278915405, "pid": 39427, "hostname": "gpu2gate1", "node_ip": "10.64.32.126", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.9828407522030984, "lr": 0.0007583973879008875, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f52e4d75580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2283.8211278915405, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 15.068888888888889, "ram_util_percent": 11.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.16046985983848572, "mean_q": 44.95599365234375, "min_q": 12.446272850036621, "max_q": 56.5010986328125, "cur_lr": 0.0007583973879008875}, "td_error": [-0.0948333740234375, -0.6410160064697266, 0.021764755249023438, 0.07577133178710938, 1.3269672393798828, -0.5715560913085938, -0.3162574768066406, 0.20229339599609375, -0.07733154296875, 0.1738128662109375, 0.30097198486328125, -0.4180717468261719, -0.2715911865234375, 0.026073455810546875, 0.5059242248535156, 0.21291732788085938, 0.6892051696777344, 0.19805145263671875, 0.0723419189453125, -0.7250099182128906, -0.3668327331542969, 0.098480224609375, 0.05987548828125, -0.21971893310546875, 0.33766937255859375, 0.18330764770507812, -0.3999519348144531, 0.047336578369140625, 0.12128067016601562, 0.05234527587890625, -1.687967300415039, -0.8602085113525391], "mean_td_error": -0.0607486367225647, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 72000.0, "diff_num_grad_updates_vs_sampler_policy": 24206.5625}}, "num_env_steps_sampled": 73000, "num_env_steps_trained": 2304000, "num_agent_steps_sampled": 73000, "num_agent_steps_trained": 2304000, "last_target_update_ts": 72501, "num_target_updates": 144}, "env_runners": {"episode_reward_max": 500.0, "episode_reward_min": 8.0, "episode_reward_mean": 277.93, "episode_len_mean": 277.93, "episode_media": {}, "episodes_timesteps_total": 27793, "policy_reward_min": {"default_policy": 8.0}, "policy_reward_max": {"default_policy": 500.0}, "policy_reward_mean": {"default_policy": 277.93}, "custom_metrics": {}, "hist_stats": {"episode_reward": [114.0, 109.0, 500.0, 500.0, 411.0, 179.0, 427.0, 129.0, 122.0, 110.0, 136.0, 216.0, 175.0, 159.0, 499.0, 153.0, 500.0, 124.0, 132.0, 132.0, 500.0, 121.0, 111.0, 116.0, 115.0, 115.0, 105.0, 112.0, 117.0, 116.0, 105.0, 106.0, 113.0, 97.0, 117.0, 111.0, 112.0, 113.0, 115.0, 112.0, 101.0, 8.0, 108.0, 101.0, 144.0, 500.0, 151.0, 393.0, 140.0, 145.0, 500.0, 152.0, 284.0, 500.0, 258.0, 500.0, 500.0, 500.0, 500.0, 91.0, 500.0, 500.0, 31.0, 86.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 331.0, 223.0, 235.0, 77.0, 222.0, 140.0, 117.0, 105.0, 114.0, 139.0, 393.0, 500.0, 500.0, 500.0, 36.0, 500.0, 500.0, 500.0, 500.0, 500.0, 12.0, 500.0], "episode_lengths": [114, 109, 500, 500, 411, 179, 427, 129, 122, 110, 136, 216, 175, 159, 499, 153, 500, 124, 132, 132, 500, 121, 111, 116, 115, 115, 105, 112, 117, 116, 105, 106, 113, 97, 117, 111, 112, 113, 115, 112, 101, 8, 108, 101, 144, 500, 151, 393, 140, 145, 500, 152, 284, 500, 258, 500, 500, 500, 500, 91, 500, 500, 31, 86, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 331, 223, 235, 77, 222, 140, 117, 105, 114, 139, 393, 500, 500, 500, 36, 500, 500, 500, 500, 500, 12, 500], "policy_default_policy_reward": [114.0, 109.0, 500.0, 500.0, 411.0, 179.0, 427.0, 129.0, 122.0, 110.0, 136.0, 216.0, 175.0, 159.0, 499.0, 153.0, 500.0, 124.0, 132.0, 132.0, 500.0, 121.0, 111.0, 116.0, 115.0, 115.0, 105.0, 112.0, 117.0, 116.0, 105.0, 106.0, 113.0, 97.0, 117.0, 111.0, 112.0, 113.0, 115.0, 112.0, 101.0, 8.0, 108.0, 101.0, 144.0, 500.0, 151.0, 393.0, 140.0, 145.0, 500.0, 152.0, 284.0, 500.0, 258.0, 500.0, 500.0, 500.0, 500.0, 91.0, 500.0, 500.0, 31.0, 86.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 331.0, 223.0, 235.0, 77.0, 222.0, 140.0, 117.0, 105.0, 114.0, 139.0, 393.0, 500.0, 500.0, 500.0, 36.0, 500.0, 500.0, 500.0, 500.0, 500.0, 12.0, 500.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0007061166247682, "mean_inference_ms": 1.9933823602573457, "mean_action_processing_ms": 0.23276372704409642, "mean_env_wait_ms": 0.10056853867755616, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018103837966918945, "StateBufferConnector_ms": 0.016501188278198242, "ViewRequirementAgentConnector_ms": 0.20997834205627441}, "num_episodes": 3, "episode_return_max": 500.0, "episode_return_min": 8.0, "episode_return_mean": 277.93, "episodes_this_iter": 3}, "num_healthy_workers": 0, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 73000, "num_agent_steps_trained": 2304000, "num_env_steps_sampled": 73000, "num_env_steps_trained": 2304000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 30.211417342050108, "num_env_steps_trained_throughput_per_sec": 966.7653549456035, "timesteps_total": 73000, "num_env_steps_sampled_lifetime": 73000, "num_agent_steps_sampled_lifetime": 73000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 73000, "timers": {"training_iteration_time_ms": 33087.664, "restore_workers_time_ms": 0.021, "training_step_time_ms": 36.107, "sample_time_ms": 4.359, "load_time_ms": 0.222, "load_throughput": 144118.681, "learn_time_ms": 15.809, "learn_throughput": 2024.171, "synch_weights_time_ms": 0.044}, "counters": {"num_env_steps_sampled": 73000, "num_env_steps_trained": 2304000, "num_agent_steps_sampled": 73000, "num_agent_steps_trained": 2304000, "last_target_update_ts": 72501, "num_target_updates": 144}, "done": false, "training_iteration": 73, "trial_id": "5ce16_00000", "date": "2024-09-27_11-30-15", "timestamp": 1727407815, "time_this_iter_s": 33.10180115699768, "time_total_s": 2316.922929048538, "pid": 39427, "hostname": "gpu2gate1", "node_ip": "10.64.32.126", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.9828407522030984, "lr": 0.0007583973879008875, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f52e4d75580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2316.922929048538, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 14.848936170212765, "ram_util_percent": 11.272340425531914}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8053934574127197, "mean_q": 46.963478088378906, "min_q": 7.414666175842285, "max_q": 58.130741119384766, "cur_lr": 0.0007583973879008875}, "td_error": [-0.6681709289550781, 0.0973663330078125, -0.43230438232421875, -1.5340938568115234, -0.21701431274414062, 0.25412750244140625, -1.105194091796875, -0.015533447265625, 0.12042999267578125, -0.3968982696533203, -0.32523345947265625, -0.9010200500488281, 0.5262908935546875, 53.910484313964844, -0.15619659423828125, -0.028331756591796875, -0.5613899230957031, 0.6249542236328125, 18.034610748291016, 0.3278923034667969, -0.46982574462890625, -0.062366485595703125, -0.15291976928710938, -0.5763931274414062, 0.4205026626586914, -0.8851394653320312, -0.10589981079101562, -0.2873268127441406, -0.5867691040039062, -0.7392463684082031, -6.348886489868164, -0.22744369506835938], "mean_td_error": 1.797908067703247, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 73000.0, "diff_num_grad_updates_vs_sampler_policy": 22907.125}}, "num_env_steps_sampled": 74000, "num_env_steps_trained": 2336000, "num_agent_steps_sampled": 74000, "num_agent_steps_trained": 2336000, "last_target_update_ts": 73501, "num_target_updates": 146}, "env_runners": {"episode_reward_max": 500.0, "episode_reward_min": 8.0, "episode_reward_mean": 285.43, "episode_len_mean": 285.43, "episode_media": {}, "episodes_timesteps_total": 28543, "policy_reward_min": {"default_policy": 8.0}, "policy_reward_max": {"default_policy": 500.0}, "policy_reward_mean": {"default_policy": 285.43}, "custom_metrics": {}, "hist_stats": {"episode_reward": [500.0, 500.0, 411.0, 179.0, 427.0, 129.0, 122.0, 110.0, 136.0, 216.0, 175.0, 159.0, 499.0, 153.0, 500.0, 124.0, 132.0, 132.0, 500.0, 121.0, 111.0, 116.0, 115.0, 115.0, 105.0, 112.0, 117.0, 116.0, 105.0, 106.0, 113.0, 97.0, 117.0, 111.0, 112.0, 113.0, 115.0, 112.0, 101.0, 8.0, 108.0, 101.0, 144.0, 500.0, 151.0, 393.0, 140.0, 145.0, 500.0, 152.0, 284.0, 500.0, 258.0, 500.0, 500.0, 500.0, 500.0, 91.0, 500.0, 500.0, 31.0, 86.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 331.0, 223.0, 235.0, 77.0, 222.0, 140.0, 117.0, 105.0, 114.0, 139.0, 393.0, 500.0, 500.0, 500.0, 36.0, 500.0, 500.0, 500.0, 500.0, 500.0, 12.0, 500.0, 500.0, 473.0], "episode_lengths": [500, 500, 411, 179, 427, 129, 122, 110, 136, 216, 175, 159, 499, 153, 500, 124, 132, 132, 500, 121, 111, 116, 115, 115, 105, 112, 117, 116, 105, 106, 113, 97, 117, 111, 112, 113, 115, 112, 101, 8, 108, 101, 144, 500, 151, 393, 140, 145, 500, 152, 284, 500, 258, 500, 500, 500, 500, 91, 500, 500, 31, 86, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 331, 223, 235, 77, 222, 140, 117, 105, 114, 139, 393, 500, 500, 500, 36, 500, 500, 500, 500, 500, 12, 500, 500, 473], "policy_default_policy_reward": [500.0, 500.0, 411.0, 179.0, 427.0, 129.0, 122.0, 110.0, 136.0, 216.0, 175.0, 159.0, 499.0, 153.0, 500.0, 124.0, 132.0, 132.0, 500.0, 121.0, 111.0, 116.0, 115.0, 115.0, 105.0, 112.0, 117.0, 116.0, 105.0, 106.0, 113.0, 97.0, 117.0, 111.0, 112.0, 113.0, 115.0, 112.0, 101.0, 8.0, 108.0, 101.0, 144.0, 500.0, 151.0, 393.0, 140.0, 145.0, 500.0, 152.0, 284.0, 500.0, 258.0, 500.0, 500.0, 500.0, 500.0, 91.0, 500.0, 500.0, 31.0, 86.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 331.0, 223.0, 235.0, 77.0, 222.0, 140.0, 117.0, 105.0, 114.0, 139.0, 393.0, 500.0, 500.0, 500.0, 36.0, 500.0, 500.0, 500.0, 500.0, 500.0, 12.0, 500.0, 500.0, 473.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0010150019602824, "mean_inference_ms": 1.9940172442588833, "mean_action_processing_ms": 0.23283833319760064, "mean_env_wait_ms": 0.10060539146576873, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01814103126525879, "StateBufferConnector_ms": 0.01645660400390625, "ViewRequirementAgentConnector_ms": 0.20983147621154785}, "num_episodes": 2, "episode_return_max": 500.0, "episode_return_min": 8.0, "episode_return_mean": 285.43, "episodes_this_iter": 2}, "num_healthy_workers": 0, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 74000, "num_agent_steps_trained": 2336000, "num_env_steps_sampled": 74000, "num_env_steps_trained": 2336000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 26.473186984795685, "num_env_steps_trained_throughput_per_sec": 847.1419835134619, "timesteps_total": 74000, "num_env_steps_sampled_lifetime": 74000, "num_agent_steps_sampled_lifetime": 74000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 74000, "timers": {"training_iteration_time_ms": 33376.975, "restore_workers_time_ms": 0.021, "training_step_time_ms": 37.368, "sample_time_ms": 4.346, "load_time_ms": 0.243, "load_throughput": 131560.212, "learn_time_ms": 16.11, "learn_throughput": 1986.348, "synch_weights_time_ms": 0.055}, "counters": {"num_env_steps_sampled": 74000, "num_env_steps_trained": 2336000, "num_agent_steps_sampled": 74000, "num_agent_steps_trained": 2336000, "last_target_update_ts": 73501, "num_target_updates": 146}, "done": false, "training_iteration": 74, "trial_id": "5ce16_00000", "date": "2024-09-27_11-30-53", "timestamp": 1727407853, "time_this_iter_s": 37.77591347694397, "time_total_s": 2354.698842525482, "pid": 39427, "hostname": "gpu2gate1", "node_ip": "10.64.32.126", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.9828407522030984, "lr": 0.0007583973879008875, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f52e4d75580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2354.698842525482, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 14.943396226415093, "ram_util_percent": 11.299999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1426047086715698, "mean_q": 45.741268157958984, "min_q": 0.5241231918334961, "max_q": 58.8267822265625, "cur_lr": 0.0007583973879008875}, "td_error": [-0.04754638671875, 0.6995010375976562, -0.7193489074707031, 0.21274566650390625, 1.1971855163574219, 14.343011856079102, 0.459930419921875, 0.48128509521484375, 0.19543075561523438, 0.07926559448242188, 0.6088409423828125, 0.049976348876953125, 0.36589813232421875, 0.3770179748535156, 0.2527885437011719, -0.4758768081665039, 0.16566848754882812, -25.18457794189453, 0.4333038330078125, 0.017803192138671875, 0.01044464111328125, -1.9842939376831055, 0.6479644775390625, 0.3852882385253906, 0.2209014892578125, 0.3277435302734375, 0.16722488403320312, 0.8324546813964844, -0.060916900634765625, 9.063211441040039, 0.043628692626953125, 3.4031543731689453], "mean_td_error": 0.20528462529182434, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 74000.0, "diff_num_grad_updates_vs_sampler_policy": 28021.65625}}, "num_env_steps_sampled": 75000, "num_env_steps_trained": 2368000, "num_agent_steps_sampled": 75000, "num_agent_steps_trained": 2368000, "last_target_update_ts": 74501, "num_target_updates": 148}, "env_runners": {"episode_reward_max": 500.0, "episode_reward_min": 8.0, "episode_reward_mean": 285.43, "episode_len_mean": 285.43, "episode_media": {}, "episodes_timesteps_total": 28543, "policy_reward_min": {"default_policy": 8.0}, "policy_reward_max": {"default_policy": 500.0}, "policy_reward_mean": {"default_policy": 285.43}, "custom_metrics": {}, "hist_stats": {"episode_reward": [411.0, 179.0, 427.0, 129.0, 122.0, 110.0, 136.0, 216.0, 175.0, 159.0, 499.0, 153.0, 500.0, 124.0, 132.0, 132.0, 500.0, 121.0, 111.0, 116.0, 115.0, 115.0, 105.0, 112.0, 117.0, 116.0, 105.0, 106.0, 113.0, 97.0, 117.0, 111.0, 112.0, 113.0, 115.0, 112.0, 101.0, 8.0, 108.0, 101.0, 144.0, 500.0, 151.0, 393.0, 140.0, 145.0, 500.0, 152.0, 284.0, 500.0, 258.0, 500.0, 500.0, 500.0, 500.0, 91.0, 500.0, 500.0, 31.0, 86.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 331.0, 223.0, 235.0, 77.0, 222.0, 140.0, 117.0, 105.0, 114.0, 139.0, 393.0, 500.0, 500.0, 500.0, 36.0, 500.0, 500.0, 500.0, 500.0, 500.0, 12.0, 500.0, 500.0, 473.0, 500.0, 500.0], "episode_lengths": [411, 179, 427, 129, 122, 110, 136, 216, 175, 159, 499, 153, 500, 124, 132, 132, 500, 121, 111, 116, 115, 115, 105, 112, 117, 116, 105, 106, 113, 97, 117, 111, 112, 113, 115, 112, 101, 8, 108, 101, 144, 500, 151, 393, 140, 145, 500, 152, 284, 500, 258, 500, 500, 500, 500, 91, 500, 500, 31, 86, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 331, 223, 235, 77, 222, 140, 117, 105, 114, 139, 393, 500, 500, 500, 36, 500, 500, 500, 500, 500, 12, 500, 500, 473, 500, 500], "policy_default_policy_reward": [411.0, 179.0, 427.0, 129.0, 122.0, 110.0, 136.0, 216.0, 175.0, 159.0, 499.0, 153.0, 500.0, 124.0, 132.0, 132.0, 500.0, 121.0, 111.0, 116.0, 115.0, 115.0, 105.0, 112.0, 117.0, 116.0, 105.0, 106.0, 113.0, 97.0, 117.0, 111.0, 112.0, 113.0, 115.0, 112.0, 101.0, 8.0, 108.0, 101.0, 144.0, 500.0, 151.0, 393.0, 140.0, 145.0, 500.0, 152.0, 284.0, 500.0, 258.0, 500.0, 500.0, 500.0, 500.0, 91.0, 500.0, 500.0, 31.0, 86.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 331.0, 223.0, 235.0, 77.0, 222.0, 140.0, 117.0, 105.0, 114.0, 139.0, 393.0, 500.0, 500.0, 500.0, 36.0, 500.0, 500.0, 500.0, 500.0, 500.0, 12.0, 500.0, 500.0, 473.0, 500.0, 500.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.001322618129263, "mean_inference_ms": 1.9946931610911138, "mean_action_processing_ms": 0.23291327869798542, "mean_env_wait_ms": 0.10063925449785571, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018143653869628906, "StateBufferConnector_ms": 0.016446590423583984, "ViewRequirementAgentConnector_ms": 0.2094557285308838}, "num_episodes": 2, "episode_return_max": 500.0, "episode_return_min": 8.0, "episode_return_mean": 285.43, "episodes_this_iter": 2}, "num_healthy_workers": 0, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 75000, "num_agent_steps_trained": 2368000, "num_env_steps_sampled": 75000, "num_env_steps_trained": 2368000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 28.39963762955507, "num_env_steps_trained_throughput_per_sec": 908.7884041457622, "timesteps_total": 75000, "num_env_steps_sampled_lifetime": 75000, "num_agent_steps_sampled_lifetime": 75000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 75000, "timers": {"training_iteration_time_ms": 33563.07, "restore_workers_time_ms": 0.026, "training_step_time_ms": 35.956, "sample_time_ms": 4.172, "load_time_ms": 0.214, "load_throughput": 149446.307, "learn_time_ms": 15.558, "learn_throughput": 2056.797, "synch_weights_time_ms": 0.047}, "counters": {"num_env_steps_sampled": 75000, "num_env_steps_trained": 2368000, "num_agent_steps_sampled": 75000, "num_agent_steps_trained": 2368000, "last_target_update_ts": 74501, "num_target_updates": 148}, "done": false, "training_iteration": 75, "trial_id": "5ce16_00000", "date": "2024-09-27_11-31-29", "timestamp": 1727407889, "time_this_iter_s": 35.213313579559326, "time_total_s": 2389.9121561050415, "pid": 39427, "hostname": "gpu2gate1", "node_ip": "10.64.32.126", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.9828407522030984, "lr": 0.0007583973879008875, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f52e4d75580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2389.9121561050415, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 15.085999999999999, "ram_util_percent": 11.299999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.662793755531311, "mean_q": 46.283714294433594, "min_q": 3.9605584144592285, "max_q": 58.036258697509766, "cur_lr": 0.0007583973879008875}, "td_error": [0.08829498291015625, 0.5340538024902344, -0.13123321533203125, -1.8691482543945312, 1.1356277465820312, 0.5765953063964844, 0.6534843444824219, -0.09337997436523438, -0.16852951049804688, 0.107208251953125, -0.00337982177734375, 0.33452606201171875, 0.4816131591796875, 0.036376953125, -0.29660797119140625, 2.9605584144592285, -0.13300323486328125, 27.100263595581055, -0.00533294677734375, -0.0603485107421875, 0.4211311340332031, 0.4101524353027344, 0.3182029724121094, -2.209286689758301, -0.11651229858398438, 0.14137649536132812, -0.13423919677734375, 0.6335182189941406, 0.5553178787231445, 0.15264129638671875, -1.6321296691894531, 1.0312271118164062], "mean_td_error": 0.9630950093269348, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 75000.0, "diff_num_grad_updates_vs_sampler_policy": 24520.75}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 2400000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 2400000, "last_target_update_ts": 75501, "num_target_updates": 150}, "env_runners": {"episode_reward_max": 500.0, "episode_reward_min": 8.0, "episode_reward_mean": 286.7, "episode_len_mean": 286.7, "episode_media": {}, "episodes_timesteps_total": 28670, "policy_reward_min": {"default_policy": 8.0}, "policy_reward_max": {"default_policy": 500.0}, "policy_reward_mean": {"default_policy": 286.7}, "custom_metrics": {}, "hist_stats": {"episode_reward": [110.0, 136.0, 216.0, 175.0, 159.0, 499.0, 153.0, 500.0, 124.0, 132.0, 132.0, 500.0, 121.0, 111.0, 116.0, 115.0, 115.0, 105.0, 112.0, 117.0, 116.0, 105.0, 106.0, 113.0, 97.0, 117.0, 111.0, 112.0, 113.0, 115.0, 112.0, 101.0, 8.0, 108.0, 101.0, 144.0, 500.0, 151.0, 393.0, 140.0, 145.0, 500.0, 152.0, 284.0, 500.0, 258.0, 500.0, 500.0, 500.0, 500.0, 91.0, 500.0, 500.0, 31.0, 86.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 331.0, 223.0, 235.0, 77.0, 222.0, 140.0, 117.0, 105.0, 114.0, 139.0, 393.0, 500.0, 500.0, 500.0, 36.0, 500.0, 500.0, 500.0, 500.0, 500.0, 12.0, 500.0, 500.0, 473.0, 500.0, 500.0, 500.0, 393.0, 185.0, 144.0, 173.0], "episode_lengths": [110, 136, 216, 175, 159, 499, 153, 500, 124, 132, 132, 500, 121, 111, 116, 115, 115, 105, 112, 117, 116, 105, 106, 113, 97, 117, 111, 112, 113, 115, 112, 101, 8, 108, 101, 144, 500, 151, 393, 140, 145, 500, 152, 284, 500, 258, 500, 500, 500, 500, 91, 500, 500, 31, 86, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 331, 223, 235, 77, 222, 140, 117, 105, 114, 139, 393, 500, 500, 500, 36, 500, 500, 500, 500, 500, 12, 500, 500, 473, 500, 500, 500, 393, 185, 144, 173], "policy_default_policy_reward": [110.0, 136.0, 216.0, 175.0, 159.0, 499.0, 153.0, 500.0, 124.0, 132.0, 132.0, 500.0, 121.0, 111.0, 116.0, 115.0, 115.0, 105.0, 112.0, 117.0, 116.0, 105.0, 106.0, 113.0, 97.0, 117.0, 111.0, 112.0, 113.0, 115.0, 112.0, 101.0, 8.0, 108.0, 101.0, 144.0, 500.0, 151.0, 393.0, 140.0, 145.0, 500.0, 152.0, 284.0, 500.0, 258.0, 500.0, 500.0, 500.0, 500.0, 91.0, 500.0, 500.0, 31.0, 86.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 331.0, 223.0, 235.0, 77.0, 222.0, 140.0, 117.0, 105.0, 114.0, 139.0, 393.0, 500.0, 500.0, 500.0, 36.0, 500.0, 500.0, 500.0, 500.0, 500.0, 12.0, 500.0, 500.0, 473.0, 500.0, 500.0, 500.0, 393.0, 185.0, 144.0, 173.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0020691937557364, "mean_inference_ms": 1.996431906770082, "mean_action_processing_ms": 0.23308653018691175, "mean_env_wait_ms": 0.10071535794515153, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018097877502441406, "StateBufferConnector_ms": 0.01645970344543457, "ViewRequirementAgentConnector_ms": 0.2070941925048828}, "num_episodes": 5, "episode_return_max": 500.0, "episode_return_min": 8.0, "episode_return_mean": 286.7, "episodes_this_iter": 5}, "num_healthy_workers": 0, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 2400000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 2400000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 28.705773547997445, "num_env_steps_trained_throughput_per_sec": 918.5847535359183, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 76000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 33743.078, "restore_workers_time_ms": 0.019, "training_step_time_ms": 33.459, "sample_time_ms": 4.203, "load_time_ms": 0.194, "load_throughput": 165211.384, "learn_time_ms": 14.375, "learn_throughput": 2226.08, "synch_weights_time_ms": 0.041}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 2400000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 2400000, "last_target_update_ts": 75501, "num_target_updates": 150}, "done": false, "training_iteration": 76, "trial_id": "5ce16_00000", "date": "2024-09-27_11-32-04", "timestamp": 1727407924, "time_this_iter_s": 34.83885836601257, "time_total_s": 2424.751014471054, "pid": 39427, "hostname": "gpu2gate1", "node_ip": "10.64.32.126", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.9828407522030984, "lr": 0.0007583973879008875, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f52e4d75580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2424.751014471054, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 13.581632653061222, "ram_util_percent": 11.299999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.30040088295936584, "mean_q": 51.768760681152344, "min_q": -2.5937280654907227, "max_q": 57.7610969543457, "cur_lr": 0.0007583973879008875}, "td_error": [-0.8725357055664062, -0.301483154296875, 0.01885986328125, -0.14745712280273438, -0.2670249938964844, 0.07542800903320312, -1.0113983154296875, 0.4706230163574219, -0.1682281494140625, 0.28986358642578125, -3.5937280654907227, -0.2711982727050781, -0.2313385009765625, -0.6194381713867188, -0.17901992797851562, 0.028865814208984375, -0.16424179077148438, -0.363922119140625, 0.5932960510253906, -0.00951385498046875, 0.10033035278320312, -0.023242950439453125, 0.10635757446289062, -0.27568817138671875, 0.2115020751953125, 0.003963470458984375, -0.09276580810546875, -0.12166213989257812, 0.5636367797851562, 0.0894317626953125, -0.3171958923339844, 0.2778511047363281], "mean_td_error": -0.19378355145454407, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 76000.0, "diff_num_grad_updates_vs_sampler_policy": 25695.75}}, "num_env_steps_sampled": 77000, "num_env_steps_trained": 2432000, "num_agent_steps_sampled": 77000, "num_agent_steps_trained": 2432000, "last_target_update_ts": 76501, "num_target_updates": 152}, "env_runners": {"episode_reward_max": 500.0, "episode_reward_min": 8.0, "episode_reward_mean": 294.24, "episode_len_mean": 294.24, "episode_media": {}, "episodes_timesteps_total": 29424, "policy_reward_min": {"default_policy": 8.0}, "policy_reward_max": {"default_policy": 500.0}, "policy_reward_mean": {"default_policy": 294.24}, "custom_metrics": {}, "hist_stats": {"episode_reward": [216.0, 175.0, 159.0, 499.0, 153.0, 500.0, 124.0, 132.0, 132.0, 500.0, 121.0, 111.0, 116.0, 115.0, 115.0, 105.0, 112.0, 117.0, 116.0, 105.0, 106.0, 113.0, 97.0, 117.0, 111.0, 112.0, 113.0, 115.0, 112.0, 101.0, 8.0, 108.0, 101.0, 144.0, 500.0, 151.0, 393.0, 140.0, 145.0, 500.0, 152.0, 284.0, 500.0, 258.0, 500.0, 500.0, 500.0, 500.0, 91.0, 500.0, 500.0, 31.0, 86.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 331.0, 223.0, 235.0, 77.0, 222.0, 140.0, 117.0, 105.0, 114.0, 139.0, 393.0, 500.0, 500.0, 500.0, 36.0, 500.0, 500.0, 500.0, 500.0, 500.0, 12.0, 500.0, 500.0, 473.0, 500.0, 500.0, 500.0, 393.0, 185.0, 144.0, 173.0, 500.0, 500.0], "episode_lengths": [216, 175, 159, 499, 153, 500, 124, 132, 132, 500, 121, 111, 116, 115, 115, 105, 112, 117, 116, 105, 106, 113, 97, 117, 111, 112, 113, 115, 112, 101, 8, 108, 101, 144, 500, 151, 393, 140, 145, 500, 152, 284, 500, 258, 500, 500, 500, 500, 91, 500, 500, 31, 86, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 331, 223, 235, 77, 222, 140, 117, 105, 114, 139, 393, 500, 500, 500, 36, 500, 500, 500, 500, 500, 12, 500, 500, 473, 500, 500, 500, 393, 185, 144, 173, 500, 500], "policy_default_policy_reward": [216.0, 175.0, 159.0, 499.0, 153.0, 500.0, 124.0, 132.0, 132.0, 500.0, 121.0, 111.0, 116.0, 115.0, 115.0, 105.0, 112.0, 117.0, 116.0, 105.0, 106.0, 113.0, 97.0, 117.0, 111.0, 112.0, 113.0, 115.0, 112.0, 101.0, 8.0, 108.0, 101.0, 144.0, 500.0, 151.0, 393.0, 140.0, 145.0, 500.0, 152.0, 284.0, 500.0, 258.0, 500.0, 500.0, 500.0, 500.0, 91.0, 500.0, 500.0, 31.0, 86.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 331.0, 223.0, 235.0, 77.0, 222.0, 140.0, 117.0, 105.0, 114.0, 139.0, 393.0, 500.0, 500.0, 500.0, 36.0, 500.0, 500.0, 500.0, 500.0, 500.0, 12.0, 500.0, 500.0, 473.0, 500.0, 500.0, 500.0, 393.0, 185.0, 144.0, 173.0, 500.0, 500.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0023527882639278, "mean_inference_ms": 1.9971200274391998, "mean_action_processing_ms": 0.23315080306514055, "mean_env_wait_ms": 0.10074331774413985, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01801276206970215, "StateBufferConnector_ms": 0.016428709030151367, "ViewRequirementAgentConnector_ms": 0.2067732810974121}, "num_episodes": 2, "episode_return_max": 500.0, "episode_return_min": 8.0, "episode_return_mean": 294.24, "episodes_this_iter": 2}, "num_healthy_workers": 0, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 77000, "num_agent_steps_trained": 2432000, "num_env_steps_sampled": 77000, "num_env_steps_trained": 2432000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 30.776061722120613, "num_env_steps_trained_throughput_per_sec": 984.8339751078596, "timesteps_total": 77000, "num_env_steps_sampled_lifetime": 77000, "num_agent_steps_sampled_lifetime": 77000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 77000, "timers": {"training_iteration_time_ms": 33742.221, "restore_workers_time_ms": 0.018, "training_step_time_ms": 31.883, "sample_time_ms": 3.742, "load_time_ms": 0.205, "load_throughput": 156358.024, "learn_time_ms": 14.086, "learn_throughput": 2271.777, "synch_weights_time_ms": 0.043}, "counters": {"num_env_steps_sampled": 77000, "num_env_steps_trained": 2432000, "num_agent_steps_sampled": 77000, "num_agent_steps_trained": 2432000, "last_target_update_ts": 76501, "num_target_updates": 152}, "done": false, "training_iteration": 77, "trial_id": "5ce16_00000", "date": "2024-09-27_11-32-36", "timestamp": 1727407956, "time_this_iter_s": 32.49445056915283, "time_total_s": 2457.245465040207, "pid": 39427, "hostname": "gpu2gate1", "node_ip": "10.64.32.126", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.9828407522030984, "lr": 0.0007583973879008875, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f52e4d75580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2457.245465040207, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 11.669565217391305, "ram_util_percent": 11.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4844496548175812, "mean_q": 49.35436248779297, "min_q": 10.294036865234375, "max_q": 58.45060348510742, "cur_lr": 0.0007583973879008875}, "td_error": [0.27753448486328125, 0.18180465698242188, -0.10453033447265625, -4.385980606079102, 0.02782440185546875, -0.0218353271484375, 0.11495590209960938, -0.02207183837890625, 0.12076187133789062, 4.730201721191406, -0.686676025390625, -0.12243270874023438, -0.1330718994140625, -0.4810981750488281, 0.2716789245605469, 0.28548431396484375, -0.13623046875, 0.7334938049316406, -0.19287109375, 0.031829833984375, 0.16121673583984375, 0.39919281005859375, 0.21649932861328125, -0.004024505615234375, -0.16117095947265625, 0.0087432861328125, -1.5788860321044922, -0.043560028076171875, -10.325180053710938, 0.037395477294921875, -0.42029571533203125, -1.406332015991211], "mean_td_error": -0.39461344480514526, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 77000.0, "diff_num_grad_updates_vs_sampler_policy": 24252.28125}}, "num_env_steps_sampled": 78000, "num_env_steps_trained": 2464000, "num_agent_steps_sampled": 78000, "num_agent_steps_trained": 2464000, "last_target_update_ts": 77501, "num_target_updates": 154}, "env_runners": {"episode_reward_max": 500.0, "episode_reward_min": 8.0, "episode_reward_mean": 299.91, "episode_len_mean": 299.91, "episode_media": {}, "episodes_timesteps_total": 29991, "policy_reward_min": {"default_policy": 8.0}, "policy_reward_max": {"default_policy": 500.0}, "policy_reward_mean": {"default_policy": 299.91}, "custom_metrics": {}, "hist_stats": {"episode_reward": [159.0, 499.0, 153.0, 500.0, 124.0, 132.0, 132.0, 500.0, 121.0, 111.0, 116.0, 115.0, 115.0, 105.0, 112.0, 117.0, 116.0, 105.0, 106.0, 113.0, 97.0, 117.0, 111.0, 112.0, 113.0, 115.0, 112.0, 101.0, 8.0, 108.0, 101.0, 144.0, 500.0, 151.0, 393.0, 140.0, 145.0, 500.0, 152.0, 284.0, 500.0, 258.0, 500.0, 500.0, 500.0, 500.0, 91.0, 500.0, 500.0, 31.0, 86.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 331.0, 223.0, 235.0, 77.0, 222.0, 140.0, 117.0, 105.0, 114.0, 139.0, 393.0, 500.0, 500.0, 500.0, 36.0, 500.0, 500.0, 500.0, 500.0, 500.0, 12.0, 500.0, 500.0, 473.0, 500.0, 500.0, 500.0, 393.0, 185.0, 144.0, 173.0, 500.0, 500.0, 500.0, 458.0], "episode_lengths": [159, 499, 153, 500, 124, 132, 132, 500, 121, 111, 116, 115, 115, 105, 112, 117, 116, 105, 106, 113, 97, 117, 111, 112, 113, 115, 112, 101, 8, 108, 101, 144, 500, 151, 393, 140, 145, 500, 152, 284, 500, 258, 500, 500, 500, 500, 91, 500, 500, 31, 86, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 331, 223, 235, 77, 222, 140, 117, 105, 114, 139, 393, 500, 500, 500, 36, 500, 500, 500, 500, 500, 12, 500, 500, 473, 500, 500, 500, 393, 185, 144, 173, 500, 500, 500, 458], "policy_default_policy_reward": [159.0, 499.0, 153.0, 500.0, 124.0, 132.0, 132.0, 500.0, 121.0, 111.0, 116.0, 115.0, 115.0, 105.0, 112.0, 117.0, 116.0, 105.0, 106.0, 113.0, 97.0, 117.0, 111.0, 112.0, 113.0, 115.0, 112.0, 101.0, 8.0, 108.0, 101.0, 144.0, 500.0, 151.0, 393.0, 140.0, 145.0, 500.0, 152.0, 284.0, 500.0, 258.0, 500.0, 500.0, 500.0, 500.0, 91.0, 500.0, 500.0, 31.0, 86.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 331.0, 223.0, 235.0, 77.0, 222.0, 140.0, 117.0, 105.0, 114.0, 139.0, 393.0, 500.0, 500.0, 500.0, 36.0, 500.0, 500.0, 500.0, 500.0, 500.0, 12.0, 500.0, 500.0, 473.0, 500.0, 500.0, 500.0, 393.0, 185.0, 144.0, 173.0, 500.0, 500.0, 500.0, 458.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.002658709153178, "mean_inference_ms": 1.997860001717464, "mean_action_processing_ms": 0.23322050855083273, "mean_env_wait_ms": 0.10077432922264032, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01793503761291504, "StateBufferConnector_ms": 0.016475200653076172, "ViewRequirementAgentConnector_ms": 0.2074298858642578}, "num_episodes": 2, "episode_return_max": 500.0, "episode_return_min": 8.0, "episode_return_mean": 299.91, "episodes_this_iter": 2}, "num_healthy_workers": 0, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 78000, "num_agent_steps_trained": 2464000, "num_env_steps_sampled": 78000, "num_env_steps_trained": 2464000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 27.955515081723732, "num_env_steps_trained_throughput_per_sec": 894.5764826151594, "timesteps_total": 78000, "num_env_steps_sampled_lifetime": 78000, "num_agent_steps_sampled_lifetime": 78000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 78000, "timers": {"training_iteration_time_ms": 34053.272, "restore_workers_time_ms": 0.023, "training_step_time_ms": 33.592, "sample_time_ms": 4.077, "load_time_ms": 0.231, "load_throughput": 138769.363, "learn_time_ms": 14.066, "learn_throughput": 2274.977, "synch_weights_time_ms": 0.05}, "counters": {"num_env_steps_sampled": 78000, "num_env_steps_trained": 2464000, "num_agent_steps_sampled": 78000, "num_agent_steps_trained": 2464000, "last_target_update_ts": 77501, "num_target_updates": 154}, "done": false, "training_iteration": 78, "trial_id": "5ce16_00000", "date": "2024-09-27_11-33-12", "timestamp": 1727407992, "time_this_iter_s": 35.77318048477173, "time_total_s": 2493.0186455249786, "pid": 39427, "hostname": "gpu2gate1", "node_ip": "10.64.32.126", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.9828407522030984, "lr": 0.0007583973879008875, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f52e4d75580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2493.0186455249786, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 11.786274509803924, "ram_util_percent": 11.299999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.2665620446205139, "mean_q": 48.49767303466797, "min_q": 8.96225357055664, "max_q": 58.232521057128906, "cur_lr": 0.0007583973879008875}, "td_error": [-0.05965423583984375, -0.006378173828125, 1.6064643859863281, 0.0392913818359375, 0.14380264282226562, -0.3904533386230469, -0.24190902709960938, 0.14504241943359375, 0.186920166015625, -0.0879974365234375, -0.055355072021484375, 0.35858154296875, 0.7721099853515625, 0.46621131896972656, -0.4407615661621094, 0.06415939331054688, -1.1577796936035156, 4.665924072265625, -1.340378761291504, 0.7799911499023438, -1.23297119140625, 0.11849594116210938, -0.14953994750976562, -0.4687843322753906, -0.2513275146484375, -0.3617286682128906, -0.6602325439453125, -0.18387222290039062, -1.1701717376708984, 1.0214042663574219, -1.524510383605957, -0.17916488647460938], "mean_td_error": 0.012669622898101807, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 78000.0, "diff_num_grad_updates_vs_sampler_policy": 20264.15625}}, "num_env_steps_sampled": 79000, "num_env_steps_trained": 2496000, "num_agent_steps_sampled": 79000, "num_agent_steps_trained": 2496000, "last_target_update_ts": 78501, "num_target_updates": 156}, "env_runners": {"episode_reward_max": 500.0, "episode_reward_min": 8.0, "episode_reward_mean": 303.33, "episode_len_mean": 303.33, "episode_media": {}, "episodes_timesteps_total": 30333, "policy_reward_min": {"default_policy": 8.0}, "policy_reward_max": {"default_policy": 500.0}, "policy_reward_mean": {"default_policy": 303.33}, "custom_metrics": {}, "hist_stats": {"episode_reward": [153.0, 500.0, 124.0, 132.0, 132.0, 500.0, 121.0, 111.0, 116.0, 115.0, 115.0, 105.0, 112.0, 117.0, 116.0, 105.0, 106.0, 113.0, 97.0, 117.0, 111.0, 112.0, 113.0, 115.0, 112.0, 101.0, 8.0, 108.0, 101.0, 144.0, 500.0, 151.0, 393.0, 140.0, 145.0, 500.0, 152.0, 284.0, 500.0, 258.0, 500.0, 500.0, 500.0, 500.0, 91.0, 500.0, 500.0, 31.0, 86.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 331.0, 223.0, 235.0, 77.0, 222.0, 140.0, 117.0, 105.0, 114.0, 139.0, 393.0, 500.0, 500.0, 500.0, 36.0, 500.0, 500.0, 500.0, 500.0, 500.0, 12.0, 500.0, 500.0, 473.0, 500.0, 500.0, 500.0, 393.0, 185.0, 144.0, 173.0, 500.0, 500.0, 500.0, 458.0, 500.0, 500.0], "episode_lengths": [153, 500, 124, 132, 132, 500, 121, 111, 116, 115, 115, 105, 112, 117, 116, 105, 106, 113, 97, 117, 111, 112, 113, 115, 112, 101, 8, 108, 101, 144, 500, 151, 393, 140, 145, 500, 152, 284, 500, 258, 500, 500, 500, 500, 91, 500, 500, 31, 86, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 331, 223, 235, 77, 222, 140, 117, 105, 114, 139, 393, 500, 500, 500, 36, 500, 500, 500, 500, 500, 12, 500, 500, 473, 500, 500, 500, 393, 185, 144, 173, 500, 500, 500, 458, 500, 500], "policy_default_policy_reward": [153.0, 500.0, 124.0, 132.0, 132.0, 500.0, 121.0, 111.0, 116.0, 115.0, 115.0, 105.0, 112.0, 117.0, 116.0, 105.0, 106.0, 113.0, 97.0, 117.0, 111.0, 112.0, 113.0, 115.0, 112.0, 101.0, 8.0, 108.0, 101.0, 144.0, 500.0, 151.0, 393.0, 140.0, 145.0, 500.0, 152.0, 284.0, 500.0, 258.0, 500.0, 500.0, 500.0, 500.0, 91.0, 500.0, 500.0, 31.0, 86.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 331.0, 223.0, 235.0, 77.0, 222.0, 140.0, 117.0, 105.0, 114.0, 139.0, 393.0, 500.0, 500.0, 500.0, 36.0, 500.0, 500.0, 500.0, 500.0, 500.0, 12.0, 500.0, 500.0, 473.0, 500.0, 500.0, 500.0, 393.0, 185.0, 144.0, 173.0, 500.0, 500.0, 500.0, 458.0, 500.0, 500.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.002975339753884, "mean_inference_ms": 1.9986511325750769, "mean_action_processing_ms": 0.2332917332794301, "mean_env_wait_ms": 0.10080585975893495, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018009424209594727, "StateBufferConnector_ms": 0.016509532928466797, "ViewRequirementAgentConnector_ms": 0.20777511596679688}, "num_episodes": 2, "episode_return_max": 500.0, "episode_return_min": 8.0, "episode_return_mean": 303.33, "episodes_this_iter": 2}, "num_healthy_workers": 0, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 79000, "num_agent_steps_trained": 2496000, "num_env_steps_sampled": 79000, "num_env_steps_trained": 2496000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 28.11155691054371, "num_env_steps_trained_throughput_per_sec": 899.5698211373988, "timesteps_total": 79000, "num_env_steps_sampled_lifetime": 79000, "num_agent_steps_sampled_lifetime": 79000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 79000, "timers": {"training_iteration_time_ms": 34276.641, "restore_workers_time_ms": 0.023, "training_step_time_ms": 37.089, "sample_time_ms": 4.281, "load_time_ms": 0.275, "load_throughput": 116407.396, "learn_time_ms": 15.751, "learn_throughput": 2031.663, "synch_weights_time_ms": 0.054}, "counters": {"num_env_steps_sampled": 79000, "num_env_steps_trained": 2496000, "num_agent_steps_sampled": 79000, "num_agent_steps_trained": 2496000, "last_target_update_ts": 78501, "num_target_updates": 156}, "done": false, "training_iteration": 79, "trial_id": "5ce16_00000", "date": "2024-09-27_11-33-48", "timestamp": 1727408028, "time_this_iter_s": 35.5750949382782, "time_total_s": 2528.593740463257, "pid": 39427, "hostname": "gpu2gate1", "node_ip": "10.64.32.126", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.9828407522030984, "lr": 0.0007583973879008875, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f52e4d75580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2528.593740463257, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 11.68, "ram_util_percent": 11.299999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.35030362010002136, "mean_q": 49.80915069580078, "min_q": 6.348712921142578, "max_q": 57.78923416137695, "cur_lr": 0.0007583973879008875}, "td_error": [0.5143852233886719, 0.00121307373046875, -0.0334625244140625, -0.9141073226928711, 0.2564544677734375, -0.2159423828125, -0.21539688110351562, 0.055912017822265625, 0.1343841552734375, -0.16979598999023438, -0.06963348388671875, 0.036708831787109375, 0.04144287109375, -0.18010711669921875, 13.918989181518555, 0.13026046752929688, 0.4829292297363281, -0.06924819946289062, -3.616741180419922, 0.3390007019042969, 0.15659713745117188, -1.275766372680664, 0.181396484375, 6.046966552734375, 0.20391464233398438, 17.266700744628906, 0.14884567260742188, 11.043326377868652, -0.0035247802734375, -0.01947784423828125, -0.027740478515625, 0.16286849975585938], "mean_td_error": 1.3847297430038452, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 79000.0, "diff_num_grad_updates_vs_sampler_policy": 23781.40625}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 2528000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 2528000, "last_target_update_ts": 79501, "num_target_updates": 158}, "env_runners": {"episode_reward_max": 500.0, "episode_reward_min": 8.0, "episode_reward_mean": 304.58, "episode_len_mean": 304.58, "episode_media": {}, "episodes_timesteps_total": 30458, "policy_reward_min": {"default_policy": 8.0}, "policy_reward_max": {"default_policy": 500.0}, "policy_reward_mean": {"default_policy": 304.58}, "custom_metrics": {}, "hist_stats": {"episode_reward": [124.0, 132.0, 132.0, 500.0, 121.0, 111.0, 116.0, 115.0, 115.0, 105.0, 112.0, 117.0, 116.0, 105.0, 106.0, 113.0, 97.0, 117.0, 111.0, 112.0, 113.0, 115.0, 112.0, 101.0, 8.0, 108.0, 101.0, 144.0, 500.0, 151.0, 393.0, 140.0, 145.0, 500.0, 152.0, 284.0, 500.0, 258.0, 500.0, 500.0, 500.0, 500.0, 91.0, 500.0, 500.0, 31.0, 86.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 331.0, 223.0, 235.0, 77.0, 222.0, 140.0, 117.0, 105.0, 114.0, 139.0, 393.0, 500.0, 500.0, 500.0, 36.0, 500.0, 500.0, 500.0, 500.0, 500.0, 12.0, 500.0, 500.0, 473.0, 500.0, 500.0, 500.0, 393.0, 185.0, 144.0, 173.0, 500.0, 500.0, 500.0, 458.0, 500.0, 500.0, 500.0, 278.0], "episode_lengths": [124, 132, 132, 500, 121, 111, 116, 115, 115, 105, 112, 117, 116, 105, 106, 113, 97, 117, 111, 112, 113, 115, 112, 101, 8, 108, 101, 144, 500, 151, 393, 140, 145, 500, 152, 284, 500, 258, 500, 500, 500, 500, 91, 500, 500, 31, 86, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 331, 223, 235, 77, 222, 140, 117, 105, 114, 139, 393, 500, 500, 500, 36, 500, 500, 500, 500, 500, 12, 500, 500, 473, 500, 500, 500, 393, 185, 144, 173, 500, 500, 500, 458, 500, 500, 500, 278], "policy_default_policy_reward": [124.0, 132.0, 132.0, 500.0, 121.0, 111.0, 116.0, 115.0, 115.0, 105.0, 112.0, 117.0, 116.0, 105.0, 106.0, 113.0, 97.0, 117.0, 111.0, 112.0, 113.0, 115.0, 112.0, 101.0, 8.0, 108.0, 101.0, 144.0, 500.0, 151.0, 393.0, 140.0, 145.0, 500.0, 152.0, 284.0, 500.0, 258.0, 500.0, 500.0, 500.0, 500.0, 91.0, 500.0, 500.0, 31.0, 86.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 331.0, 223.0, 235.0, 77.0, 222.0, 140.0, 117.0, 105.0, 114.0, 139.0, 393.0, 500.0, 500.0, 500.0, 36.0, 500.0, 500.0, 500.0, 500.0, 500.0, 12.0, 500.0, 500.0, 473.0, 500.0, 500.0, 500.0, 393.0, 185.0, 144.0, 173.0, 500.0, 500.0, 500.0, 458.0, 500.0, 500.0, 500.0, 278.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.003261702727099, "mean_inference_ms": 1.9993885390613397, "mean_action_processing_ms": 0.2333545654069584, "mean_env_wait_ms": 0.10083310722083492, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017988204956054688, "StateBufferConnector_ms": 0.016449928283691406, "ViewRequirementAgentConnector_ms": 0.20732593536376953}, "num_episodes": 2, "episode_return_max": 500.0, "episode_return_min": 8.0, "episode_return_mean": 304.58, "episodes_this_iter": 2}, "num_healthy_workers": 0, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 2528000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 2528000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 32.49966398526937, "num_env_steps_trained_throughput_per_sec": 1039.98924752862, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 33973.721, "restore_workers_time_ms": 0.018, "training_step_time_ms": 31.319, "sample_time_ms": 3.649, "load_time_ms": 0.2, "load_throughput": 160068.847, "learn_time_ms": 13.143, "learn_throughput": 2434.811, "synch_weights_time_ms": 0.041}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 2528000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 2528000, "last_target_update_ts": 79501, "num_target_updates": 158}, "done": false, "training_iteration": 80, "trial_id": "5ce16_00000", "date": "2024-09-27_11-34-19", "timestamp": 1727408059, "time_this_iter_s": 30.771332025527954, "time_total_s": 2559.365072488785, "pid": 39427, "hostname": "gpu2gate1", "node_ip": "10.64.32.126", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.9828407522030984, "lr": 0.0007583973879008875, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f52e4d75580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2559.365072488785, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 11.656818181818181, "ram_util_percent": 11.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2325555086135864, "mean_q": 51.59847640991211, "min_q": 7.72849178314209, "max_q": 58.62686538696289, "cur_lr": 0.0007583973879008875}, "td_error": [0.6880722045898438, 0.05494403839111328, 0.0203857421875, 1.8246374130249023, 0.694366455078125, 0.6409568786621094, 0.318817138671875, -0.12055206298828125, 0.3423957824707031, 0.6576919555664062, 0.46176910400390625, 0.3053703308105469, 0.1074371337890625, 0.08586502075195312, -0.09958648681640625, -0.01781463623046875, 0.4310150146484375, 0.4636116027832031, 0.43732452392578125, 0.6064720153808594, 0.2449951171875, -0.0636444091796875, 0.139434814453125, 0.5613765716552734, 0.19469451904296875, -0.19810867309570312, 0.111968994140625, -0.04026031494140625, 0.3535957336425781, 0.5336990356445312, 0.7116203308105469, 0.3288841247558594], "mean_td_error": 0.3369198441505432, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 80000.0, "diff_num_grad_updates_vs_sampler_policy": 26914.25}}, "num_env_steps_sampled": 81000, "num_env_steps_trained": 2560000, "num_agent_steps_sampled": 81000, "num_agent_steps_trained": 2560000, "last_target_update_ts": 80501, "num_target_updates": 160}, "env_runners": {"episode_reward_max": 500.0, "episode_reward_min": 8.0, "episode_reward_mean": 312.02, "episode_len_mean": 312.02, "episode_media": {}, "episodes_timesteps_total": 31202, "policy_reward_min": {"default_policy": 8.0}, "policy_reward_max": {"default_policy": 500.0}, "policy_reward_mean": {"default_policy": 312.02}, "custom_metrics": {}, "hist_stats": {"episode_reward": [132.0, 500.0, 121.0, 111.0, 116.0, 115.0, 115.0, 105.0, 112.0, 117.0, 116.0, 105.0, 106.0, 113.0, 97.0, 117.0, 111.0, 112.0, 113.0, 115.0, 112.0, 101.0, 8.0, 108.0, 101.0, 144.0, 500.0, 151.0, 393.0, 140.0, 145.0, 500.0, 152.0, 284.0, 500.0, 258.0, 500.0, 500.0, 500.0, 500.0, 91.0, 500.0, 500.0, 31.0, 86.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 331.0, 223.0, 235.0, 77.0, 222.0, 140.0, 117.0, 105.0, 114.0, 139.0, 393.0, 500.0, 500.0, 500.0, 36.0, 500.0, 500.0, 500.0, 500.0, 500.0, 12.0, 500.0, 500.0, 473.0, 500.0, 500.0, 500.0, 393.0, 185.0, 144.0, 173.0, 500.0, 500.0, 500.0, 458.0, 500.0, 500.0, 500.0, 278.0, 500.0, 500.0], "episode_lengths": [132, 500, 121, 111, 116, 115, 115, 105, 112, 117, 116, 105, 106, 113, 97, 117, 111, 112, 113, 115, 112, 101, 8, 108, 101, 144, 500, 151, 393, 140, 145, 500, 152, 284, 500, 258, 500, 500, 500, 500, 91, 500, 500, 31, 86, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 331, 223, 235, 77, 222, 140, 117, 105, 114, 139, 393, 500, 500, 500, 36, 500, 500, 500, 500, 500, 12, 500, 500, 473, 500, 500, 500, 393, 185, 144, 173, 500, 500, 500, 458, 500, 500, 500, 278, 500, 500], "policy_default_policy_reward": [132.0, 500.0, 121.0, 111.0, 116.0, 115.0, 115.0, 105.0, 112.0, 117.0, 116.0, 105.0, 106.0, 113.0, 97.0, 117.0, 111.0, 112.0, 113.0, 115.0, 112.0, 101.0, 8.0, 108.0, 101.0, 144.0, 500.0, 151.0, 393.0, 140.0, 145.0, 500.0, 152.0, 284.0, 500.0, 258.0, 500.0, 500.0, 500.0, 500.0, 91.0, 500.0, 500.0, 31.0, 86.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 331.0, 223.0, 235.0, 77.0, 222.0, 140.0, 117.0, 105.0, 114.0, 139.0, 393.0, 500.0, 500.0, 500.0, 36.0, 500.0, 500.0, 500.0, 500.0, 500.0, 12.0, 500.0, 500.0, 473.0, 500.0, 500.0, 500.0, 393.0, 185.0, 144.0, 173.0, 500.0, 500.0, 500.0, 458.0, 500.0, 500.0, 500.0, 278.0, 500.0, 500.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0035528598800652, "mean_inference_ms": 2.000147138137645, "mean_action_processing_ms": 0.23341630499597188, "mean_env_wait_ms": 0.10086079946907407, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01803445816040039, "StateBufferConnector_ms": 0.016473054885864258, "ViewRequirementAgentConnector_ms": 0.2078399658203125}, "num_episodes": 2, "episode_return_max": 500.0, "episode_return_min": 8.0, "episode_return_mean": 312.02, "episodes_this_iter": 2}, "num_healthy_workers": 0, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 81000, "num_agent_steps_trained": 2560000, "num_env_steps_sampled": 81000, "num_env_steps_trained": 2560000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 29.026941755600333, "num_env_steps_trained_throughput_per_sec": 928.8621361792107, "timesteps_total": 81000, "num_env_steps_sampled_lifetime": 81000, "num_agent_steps_sampled_lifetime": 81000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 81000, "timers": {"training_iteration_time_ms": 34178.576, "restore_workers_time_ms": 0.02, "training_step_time_ms": 28.529, "sample_time_ms": 3.293, "load_time_ms": 0.178, "load_throughput": 179820.107, "learn_time_ms": 12.323, "learn_throughput": 2596.72, "synch_weights_time_ms": 0.046}, "counters": {"num_env_steps_sampled": 81000, "num_env_steps_trained": 2560000, "num_agent_steps_sampled": 81000, "num_agent_steps_trained": 2560000, "last_target_update_ts": 80501, "num_target_updates": 160}, "done": false, "training_iteration": 81, "trial_id": "5ce16_00000", "date": "2024-09-27_11-34-53", "timestamp": 1727408093, "time_this_iter_s": 34.45257115364075, "time_total_s": 2593.8176436424255, "pid": 39427, "hostname": "gpu2gate1", "node_ip": "10.64.32.126", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.9828407522030984, "lr": 0.0007583973879008875, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f52e4d75580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2593.8176436424255, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 11.825000000000001, "ram_util_percent": 11.299999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6568522453308105, "mean_q": 50.93098449707031, "min_q": 9.200511932373047, "max_q": 58.735042572021484, "cur_lr": 0.0007583973879008875}, "td_error": [24.380462646484375, 0.16603851318359375, -0.19580841064453125, 55.4991569519043, -0.08699417114257812, 0.18512725830078125, 0.07050704956054688, 0.041454315185546875, 0.029415130615234375, 0.15537643432617188, -0.2622528076171875, 3.3147735595703125, 1.9262962341308594, 0.14690780639648438, 0.2250213623046875, 8.200511932373047, -0.3124351501464844, -0.13510513305664062, -0.046024322509765625, 3.3147735595703125, -0.16735076904296875, -0.048755645751953125, 0.22731781005859375, -0.11931228637695312, 0.012584686279296875, -0.16738128662109375, 6.3354668617248535, 0.26264190673828125, 0.009716033935546875, 0.201812744140625, -0.25502777099609375, 0.044742584228515625], "mean_td_error": 3.217302083969116, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 81000.0, "diff_num_grad_updates_vs_sampler_policy": 23770.6875}}, "num_env_steps_sampled": 82000, "num_env_steps_trained": 2592000, "num_agent_steps_sampled": 82000, "num_agent_steps_trained": 2592000, "last_target_update_ts": 81501, "num_target_updates": 162}, "env_runners": {"episode_reward_max": 500.0, "episode_reward_min": 8.0, "episode_reward_mean": 315.7, "episode_len_mean": 315.7, "episode_media": {}, "episodes_timesteps_total": 31570, "policy_reward_min": {"default_policy": 8.0}, "policy_reward_max": {"default_policy": 500.0}, "policy_reward_mean": {"default_policy": 315.7}, "custom_metrics": {}, "hist_stats": {"episode_reward": [121.0, 111.0, 116.0, 115.0, 115.0, 105.0, 112.0, 117.0, 116.0, 105.0, 106.0, 113.0, 97.0, 117.0, 111.0, 112.0, 113.0, 115.0, 112.0, 101.0, 8.0, 108.0, 101.0, 144.0, 500.0, 151.0, 393.0, 140.0, 145.0, 500.0, 152.0, 284.0, 500.0, 258.0, 500.0, 500.0, 500.0, 500.0, 91.0, 500.0, 500.0, 31.0, 86.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 331.0, 223.0, 235.0, 77.0, 222.0, 140.0, 117.0, 105.0, 114.0, 139.0, 393.0, 500.0, 500.0, 500.0, 36.0, 500.0, 500.0, 500.0, 500.0, 500.0, 12.0, 500.0, 500.0, 473.0, 500.0, 500.0, 500.0, 393.0, 185.0, 144.0, 173.0, 500.0, 500.0, 500.0, 458.0, 500.0, 500.0, 500.0, 278.0, 500.0, 500.0, 500.0, 500.0], "episode_lengths": [121, 111, 116, 115, 115, 105, 112, 117, 116, 105, 106, 113, 97, 117, 111, 112, 113, 115, 112, 101, 8, 108, 101, 144, 500, 151, 393, 140, 145, 500, 152, 284, 500, 258, 500, 500, 500, 500, 91, 500, 500, 31, 86, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 331, 223, 235, 77, 222, 140, 117, 105, 114, 139, 393, 500, 500, 500, 36, 500, 500, 500, 500, 500, 12, 500, 500, 473, 500, 500, 500, 393, 185, 144, 173, 500, 500, 500, 458, 500, 500, 500, 278, 500, 500, 500, 500], "policy_default_policy_reward": [121.0, 111.0, 116.0, 115.0, 115.0, 105.0, 112.0, 117.0, 116.0, 105.0, 106.0, 113.0, 97.0, 117.0, 111.0, 112.0, 113.0, 115.0, 112.0, 101.0, 8.0, 108.0, 101.0, 144.0, 500.0, 151.0, 393.0, 140.0, 145.0, 500.0, 152.0, 284.0, 500.0, 258.0, 500.0, 500.0, 500.0, 500.0, 91.0, 500.0, 500.0, 31.0, 86.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 331.0, 223.0, 235.0, 77.0, 222.0, 140.0, 117.0, 105.0, 114.0, 139.0, 393.0, 500.0, 500.0, 500.0, 36.0, 500.0, 500.0, 500.0, 500.0, 500.0, 12.0, 500.0, 500.0, 473.0, 500.0, 500.0, 500.0, 393.0, 185.0, 144.0, 173.0, 500.0, 500.0, 500.0, 458.0, 500.0, 500.0, 500.0, 278.0, 500.0, 500.0, 500.0, 500.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0038300521302144, "mean_inference_ms": 2.0008900233054443, "mean_action_processing_ms": 0.23347467736016334, "mean_env_wait_ms": 0.10088624553130816, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018009662628173828, "StateBufferConnector_ms": 0.016412019729614258, "ViewRequirementAgentConnector_ms": 0.20735836029052734}, "num_episodes": 2, "episode_return_max": 500.0, "episode_return_min": 8.0, "episode_return_mean": 315.7, "episodes_this_iter": 2}, "num_healthy_workers": 0, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 82000, "num_agent_steps_trained": 2592000, "num_env_steps_sampled": 82000, "num_env_steps_trained": 2592000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 29.986172043265665, "num_env_steps_trained_throughput_per_sec": 959.5575053845013, "timesteps_total": 82000, "num_env_steps_sampled_lifetime": 82000, "num_agent_steps_sampled_lifetime": 82000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 82000, "timers": {"training_iteration_time_ms": 34332.83, "restore_workers_time_ms": 0.022, "training_step_time_ms": 33.041, "sample_time_ms": 3.98, "load_time_ms": 0.213, "load_throughput": 150165.281, "learn_time_ms": 13.679, "learn_throughput": 2339.344, "synch_weights_time_ms": 0.046}, "counters": {"num_env_steps_sampled": 82000, "num_env_steps_trained": 2592000, "num_agent_steps_sampled": 82000, "num_agent_steps_trained": 2592000, "last_target_update_ts": 81501, "num_target_updates": 162}, "done": false, "training_iteration": 82, "trial_id": "5ce16_00000", "date": "2024-09-27_11-35-27", "timestamp": 1727408127, "time_this_iter_s": 33.3502836227417, "time_total_s": 2627.1679272651672, "pid": 39427, "hostname": "gpu2gate1", "node_ip": "10.64.32.126", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.9828407522030984, "lr": 0.0007583973879008875, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f52e4d75580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2627.1679272651672, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 12.204255319148936, "ram_util_percent": 11.391489361702124}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5244075655937195, "mean_q": 51.371063232421875, "min_q": 1.1421571969985962, "max_q": 57.94809341430664, "cur_lr": 0.0007583973879008875}, "td_error": [0.1421571969985962, -0.6599235534667969, -0.10132217407226562, 0.047077178955078125, 0.0680389404296875, -0.8521232604980469, 0.5974998474121094, -0.2624778747558594, -0.3351287841796875, 0.2540016174316406, 0.15329360961914062, 0.20199966430664062, 0.20170211791992188, 42.533870697021484, 0.02877044677734375, -0.14098739624023438, 0.270263671875, -0.49396514892578125, -0.11705398559570312, 0.9649200439453125, 22.71727180480957, 0.018489837646484375, 0.3923835754394531, 0.27065277099609375, -0.25858306884765625, -0.3378334045410156, -0.2998046875, -0.17894363403320312, -0.19067001342773438, -0.22467041015625, 0.19288253784179688, 0.2541656494140625], "mean_td_error": 2.0267486572265625, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 82000.0, "diff_num_grad_updates_vs_sampler_policy": 25041.28125}}, "num_env_steps_sampled": 83000, "num_env_steps_trained": 2624000, "num_agent_steps_sampled": 83000, "num_agent_steps_trained": 2624000, "last_target_update_ts": 82501, "num_target_updates": 164}, "env_runners": {"episode_reward_max": 500.0, "episode_reward_min": 8.0, "episode_reward_mean": 323.73, "episode_len_mean": 323.73, "episode_media": {}, "episodes_timesteps_total": 32373, "policy_reward_min": {"default_policy": 8.0}, "policy_reward_max": {"default_policy": 500.0}, "policy_reward_mean": {"default_policy": 323.73}, "custom_metrics": {}, "hist_stats": {"episode_reward": [115.0, 105.0, 112.0, 117.0, 116.0, 105.0, 106.0, 113.0, 97.0, 117.0, 111.0, 112.0, 113.0, 115.0, 112.0, 101.0, 8.0, 108.0, 101.0, 144.0, 500.0, 151.0, 393.0, 140.0, 145.0, 500.0, 152.0, 284.0, 500.0, 258.0, 500.0, 500.0, 500.0, 500.0, 91.0, 500.0, 500.0, 31.0, 86.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 331.0, 223.0, 235.0, 77.0, 222.0, 140.0, 117.0, 105.0, 114.0, 139.0, 393.0, 500.0, 500.0, 500.0, 36.0, 500.0, 500.0, 500.0, 500.0, 500.0, 12.0, 500.0, 500.0, 473.0, 500.0, 500.0, 500.0, 393.0, 185.0, 144.0, 173.0, 500.0, 500.0, 500.0, 458.0, 500.0, 500.0, 500.0, 278.0, 500.0, 500.0, 500.0, 500.0, 500.0, 332.0, 137.0, 297.0], "episode_lengths": [115, 105, 112, 117, 116, 105, 106, 113, 97, 117, 111, 112, 113, 115, 112, 101, 8, 108, 101, 144, 500, 151, 393, 140, 145, 500, 152, 284, 500, 258, 500, 500, 500, 500, 91, 500, 500, 31, 86, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 331, 223, 235, 77, 222, 140, 117, 105, 114, 139, 393, 500, 500, 500, 36, 500, 500, 500, 500, 500, 12, 500, 500, 473, 500, 500, 500, 393, 185, 144, 173, 500, 500, 500, 458, 500, 500, 500, 278, 500, 500, 500, 500, 500, 332, 137, 297], "policy_default_policy_reward": [115.0, 105.0, 112.0, 117.0, 116.0, 105.0, 106.0, 113.0, 97.0, 117.0, 111.0, 112.0, 113.0, 115.0, 112.0, 101.0, 8.0, 108.0, 101.0, 144.0, 500.0, 151.0, 393.0, 140.0, 145.0, 500.0, 152.0, 284.0, 500.0, 258.0, 500.0, 500.0, 500.0, 500.0, 91.0, 500.0, 500.0, 31.0, 86.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 331.0, 223.0, 235.0, 77.0, 222.0, 140.0, 117.0, 105.0, 114.0, 139.0, 393.0, 500.0, 500.0, 500.0, 36.0, 500.0, 500.0, 500.0, 500.0, 500.0, 12.0, 500.0, 500.0, 473.0, 500.0, 500.0, 500.0, 393.0, 185.0, 144.0, 173.0, 500.0, 500.0, 500.0, 458.0, 500.0, 500.0, 500.0, 278.0, 500.0, 500.0, 500.0, 500.0, 500.0, 332.0, 137.0, 297.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0043607843315088, "mean_inference_ms": 2.002410469170308, "mean_action_processing_ms": 0.23358675986287886, "mean_env_wait_ms": 0.10093204517001718, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017909765243530273, "StateBufferConnector_ms": 0.016335487365722656, "ViewRequirementAgentConnector_ms": 0.20637059211730957}, "num_episodes": 4, "episode_return_max": 500.0, "episode_return_min": 8.0, "episode_return_mean": 323.73, "episodes_this_iter": 4}, "num_healthy_workers": 0, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 83000, "num_agent_steps_trained": 2624000, "num_env_steps_sampled": 83000, "num_env_steps_trained": 2624000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 29.27230295343946, "num_env_steps_trained_throughput_per_sec": 936.7136945100627, "timesteps_total": 83000, "num_env_steps_sampled_lifetime": 83000, "num_agent_steps_sampled_lifetime": 83000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 83000, "timers": {"training_iteration_time_ms": 34439.02, "restore_workers_time_ms": 0.019, "training_step_time_ms": 30.627, "sample_time_ms": 3.688, "load_time_ms": 0.184, "load_throughput": 173812.132, "learn_time_ms": 13.525, "learn_throughput": 2366.0, "synch_weights_time_ms": 0.04}, "counters": {"num_env_steps_sampled": 83000, "num_env_steps_trained": 2624000, "num_agent_steps_sampled": 83000, "num_agent_steps_trained": 2624000, "last_target_update_ts": 82501, "num_target_updates": 164}, "done": false, "training_iteration": 83, "trial_id": "5ce16_00000", "date": "2024-09-27_11-36-01", "timestamp": 1727408161, "time_this_iter_s": 34.163681745529175, "time_total_s": 2661.3316090106964, "pid": 39427, "hostname": "gpu2gate1", "node_ip": "10.64.32.126", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.9828407522030984, "lr": 0.0007583973879008875, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f52e4d75580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2661.3316090106964, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 11.637500000000001, "ram_util_percent": 11.395833333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.010986328125, "mean_q": 50.250553131103516, "min_q": -0.39726758003234863, "max_q": 58.188194274902344, "cur_lr": 0.0007583973879008875}, "td_error": [0.05142974853515625, 2.610584259033203, 0.26421356201171875, -0.11895751953125, 0.340087890625, 0.05095672607421875, 0.24896240234375, 0.2879600524902344, 1.0884246826171875, 0.111358642578125, 0.3217315673828125, 0.2609367370605469, 0.18077468872070312, 0.16844940185546875, 9.651202201843262, 0.07176589965820312, 0.8146247863769531, 0.21782302856445312, 0.15726470947265625, 0.2982521057128906, 10.480071067810059, 0.40325927734375, 0.7033233642578125, -0.06418228149414062, 0.20737457275390625, 0.18938064575195312, 0.215545654296875, 0.3926734924316406, 0.10824966430664062, -0.44272613525390625, 0.5474281311035156, 0.7304878234863281], "mean_td_error": 0.9546478986740112, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 83000.0, "diff_num_grad_updates_vs_sampler_policy": 28339.625}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 2656000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 2656000, "last_target_update_ts": 83501, "num_target_updates": 166}, "env_runners": {"episode_reward_max": 500.0, "episode_reward_min": 8.0, "episode_reward_mean": 329.02, "episode_len_mean": 329.02, "episode_media": {}, "episodes_timesteps_total": 32902, "policy_reward_min": {"default_policy": 8.0}, "policy_reward_max": {"default_policy": 500.0}, "policy_reward_mean": {"default_policy": 329.02}, "custom_metrics": {}, "hist_stats": {"episode_reward": [117.0, 116.0, 105.0, 106.0, 113.0, 97.0, 117.0, 111.0, 112.0, 113.0, 115.0, 112.0, 101.0, 8.0, 108.0, 101.0, 144.0, 500.0, 151.0, 393.0, 140.0, 145.0, 500.0, 152.0, 284.0, 500.0, 258.0, 500.0, 500.0, 500.0, 500.0, 91.0, 500.0, 500.0, 31.0, 86.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 331.0, 223.0, 235.0, 77.0, 222.0, 140.0, 117.0, 105.0, 114.0, 139.0, 393.0, 500.0, 500.0, 500.0, 36.0, 500.0, 500.0, 500.0, 500.0, 500.0, 12.0, 500.0, 500.0, 473.0, 500.0, 500.0, 500.0, 393.0, 185.0, 144.0, 173.0, 500.0, 500.0, 500.0, 458.0, 500.0, 500.0, 500.0, 278.0, 500.0, 500.0, 500.0, 500.0, 500.0, 332.0, 137.0, 297.0, 106.0, 255.0, 500.0], "episode_lengths": [117, 116, 105, 106, 113, 97, 117, 111, 112, 113, 115, 112, 101, 8, 108, 101, 144, 500, 151, 393, 140, 145, 500, 152, 284, 500, 258, 500, 500, 500, 500, 91, 500, 500, 31, 86, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 331, 223, 235, 77, 222, 140, 117, 105, 114, 139, 393, 500, 500, 500, 36, 500, 500, 500, 500, 500, 12, 500, 500, 473, 500, 500, 500, 393, 185, 144, 173, 500, 500, 500, 458, 500, 500, 500, 278, 500, 500, 500, 500, 500, 332, 137, 297, 106, 255, 500], "policy_default_policy_reward": [117.0, 116.0, 105.0, 106.0, 113.0, 97.0, 117.0, 111.0, 112.0, 113.0, 115.0, 112.0, 101.0, 8.0, 108.0, 101.0, 144.0, 500.0, 151.0, 393.0, 140.0, 145.0, 500.0, 152.0, 284.0, 500.0, 258.0, 500.0, 500.0, 500.0, 500.0, 91.0, 500.0, 500.0, 31.0, 86.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 331.0, 223.0, 235.0, 77.0, 222.0, 140.0, 117.0, 105.0, 114.0, 139.0, 393.0, 500.0, 500.0, 500.0, 36.0, 500.0, 500.0, 500.0, 500.0, 500.0, 12.0, 500.0, 500.0, 473.0, 500.0, 500.0, 500.0, 393.0, 185.0, 144.0, 173.0, 500.0, 500.0, 500.0, 458.0, 500.0, 500.0, 500.0, 278.0, 500.0, 500.0, 500.0, 500.0, 500.0, 332.0, 137.0, 297.0, 106.0, 255.0, 500.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0047421272902572, "mean_inference_ms": 2.0035585119861117, "mean_action_processing_ms": 0.233665532842112, "mean_env_wait_ms": 0.10096351341133453, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017770051956176758, "StateBufferConnector_ms": 0.016227006912231445, "ViewRequirementAgentConnector_ms": 0.2053391933441162}, "num_episodes": 3, "episode_return_max": 500.0, "episode_return_min": 8.0, "episode_return_mean": 329.02, "episodes_this_iter": 3}, "num_healthy_workers": 0, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 2656000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 2656000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 30.847695753680423, "num_env_steps_trained_throughput_per_sec": 987.1262641177735, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 84000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 33903.346, "restore_workers_time_ms": 0.021, "training_step_time_ms": 33.479, "sample_time_ms": 4.041, "load_time_ms": 0.209, "load_throughput": 153024.431, "learn_time_ms": 15.02, "learn_throughput": 2130.487, "synch_weights_time_ms": 0.043}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 2656000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 2656000, "last_target_update_ts": 83501, "num_target_updates": 166}, "done": false, "training_iteration": 84, "trial_id": "5ce16_00000", "date": "2024-09-27_11-36-34", "timestamp": 1727408194, "time_this_iter_s": 32.41897916793823, "time_total_s": 2693.7505881786346, "pid": 39427, "hostname": "gpu2gate1", "node_ip": "10.64.32.126", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.9828407522030984, "lr": 0.0007583973879008875, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f52e4d75580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2693.7505881786346, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 11.665217391304349, "ram_util_percent": 11.397826086956519}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.547842264175415, "mean_q": 50.38530731201172, "min_q": 7.625545978546143, "max_q": 58.078125, "cur_lr": 0.0007583973879008875}, "td_error": [0.033672332763671875, 0.15468215942382812, -0.3638267517089844, -0.08005905151367188, -0.06853866577148438, -0.2671966552734375, 0.8317375183105469, -0.049068450927734375, 0.11246490478515625, -0.2752265930175781, -0.19008255004882812, 0.0414886474609375, -0.08827972412109375, -0.046016693115234375, 0.3179817199707031, 0.9693355560302734, 0.0491790771484375, -2.2139029502868652, -3.577451705932617, 0.03566741943359375, -0.20765304565429688, -0.6686973571777344, -0.005634307861328125, -0.08420181274414062, -1.7357330322265625, -0.00262451171875, -0.020298004150390625, -0.1676788330078125, -0.3281745910644531, 0.07561492919921875, -0.185791015625, 0.1623401641845703], "mean_td_error": -0.24506163597106934, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 84000.0, "diff_num_grad_updates_vs_sampler_policy": 27190.28125}}, "num_env_steps_sampled": 85000, "num_env_steps_trained": 2688000, "num_agent_steps_sampled": 85000, "num_agent_steps_trained": 2688000, "last_target_update_ts": 84501, "num_target_updates": 168}, "env_runners": {"episode_reward_max": 500.0, "episode_reward_min": 8.0, "episode_reward_mean": 336.62, "episode_len_mean": 336.62, "episode_media": {}, "episodes_timesteps_total": 33662, "policy_reward_min": {"default_policy": 8.0}, "policy_reward_max": {"default_policy": 500.0}, "policy_reward_mean": {"default_policy": 336.62}, "custom_metrics": {}, "hist_stats": {"episode_reward": [106.0, 113.0, 97.0, 117.0, 111.0, 112.0, 113.0, 115.0, 112.0, 101.0, 8.0, 108.0, 101.0, 144.0, 500.0, 151.0, 393.0, 140.0, 145.0, 500.0, 152.0, 284.0, 500.0, 258.0, 500.0, 500.0, 500.0, 500.0, 91.0, 500.0, 500.0, 31.0, 86.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 331.0, 223.0, 235.0, 77.0, 222.0, 140.0, 117.0, 105.0, 114.0, 139.0, 393.0, 500.0, 500.0, 500.0, 36.0, 500.0, 500.0, 500.0, 500.0, 500.0, 12.0, 500.0, 500.0, 473.0, 500.0, 500.0, 500.0, 393.0, 185.0, 144.0, 173.0, 500.0, 500.0, 500.0, 458.0, 500.0, 500.0, 500.0, 278.0, 500.0, 500.0, 500.0, 500.0, 500.0, 332.0, 137.0, 297.0, 106.0, 255.0, 500.0, 500.0, 151.0, 447.0], "episode_lengths": [106, 113, 97, 117, 111, 112, 113, 115, 112, 101, 8, 108, 101, 144, 500, 151, 393, 140, 145, 500, 152, 284, 500, 258, 500, 500, 500, 500, 91, 500, 500, 31, 86, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 331, 223, 235, 77, 222, 140, 117, 105, 114, 139, 393, 500, 500, 500, 36, 500, 500, 500, 500, 500, 12, 500, 500, 473, 500, 500, 500, 393, 185, 144, 173, 500, 500, 500, 458, 500, 500, 500, 278, 500, 500, 500, 500, 500, 332, 137, 297, 106, 255, 500, 500, 151, 447], "policy_default_policy_reward": [106.0, 113.0, 97.0, 117.0, 111.0, 112.0, 113.0, 115.0, 112.0, 101.0, 8.0, 108.0, 101.0, 144.0, 500.0, 151.0, 393.0, 140.0, 145.0, 500.0, 152.0, 284.0, 500.0, 258.0, 500.0, 500.0, 500.0, 500.0, 91.0, 500.0, 500.0, 31.0, 86.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 331.0, 223.0, 235.0, 77.0, 222.0, 140.0, 117.0, 105.0, 114.0, 139.0, 393.0, 500.0, 500.0, 500.0, 36.0, 500.0, 500.0, 500.0, 500.0, 500.0, 12.0, 500.0, 500.0, 473.0, 500.0, 500.0, 500.0, 393.0, 185.0, 144.0, 173.0, 500.0, 500.0, 500.0, 458.0, 500.0, 500.0, 500.0, 278.0, 500.0, 500.0, 500.0, 500.0, 500.0, 332.0, 137.0, 297.0, 106.0, 255.0, 500.0, 500.0, 151.0, 447.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0051183669000598, "mean_inference_ms": 2.004711587933242, "mean_action_processing_ms": 0.2337446262897346, "mean_env_wait_ms": 0.10099465107442147, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017748594284057617, "StateBufferConnector_ms": 0.016202688217163086, "ViewRequirementAgentConnector_ms": 0.20564699172973633}, "num_episodes": 3, "episode_return_max": 500.0, "episode_return_min": 8.0, "episode_return_mean": 336.62, "episodes_this_iter": 3}, "num_healthy_workers": 0, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 85000, "num_agent_steps_trained": 2688000, "num_env_steps_sampled": 85000, "num_env_steps_trained": 2688000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 27.356344256165546, "num_env_steps_trained_throughput_per_sec": 875.4030161972975, "timesteps_total": 85000, "num_env_steps_sampled_lifetime": 85000, "num_agent_steps_sampled_lifetime": 85000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 85000, "timers": {"training_iteration_time_ms": 34037.632, "restore_workers_time_ms": 0.023, "training_step_time_ms": 35.918, "sample_time_ms": 4.336, "load_time_ms": 0.242, "load_throughput": 132013.109, "learn_time_ms": 15.473, "learn_throughput": 2068.095, "synch_weights_time_ms": 0.054}, "counters": {"num_env_steps_sampled": 85000, "num_env_steps_trained": 2688000, "num_agent_steps_sampled": 85000, "num_agent_steps_trained": 2688000, "last_target_update_ts": 84501, "num_target_updates": 168}, "done": false, "training_iteration": 85, "trial_id": "5ce16_00000", "date": "2024-09-27_11-37-10", "timestamp": 1727408230, "time_this_iter_s": 36.55659317970276, "time_total_s": 2730.3071813583374, "pid": 39427, "hostname": "gpu2gate1", "node_ip": "10.64.32.126", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.9828407522030984, "lr": 0.0007583973879008875, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f52e4d75580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2730.3071813583374, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 11.746153846153844, "ram_util_percent": 11.309615384615379}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.26941558718681335, "mean_q": 52.08162307739258, "min_q": 2.7603325843811035, "max_q": 59.39863967895508, "cur_lr": 0.0007583973879008875}, "td_error": [-0.4256477355957031, -0.3065948486328125, 0.01392364501953125, 0.42743682861328125, -0.24395751953125, -0.20547103881835938, 0.4212493896484375, -0.042995452880859375, -0.18471527099609375, 0.31134033203125, 0.3083000183105469, -0.21856307983398438, 0.3204460144042969, -0.20275497436523438, -0.377899169921875, 1.7733230590820312, 0.8645858764648438, -0.007724761962890625, 0.048992156982421875, -0.01174163818359375, -0.09857559204101562, 0.0240936279296875, 1.7603325843811035, -0.02889251708984375, -0.18169403076171875, -0.08886337280273438, 0.032146453857421875, -0.06337738037109375, -0.0142822265625, -0.0355224609375, -0.20788192749023438, -0.7641448974609375], "mean_td_error": 0.08108969032764435, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 85000.0, "diff_num_grad_updates_vs_sampler_policy": 25055.34375}}, "num_env_steps_sampled": 86000, "num_env_steps_trained": 2720000, "num_agent_steps_sampled": 86000, "num_agent_steps_trained": 2720000, "last_target_update_ts": 85501, "num_target_updates": 170}, "env_runners": {"episode_reward_max": 500.0, "episode_reward_min": 8.0, "episode_reward_mean": 343.26, "episode_len_mean": 343.26, "episode_media": {}, "episodes_timesteps_total": 34326, "policy_reward_min": {"default_policy": 8.0}, "policy_reward_max": {"default_policy": 500.0}, "policy_reward_mean": {"default_policy": 343.26}, "custom_metrics": {}, "hist_stats": {"episode_reward": [117.0, 111.0, 112.0, 113.0, 115.0, 112.0, 101.0, 8.0, 108.0, 101.0, 144.0, 500.0, 151.0, 393.0, 140.0, 145.0, 500.0, 152.0, 284.0, 500.0, 258.0, 500.0, 500.0, 500.0, 500.0, 91.0, 500.0, 500.0, 31.0, 86.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 331.0, 223.0, 235.0, 77.0, 222.0, 140.0, 117.0, 105.0, 114.0, 139.0, 393.0, 500.0, 500.0, 500.0, 36.0, 500.0, 500.0, 500.0, 500.0, 500.0, 12.0, 500.0, 500.0, 473.0, 500.0, 500.0, 500.0, 393.0, 185.0, 144.0, 173.0, 500.0, 500.0, 500.0, 458.0, 500.0, 500.0, 500.0, 278.0, 500.0, 500.0, 500.0, 500.0, 500.0, 332.0, 137.0, 297.0, 106.0, 255.0, 500.0, 500.0, 151.0, 447.0, 232.0, 500.0, 248.0], "episode_lengths": [117, 111, 112, 113, 115, 112, 101, 8, 108, 101, 144, 500, 151, 393, 140, 145, 500, 152, 284, 500, 258, 500, 500, 500, 500, 91, 500, 500, 31, 86, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 331, 223, 235, 77, 222, 140, 117, 105, 114, 139, 393, 500, 500, 500, 36, 500, 500, 500, 500, 500, 12, 500, 500, 473, 500, 500, 500, 393, 185, 144, 173, 500, 500, 500, 458, 500, 500, 500, 278, 500, 500, 500, 500, 500, 332, 137, 297, 106, 255, 500, 500, 151, 447, 232, 500, 248], "policy_default_policy_reward": [117.0, 111.0, 112.0, 113.0, 115.0, 112.0, 101.0, 8.0, 108.0, 101.0, 144.0, 500.0, 151.0, 393.0, 140.0, 145.0, 500.0, 152.0, 284.0, 500.0, 258.0, 500.0, 500.0, 500.0, 500.0, 91.0, 500.0, 500.0, 31.0, 86.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 331.0, 223.0, 235.0, 77.0, 222.0, 140.0, 117.0, 105.0, 114.0, 139.0, 393.0, 500.0, 500.0, 500.0, 36.0, 500.0, 500.0, 500.0, 500.0, 500.0, 12.0, 500.0, 500.0, 473.0, 500.0, 500.0, 500.0, 393.0, 185.0, 144.0, 173.0, 500.0, 500.0, 500.0, 458.0, 500.0, 500.0, 500.0, 278.0, 500.0, 500.0, 500.0, 500.0, 500.0, 332.0, 137.0, 297.0, 106.0, 255.0, 500.0, 500.0, 151.0, 447.0, 232.0, 500.0, 248.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0055356200604124, "mean_inference_ms": 2.0059496777469974, "mean_action_processing_ms": 0.2338321782247769, "mean_env_wait_ms": 0.10103066482241944, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017659664154052734, "StateBufferConnector_ms": 0.016207218170166016, "ViewRequirementAgentConnector_ms": 0.20578789710998535}, "num_episodes": 3, "episode_return_max": 500.0, "episode_return_min": 8.0, "episode_return_mean": 343.26, "episodes_this_iter": 3}, "num_healthy_workers": 0, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 86000, "num_agent_steps_trained": 2720000, "num_env_steps_sampled": 86000, "num_env_steps_trained": 2720000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 26.44875314455026, "num_env_steps_trained_throughput_per_sec": 846.3601006256083, "timesteps_total": 86000, "num_env_steps_sampled_lifetime": 86000, "num_agent_steps_sampled_lifetime": 86000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 86000, "timers": {"training_iteration_time_ms": 34334.91, "restore_workers_time_ms": 0.028, "training_step_time_ms": 33.99, "sample_time_ms": 3.941, "load_time_ms": 0.225, "load_throughput": 142209.926, "learn_time_ms": 14.436, "learn_throughput": 2216.654, "synch_weights_time_ms": 0.049}, "counters": {"num_env_steps_sampled": 86000, "num_env_steps_trained": 2720000, "num_agent_steps_sampled": 86000, "num_agent_steps_trained": 2720000, "last_target_update_ts": 85501, "num_target_updates": 170}, "done": false, "training_iteration": 86, "trial_id": "5ce16_00000", "date": "2024-09-27_11-37-48", "timestamp": 1727408268, "time_this_iter_s": 37.8110249042511, "time_total_s": 2768.1182062625885, "pid": 39427, "hostname": "gpu2gate1", "node_ip": "10.64.32.126", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.9828407522030984, "lr": 0.0007583973879008875, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f52e4d75580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2768.1182062625885, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 11.420370370370373, "ram_util_percent": 11.299999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6949336528778076, "mean_q": 49.52207946777344, "min_q": 1.327202558517456, "max_q": 57.679115295410156, "cur_lr": 0.0007583973879008875}, "td_error": [1.6429824829101562, 0.03623199462890625, -0.14605331420898438, 0.15980911254882812, 0.60845947265625, 0.32720255851745605, 51.535552978515625, 0.2554359436035156, -0.19122695922851562, 2.0879249572753906, 0.18975448608398438, -0.07741928100585938, -0.4458885192871094, -0.046802520751953125, -0.026767730712890625, 2.008800506591797, -0.009311676025390625, 0.2755088806152344, 0.1036529541015625, 0.07875823974609375, 0.06982421875, 0.2981834411621094, 0.6274795532226562, 2.6236438751220703, 0.2178497314453125, 0.327789306640625, 0.040180206298828125, -0.06453704833984375, 0.00159454345703125, 0.10205841064453125, -0.01403045654296875, 0.5184478759765625], "mean_td_error": 1.972346544265747, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 86000.0, "diff_num_grad_updates_vs_sampler_policy": 28023.6875}}, "num_env_steps_sampled": 87000, "num_env_steps_trained": 2752000, "num_agent_steps_sampled": 87000, "num_agent_steps_trained": 2752000, "last_target_update_ts": 86501, "num_target_updates": 172}, "env_runners": {"episode_reward_max": 500.0, "episode_reward_min": 8.0, "episode_reward_mean": 349.78, "episode_len_mean": 349.78, "episode_media": {}, "episodes_timesteps_total": 34978, "policy_reward_min": {"default_policy": 8.0}, "policy_reward_max": {"default_policy": 500.0}, "policy_reward_mean": {"default_policy": 349.78}, "custom_metrics": {}, "hist_stats": {"episode_reward": [115.0, 112.0, 101.0, 8.0, 108.0, 101.0, 144.0, 500.0, 151.0, 393.0, 140.0, 145.0, 500.0, 152.0, 284.0, 500.0, 258.0, 500.0, 500.0, 500.0, 500.0, 91.0, 500.0, 500.0, 31.0, 86.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 331.0, 223.0, 235.0, 77.0, 222.0, 140.0, 117.0, 105.0, 114.0, 139.0, 393.0, 500.0, 500.0, 500.0, 36.0, 500.0, 500.0, 500.0, 500.0, 500.0, 12.0, 500.0, 500.0, 473.0, 500.0, 500.0, 500.0, 393.0, 185.0, 144.0, 173.0, 500.0, 500.0, 500.0, 458.0, 500.0, 500.0, 500.0, 278.0, 500.0, 500.0, 500.0, 500.0, 500.0, 332.0, 137.0, 297.0, 106.0, 255.0, 500.0, 500.0, 151.0, 447.0, 232.0, 500.0, 248.0, 279.0, 360.0, 235.0, 231.0], "episode_lengths": [115, 112, 101, 8, 108, 101, 144, 500, 151, 393, 140, 145, 500, 152, 284, 500, 258, 500, 500, 500, 500, 91, 500, 500, 31, 86, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 331, 223, 235, 77, 222, 140, 117, 105, 114, 139, 393, 500, 500, 500, 36, 500, 500, 500, 500, 500, 12, 500, 500, 473, 500, 500, 500, 393, 185, 144, 173, 500, 500, 500, 458, 500, 500, 500, 278, 500, 500, 500, 500, 500, 332, 137, 297, 106, 255, 500, 500, 151, 447, 232, 500, 248, 279, 360, 235, 231], "policy_default_policy_reward": [115.0, 112.0, 101.0, 8.0, 108.0, 101.0, 144.0, 500.0, 151.0, 393.0, 140.0, 145.0, 500.0, 152.0, 284.0, 500.0, 258.0, 500.0, 500.0, 500.0, 500.0, 91.0, 500.0, 500.0, 31.0, 86.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 331.0, 223.0, 235.0, 77.0, 222.0, 140.0, 117.0, 105.0, 114.0, 139.0, 393.0, 500.0, 500.0, 500.0, 36.0, 500.0, 500.0, 500.0, 500.0, 500.0, 12.0, 500.0, 500.0, 473.0, 500.0, 500.0, 500.0, 393.0, 185.0, 144.0, 173.0, 500.0, 500.0, 500.0, 458.0, 500.0, 500.0, 500.0, 278.0, 500.0, 500.0, 500.0, 500.0, 500.0, 332.0, 137.0, 297.0, 106.0, 255.0, 500.0, 500.0, 151.0, 447.0, 232.0, 500.0, 248.0, 279.0, 360.0, 235.0, 231.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0060975135870012, "mean_inference_ms": 2.007626840289088, "mean_action_processing_ms": 0.2339496950829724, "mean_env_wait_ms": 0.10107901301170141, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0176088809967041, "StateBufferConnector_ms": 0.016130924224853516, "ViewRequirementAgentConnector_ms": 0.20498943328857422}, "num_episodes": 4, "episode_return_max": 500.0, "episode_return_min": 8.0, "episode_return_mean": 349.78, "episodes_this_iter": 4}, "num_healthy_workers": 0, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 87000, "num_agent_steps_trained": 2752000, "num_env_steps_sampled": 87000, "num_env_steps_trained": 2752000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 28.617184677038153, "num_env_steps_trained_throughput_per_sec": 915.7499096652209, "timesteps_total": 87000, "num_env_steps_sampled_lifetime": 87000, "num_agent_steps_sampled_lifetime": 87000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 87000, "timers": {"training_iteration_time_ms": 34580.017, "restore_workers_time_ms": 0.02, "training_step_time_ms": 32.422, "sample_time_ms": 3.728, "load_time_ms": 0.232, "load_throughput": 138140.93, "learn_time_ms": 14.174, "learn_throughput": 2257.669, "synch_weights_time_ms": 0.043}, "counters": {"num_env_steps_sampled": 87000, "num_env_steps_trained": 2752000, "num_agent_steps_sampled": 87000, "num_agent_steps_trained": 2752000, "last_target_update_ts": 86501, "num_target_updates": 172}, "done": false, "training_iteration": 87, "trial_id": "5ce16_00000", "date": "2024-09-27_11-38-23", "timestamp": 1727408303, "time_this_iter_s": 34.94563889503479, "time_total_s": 2803.0638451576233, "pid": 39427, "hostname": "gpu2gate1", "node_ip": "10.64.32.126", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.9828407522030984, "lr": 0.0007583973879008875, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f52e4d75580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2803.0638451576233, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 11.885714285714288, "ram_util_percent": 11.299999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3837449848651886, "mean_q": 53.47024917602539, "min_q": 4.867395877838135, "max_q": 58.654205322265625, "cur_lr": 0.0007583973879008875}, "td_error": [0.4897499084472656, -0.0822601318359375, 1.104583740234375, -1.1638975143432617, 0.2168121337890625, 0.2829170227050781, -0.3714942932128906, 2.2066192626953125, -0.16684722900390625, 0.0378875732421875, 0.2556266784667969, 0.3495674133300781, 0.0698394775390625, 0.3266792297363281, 0.6167831420898438, -0.15802764892578125, -0.21628570556640625, -0.038402557373046875, 0.45854949951171875, 0.07623291015625, 0.11993408203125, -0.7366561889648438, -0.10762786865234375, -0.061634063720703125, 0.38146209716796875, -0.4273567199707031, -2.5981674194335938, 0.14789199829101562, 0.28163909912109375, 0.10694122314453125, -0.182159423828125, 0.2937126159667969], "mean_td_error": 0.04726913571357727, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 87000.0, "diff_num_grad_updates_vs_sampler_policy": 23172.78125}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 2784000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 2784000, "last_target_update_ts": 87501, "num_target_updates": 174}, "env_runners": {"episode_reward_max": 500.0, "episode_reward_min": 8.0, "episode_reward_mean": 356.51, "episode_len_mean": 356.51, "episode_media": {}, "episodes_timesteps_total": 35651, "policy_reward_min": {"default_policy": 8.0}, "policy_reward_max": {"default_policy": 500.0}, "policy_reward_mean": {"default_policy": 356.51}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.0, 108.0, 101.0, 144.0, 500.0, 151.0, 393.0, 140.0, 145.0, 500.0, 152.0, 284.0, 500.0, 258.0, 500.0, 500.0, 500.0, 500.0, 91.0, 500.0, 500.0, 31.0, 86.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 331.0, 223.0, 235.0, 77.0, 222.0, 140.0, 117.0, 105.0, 114.0, 139.0, 393.0, 500.0, 500.0, 500.0, 36.0, 500.0, 500.0, 500.0, 500.0, 500.0, 12.0, 500.0, 500.0, 473.0, 500.0, 500.0, 500.0, 393.0, 185.0, 144.0, 173.0, 500.0, 500.0, 500.0, 458.0, 500.0, 500.0, 500.0, 278.0, 500.0, 500.0, 500.0, 500.0, 500.0, 332.0, 137.0, 297.0, 106.0, 255.0, 500.0, 500.0, 151.0, 447.0, 232.0, 500.0, 248.0, 279.0, 360.0, 235.0, 231.0, 247.0, 254.0, 500.0], "episode_lengths": [8, 108, 101, 144, 500, 151, 393, 140, 145, 500, 152, 284, 500, 258, 500, 500, 500, 500, 91, 500, 500, 31, 86, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 331, 223, 235, 77, 222, 140, 117, 105, 114, 139, 393, 500, 500, 500, 36, 500, 500, 500, 500, 500, 12, 500, 500, 473, 500, 500, 500, 393, 185, 144, 173, 500, 500, 500, 458, 500, 500, 500, 278, 500, 500, 500, 500, 500, 332, 137, 297, 106, 255, 500, 500, 151, 447, 232, 500, 248, 279, 360, 235, 231, 247, 254, 500], "policy_default_policy_reward": [8.0, 108.0, 101.0, 144.0, 500.0, 151.0, 393.0, 140.0, 145.0, 500.0, 152.0, 284.0, 500.0, 258.0, 500.0, 500.0, 500.0, 500.0, 91.0, 500.0, 500.0, 31.0, 86.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 331.0, 223.0, 235.0, 77.0, 222.0, 140.0, 117.0, 105.0, 114.0, 139.0, 393.0, 500.0, 500.0, 500.0, 36.0, 500.0, 500.0, 500.0, 500.0, 500.0, 12.0, 500.0, 500.0, 473.0, 500.0, 500.0, 500.0, 393.0, 185.0, 144.0, 173.0, 500.0, 500.0, 500.0, 458.0, 500.0, 500.0, 500.0, 278.0, 500.0, 500.0, 500.0, 500.0, 500.0, 332.0, 137.0, 297.0, 106.0, 255.0, 500.0, 500.0, 151.0, 447.0, 232.0, 500.0, 248.0, 279.0, 360.0, 235.0, 231.0, 247.0, 254.0, 500.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.006464046348774, "mean_inference_ms": 2.008808895947797, "mean_action_processing_ms": 0.23402456546051012, "mean_env_wait_ms": 0.10110753435379637, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01750922203063965, "StateBufferConnector_ms": 0.016036033630371094, "ViewRequirementAgentConnector_ms": 0.20407724380493164}, "num_episodes": 3, "episode_return_max": 500.0, "episode_return_min": 8.0, "episode_return_mean": 356.51, "episodes_this_iter": 3}, "num_healthy_workers": 0, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 2784000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 2784000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 30.65119517587202, "num_env_steps_trained_throughput_per_sec": 980.8382456279046, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 88000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 34265.422, "restore_workers_time_ms": 0.02, "training_step_time_ms": 33.81, "sample_time_ms": 3.965, "load_time_ms": 0.207, "load_throughput": 154539.698, "learn_time_ms": 14.723, "learn_throughput": 2173.422, "synch_weights_time_ms": 0.043}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 2784000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 2784000, "last_target_update_ts": 87501, "num_target_updates": 174}, "done": false, "training_iteration": 88, "trial_id": "5ce16_00000", "date": "2024-09-27_11-38-56", "timestamp": 1727408336, "time_this_iter_s": 32.62741017341614, "time_total_s": 2835.6912553310394, "pid": 39427, "hostname": "gpu2gate1", "node_ip": "10.64.32.126", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.9828407522030984, "lr": 0.0007583973879008875, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f52e4d75580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2835.6912553310394, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 11.586956521739133, "ram_util_percent": 11.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6841127872467041, "mean_q": 48.20827102661133, "min_q": 2.1789498329162598, "max_q": 57.39019775390625, "cur_lr": 0.0007583973879008875}, "td_error": [-0.2608184814453125, -0.22737884521484375, -0.3367767333984375, -0.33177947998046875, -0.11376953125, -0.22743988037109375, -0.12313079833984375, -0.2518424987792969, 0.061511993408203125, -0.3392524719238281, 0.5520820617675781, -0.2846527099609375, 1.4804506301879883, -0.3175315856933594, -0.1557464599609375, -0.3989410400390625, 1.220808982849121, -0.3175077438354492, -0.19136428833007812, -0.4327545166015625, -0.7033348083496094, 34.12248229980469, 0.01221466064453125, -0.0437164306640625, -0.2757530212402344, -0.03011322021484375, -0.24217987060546875, 5.489341735839844, -0.1055755615234375, -0.18373489379882812, 0.4160919189453125, -0.18090057373046875], "mean_td_error": 1.1649683713912964, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 88000.0, "diff_num_grad_updates_vs_sampler_policy": 31143.65625}}, "num_env_steps_sampled": 89000, "num_env_steps_trained": 2816000, "num_agent_steps_sampled": 89000, "num_agent_steps_trained": 2816000, "last_target_update_ts": 88501, "num_target_updates": 176}, "env_runners": {"episode_reward_max": 500.0, "episode_reward_min": 12.0, "episode_reward_mean": 365.35, "episode_len_mean": 365.35, "episode_media": {}, "episodes_timesteps_total": 36535, "policy_reward_min": {"default_policy": 12.0}, "policy_reward_max": {"default_policy": 500.0}, "policy_reward_mean": {"default_policy": 365.35}, "custom_metrics": {}, "hist_stats": {"episode_reward": [101.0, 144.0, 500.0, 151.0, 393.0, 140.0, 145.0, 500.0, 152.0, 284.0, 500.0, 258.0, 500.0, 500.0, 500.0, 500.0, 91.0, 500.0, 500.0, 31.0, 86.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 331.0, 223.0, 235.0, 77.0, 222.0, 140.0, 117.0, 105.0, 114.0, 139.0, 393.0, 500.0, 500.0, 500.0, 36.0, 500.0, 500.0, 500.0, 500.0, 500.0, 12.0, 500.0, 500.0, 473.0, 500.0, 500.0, 500.0, 393.0, 185.0, 144.0, 173.0, 500.0, 500.0, 500.0, 458.0, 500.0, 500.0, 500.0, 278.0, 500.0, 500.0, 500.0, 500.0, 500.0, 332.0, 137.0, 297.0, 106.0, 255.0, 500.0, 500.0, 151.0, 447.0, 232.0, 500.0, 248.0, 279.0, 360.0, 235.0, 231.0, 247.0, 254.0, 500.0, 500.0, 500.0], "episode_lengths": [101, 144, 500, 151, 393, 140, 145, 500, 152, 284, 500, 258, 500, 500, 500, 500, 91, 500, 500, 31, 86, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 331, 223, 235, 77, 222, 140, 117, 105, 114, 139, 393, 500, 500, 500, 36, 500, 500, 500, 500, 500, 12, 500, 500, 473, 500, 500, 500, 393, 185, 144, 173, 500, 500, 500, 458, 500, 500, 500, 278, 500, 500, 500, 500, 500, 332, 137, 297, 106, 255, 500, 500, 151, 447, 232, 500, 248, 279, 360, 235, 231, 247, 254, 500, 500, 500], "policy_default_policy_reward": [101.0, 144.0, 500.0, 151.0, 393.0, 140.0, 145.0, 500.0, 152.0, 284.0, 500.0, 258.0, 500.0, 500.0, 500.0, 500.0, 91.0, 500.0, 500.0, 31.0, 86.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 331.0, 223.0, 235.0, 77.0, 222.0, 140.0, 117.0, 105.0, 114.0, 139.0, 393.0, 500.0, 500.0, 500.0, 36.0, 500.0, 500.0, 500.0, 500.0, 500.0, 12.0, 500.0, 500.0, 473.0, 500.0, 500.0, 500.0, 393.0, 185.0, 144.0, 173.0, 500.0, 500.0, 500.0, 458.0, 500.0, 500.0, 500.0, 278.0, 500.0, 500.0, 500.0, 500.0, 500.0, 332.0, 137.0, 297.0, 106.0, 255.0, 500.0, 500.0, 151.0, 447.0, 232.0, 500.0, 248.0, 279.0, 360.0, 235.0, 231.0, 247.0, 254.0, 500.0, 500.0, 500.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0067006795819702, "mean_inference_ms": 2.0096088298926844, "mean_action_processing_ms": 0.23407206708066147, "mean_env_wait_ms": 0.10112512942225399, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017490863800048828, "StateBufferConnector_ms": 0.015960693359375, "ViewRequirementAgentConnector_ms": 0.203352689743042}, "num_episodes": 2, "episode_return_max": 500.0, "episode_return_min": 12.0, "episode_return_mean": 365.35, "episodes_this_iter": 2}, "num_healthy_workers": 0, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 89000, "num_agent_steps_trained": 2816000, "num_env_steps_sampled": 89000, "num_env_steps_trained": 2816000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 29.773905794211064, "num_env_steps_trained_throughput_per_sec": 952.764985414754, "timesteps_total": 89000, "num_env_steps_sampled_lifetime": 89000, "num_agent_steps_sampled_lifetime": 89000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 89000, "timers": {"training_iteration_time_ms": 34066.819, "restore_workers_time_ms": 0.019, "training_step_time_ms": 33.328, "sample_time_ms": 3.93, "load_time_ms": 0.214, "load_throughput": 149746.433, "learn_time_ms": 14.735, "learn_throughput": 2171.657, "synch_weights_time_ms": 0.045}, "counters": {"num_env_steps_sampled": 89000, "num_env_steps_trained": 2816000, "num_agent_steps_sampled": 89000, "num_agent_steps_trained": 2816000, "last_target_update_ts": 88501, "num_target_updates": 176}, "done": false, "training_iteration": 89, "trial_id": "5ce16_00000", "date": "2024-09-27_11-39-30", "timestamp": 1727408370, "time_this_iter_s": 33.58850455284119, "time_total_s": 2869.2797598838806, "pid": 39427, "hostname": "gpu2gate1", "node_ip": "10.64.32.126", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.9828407522030984, "lr": 0.0007583973879008875, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f52e4d75580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2869.2797598838806, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 11.877083333333333, "ram_util_percent": 11.299999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6392478942871094, "mean_q": 47.217994689941406, "min_q": 6.683520317077637, "max_q": 58.40410614013672, "cur_lr": 0.0007583973879008875}, "td_error": [0.02593231201171875, 0.053890228271484375, 0.23259353637695312, 0.12850189208984375, -0.13504791259765625, -3.5679759979248047, -0.09185791015625, 0.20094680786132812, 0.18201065063476562, -0.19547271728515625, -1.083664894104004, -0.018718719482421875, 0.6353950500488281, -0.054767608642578125, -0.08111572265625, -0.5597801208496094, -0.1209564208984375, -0.7572135925292969, 0.3217506408691406, 0.376434326171875, -0.21855926513671875, -0.21915054321289062, -0.13282012939453125, -0.23147964477539062, -0.21323776245117188, -0.23102188110351562, 0.5731968879699707, -0.06085968017578125, -0.2389373779296875, -0.6293849945068359, -0.13604736328125, -0.4504203796386719], "mean_td_error": -0.2093074470758438, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 89000.0, "diff_num_grad_updates_vs_sampler_policy": 28943.71875}}, "num_env_steps_sampled": 90000, "num_env_steps_trained": 2848000, "num_agent_steps_sampled": 90000, "num_agent_steps_trained": 2848000, "last_target_update_ts": 89501, "num_target_updates": 178}, "env_runners": {"episode_reward_max": 500.0, "episode_reward_min": 12.0, "episode_reward_mean": 372.9, "episode_len_mean": 372.9, "episode_media": {}, "episodes_timesteps_total": 37290, "policy_reward_min": {"default_policy": 12.0}, "policy_reward_max": {"default_policy": 500.0}, "policy_reward_mean": {"default_policy": 372.9}, "custom_metrics": {}, "hist_stats": {"episode_reward": [500.0, 151.0, 393.0, 140.0, 145.0, 500.0, 152.0, 284.0, 500.0, 258.0, 500.0, 500.0, 500.0, 500.0, 91.0, 500.0, 500.0, 31.0, 86.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 331.0, 223.0, 235.0, 77.0, 222.0, 140.0, 117.0, 105.0, 114.0, 139.0, 393.0, 500.0, 500.0, 500.0, 36.0, 500.0, 500.0, 500.0, 500.0, 500.0, 12.0, 500.0, 500.0, 473.0, 500.0, 500.0, 500.0, 393.0, 185.0, 144.0, 173.0, 500.0, 500.0, 500.0, 458.0, 500.0, 500.0, 500.0, 278.0, 500.0, 500.0, 500.0, 500.0, 500.0, 332.0, 137.0, 297.0, 106.0, 255.0, 500.0, 500.0, 151.0, 447.0, 232.0, 500.0, 248.0, 279.0, 360.0, 235.0, 231.0, 247.0, 254.0, 500.0, 500.0, 500.0, 500.0, 500.0], "episode_lengths": [500, 151, 393, 140, 145, 500, 152, 284, 500, 258, 500, 500, 500, 500, 91, 500, 500, 31, 86, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 331, 223, 235, 77, 222, 140, 117, 105, 114, 139, 393, 500, 500, 500, 36, 500, 500, 500, 500, 500, 12, 500, 500, 473, 500, 500, 500, 393, 185, 144, 173, 500, 500, 500, 458, 500, 500, 500, 278, 500, 500, 500, 500, 500, 332, 137, 297, 106, 255, 500, 500, 151, 447, 232, 500, 248, 279, 360, 235, 231, 247, 254, 500, 500, 500, 500, 500], "policy_default_policy_reward": [500.0, 151.0, 393.0, 140.0, 145.0, 500.0, 152.0, 284.0, 500.0, 258.0, 500.0, 500.0, 500.0, 500.0, 91.0, 500.0, 500.0, 31.0, 86.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 331.0, 223.0, 235.0, 77.0, 222.0, 140.0, 117.0, 105.0, 114.0, 139.0, 393.0, 500.0, 500.0, 500.0, 36.0, 500.0, 500.0, 500.0, 500.0, 500.0, 12.0, 500.0, 500.0, 473.0, 500.0, 500.0, 500.0, 393.0, 185.0, 144.0, 173.0, 500.0, 500.0, 500.0, 458.0, 500.0, 500.0, 500.0, 278.0, 500.0, 500.0, 500.0, 500.0, 500.0, 332.0, 137.0, 297.0, 106.0, 255.0, 500.0, 500.0, 151.0, 447.0, 232.0, 500.0, 248.0, 279.0, 360.0, 235.0, 231.0, 247.0, 254.0, 500.0, 500.0, 500.0, 500.0, 500.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0069489080645389, "mean_inference_ms": 2.0104268036010553, "mean_action_processing_ms": 0.23412194543387732, "mean_env_wait_ms": 0.1011448461382005, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01747727394104004, "StateBufferConnector_ms": 0.016061067581176758, "ViewRequirementAgentConnector_ms": 0.20334959030151367}, "num_episodes": 2, "episode_return_max": 500.0, "episode_return_min": 12.0, "episode_return_mean": 372.9, "episodes_this_iter": 2}, "num_healthy_workers": 0, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 90000, "num_agent_steps_trained": 2848000, "num_env_steps_sampled": 90000, "num_env_steps_trained": 2848000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 28.567920259295636, "num_env_steps_trained_throughput_per_sec": 914.1734482974604, "timesteps_total": 90000, "num_env_steps_sampled_lifetime": 90000, "num_agent_steps_sampled_lifetime": 90000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 90000, "timers": {"training_iteration_time_ms": 34490.309, "restore_workers_time_ms": 0.021, "training_step_time_ms": 35.265, "sample_time_ms": 4.143, "load_time_ms": 0.23, "load_throughput": 138912.987, "learn_time_ms": 15.057, "learn_throughput": 2125.265, "synch_weights_time_ms": 0.051}, "counters": {"num_env_steps_sampled": 90000, "num_env_steps_trained": 2848000, "num_agent_steps_sampled": 90000, "num_agent_steps_trained": 2848000, "last_target_update_ts": 89501, "num_target_updates": 178}, "done": false, "training_iteration": 90, "trial_id": "5ce16_00000", "date": "2024-09-27_11-40-05", "timestamp": 1727408405, "time_this_iter_s": 35.00633406639099, "time_total_s": 2904.2860939502716, "pid": 39427, "hostname": "gpu2gate1", "node_ip": "10.64.32.126", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.9828407522030984, "lr": 0.0007583973879008875, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f52e4d75580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2904.2860939502716, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 11.773469387755101, "ram_util_percent": 11.30204081632653}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.19152769446372986, "mean_q": 52.962188720703125, "min_q": 7.871234893798828, "max_q": 58.70853042602539, "cur_lr": 0.0007583973879008875}, "td_error": [-0.008258819580078125, 0.5564193725585938, -0.08815383911132812, -0.17107772827148438, -0.2625885009765625, -0.3100700378417969, 0.21059036254882812, -0.004299163818359375, -0.08367538452148438, 0.4312553405761719, 0.17475128173828125, 0.27678680419921875, 0.03456878662109375, -4.254384994506836, -0.2859382629394531, -0.0366058349609375, -0.8178253173828125, -0.26670074462890625, 0.6503868103027344, -0.49777984619140625, 0.5894508361816406, 0.2004547119140625, -1.8917045593261719, 0.1749114990234375, -0.2644386291503906, 0.06264495849609375, -0.6168766021728516, 0.096588134765625, 0.04636383056640625, 0.4453926086425781, 0.0467376708984375, -0.06608963012695312], "mean_td_error": -0.18528640270233154, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 90000.0, "diff_num_grad_updates_vs_sampler_policy": 27361.78125}}, "num_env_steps_sampled": 91000, "num_env_steps_trained": 2880000, "num_agent_steps_sampled": 91000, "num_agent_steps_trained": 2880000, "last_target_update_ts": 90501, "num_target_updates": 180}, "env_runners": {"episode_reward_max": 500.0, "episode_reward_min": 12.0, "episode_reward_mean": 373.44, "episode_len_mean": 373.44, "episode_media": {}, "episodes_timesteps_total": 37344, "policy_reward_min": {"default_policy": 12.0}, "policy_reward_max": {"default_policy": 500.0}, "policy_reward_mean": {"default_policy": 373.44}, "custom_metrics": {}, "hist_stats": {"episode_reward": [393.0, 140.0, 145.0, 500.0, 152.0, 284.0, 500.0, 258.0, 500.0, 500.0, 500.0, 500.0, 91.0, 500.0, 500.0, 31.0, 86.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 331.0, 223.0, 235.0, 77.0, 222.0, 140.0, 117.0, 105.0, 114.0, 139.0, 393.0, 500.0, 500.0, 500.0, 36.0, 500.0, 500.0, 500.0, 500.0, 500.0, 12.0, 500.0, 500.0, 473.0, 500.0, 500.0, 500.0, 393.0, 185.0, 144.0, 173.0, 500.0, 500.0, 500.0, 458.0, 500.0, 500.0, 500.0, 278.0, 500.0, 500.0, 500.0, 500.0, 500.0, 332.0, 137.0, 297.0, 106.0, 255.0, 500.0, 500.0, 151.0, 447.0, 232.0, 500.0, 248.0, 279.0, 360.0, 235.0, 231.0, 247.0, 254.0, 500.0, 500.0, 500.0, 500.0, 500.0, 205.0, 500.0], "episode_lengths": [393, 140, 145, 500, 152, 284, 500, 258, 500, 500, 500, 500, 91, 500, 500, 31, 86, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 331, 223, 235, 77, 222, 140, 117, 105, 114, 139, 393, 500, 500, 500, 36, 500, 500, 500, 500, 500, 12, 500, 500, 473, 500, 500, 500, 393, 185, 144, 173, 500, 500, 500, 458, 500, 500, 500, 278, 500, 500, 500, 500, 500, 332, 137, 297, 106, 255, 500, 500, 151, 447, 232, 500, 248, 279, 360, 235, 231, 247, 254, 500, 500, 500, 500, 500, 205, 500], "policy_default_policy_reward": [393.0, 140.0, 145.0, 500.0, 152.0, 284.0, 500.0, 258.0, 500.0, 500.0, 500.0, 500.0, 91.0, 500.0, 500.0, 31.0, 86.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 331.0, 223.0, 235.0, 77.0, 222.0, 140.0, 117.0, 105.0, 114.0, 139.0, 393.0, 500.0, 500.0, 500.0, 36.0, 500.0, 500.0, 500.0, 500.0, 500.0, 12.0, 500.0, 500.0, 473.0, 500.0, 500.0, 500.0, 393.0, 185.0, 144.0, 173.0, 500.0, 500.0, 500.0, 458.0, 500.0, 500.0, 500.0, 278.0, 500.0, 500.0, 500.0, 500.0, 500.0, 332.0, 137.0, 297.0, 106.0, 255.0, 500.0, 500.0, 151.0, 447.0, 232.0, 500.0, 248.0, 279.0, 360.0, 235.0, 231.0, 247.0, 254.0, 500.0, 500.0, 500.0, 500.0, 500.0, 205.0, 500.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0071790145000026, "mean_inference_ms": 2.0112054589948327, "mean_action_processing_ms": 0.23416799873433242, "mean_env_wait_ms": 0.10116253512445335, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017519235610961914, "StateBufferConnector_ms": 0.016080617904663086, "ViewRequirementAgentConnector_ms": 0.2031233310699463}, "num_episodes": 2, "episode_return_max": 500.0, "episode_return_min": 12.0, "episode_return_mean": 373.44, "episodes_this_iter": 2}, "num_healthy_workers": 0, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 91000, "num_agent_steps_trained": 2880000, "num_env_steps_sampled": 91000, "num_env_steps_trained": 2880000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 27.283850191685403, "num_env_steps_trained_throughput_per_sec": 873.0832061339329, "timesteps_total": 91000, "num_env_steps_sampled_lifetime": 91000, "num_agent_steps_sampled_lifetime": 91000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 91000, "timers": {"training_iteration_time_ms": 34710.406, "restore_workers_time_ms": 0.021, "training_step_time_ms": 33.613, "sample_time_ms": 4.024, "load_time_ms": 0.23, "load_throughput": 139186.693, "learn_time_ms": 14.528, "learn_throughput": 2202.703, "synch_weights_time_ms": 0.047}, "counters": {"num_env_steps_sampled": 91000, "num_env_steps_trained": 2880000, "num_agent_steps_sampled": 91000, "num_agent_steps_trained": 2880000, "last_target_update_ts": 90501, "num_target_updates": 180}, "done": false, "training_iteration": 91, "trial_id": "5ce16_00000", "date": "2024-09-27_11-40-42", "timestamp": 1727408442, "time_this_iter_s": 36.65386891365051, "time_total_s": 2940.939962863922, "pid": 39427, "hostname": "gpu2gate1", "node_ip": "10.64.32.126", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.9828407522030984, "lr": 0.0007583973879008875, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f52e4d75580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2940.939962863922, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 11.553846153846155, "ram_util_percent": 11.299999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.38238954544067383, "mean_q": 52.35773468017578, "min_q": 7.36004114151001, "max_q": 59.073577880859375, "cur_lr": 0.0007583973879008875}, "td_error": [0.3383445739746094, 0.17136764526367188, 6.36004114151001, -0.13143539428710938, -0.14904403686523438, 0.07022476196289062, -0.24355316162109375, 0.049686431884765625, -0.6499977111816406, 0.41187286376953125, 0.5224075317382812, -0.06011962890625, -0.6936187744140625, -0.019382476806640625, 0.18355178833007812, -0.05132293701171875, 0.18662261962890625, -0.193603515625, -0.147369384765625, 0.5893745422363281, -0.018863677978515625, -0.31021881103515625, -0.23540496826171875, -0.4276885986328125, -0.65875244140625, -0.0799102783203125, -0.16642379760742188, 0.15059471130371094, 0.07699966430664062, -2.349689483642578, -0.028125762939453125, -0.08765792846679688], "mean_td_error": 0.07527829706668854, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 91000.0, "diff_num_grad_updates_vs_sampler_policy": 25870.78125}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 2912000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 2912000, "last_target_update_ts": 91501, "num_target_updates": 182}, "env_runners": {"episode_reward_max": 500.0, "episode_reward_min": 12.0, "episode_reward_mean": 377.38, "episode_len_mean": 377.38, "episode_media": {}, "episodes_timesteps_total": 37738, "policy_reward_min": {"default_policy": 12.0}, "policy_reward_max": {"default_policy": 500.0}, "policy_reward_mean": {"default_policy": 377.38}, "custom_metrics": {}, "hist_stats": {"episode_reward": [145.0, 500.0, 152.0, 284.0, 500.0, 258.0, 500.0, 500.0, 500.0, 500.0, 91.0, 500.0, 500.0, 31.0, 86.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 331.0, 223.0, 235.0, 77.0, 222.0, 140.0, 117.0, 105.0, 114.0, 139.0, 393.0, 500.0, 500.0, 500.0, 36.0, 500.0, 500.0, 500.0, 500.0, 500.0, 12.0, 500.0, 500.0, 473.0, 500.0, 500.0, 500.0, 393.0, 185.0, 144.0, 173.0, 500.0, 500.0, 500.0, 458.0, 500.0, 500.0, 500.0, 278.0, 500.0, 500.0, 500.0, 500.0, 500.0, 332.0, 137.0, 297.0, 106.0, 255.0, 500.0, 500.0, 151.0, 447.0, 232.0, 500.0, 248.0, 279.0, 360.0, 235.0, 231.0, 247.0, 254.0, 500.0, 500.0, 500.0, 500.0, 500.0, 205.0, 500.0, 477.0, 450.0], "episode_lengths": [145, 500, 152, 284, 500, 258, 500, 500, 500, 500, 91, 500, 500, 31, 86, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 331, 223, 235, 77, 222, 140, 117, 105, 114, 139, 393, 500, 500, 500, 36, 500, 500, 500, 500, 500, 12, 500, 500, 473, 500, 500, 500, 393, 185, 144, 173, 500, 500, 500, 458, 500, 500, 500, 278, 500, 500, 500, 500, 500, 332, 137, 297, 106, 255, 500, 500, 151, 447, 232, 500, 248, 279, 360, 235, 231, 247, 254, 500, 500, 500, 500, 500, 205, 500, 477, 450], "policy_default_policy_reward": [145.0, 500.0, 152.0, 284.0, 500.0, 258.0, 500.0, 500.0, 500.0, 500.0, 91.0, 500.0, 500.0, 31.0, 86.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 331.0, 223.0, 235.0, 77.0, 222.0, 140.0, 117.0, 105.0, 114.0, 139.0, 393.0, 500.0, 500.0, 500.0, 36.0, 500.0, 500.0, 500.0, 500.0, 500.0, 12.0, 500.0, 500.0, 473.0, 500.0, 500.0, 500.0, 393.0, 185.0, 144.0, 173.0, 500.0, 500.0, 500.0, 458.0, 500.0, 500.0, 500.0, 278.0, 500.0, 500.0, 500.0, 500.0, 500.0, 332.0, 137.0, 297.0, 106.0, 255.0, 500.0, 500.0, 151.0, 447.0, 232.0, 500.0, 248.0, 279.0, 360.0, 235.0, 231.0, 247.0, 254.0, 500.0, 500.0, 500.0, 500.0, 500.0, 205.0, 500.0, 477.0, 450.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.007415295985724, "mean_inference_ms": 2.0120075804224675, "mean_action_processing_ms": 0.2342146234554656, "mean_env_wait_ms": 0.10118096501538297, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017418622970581055, "StateBufferConnector_ms": 0.01600050926208496, "ViewRequirementAgentConnector_ms": 0.20276498794555664}, "num_episodes": 2, "episode_return_max": 500.0, "episode_return_min": 12.0, "episode_return_mean": 377.38, "episodes_this_iter": 2}, "num_healthy_workers": 0, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 2912000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 2912000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 28.60027029865137, "num_env_steps_trained_throughput_per_sec": 915.2086495568439, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 92000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 34872.017, "restore_workers_time_ms": 0.021, "training_step_time_ms": 36.401, "sample_time_ms": 4.298, "load_time_ms": 0.237, "load_throughput": 134851.53, "learn_time_ms": 15.711, "learn_throughput": 2036.725, "synch_weights_time_ms": 0.052}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 2912000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 2912000, "last_target_update_ts": 91501, "num_target_updates": 182}, "done": false, "training_iteration": 92, "trial_id": "5ce16_00000", "date": "2024-09-27_11-41-17", "timestamp": 1727408477, "time_this_iter_s": 34.96688103675842, "time_total_s": 2975.9068439006805, "pid": 39427, "hostname": "gpu2gate1", "node_ip": "10.64.32.126", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.9828407522030984, "lr": 0.0007583973879008875, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f52e4d75580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2975.9068439006805, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 11.583999999999998, "ram_util_percent": 11.299999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.38046276569366455, "mean_q": 52.66532897949219, "min_q": -15.346138954162598, "max_q": 58.765174865722656, "cur_lr": 0.0007583973879008875}, "td_error": [0.13018035888671875, -0.2191925048828125, -0.19739151000976562, 0.039371490478515625, -0.12182235717773438, -0.5534515380859375, -0.0154266357421875, -0.14407730102539062, -0.20033645629882812, -0.17160797119140625, 8.7738037109375e-05, 0.2880058288574219, -0.03362274169921875, 0.3791656494140625, -0.29166316986083984, 0.9225883483886719, 0.06930923461914062, 0.40709686279296875, -0.06995773315429688, -0.07995223999023438, 1.846099853515625, -0.13234329223632812, -0.30853271484375, 0.1487274169921875, 0.023960113525390625, -0.6673355102539062, 0.18947219848632812, -0.18640518188476562, -0.2624015808105469, -16.34613800048828, -0.437957763671875, -0.07248306274414062], "mean_td_error": -0.5021260976791382, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 92000.0, "diff_num_grad_updates_vs_sampler_policy": 22367.75}}, "num_env_steps_sampled": 93000, "num_env_steps_trained": 2944000, "num_agent_steps_sampled": 93000, "num_agent_steps_trained": 2944000, "last_target_update_ts": 92501, "num_target_updates": 184}, "env_runners": {"episode_reward_max": 500.0, "episode_reward_min": 12.0, "episode_reward_mean": 381.33, "episode_len_mean": 381.33, "episode_media": {}, "episodes_timesteps_total": 38133, "policy_reward_min": {"default_policy": 12.0}, "policy_reward_max": {"default_policy": 500.0}, "policy_reward_mean": {"default_policy": 381.33}, "custom_metrics": {}, "hist_stats": {"episode_reward": [284.0, 500.0, 258.0, 500.0, 500.0, 500.0, 500.0, 91.0, 500.0, 500.0, 31.0, 86.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 331.0, 223.0, 235.0, 77.0, 222.0, 140.0, 117.0, 105.0, 114.0, 139.0, 393.0, 500.0, 500.0, 500.0, 36.0, 500.0, 500.0, 500.0, 500.0, 500.0, 12.0, 500.0, 500.0, 473.0, 500.0, 500.0, 500.0, 393.0, 185.0, 144.0, 173.0, 500.0, 500.0, 500.0, 458.0, 500.0, 500.0, 500.0, 278.0, 500.0, 500.0, 500.0, 500.0, 500.0, 332.0, 137.0, 297.0, 106.0, 255.0, 500.0, 500.0, 151.0, 447.0, 232.0, 500.0, 248.0, 279.0, 360.0, 235.0, 231.0, 247.0, 254.0, 500.0, 500.0, 500.0, 500.0, 500.0, 205.0, 500.0, 477.0, 450.0, 500.0, 192.0, 500.0], "episode_lengths": [284, 500, 258, 500, 500, 500, 500, 91, 500, 500, 31, 86, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 331, 223, 235, 77, 222, 140, 117, 105, 114, 139, 393, 500, 500, 500, 36, 500, 500, 500, 500, 500, 12, 500, 500, 473, 500, 500, 500, 393, 185, 144, 173, 500, 500, 500, 458, 500, 500, 500, 278, 500, 500, 500, 500, 500, 332, 137, 297, 106, 255, 500, 500, 151, 447, 232, 500, 248, 279, 360, 235, 231, 247, 254, 500, 500, 500, 500, 500, 205, 500, 477, 450, 500, 192, 500], "policy_default_policy_reward": [284.0, 500.0, 258.0, 500.0, 500.0, 500.0, 500.0, 91.0, 500.0, 500.0, 31.0, 86.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 331.0, 223.0, 235.0, 77.0, 222.0, 140.0, 117.0, 105.0, 114.0, 139.0, 393.0, 500.0, 500.0, 500.0, 36.0, 500.0, 500.0, 500.0, 500.0, 500.0, 12.0, 500.0, 500.0, 473.0, 500.0, 500.0, 500.0, 393.0, 185.0, 144.0, 173.0, 500.0, 500.0, 500.0, 458.0, 500.0, 500.0, 500.0, 278.0, 500.0, 500.0, 500.0, 500.0, 500.0, 332.0, 137.0, 297.0, 106.0, 255.0, 500.0, 500.0, 151.0, 447.0, 232.0, 500.0, 248.0, 279.0, 360.0, 235.0, 231.0, 247.0, 254.0, 500.0, 500.0, 500.0, 500.0, 500.0, 205.0, 500.0, 477.0, 450.0, 500.0, 192.0, 500.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0077984985385147, "mean_inference_ms": 2.0132301795087955, "mean_action_processing_ms": 0.23429379885661267, "mean_env_wait_ms": 0.10121563462325595, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017479658126831055, "StateBufferConnector_ms": 0.0159759521484375, "ViewRequirementAgentConnector_ms": 0.20312285423278809}, "num_episodes": 3, "episode_return_max": 500.0, "episode_return_min": 12.0, "episode_return_mean": 381.33, "episodes_this_iter": 3}, "num_healthy_workers": 0, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 93000, "num_agent_steps_trained": 2944000, "num_env_steps_sampled": 93000, "num_env_steps_trained": 2944000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 27.595904625070652, "num_env_steps_trained_throughput_per_sec": 883.0689480022609, "timesteps_total": 93000, "num_env_steps_sampled_lifetime": 93000, "num_agent_steps_sampled_lifetime": 93000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 93000, "timers": {"training_iteration_time_ms": 35079.545, "restore_workers_time_ms": 0.028, "training_step_time_ms": 39.655, "sample_time_ms": 4.83, "load_time_ms": 0.279, "load_throughput": 114804.318, "learn_time_ms": 16.529, "learn_throughput": 1935.99, "synch_weights_time_ms": 0.06}, "counters": {"num_env_steps_sampled": 93000, "num_env_steps_trained": 2944000, "num_agent_steps_sampled": 93000, "num_agent_steps_trained": 2944000, "last_target_update_ts": 92501, "num_target_updates": 184}, "done": false, "training_iteration": 93, "trial_id": "5ce16_00000", "date": "2024-09-27_11-41-53", "timestamp": 1727408513, "time_this_iter_s": 36.23951506614685, "time_total_s": 3012.1463589668274, "pid": 39427, "hostname": "gpu2gate1", "node_ip": "10.64.32.126", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.9828407522030984, "lr": 0.0007583973879008875, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f52e4d75580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3012.1463589668274, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 11.598039215686272, "ram_util_percent": 11.299999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.19115382432937622, "mean_q": 54.81371307373047, "min_q": 18.254207611083984, "max_q": 58.523868560791016, "cur_lr": 0.0007583973879008875}, "td_error": [0.3310394287109375, -0.06787872314453125, -0.1888427734375, 0.21413803100585938, 0.15668106079101562, 0.13343048095703125, -0.09254074096679688, -0.11298751831054688, -0.10245513916015625, 0.2763671875, 0.28497314453125, 7.89306640625, -0.14006805419921875, -1.3547286987304688, -0.5977745056152344, 0.23044395446777344, 0.056301116943359375, 0.36934661865234375, 0.15552520751953125, 0.03572845458984375, 0.18616104125976562, -0.8109207153320312, 0.00939178466796875, 0.23350906372070312, -0.5878524780273438, 0.22168350219726562, -0.0243682861328125, -0.08358383178710938, 0.41172027587890625, 0.214630126953125, -0.221466064453125, -0.13776779174804688], "mean_td_error": 0.21534067392349243, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 93000.0, "diff_num_grad_updates_vs_sampler_policy": 25073.0625}}, "num_env_steps_sampled": 94000, "num_env_steps_trained": 2976000, "num_agent_steps_sampled": 94000, "num_agent_steps_trained": 2976000, "last_target_update_ts": 93501, "num_target_updates": 186}, "env_runners": {"episode_reward_max": 500.0, "episode_reward_min": 12.0, "episode_reward_mean": 367.07, "episode_len_mean": 367.07, "episode_media": {}, "episodes_timesteps_total": 36707, "policy_reward_min": {"default_policy": 12.0}, "policy_reward_max": {"default_policy": 500.0}, "policy_reward_mean": {"default_policy": 367.07}, "custom_metrics": {}, "hist_stats": {"episode_reward": [500.0, 91.0, 500.0, 500.0, 31.0, 86.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 331.0, 223.0, 235.0, 77.0, 222.0, 140.0, 117.0, 105.0, 114.0, 139.0, 393.0, 500.0, 500.0, 500.0, 36.0, 500.0, 500.0, 500.0, 500.0, 500.0, 12.0, 500.0, 500.0, 473.0, 500.0, 500.0, 500.0, 393.0, 185.0, 144.0, 173.0, 500.0, 500.0, 500.0, 458.0, 500.0, 500.0, 500.0, 278.0, 500.0, 500.0, 500.0, 500.0, 500.0, 332.0, 137.0, 297.0, 106.0, 255.0, 500.0, 500.0, 151.0, 447.0, 232.0, 500.0, 248.0, 279.0, 360.0, 235.0, 231.0, 247.0, 254.0, 500.0, 500.0, 500.0, 500.0, 500.0, 205.0, 500.0, 477.0, 450.0, 500.0, 192.0, 500.0, 285.0, 216.0, 168.0, 152.0, 142.0, 153.0], "episode_lengths": [500, 91, 500, 500, 31, 86, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 331, 223, 235, 77, 222, 140, 117, 105, 114, 139, 393, 500, 500, 500, 36, 500, 500, 500, 500, 500, 12, 500, 500, 473, 500, 500, 500, 393, 185, 144, 173, 500, 500, 500, 458, 500, 500, 500, 278, 500, 500, 500, 500, 500, 332, 137, 297, 106, 255, 500, 500, 151, 447, 232, 500, 248, 279, 360, 235, 231, 247, 254, 500, 500, 500, 500, 500, 205, 500, 477, 450, 500, 192, 500, 285, 216, 168, 152, 142, 153], "policy_default_policy_reward": [500.0, 91.0, 500.0, 500.0, 31.0, 86.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 331.0, 223.0, 235.0, 77.0, 222.0, 140.0, 117.0, 105.0, 114.0, 139.0, 393.0, 500.0, 500.0, 500.0, 36.0, 500.0, 500.0, 500.0, 500.0, 500.0, 12.0, 500.0, 500.0, 473.0, 500.0, 500.0, 500.0, 393.0, 185.0, 144.0, 173.0, 500.0, 500.0, 500.0, 458.0, 500.0, 500.0, 500.0, 278.0, 500.0, 500.0, 500.0, 500.0, 500.0, 332.0, 137.0, 297.0, 106.0, 255.0, 500.0, 500.0, 151.0, 447.0, 232.0, 500.0, 248.0, 279.0, 360.0, 235.0, 231.0, 247.0, 254.0, 500.0, 500.0, 500.0, 500.0, 500.0, 205.0, 500.0, 477.0, 450.0, 500.0, 192.0, 500.0, 285.0, 216.0, 168.0, 152.0, 142.0, 153.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0085540226882748, "mean_inference_ms": 2.015696174646796, "mean_action_processing_ms": 0.23443833700441474, "mean_env_wait_ms": 0.1012795039106841, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017621994018554688, "StateBufferConnector_ms": 0.015995025634765625, "ViewRequirementAgentConnector_ms": 0.2039186954498291}, "num_episodes": 6, "episode_return_max": 500.0, "episode_return_min": 12.0, "episode_return_mean": 367.07, "episodes_this_iter": 6}, "num_healthy_workers": 0, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 94000, "num_agent_steps_trained": 2976000, "num_env_steps_sampled": 94000, "num_env_steps_trained": 2976000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 31.047151705426195, "num_env_steps_trained_throughput_per_sec": 993.5088545736382, "timesteps_total": 94000, "num_env_steps_sampled_lifetime": 94000, "num_agent_steps_sampled_lifetime": 94000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 94000, "timers": {"training_iteration_time_ms": 35058.72, "restore_workers_time_ms": 0.019, "training_step_time_ms": 32.619, "sample_time_ms": 3.701, "load_time_ms": 0.256, "load_throughput": 125191.426, "learn_time_ms": 14.339, "learn_throughput": 2231.64, "synch_weights_time_ms": 0.046}, "counters": {"num_env_steps_sampled": 94000, "num_env_steps_trained": 2976000, "num_agent_steps_sampled": 94000, "num_agent_steps_trained": 2976000, "last_target_update_ts": 93501, "num_target_updates": 186}, "done": false, "training_iteration": 94, "trial_id": "5ce16_00000", "date": "2024-09-27_11-42-26", "timestamp": 1727408546, "time_this_iter_s": 32.2110755443573, "time_total_s": 3044.3574345111847, "pid": 39427, "hostname": "gpu2gate1", "node_ip": "10.64.32.126", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.9828407522030984, "lr": 0.0007583973879008875, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f52e4d75580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3044.3574345111847, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 12.08222222222222, "ram_util_percent": 11.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7696779370307922, "mean_q": 47.60865020751953, "min_q": -3.005192756652832, "max_q": 59.24985885620117, "cur_lr": 0.0007583973879008875}, "td_error": [0.15402603149414062, -0.5596656799316406, 0.5777435302734375, -4.005192756652832, 2.1909027099609375, -0.1047821044921875, 2.2528076171875, -0.3222618103027344, 0.3511505126953125, -0.001094818115234375, -1.9639415740966797, -0.4032859802246094, 16.68305206298828, -0.6161956787109375, 0.2515830993652344, -0.4041633605957031, -0.44588470458984375, 0.15181732177734375, 0.0192718505859375, 0.3208656311035156, 0.396270751953125, 0.269073486328125, 0.191253662109375, -0.2925983667373657, 0.19343185424804688, 0.176727294921875, 0.6918296813964844, -0.22430801391601562, -0.3740043640136719, -0.07836151123046875, -0.12711715698242188, 0.0201568603515625], "mean_td_error": 0.4677845537662506, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 94000.0, "diff_num_grad_updates_vs_sampler_policy": 24824.5}}, "num_env_steps_sampled": 95000, "num_env_steps_trained": 3008000, "num_agent_steps_sampled": 95000, "num_agent_steps_trained": 3008000, "last_target_update_ts": 94501, "num_target_updates": 188}, "env_runners": {"episode_reward_max": 500.0, "episode_reward_min": 12.0, "episode_reward_mean": 366.71, "episode_len_mean": 366.71, "episode_media": {}, "episodes_timesteps_total": 36671, "policy_reward_min": {"default_policy": 12.0}, "policy_reward_max": {"default_policy": 500.0}, "policy_reward_mean": {"default_policy": 366.71}, "custom_metrics": {}, "hist_stats": {"episode_reward": [500.0, 31.0, 86.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 331.0, 223.0, 235.0, 77.0, 222.0, 140.0, 117.0, 105.0, 114.0, 139.0, 393.0, 500.0, 500.0, 500.0, 36.0, 500.0, 500.0, 500.0, 500.0, 500.0, 12.0, 500.0, 500.0, 473.0, 500.0, 500.0, 500.0, 393.0, 185.0, 144.0, 173.0, 500.0, 500.0, 500.0, 458.0, 500.0, 500.0, 500.0, 278.0, 500.0, 500.0, 500.0, 500.0, 500.0, 332.0, 137.0, 297.0, 106.0, 255.0, 500.0, 500.0, 151.0, 447.0, 232.0, 500.0, 248.0, 279.0, 360.0, 235.0, 231.0, 247.0, 254.0, 500.0, 500.0, 500.0, 500.0, 500.0, 205.0, 500.0, 477.0, 450.0, 500.0, 192.0, 500.0, 285.0, 216.0, 168.0, 152.0, 142.0, 153.0, 365.0, 430.0, 260.0], "episode_lengths": [500, 31, 86, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 331, 223, 235, 77, 222, 140, 117, 105, 114, 139, 393, 500, 500, 500, 36, 500, 500, 500, 500, 500, 12, 500, 500, 473, 500, 500, 500, 393, 185, 144, 173, 500, 500, 500, 458, 500, 500, 500, 278, 500, 500, 500, 500, 500, 332, 137, 297, 106, 255, 500, 500, 151, 447, 232, 500, 248, 279, 360, 235, 231, 247, 254, 500, 500, 500, 500, 500, 205, 500, 477, 450, 500, 192, 500, 285, 216, 168, 152, 142, 153, 365, 430, 260], "policy_default_policy_reward": [500.0, 31.0, 86.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 331.0, 223.0, 235.0, 77.0, 222.0, 140.0, 117.0, 105.0, 114.0, 139.0, 393.0, 500.0, 500.0, 500.0, 36.0, 500.0, 500.0, 500.0, 500.0, 500.0, 12.0, 500.0, 500.0, 473.0, 500.0, 500.0, 500.0, 393.0, 185.0, 144.0, 173.0, 500.0, 500.0, 500.0, 458.0, 500.0, 500.0, 500.0, 278.0, 500.0, 500.0, 500.0, 500.0, 500.0, 332.0, 137.0, 297.0, 106.0, 255.0, 500.0, 500.0, 151.0, 447.0, 232.0, 500.0, 248.0, 279.0, 360.0, 235.0, 231.0, 247.0, 254.0, 500.0, 500.0, 500.0, 500.0, 500.0, 205.0, 500.0, 477.0, 450.0, 500.0, 192.0, 500.0, 285.0, 216.0, 168.0, 152.0, 142.0, 153.0, 365.0, 430.0, 260.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0088782479176301, "mean_inference_ms": 2.0168492795696396, "mean_action_processing_ms": 0.23450019262016503, "mean_env_wait_ms": 0.10130562607926645, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017689228057861328, "StateBufferConnector_ms": 0.015907764434814453, "ViewRequirementAgentConnector_ms": 0.20278501510620117}, "num_episodes": 3, "episode_return_max": 500.0, "episode_return_min": 12.0, "episode_return_mean": 366.71, "episodes_this_iter": 3}, "num_healthy_workers": 0, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 95000, "num_agent_steps_trained": 3008000, "num_env_steps_sampled": 95000, "num_env_steps_trained": 3008000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 29.780215854847405, "num_env_steps_trained_throughput_per_sec": 952.966907355117, "timesteps_total": 95000, "num_env_steps_sampled_lifetime": 95000, "num_agent_steps_sampled_lifetime": 95000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 95000, "timers": {"training_iteration_time_ms": 34761.196, "restore_workers_time_ms": 0.022, "training_step_time_ms": 33.339, "sample_time_ms": 3.91, "load_time_ms": 0.226, "load_throughput": 141744.353, "learn_time_ms": 14.313, "learn_throughput": 2235.665, "synch_weights_time_ms": 0.049}, "counters": {"num_env_steps_sampled": 95000, "num_env_steps_trained": 3008000, "num_agent_steps_sampled": 95000, "num_agent_steps_trained": 3008000, "last_target_update_ts": 94501, "num_target_updates": 188}, "done": false, "training_iteration": 95, "trial_id": "5ce16_00000", "date": "2024-09-27_11-42-59", "timestamp": 1727408579, "time_this_iter_s": 33.58142066001892, "time_total_s": 3077.9388551712036, "pid": 39427, "hostname": "gpu2gate1", "node_ip": "10.64.32.126", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.9828407522030984, "lr": 0.0007583973879008875, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f52e4d75580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3077.9388551712036, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 11.75, "ram_util_percent": 11.299999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5423597693443298, "mean_q": 51.277931213378906, "min_q": -3.905411720275879, "max_q": 59.51296615600586, "cur_lr": 0.0007583973879008875}, "td_error": [-0.2661018371582031, 0.3378410339355469, -0.19051361083984375, -0.03797149658203125, -1.4992809295654297, 0.020694732666015625, 6.810125827789307, -0.09955596923828125, -0.6083335876464844, -0.06805801391601562, -0.14135360717773438, -0.6032218933105469, -0.17214584350585938, -0.12215423583984375, 0.038249969482421875, -0.015666961669921875, -0.3657569885253906, -0.19550704956054688, 1.3227653503417969, 0.24477767944335938, -0.280792236328125, -0.016815185546875, -0.25640106201171875, -0.12183380126953125, -0.1104736328125, 0.3105430603027344, -0.0397491455078125, 0.309295654296875, 0.20693206787109375, -4.905411720275879, -0.7643623352050781, -0.14827728271484375], "mean_td_error": -0.04464103281497955, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 95000.0, "diff_num_grad_updates_vs_sampler_policy": 21671.21875}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 3040000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 3040000, "last_target_update_ts": 95501, "num_target_updates": 190}, "env_runners": {"episode_reward_max": 500.0, "episode_reward_min": 12.0, "episode_reward_mean": 371.07, "episode_len_mean": 371.07, "episode_media": {}, "episodes_timesteps_total": 37107, "policy_reward_min": {"default_policy": 12.0}, "policy_reward_max": {"default_policy": 500.0}, "policy_reward_mean": {"default_policy": 371.07}, "custom_metrics": {}, "hist_stats": {"episode_reward": [86.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 331.0, 223.0, 235.0, 77.0, 222.0, 140.0, 117.0, 105.0, 114.0, 139.0, 393.0, 500.0, 500.0, 500.0, 36.0, 500.0, 500.0, 500.0, 500.0, 500.0, 12.0, 500.0, 500.0, 473.0, 500.0, 500.0, 500.0, 393.0, 185.0, 144.0, 173.0, 500.0, 500.0, 500.0, 458.0, 500.0, 500.0, 500.0, 278.0, 500.0, 500.0, 500.0, 500.0, 500.0, 332.0, 137.0, 297.0, 106.0, 255.0, 500.0, 500.0, 151.0, 447.0, 232.0, 500.0, 248.0, 279.0, 360.0, 235.0, 231.0, 247.0, 254.0, 500.0, 500.0, 500.0, 500.0, 500.0, 205.0, 500.0, 477.0, 450.0, 500.0, 192.0, 500.0, 285.0, 216.0, 168.0, 152.0, 142.0, 153.0, 365.0, 430.0, 260.0, 467.0, 500.0], "episode_lengths": [86, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 331, 223, 235, 77, 222, 140, 117, 105, 114, 139, 393, 500, 500, 500, 36, 500, 500, 500, 500, 500, 12, 500, 500, 473, 500, 500, 500, 393, 185, 144, 173, 500, 500, 500, 458, 500, 500, 500, 278, 500, 500, 500, 500, 500, 332, 137, 297, 106, 255, 500, 500, 151, 447, 232, 500, 248, 279, 360, 235, 231, 247, 254, 500, 500, 500, 500, 500, 205, 500, 477, 450, 500, 192, 500, 285, 216, 168, 152, 142, 153, 365, 430, 260, 467, 500], "policy_default_policy_reward": [86.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 331.0, 223.0, 235.0, 77.0, 222.0, 140.0, 117.0, 105.0, 114.0, 139.0, 393.0, 500.0, 500.0, 500.0, 36.0, 500.0, 500.0, 500.0, 500.0, 500.0, 12.0, 500.0, 500.0, 473.0, 500.0, 500.0, 500.0, 393.0, 185.0, 144.0, 173.0, 500.0, 500.0, 500.0, 458.0, 500.0, 500.0, 500.0, 278.0, 500.0, 500.0, 500.0, 500.0, 500.0, 332.0, 137.0, 297.0, 106.0, 255.0, 500.0, 500.0, 151.0, 447.0, 232.0, 500.0, 248.0, 279.0, 360.0, 235.0, 231.0, 247.0, 254.0, 500.0, 500.0, 500.0, 500.0, 500.0, 205.0, 500.0, 477.0, 450.0, 500.0, 192.0, 500.0, 285.0, 216.0, 168.0, 152.0, 142.0, 153.0, 365.0, 430.0, 260.0, 467.0, 500.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0090252277878677, "mean_inference_ms": 2.0174789871159353, "mean_action_processing_ms": 0.23453081683951685, "mean_env_wait_ms": 0.10131807821575509, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01765751838684082, "StateBufferConnector_ms": 0.01589059829711914, "ViewRequirementAgentConnector_ms": 0.2024226188659668}, "num_episodes": 2, "episode_return_max": 500.0, "episode_return_min": 12.0, "episode_return_mean": 371.07, "episodes_this_iter": 2}, "num_healthy_workers": 0, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 3040000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 3040000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 30.281484405714615, "num_env_steps_trained_throughput_per_sec": 969.0075009828677, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 34282.647, "restore_workers_time_ms": 0.021, "training_step_time_ms": 32.783, "sample_time_ms": 3.748, "load_time_ms": 0.238, "load_throughput": 134338.633, "learn_time_ms": 14.284, "learn_throughput": 2240.308, "synch_weights_time_ms": 0.048}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 3040000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 3040000, "last_target_update_ts": 95501, "num_target_updates": 190}, "done": false, "training_iteration": 96, "trial_id": "5ce16_00000", "date": "2024-09-27_11-43-32", "timestamp": 1727408612, "time_this_iter_s": 33.02558875083923, "time_total_s": 3110.964443922043, "pid": 39427, "hostname": "gpu2gate1", "node_ip": "10.64.32.126", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.9828407522030984, "lr": 0.0007583973879008875, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f52e4d75580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3110.964443922043, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 11.719148936170212, "ram_util_percent": 11.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4902704060077667, "mean_q": 51.92949676513672, "min_q": 2.9248499870300293, "max_q": 59.73222732543945, "cur_lr": 0.0007583973879008875}, "td_error": [-0.007770538330078125, 0.16770172119140625, -0.028713226318359375, 0.11765289306640625, 0.27809906005859375, -0.06255722045898438, -0.041133880615234375, 0.09568023681640625, -0.06756210327148438, 0.0678863525390625, 0.13156890869140625, -0.08755111694335938, 0.3227424621582031, 0.8686256408691406, -0.13180160522460938, 0.060150146484375, 0.015605926513671875, -0.5793075561523438, -0.4506683349609375, 3.084686756134033, 0.1802215576171875, -0.2401294708251953, 1.2760772705078125, 0.09397125244140625, 0.553131103515625, -0.09496688842773438, -0.08702850341796875, -0.0682373046875, 0.9817240238189697, 0.3903312683105469, 0.3288993835449219, -0.7518844604492188], "mean_td_error": 0.19735762476921082, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 96000.0, "diff_num_grad_updates_vs_sampler_policy": 19524.53125}}, "num_env_steps_sampled": 97000, "num_env_steps_trained": 3072000, "num_agent_steps_sampled": 97000, "num_agent_steps_trained": 3072000, "last_target_update_ts": 96501, "num_target_updates": 192}, "env_runners": {"episode_reward_max": 500.0, "episode_reward_min": 12.0, "episode_reward_mean": 375.21, "episode_len_mean": 375.21, "episode_media": {}, "episodes_timesteps_total": 37521, "policy_reward_min": {"default_policy": 12.0}, "policy_reward_max": {"default_policy": 500.0}, "policy_reward_mean": {"default_policy": 375.21}, "custom_metrics": {}, "hist_stats": {"episode_reward": [500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 331.0, 223.0, 235.0, 77.0, 222.0, 140.0, 117.0, 105.0, 114.0, 139.0, 393.0, 500.0, 500.0, 500.0, 36.0, 500.0, 500.0, 500.0, 500.0, 500.0, 12.0, 500.0, 500.0, 473.0, 500.0, 500.0, 500.0, 393.0, 185.0, 144.0, 173.0, 500.0, 500.0, 500.0, 458.0, 500.0, 500.0, 500.0, 278.0, 500.0, 500.0, 500.0, 500.0, 500.0, 332.0, 137.0, 297.0, 106.0, 255.0, 500.0, 500.0, 151.0, 447.0, 232.0, 500.0, 248.0, 279.0, 360.0, 235.0, 231.0, 247.0, 254.0, 500.0, 500.0, 500.0, 500.0, 500.0, 205.0, 500.0, 477.0, 450.0, 500.0, 192.0, 500.0, 285.0, 216.0, 168.0, 152.0, 142.0, 153.0, 365.0, 430.0, 260.0, 467.0, 500.0, 500.0, 500.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 331, 223, 235, 77, 222, 140, 117, 105, 114, 139, 393, 500, 500, 500, 36, 500, 500, 500, 500, 500, 12, 500, 500, 473, 500, 500, 500, 393, 185, 144, 173, 500, 500, 500, 458, 500, 500, 500, 278, 500, 500, 500, 500, 500, 332, 137, 297, 106, 255, 500, 500, 151, 447, 232, 500, 248, 279, 360, 235, 231, 247, 254, 500, 500, 500, 500, 500, 205, 500, 477, 450, 500, 192, 500, 285, 216, 168, 152, 142, 153, 365, 430, 260, 467, 500, 500, 500], "policy_default_policy_reward": [500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 331.0, 223.0, 235.0, 77.0, 222.0, 140.0, 117.0, 105.0, 114.0, 139.0, 393.0, 500.0, 500.0, 500.0, 36.0, 500.0, 500.0, 500.0, 500.0, 500.0, 12.0, 500.0, 500.0, 473.0, 500.0, 500.0, 500.0, 393.0, 185.0, 144.0, 173.0, 500.0, 500.0, 500.0, 458.0, 500.0, 500.0, 500.0, 278.0, 500.0, 500.0, 500.0, 500.0, 500.0, 332.0, 137.0, 297.0, 106.0, 255.0, 500.0, 500.0, 151.0, 447.0, 232.0, 500.0, 248.0, 279.0, 360.0, 235.0, 231.0, 247.0, 254.0, 500.0, 500.0, 500.0, 500.0, 500.0, 205.0, 500.0, 477.0, 450.0, 500.0, 192.0, 500.0, 285.0, 216.0, 168.0, 152.0, 142.0, 153.0, 365.0, 430.0, 260.0, 467.0, 500.0, 500.0, 500.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0091529068981624, "mean_inference_ms": 2.0180617284123525, "mean_action_processing_ms": 0.23455695401689883, "mean_env_wait_ms": 0.10132861703795455, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017658233642578125, "StateBufferConnector_ms": 0.01566624641418457, "ViewRequirementAgentConnector_ms": 0.20212054252624512}, "num_episodes": 2, "episode_return_max": 500.0, "episode_return_min": 12.0, "episode_return_mean": 375.21, "episodes_this_iter": 2}, "num_healthy_workers": 0, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 97000, "num_agent_steps_trained": 3072000, "num_env_steps_sampled": 97000, "num_env_steps_trained": 3072000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 29.63340566685584, "num_env_steps_trained_throughput_per_sec": 948.2689813393869, "timesteps_total": 97000, "num_env_steps_sampled_lifetime": 97000, "num_agent_steps_sampled_lifetime": 97000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 97000, "timers": {"training_iteration_time_ms": 34162.813, "restore_workers_time_ms": 0.041, "training_step_time_ms": 33.364, "sample_time_ms": 3.688, "load_time_ms": 0.22, "load_throughput": 145257.281, "learn_time_ms": 14.403, "learn_throughput": 2221.725, "synch_weights_time_ms": 0.048}, "counters": {"num_env_steps_sampled": 97000, "num_env_steps_trained": 3072000, "num_agent_steps_sampled": 97000, "num_agent_steps_trained": 3072000, "last_target_update_ts": 96501, "num_target_updates": 192}, "done": false, "training_iteration": 97, "trial_id": "5ce16_00000", "date": "2024-09-27_11-44-06", "timestamp": 1727408646, "time_this_iter_s": 33.74754762649536, "time_total_s": 3144.711991548538, "pid": 39427, "hostname": "gpu2gate1", "node_ip": "10.64.32.126", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.9828407522030984, "lr": 0.0007583973879008875, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f52e4d75580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3144.711991548538, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 11.736170212765957, "ram_util_percent": 11.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7172312140464783, "mean_q": 51.17292022705078, "min_q": 3.2324399948120117, "max_q": 60.13218688964844, "cur_lr": 0.0007583973879008875}, "td_error": [-0.16788101196289062, -0.07518768310546875, 0.03733062744140625, 0.17993545532226562, 0.24530410766601562, 0.7069129943847656, 0.6034126281738281, -0.1756134033203125, 0.01886749267578125, -0.016506195068359375, 0.2639923095703125, -5.741729736328125, 0.09369277954101562, 0.29241943359375, 0.37371063232421875, -0.0655975341796875, -2.5366835594177246, 0.041156768798828125, -0.19257736206054688, -0.20666122436523438, 0.0806121826171875, 0.022220611572265625, 0.057037353515625, 0.36304473876953125, -0.6515769958496094, 0.4457130432128906, 0.0220947265625, 0.24638748168945312, -4.532238006591797, 0.4409656524658203, -2.8387107849121094, -0.4035167694091797], "mean_td_error": -0.4084271788597107, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 97000.0, "diff_num_grad_updates_vs_sampler_policy": 19958.1875}}, "num_env_steps_sampled": 98000, "num_env_steps_trained": 3104000, "num_agent_steps_sampled": 98000, "num_agent_steps_trained": 3104000, "last_target_update_ts": 97501, "num_target_updates": 194}, "env_runners": {"episode_reward_max": 500.0, "episode_reward_min": 12.0, "episode_reward_mean": 370.55, "episode_len_mean": 370.55, "episode_media": {}, "episodes_timesteps_total": 37055, "policy_reward_min": {"default_policy": 12.0}, "policy_reward_max": {"default_policy": 500.0}, "policy_reward_mean": {"default_policy": 370.55}, "custom_metrics": {}, "hist_stats": {"episode_reward": [500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 331.0, 223.0, 235.0, 77.0, 222.0, 140.0, 117.0, 105.0, 114.0, 139.0, 393.0, 500.0, 500.0, 500.0, 36.0, 500.0, 500.0, 500.0, 500.0, 500.0, 12.0, 500.0, 500.0, 473.0, 500.0, 500.0, 500.0, 393.0, 185.0, 144.0, 173.0, 500.0, 500.0, 500.0, 458.0, 500.0, 500.0, 500.0, 278.0, 500.0, 500.0, 500.0, 500.0, 500.0, 332.0, 137.0, 297.0, 106.0, 255.0, 500.0, 500.0, 151.0, 447.0, 232.0, 500.0, 248.0, 279.0, 360.0, 235.0, 231.0, 247.0, 254.0, 500.0, 500.0, 500.0, 500.0, 500.0, 205.0, 500.0, 477.0, 450.0, 500.0, 192.0, 500.0, 285.0, 216.0, 168.0, 152.0, 142.0, 153.0, 365.0, 430.0, 260.0, 467.0, 500.0, 500.0, 500.0, 500.0, 500.0, 34.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 331, 223, 235, 77, 222, 140, 117, 105, 114, 139, 393, 500, 500, 500, 36, 500, 500, 500, 500, 500, 12, 500, 500, 473, 500, 500, 500, 393, 185, 144, 173, 500, 500, 500, 458, 500, 500, 500, 278, 500, 500, 500, 500, 500, 332, 137, 297, 106, 255, 500, 500, 151, 447, 232, 500, 248, 279, 360, 235, 231, 247, 254, 500, 500, 500, 500, 500, 205, 500, 477, 450, 500, 192, 500, 285, 216, 168, 152, 142, 153, 365, 430, 260, 467, 500, 500, 500, 500, 500, 34], "policy_default_policy_reward": [500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 331.0, 223.0, 235.0, 77.0, 222.0, 140.0, 117.0, 105.0, 114.0, 139.0, 393.0, 500.0, 500.0, 500.0, 36.0, 500.0, 500.0, 500.0, 500.0, 500.0, 12.0, 500.0, 500.0, 473.0, 500.0, 500.0, 500.0, 393.0, 185.0, 144.0, 173.0, 500.0, 500.0, 500.0, 458.0, 500.0, 500.0, 500.0, 278.0, 500.0, 500.0, 500.0, 500.0, 500.0, 332.0, 137.0, 297.0, 106.0, 255.0, 500.0, 500.0, 151.0, 447.0, 232.0, 500.0, 248.0, 279.0, 360.0, 235.0, 231.0, 247.0, 254.0, 500.0, 500.0, 500.0, 500.0, 500.0, 205.0, 500.0, 477.0, 450.0, 500.0, 192.0, 500.0, 285.0, 216.0, 168.0, 152.0, 142.0, 153.0, 365.0, 430.0, 260.0, 467.0, 500.0, 500.0, 500.0, 500.0, 500.0, 34.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0092625154309898, "mean_inference_ms": 2.0187526650697425, "mean_action_processing_ms": 0.23457665476163242, "mean_env_wait_ms": 0.10133658060278634, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017647504806518555, "StateBufferConnector_ms": 0.015516519546508789, "ViewRequirementAgentConnector_ms": 0.20177125930786133}, "num_episodes": 3, "episode_return_max": 500.0, "episode_return_min": 12.0, "episode_return_mean": 370.55, "episodes_this_iter": 3}, "num_healthy_workers": 0, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 98000, "num_agent_steps_trained": 3104000, "num_env_steps_sampled": 98000, "num_env_steps_trained": 3104000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 28.97927274745512, "num_env_steps_trained_throughput_per_sec": 927.3367279185638, "timesteps_total": 98000, "num_env_steps_sampled_lifetime": 98000, "num_agent_steps_sampled_lifetime": 98000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 98000, "timers": {"training_iteration_time_ms": 34351.04, "restore_workers_time_ms": 0.023, "training_step_time_ms": 42.45, "sample_time_ms": 4.788, "load_time_ms": 0.277, "load_throughput": 115665.053, "learn_time_ms": 18.079, "learn_throughput": 1770.003, "synch_weights_time_ms": 0.06}, "counters": {"num_env_steps_sampled": 98000, "num_env_steps_trained": 3104000, "num_agent_steps_sampled": 98000, "num_agent_steps_trained": 3104000, "last_target_update_ts": 97501, "num_target_updates": 194}, "done": false, "training_iteration": 98, "trial_id": "5ce16_00000", "date": "2024-09-27_11-44-41", "timestamp": 1727408681, "time_this_iter_s": 34.50999093055725, "time_total_s": 3179.2219824790955, "pid": 39427, "hostname": "gpu2gate1", "node_ip": "10.64.32.126", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.9828407522030984, "lr": 0.0007583973879008875, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f52e4d75580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3179.2219824790955, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 11.65, "ram_util_percent": 11.299999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9653930068016052, "mean_q": 54.842308044433594, "min_q": 5.262867450714111, "max_q": 61.3718147277832, "cur_lr": 0.0007583973879008875}, "td_error": [0.7344970703125, -0.21736526489257812, 0.10513687133789062, 0.5914306640625, 0.2867088317871094, 0.7719497680664062, 0.419708251953125, -0.064788818359375, 0.371185302734375, 0.4469871520996094, -1.0072479248046875, 0.671966552734375, 0.369232177734375, -2.8076534271240234, -0.05699920654296875, 0.019618988037109375, 0.6373977661132812, 0.2924041748046875, 0.3424034118652344, 0.06548309326171875, 0.8582038879394531, -1.2473220825195312, 0.3679771423339844, 0.3772621154785156, -0.7601852416992188, -0.12548446655273438, 3.890418529510498, -0.07927322387695312, -0.05773162841796875, -0.003726959228515625, 0.6330375671386719, -0.034816741943359375], "mean_td_error": 0.18095044791698456, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 98000.0, "diff_num_grad_updates_vs_sampler_policy": 23375.625}}, "num_env_steps_sampled": 99000, "num_env_steps_trained": 3136000, "num_agent_steps_sampled": 99000, "num_agent_steps_trained": 3136000, "last_target_update_ts": 98501, "num_target_updates": 196}, "env_runners": {"episode_reward_max": 500.0, "episode_reward_min": 12.0, "episode_reward_mean": 368.46, "episode_len_mean": 368.46, "episode_media": {}, "episodes_timesteps_total": 36846, "policy_reward_min": {"default_policy": 12.0}, "policy_reward_max": {"default_policy": 500.0}, "policy_reward_mean": {"default_policy": 368.46}, "custom_metrics": {}, "hist_stats": {"episode_reward": [500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 331.0, 223.0, 235.0, 77.0, 222.0, 140.0, 117.0, 105.0, 114.0, 139.0, 393.0, 500.0, 500.0, 500.0, 36.0, 500.0, 500.0, 500.0, 500.0, 500.0, 12.0, 500.0, 500.0, 473.0, 500.0, 500.0, 500.0, 393.0, 185.0, 144.0, 173.0, 500.0, 500.0, 500.0, 458.0, 500.0, 500.0, 500.0, 278.0, 500.0, 500.0, 500.0, 500.0, 500.0, 332.0, 137.0, 297.0, 106.0, 255.0, 500.0, 500.0, 151.0, 447.0, 232.0, 500.0, 248.0, 279.0, 360.0, 235.0, 231.0, 247.0, 254.0, 500.0, 500.0, 500.0, 500.0, 500.0, 205.0, 500.0, 477.0, 450.0, 500.0, 192.0, 500.0, 285.0, 216.0, 168.0, 152.0, 142.0, 153.0, 365.0, 430.0, 260.0, 467.0, 500.0, 500.0, 500.0, 500.0, 500.0, 34.0, 291.0, 500.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 331, 223, 235, 77, 222, 140, 117, 105, 114, 139, 393, 500, 500, 500, 36, 500, 500, 500, 500, 500, 12, 500, 500, 473, 500, 500, 500, 393, 185, 144, 173, 500, 500, 500, 458, 500, 500, 500, 278, 500, 500, 500, 500, 500, 332, 137, 297, 106, 255, 500, 500, 151, 447, 232, 500, 248, 279, 360, 235, 231, 247, 254, 500, 500, 500, 500, 500, 205, 500, 477, 450, 500, 192, 500, 285, 216, 168, 152, 142, 153, 365, 430, 260, 467, 500, 500, 500, 500, 500, 34, 291, 500], "policy_default_policy_reward": [500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 331.0, 223.0, 235.0, 77.0, 222.0, 140.0, 117.0, 105.0, 114.0, 139.0, 393.0, 500.0, 500.0, 500.0, 36.0, 500.0, 500.0, 500.0, 500.0, 500.0, 12.0, 500.0, 500.0, 473.0, 500.0, 500.0, 500.0, 393.0, 185.0, 144.0, 173.0, 500.0, 500.0, 500.0, 458.0, 500.0, 500.0, 500.0, 278.0, 500.0, 500.0, 500.0, 500.0, 500.0, 332.0, 137.0, 297.0, 106.0, 255.0, 500.0, 500.0, 151.0, 447.0, 232.0, 500.0, 248.0, 279.0, 360.0, 235.0, 231.0, 247.0, 254.0, 500.0, 500.0, 500.0, 500.0, 500.0, 205.0, 500.0, 477.0, 450.0, 500.0, 192.0, 500.0, 285.0, 216.0, 168.0, 152.0, 142.0, 153.0, 365.0, 430.0, 260.0, 467.0, 500.0, 500.0, 500.0, 500.0, 500.0, 34.0, 291.0, 500.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0093332987742738, "mean_inference_ms": 2.0191938985633104, "mean_action_processing_ms": 0.23458967378385387, "mean_env_wait_ms": 0.1013425558905908, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017792940139770508, "StateBufferConnector_ms": 0.01569962501525879, "ViewRequirementAgentConnector_ms": 0.20216870307922363}, "num_episodes": 2, "episode_return_max": 500.0, "episode_return_min": 12.0, "episode_return_mean": 368.46, "episodes_this_iter": 2}, "num_healthy_workers": 0, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 99000, "num_agent_steps_trained": 3136000, "num_env_steps_sampled": 99000, "num_env_steps_trained": 3136000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 27.29908548313562, "num_env_steps_trained_throughput_per_sec": 873.5707354603398, "timesteps_total": 99000, "num_env_steps_sampled_lifetime": 99000, "num_agent_steps_sampled_lifetime": 99000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 99000, "timers": {"training_iteration_time_ms": 34655.514, "restore_workers_time_ms": 0.021, "training_step_time_ms": 36.159, "sample_time_ms": 4.174, "load_time_ms": 0.226, "load_throughput": 141564.949, "learn_time_ms": 15.901, "learn_throughput": 2012.468, "synch_weights_time_ms": 0.045}, "counters": {"num_env_steps_sampled": 99000, "num_env_steps_trained": 3136000, "num_agent_steps_sampled": 99000, "num_agent_steps_trained": 3136000, "last_target_update_ts": 98501, "num_target_updates": 196}, "done": false, "training_iteration": 99, "trial_id": "5ce16_00000", "date": "2024-09-27_11-45-18", "timestamp": 1727408718, "time_this_iter_s": 36.63295006752014, "time_total_s": 3215.8549325466156, "pid": 39427, "hostname": "gpu2gate1", "node_ip": "10.64.32.126", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.9828407522030984, "lr": 0.0007583973879008875, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f52e4d75580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3215.8549325466156, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 11.925, "ram_util_percent": 11.299999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0116431713104248, "mean_q": 52.416412353515625, "min_q": 12.600933074951172, "max_q": 60.04454040527344, "cur_lr": 0.0007583973879008875}, "td_error": [-1.1824531555175781, -0.19566726684570312, -1.8088054656982422, 0.06330490112304688, -1.4416313171386719, -0.053691864013671875, 0.20211029052734375, -0.1731414794921875, -0.06146240234375, 0.5822181701660156, 0.12534332275390625, -4.861736297607422, -0.14980316162109375, -0.5047035217285156, -0.9275045394897461, -0.06082916259765625, 0.07858657836914062, -0.013622283935546875, 0.10546875, -0.06806564331054688, 0.2906990051269531, -0.4738578796386719, 0.06194305419921875, 0.003185272216796875, -0.677978515625, -3.7373199462890625, -0.1353912353515625, 0.11043548583984375, -2.456737518310547, -0.15979385375976562, 0.11735916137695312, -0.4556388854980469], "mean_td_error": -0.5580993890762329, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 99000.0, "diff_num_grad_updates_vs_sampler_policy": 24714.15625}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 3168000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 3168000, "last_target_update_ts": 99501, "num_target_updates": 198}, "env_runners": {"episode_reward_max": 500.0, "episode_reward_min": 12.0, "episode_reward_mean": 368.46, "episode_len_mean": 368.46, "episode_media": {}, "episodes_timesteps_total": 36846, "policy_reward_min": {"default_policy": 12.0}, "policy_reward_max": {"default_policy": 500.0}, "policy_reward_mean": {"default_policy": 368.46}, "custom_metrics": {}, "hist_stats": {"episode_reward": [500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 331.0, 223.0, 235.0, 77.0, 222.0, 140.0, 117.0, 105.0, 114.0, 139.0, 393.0, 500.0, 500.0, 500.0, 36.0, 500.0, 500.0, 500.0, 500.0, 500.0, 12.0, 500.0, 500.0, 473.0, 500.0, 500.0, 500.0, 393.0, 185.0, 144.0, 173.0, 500.0, 500.0, 500.0, 458.0, 500.0, 500.0, 500.0, 278.0, 500.0, 500.0, 500.0, 500.0, 500.0, 332.0, 137.0, 297.0, 106.0, 255.0, 500.0, 500.0, 151.0, 447.0, 232.0, 500.0, 248.0, 279.0, 360.0, 235.0, 231.0, 247.0, 254.0, 500.0, 500.0, 500.0, 500.0, 500.0, 205.0, 500.0, 477.0, 450.0, 500.0, 192.0, 500.0, 285.0, 216.0, 168.0, 152.0, 142.0, 153.0, 365.0, 430.0, 260.0, 467.0, 500.0, 500.0, 500.0, 500.0, 500.0, 34.0, 291.0, 500.0, 500.0, 500.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 331, 223, 235, 77, 222, 140, 117, 105, 114, 139, 393, 500, 500, 500, 36, 500, 500, 500, 500, 500, 12, 500, 500, 473, 500, 500, 500, 393, 185, 144, 173, 500, 500, 500, 458, 500, 500, 500, 278, 500, 500, 500, 500, 500, 332, 137, 297, 106, 255, 500, 500, 151, 447, 232, 500, 248, 279, 360, 235, 231, 247, 254, 500, 500, 500, 500, 500, 205, 500, 477, 450, 500, 192, 500, 285, 216, 168, 152, 142, 153, 365, 430, 260, 467, 500, 500, 500, 500, 500, 34, 291, 500, 500, 500], "policy_default_policy_reward": [500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 331.0, 223.0, 235.0, 77.0, 222.0, 140.0, 117.0, 105.0, 114.0, 139.0, 393.0, 500.0, 500.0, 500.0, 36.0, 500.0, 500.0, 500.0, 500.0, 500.0, 12.0, 500.0, 500.0, 473.0, 500.0, 500.0, 500.0, 393.0, 185.0, 144.0, 173.0, 500.0, 500.0, 500.0, 458.0, 500.0, 500.0, 500.0, 278.0, 500.0, 500.0, 500.0, 500.0, 500.0, 332.0, 137.0, 297.0, 106.0, 255.0, 500.0, 500.0, 151.0, 447.0, 232.0, 500.0, 248.0, 279.0, 360.0, 235.0, 231.0, 247.0, 254.0, 500.0, 500.0, 500.0, 500.0, 500.0, 205.0, 500.0, 477.0, 450.0, 500.0, 192.0, 500.0, 285.0, 216.0, 168.0, 152.0, 142.0, 153.0, 365.0, 430.0, 260.0, 467.0, 500.0, 500.0, 500.0, 500.0, 500.0, 34.0, 291.0, 500.0, 500.0, 500.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0094470490374647, "mean_inference_ms": 2.0197429708682453, "mean_action_processing_ms": 0.23461179913047192, "mean_env_wait_ms": 0.10135253480593544, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0179595947265625, "StateBufferConnector_ms": 0.01571941375732422, "ViewRequirementAgentConnector_ms": 0.2028670310974121}, "num_episodes": 2, "episode_return_max": 500.0, "episode_return_min": 12.0, "episode_return_mean": 368.46, "episodes_this_iter": 2}, "num_healthy_workers": 0, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 3168000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 3168000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 27.47974775053062, "num_env_steps_trained_throughput_per_sec": 879.3519280169799, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 100000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 34794.112, "restore_workers_time_ms": 0.021, "training_step_time_ms": 35.202, "sample_time_ms": 4.088, "load_time_ms": 0.227, "load_throughput": 141237.218, "learn_time_ms": 15.778, "learn_throughput": 2028.141, "synch_weights_time_ms": 0.045}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 3168000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 3168000, "last_target_update_ts": 99501, "num_target_updates": 198}, "done": false, "training_iteration": 100, "trial_id": "5ce16_00000", "date": "2024-09-27_11-45-54", "timestamp": 1727408754, "time_this_iter_s": 36.392169713974, "time_total_s": 3252.2471022605896, "pid": 39427, "hostname": "gpu2gate1", "node_ip": "10.64.32.126", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.9828407522030984, "lr": 0.0007583973879008875, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f52e4d75580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3252.2471022605896, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 11.574999999999998, "ram_util_percent": 11.299999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.445121705532074, "mean_q": 53.01179504394531, "min_q": 2.9814133644104004, "max_q": 60.037330627441406, "cur_lr": 0.0007583973879008875}, "td_error": [0.38080596923828125, -0.020214080810546875, -0.0405731201171875, -2.8532257080078125, -0.09545135498046875, -7.079041004180908, 0.16564178466796875, 0.22249984741210938, 0.004425048828125, -0.10909271240234375, 0.29204559326171875, -0.5251998901367188, 0.012134552001953125, 0.5548667907714844, 0.2981910705566406, 0.11677932739257812, 0.27669525146484375, 0.0478057861328125, -4.269855499267578, -2.0626296997070312, 0.051937103271484375, 0.07187652587890625, 0.8077888488769531, 0.15251922607421875, 0.16478729248046875, -0.9193801879882812, 0.23608016967773438, 3.5086679458618164, 0.23981857299804688, 0.08317184448242188, 0.6462440490722656, 2.2077178955078125], "mean_td_error": -0.23225510120391846, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 100000.0, "diff_num_grad_updates_vs_sampler_policy": 27981.5}}, "num_env_steps_sampled": 101000, "num_env_steps_trained": 3200000, "num_agent_steps_sampled": 101000, "num_agent_steps_trained": 3200000, "last_target_update_ts": 100501, "num_target_updates": 200}, "env_runners": {"episode_reward_max": 500.0, "episode_reward_min": 12.0, "episode_reward_mean": 367.03, "episode_len_mean": 367.03, "episode_media": {}, "episodes_timesteps_total": 36703, "policy_reward_min": {"default_policy": 12.0}, "policy_reward_max": {"default_policy": 500.0}, "policy_reward_mean": {"default_policy": 367.03}, "custom_metrics": {}, "hist_stats": {"episode_reward": [500.0, 500.0, 500.0, 500.0, 331.0, 223.0, 235.0, 77.0, 222.0, 140.0, 117.0, 105.0, 114.0, 139.0, 393.0, 500.0, 500.0, 500.0, 36.0, 500.0, 500.0, 500.0, 500.0, 500.0, 12.0, 500.0, 500.0, 473.0, 500.0, 500.0, 500.0, 393.0, 185.0, 144.0, 173.0, 500.0, 500.0, 500.0, 458.0, 500.0, 500.0, 500.0, 278.0, 500.0, 500.0, 500.0, 500.0, 500.0, 332.0, 137.0, 297.0, 106.0, 255.0, 500.0, 500.0, 151.0, 447.0, 232.0, 500.0, 248.0, 279.0, 360.0, 235.0, 231.0, 247.0, 254.0, 500.0, 500.0, 500.0, 500.0, 500.0, 205.0, 500.0, 477.0, 450.0, 500.0, 192.0, 500.0, 285.0, 216.0, 168.0, 152.0, 142.0, 153.0, 365.0, 430.0, 260.0, 467.0, 500.0, 500.0, 500.0, 500.0, 500.0, 34.0, 291.0, 500.0, 500.0, 500.0, 489.0, 368.0], "episode_lengths": [500, 500, 500, 500, 331, 223, 235, 77, 222, 140, 117, 105, 114, 139, 393, 500, 500, 500, 36, 500, 500, 500, 500, 500, 12, 500, 500, 473, 500, 500, 500, 393, 185, 144, 173, 500, 500, 500, 458, 500, 500, 500, 278, 500, 500, 500, 500, 500, 332, 137, 297, 106, 255, 500, 500, 151, 447, 232, 500, 248, 279, 360, 235, 231, 247, 254, 500, 500, 500, 500, 500, 205, 500, 477, 450, 500, 192, 500, 285, 216, 168, 152, 142, 153, 365, 430, 260, 467, 500, 500, 500, 500, 500, 34, 291, 500, 500, 500, 489, 368], "policy_default_policy_reward": [500.0, 500.0, 500.0, 500.0, 331.0, 223.0, 235.0, 77.0, 222.0, 140.0, 117.0, 105.0, 114.0, 139.0, 393.0, 500.0, 500.0, 500.0, 36.0, 500.0, 500.0, 500.0, 500.0, 500.0, 12.0, 500.0, 500.0, 473.0, 500.0, 500.0, 500.0, 393.0, 185.0, 144.0, 173.0, 500.0, 500.0, 500.0, 458.0, 500.0, 500.0, 500.0, 278.0, 500.0, 500.0, 500.0, 500.0, 500.0, 332.0, 137.0, 297.0, 106.0, 255.0, 500.0, 500.0, 151.0, 447.0, 232.0, 500.0, 248.0, 279.0, 360.0, 235.0, 231.0, 247.0, 254.0, 500.0, 500.0, 500.0, 500.0, 500.0, 205.0, 500.0, 477.0, 450.0, 500.0, 192.0, 500.0, 285.0, 216.0, 168.0, 152.0, 142.0, 153.0, 365.0, 430.0, 260.0, 467.0, 500.0, 500.0, 500.0, 500.0, 500.0, 34.0, 291.0, 500.0, 500.0, 500.0, 489.0, 368.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0095483776971, "mean_inference_ms": 2.020268697620638, "mean_action_processing_ms": 0.23463054418175416, "mean_env_wait_ms": 0.10136167750638184, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01799941062927246, "StateBufferConnector_ms": 0.015686988830566406, "ViewRequirementAgentConnector_ms": 0.2023601531982422}, "num_episodes": 2, "episode_return_max": 500.0, "episode_return_min": 12.0, "episode_return_mean": 367.03, "episodes_this_iter": 2}, "num_healthy_workers": 0, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 101000, "num_agent_steps_trained": 3200000, "num_env_steps_sampled": 101000, "num_env_steps_trained": 3200000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 29.03801803541459, "num_env_steps_trained_throughput_per_sec": 929.2165771332669, "timesteps_total": 101000, "num_env_steps_sampled_lifetime": 101000, "num_agent_steps_sampled_lifetime": 101000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 101000, "timers": {"training_iteration_time_ms": 34572.701, "restore_workers_time_ms": 0.046, "training_step_time_ms": 36.009, "sample_time_ms": 4.09, "load_time_ms": 0.229, "load_throughput": 139722.807, "learn_time_ms": 16.04, "learn_throughput": 1995.055, "synch_weights_time_ms": 0.043}, "counters": {"num_env_steps_sampled": 101000, "num_env_steps_trained": 3200000, "num_agent_steps_sampled": 101000, "num_agent_steps_trained": 3200000, "last_target_update_ts": 100501, "num_target_updates": 200}, "done": false, "training_iteration": 101, "trial_id": "5ce16_00000", "date": "2024-09-27_11-46-29", "timestamp": 1727408789, "time_this_iter_s": 34.439475297927856, "time_total_s": 3286.6865775585175, "pid": 39427, "hostname": "gpu2gate1", "node_ip": "10.64.32.126", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.9828407522030984, "lr": 0.0007583973879008875, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f52e4d75580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3286.6865775585175, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 11.810416666666667, "ram_util_percent": 11.299999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.13587351143360138, "mean_q": 55.66358947753906, "min_q": 4.383284568786621, "max_q": 60.72257614135742, "cur_lr": 0.0007583973879008875}, "td_error": [0.4301891326904297, -0.10558319091796875, 0.33283233642578125, -0.12903594970703125, -0.0180816650390625, 0.08121109008789062, 0.19610595703125, 0.22828292846679688, -0.033878326416015625, 0.3803825378417969, 0.04106903076171875, -1.392939567565918, -0.2787742614746094, -0.19097518920898438, 0.23371505737304688, -0.15484237670898438, -0.172698974609375, -0.0281524658203125, -0.07786178588867188, 0.1343536376953125, -0.14898300170898438, -0.5858879089355469, 0.00635528564453125, -0.6364212036132812, 0.08701324462890625, 0.23165130615234375, -0.17821502685546875, -0.5555419921875, 0.39859771728515625, -0.0880584716796875, 0.1527862548828125, 0.00318145751953125], "mean_td_error": -0.05744388699531555, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 101000.0, "diff_num_grad_updates_vs_sampler_policy": 25108.375}}, "num_env_steps_sampled": 102000, "num_env_steps_trained": 3232000, "num_agent_steps_sampled": 102000, "num_agent_steps_trained": 3232000, "last_target_update_ts": 101501, "num_target_updates": 202}, "env_runners": {"episode_reward_max": 500.0, "episode_reward_min": 12.0, "episode_reward_mean": 367.03, "episode_len_mean": 367.03, "episode_media": {}, "episodes_timesteps_total": 36703, "policy_reward_min": {"default_policy": 12.0}, "policy_reward_max": {"default_policy": 500.0}, "policy_reward_mean": {"default_policy": 367.03}, "custom_metrics": {}, "hist_stats": {"episode_reward": [500.0, 500.0, 331.0, 223.0, 235.0, 77.0, 222.0, 140.0, 117.0, 105.0, 114.0, 139.0, 393.0, 500.0, 500.0, 500.0, 36.0, 500.0, 500.0, 500.0, 500.0, 500.0, 12.0, 500.0, 500.0, 473.0, 500.0, 500.0, 500.0, 393.0, 185.0, 144.0, 173.0, 500.0, 500.0, 500.0, 458.0, 500.0, 500.0, 500.0, 278.0, 500.0, 500.0, 500.0, 500.0, 500.0, 332.0, 137.0, 297.0, 106.0, 255.0, 500.0, 500.0, 151.0, 447.0, 232.0, 500.0, 248.0, 279.0, 360.0, 235.0, 231.0, 247.0, 254.0, 500.0, 500.0, 500.0, 500.0, 500.0, 205.0, 500.0, 477.0, 450.0, 500.0, 192.0, 500.0, 285.0, 216.0, 168.0, 152.0, 142.0, 153.0, 365.0, 430.0, 260.0, 467.0, 500.0, 500.0, 500.0, 500.0, 500.0, 34.0, 291.0, 500.0, 500.0, 500.0, 489.0, 368.0, 500.0, 500.0], "episode_lengths": [500, 500, 331, 223, 235, 77, 222, 140, 117, 105, 114, 139, 393, 500, 500, 500, 36, 500, 500, 500, 500, 500, 12, 500, 500, 473, 500, 500, 500, 393, 185, 144, 173, 500, 500, 500, 458, 500, 500, 500, 278, 500, 500, 500, 500, 500, 332, 137, 297, 106, 255, 500, 500, 151, 447, 232, 500, 248, 279, 360, 235, 231, 247, 254, 500, 500, 500, 500, 500, 205, 500, 477, 450, 500, 192, 500, 285, 216, 168, 152, 142, 153, 365, 430, 260, 467, 500, 500, 500, 500, 500, 34, 291, 500, 500, 500, 489, 368, 500, 500], "policy_default_policy_reward": [500.0, 500.0, 331.0, 223.0, 235.0, 77.0, 222.0, 140.0, 117.0, 105.0, 114.0, 139.0, 393.0, 500.0, 500.0, 500.0, 36.0, 500.0, 500.0, 500.0, 500.0, 500.0, 12.0, 500.0, 500.0, 473.0, 500.0, 500.0, 500.0, 393.0, 185.0, 144.0, 173.0, 500.0, 500.0, 500.0, 458.0, 500.0, 500.0, 500.0, 278.0, 500.0, 500.0, 500.0, 500.0, 500.0, 332.0, 137.0, 297.0, 106.0, 255.0, 500.0, 500.0, 151.0, 447.0, 232.0, 500.0, 248.0, 279.0, 360.0, 235.0, 231.0, 247.0, 254.0, 500.0, 500.0, 500.0, 500.0, 500.0, 205.0, 500.0, 477.0, 450.0, 500.0, 192.0, 500.0, 285.0, 216.0, 168.0, 152.0, 142.0, 153.0, 365.0, 430.0, 260.0, 467.0, 500.0, 500.0, 500.0, 500.0, 500.0, 34.0, 291.0, 500.0, 500.0, 500.0, 489.0, 368.0, 500.0, 500.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0096751071006342, "mean_inference_ms": 2.020839027361283, "mean_action_processing_ms": 0.23465327631356517, "mean_env_wait_ms": 0.10137455389526227, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0180361270904541, "StateBufferConnector_ms": 0.01571345329284668, "ViewRequirementAgentConnector_ms": 0.20243239402770996}, "num_episodes": 2, "episode_return_max": 500.0, "episode_return_min": 12.0, "episode_return_mean": 367.03, "episodes_this_iter": 2}, "num_healthy_workers": 0, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 102000, "num_agent_steps_trained": 3232000, "num_env_steps_sampled": 102000, "num_env_steps_trained": 3232000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 26.99143100266928, "num_env_steps_trained_throughput_per_sec": 863.725792085417, "timesteps_total": 102000, "num_env_steps_sampled_lifetime": 102000, "num_agent_steps_sampled_lifetime": 102000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 102000, "timers": {"training_iteration_time_ms": 34781.101, "restore_workers_time_ms": 0.022, "training_step_time_ms": 35.705, "sample_time_ms": 4.292, "load_time_ms": 0.22, "load_throughput": 145477.702, "learn_time_ms": 15.474, "learn_throughput": 2068.032, "synch_weights_time_ms": 0.059}, "counters": {"num_env_steps_sampled": 102000, "num_env_steps_trained": 3232000, "num_agent_steps_sampled": 102000, "num_agent_steps_trained": 3232000, "last_target_update_ts": 101501, "num_target_updates": 202}, "done": false, "training_iteration": 102, "trial_id": "5ce16_00000", "date": "2024-09-27_11-47-06", "timestamp": 1727408826, "time_this_iter_s": 37.05151295661926, "time_total_s": 3323.7380905151367, "pid": 39427, "hostname": "gpu2gate1", "node_ip": "10.64.32.126", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.9828407522030984, "lr": 0.0007583973879008875, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f52e4d75580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3323.7380905151367, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 11.696226415094344, "ram_util_percent": 11.299999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4730100631713867, "mean_q": 56.066410064697266, "min_q": 28.34236717224121, "max_q": 60.52152633666992, "cur_lr": 0.0007583973879008875}, "td_error": [0.20611953735351562, 0.14324569702148438, -0.6275043487548828, 0.13931655883789062, 0.11333465576171875, 0.006175994873046875, -0.15848159790039062, 0.1729278564453125, 0.0318145751953125, -0.42041015625, -0.009857177734375, 0.052524566650390625, -0.3438224792480469, -0.13853836059570312, -0.10382843017578125, -1.5570526123046875, 27.446863174438477, -0.2775840759277344, -0.07007217407226562, 0.10706710815429688, 0.08524703979492188, -5.675676345825195, 0.02358245849609375, 0.3520927429199219, -0.055683135986328125, 0.17929458618164062, -0.022548675537109375, 0.046733856201171875, -0.061065673828125, 0.12702178955078125, 0.2625999450683594, -0.058872222900390625], "mean_td_error": 0.6223426461219788, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 102000.0, "diff_num_grad_updates_vs_sampler_policy": 22046.34375}}, "num_env_steps_sampled": 103000, "num_env_steps_trained": 3264000, "num_agent_steps_sampled": 103000, "num_agent_steps_trained": 3264000, "last_target_update_ts": 102501, "num_target_updates": 204}, "env_runners": {"episode_reward_max": 500.0, "episode_reward_min": 12.0, "episode_reward_mean": 367.03, "episode_len_mean": 367.03, "episode_media": {}, "episodes_timesteps_total": 36703, "policy_reward_min": {"default_policy": 12.0}, "policy_reward_max": {"default_policy": 500.0}, "policy_reward_mean": {"default_policy": 367.03}, "custom_metrics": {}, "hist_stats": {"episode_reward": [331.0, 223.0, 235.0, 77.0, 222.0, 140.0, 117.0, 105.0, 114.0, 139.0, 393.0, 500.0, 500.0, 500.0, 36.0, 500.0, 500.0, 500.0, 500.0, 500.0, 12.0, 500.0, 500.0, 473.0, 500.0, 500.0, 500.0, 393.0, 185.0, 144.0, 173.0, 500.0, 500.0, 500.0, 458.0, 500.0, 500.0, 500.0, 278.0, 500.0, 500.0, 500.0, 500.0, 500.0, 332.0, 137.0, 297.0, 106.0, 255.0, 500.0, 500.0, 151.0, 447.0, 232.0, 500.0, 248.0, 279.0, 360.0, 235.0, 231.0, 247.0, 254.0, 500.0, 500.0, 500.0, 500.0, 500.0, 205.0, 500.0, 477.0, 450.0, 500.0, 192.0, 500.0, 285.0, 216.0, 168.0, 152.0, 142.0, 153.0, 365.0, 430.0, 260.0, 467.0, 500.0, 500.0, 500.0, 500.0, 500.0, 34.0, 291.0, 500.0, 500.0, 500.0, 489.0, 368.0, 500.0, 500.0, 500.0, 500.0], "episode_lengths": [331, 223, 235, 77, 222, 140, 117, 105, 114, 139, 393, 500, 500, 500, 36, 500, 500, 500, 500, 500, 12, 500, 500, 473, 500, 500, 500, 393, 185, 144, 173, 500, 500, 500, 458, 500, 500, 500, 278, 500, 500, 500, 500, 500, 332, 137, 297, 106, 255, 500, 500, 151, 447, 232, 500, 248, 279, 360, 235, 231, 247, 254, 500, 500, 500, 500, 500, 205, 500, 477, 450, 500, 192, 500, 285, 216, 168, 152, 142, 153, 365, 430, 260, 467, 500, 500, 500, 500, 500, 34, 291, 500, 500, 500, 489, 368, 500, 500, 500, 500], "policy_default_policy_reward": [331.0, 223.0, 235.0, 77.0, 222.0, 140.0, 117.0, 105.0, 114.0, 139.0, 393.0, 500.0, 500.0, 500.0, 36.0, 500.0, 500.0, 500.0, 500.0, 500.0, 12.0, 500.0, 500.0, 473.0, 500.0, 500.0, 500.0, 393.0, 185.0, 144.0, 173.0, 500.0, 500.0, 500.0, 458.0, 500.0, 500.0, 500.0, 278.0, 500.0, 500.0, 500.0, 500.0, 500.0, 332.0, 137.0, 297.0, 106.0, 255.0, 500.0, 500.0, 151.0, 447.0, 232.0, 500.0, 248.0, 279.0, 360.0, 235.0, 231.0, 247.0, 254.0, 500.0, 500.0, 500.0, 500.0, 500.0, 205.0, 500.0, 477.0, 450.0, 500.0, 192.0, 500.0, 285.0, 216.0, 168.0, 152.0, 142.0, 153.0, 365.0, 430.0, 260.0, 467.0, 500.0, 500.0, 500.0, 500.0, 500.0, 34.0, 291.0, 500.0, 500.0, 500.0, 489.0, 368.0, 500.0, 500.0, 500.0, 500.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0098275905248224, "mean_inference_ms": 2.0214409055122395, "mean_action_processing_ms": 0.23468012721656373, "mean_env_wait_ms": 0.10138986283949723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018004894256591797, "StateBufferConnector_ms": 0.015691041946411133, "ViewRequirementAgentConnector_ms": 0.20231103897094727}, "num_episodes": 2, "episode_return_max": 500.0, "episode_return_min": 12.0, "episode_return_mean": 367.03, "episodes_this_iter": 2}, "num_healthy_workers": 0, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 103000, "num_agent_steps_trained": 3264000, "num_env_steps_sampled": 103000, "num_env_steps_trained": 3264000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 27.366774865685787, "num_env_steps_trained_throughput_per_sec": 875.7367957019452, "timesteps_total": 103000, "num_env_steps_sampled_lifetime": 103000, "num_agent_steps_sampled_lifetime": 103000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 103000, "timers": {"training_iteration_time_ms": 34811.444, "restore_workers_time_ms": 0.021, "training_step_time_ms": 34.459, "sample_time_ms": 4.013, "load_time_ms": 0.239, "load_throughput": 133923.097, "learn_time_ms": 14.909, "learn_throughput": 2146.381, "synch_weights_time_ms": 0.05}, "counters": {"num_env_steps_sampled": 103000, "num_env_steps_trained": 3264000, "num_agent_steps_sampled": 103000, "num_agent_steps_trained": 3264000, "last_target_update_ts": 102501, "num_target_updates": 204}, "done": false, "training_iteration": 103, "trial_id": "5ce16_00000", "date": "2024-09-27_11-47-43", "timestamp": 1727408863, "time_this_iter_s": 36.542948484420776, "time_total_s": 3360.2810389995575, "pid": 39427, "hostname": "gpu2gate1", "node_ip": "10.64.32.126", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.9828407522030984, "lr": 0.0007583973879008875, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f52e4d75580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3360.2810389995575, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 11.582352941176472, "ram_util_percent": 11.299999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.22803540527820587, "mean_q": 58.30516052246094, "min_q": 46.88436508178711, "max_q": 60.382511138916016, "cur_lr": 0.0007583973879008875}, "td_error": [-0.05019378662109375, -0.0813140869140625, -0.13769149780273438, -0.17805099487304688, 0.3320732116699219, -0.4267845153808594, 0.0293731689453125, -0.12688446044921875, 0.0960693359375, -0.14418411254882812, -0.08880615234375, -0.19457244873046875, -0.08437728881835938, 0.018238067626953125, -0.5095024108886719, 0.0451812744140625, -0.11259841918945312, 0.33547210693359375, 0.046478271484375, -0.14429855346679688, -0.09643936157226562, -0.08154678344726562, -2.3398704528808594, -0.010448455810546875, -0.18426513671875, -0.10129928588867188, -0.043895721435546875, 0.00591278076171875, 0.6987724304199219, -0.1739349365234375, 0.3189239501953125, -0.08401107788085938], "mean_td_error": -0.10838985443115234, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 103000.0, "diff_num_grad_updates_vs_sampler_policy": 23928.34375}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 3296000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 3296000, "last_target_update_ts": 103501, "num_target_updates": 206}, "env_runners": {"episode_reward_max": 500.0, "episode_reward_min": 12.0, "episode_reward_mean": 371.49, "episode_len_mean": 371.49, "episode_media": {}, "episodes_timesteps_total": 37149, "policy_reward_min": {"default_policy": 12.0}, "policy_reward_max": {"default_policy": 500.0}, "policy_reward_mean": {"default_policy": 371.49}, "custom_metrics": {}, "hist_stats": {"episode_reward": [235.0, 77.0, 222.0, 140.0, 117.0, 105.0, 114.0, 139.0, 393.0, 500.0, 500.0, 500.0, 36.0, 500.0, 500.0, 500.0, 500.0, 500.0, 12.0, 500.0, 500.0, 473.0, 500.0, 500.0, 500.0, 393.0, 185.0, 144.0, 173.0, 500.0, 500.0, 500.0, 458.0, 500.0, 500.0, 500.0, 278.0, 500.0, 500.0, 500.0, 500.0, 500.0, 332.0, 137.0, 297.0, 106.0, 255.0, 500.0, 500.0, 151.0, 447.0, 232.0, 500.0, 248.0, 279.0, 360.0, 235.0, 231.0, 247.0, 254.0, 500.0, 500.0, 500.0, 500.0, 500.0, 205.0, 500.0, 477.0, 450.0, 500.0, 192.0, 500.0, 285.0, 216.0, 168.0, 152.0, 142.0, 153.0, 365.0, 430.0, 260.0, 467.0, 500.0, 500.0, 500.0, 500.0, 500.0, 34.0, 291.0, 500.0, 500.0, 500.0, 489.0, 368.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0], "episode_lengths": [235, 77, 222, 140, 117, 105, 114, 139, 393, 500, 500, 500, 36, 500, 500, 500, 500, 500, 12, 500, 500, 473, 500, 500, 500, 393, 185, 144, 173, 500, 500, 500, 458, 500, 500, 500, 278, 500, 500, 500, 500, 500, 332, 137, 297, 106, 255, 500, 500, 151, 447, 232, 500, 248, 279, 360, 235, 231, 247, 254, 500, 500, 500, 500, 500, 205, 500, 477, 450, 500, 192, 500, 285, 216, 168, 152, 142, 153, 365, 430, 260, 467, 500, 500, 500, 500, 500, 34, 291, 500, 500, 500, 489, 368, 500, 500, 500, 500, 500, 500], "policy_default_policy_reward": [235.0, 77.0, 222.0, 140.0, 117.0, 105.0, 114.0, 139.0, 393.0, 500.0, 500.0, 500.0, 36.0, 500.0, 500.0, 500.0, 500.0, 500.0, 12.0, 500.0, 500.0, 473.0, 500.0, 500.0, 500.0, 393.0, 185.0, 144.0, 173.0, 500.0, 500.0, 500.0, 458.0, 500.0, 500.0, 500.0, 278.0, 500.0, 500.0, 500.0, 500.0, 500.0, 332.0, 137.0, 297.0, 106.0, 255.0, 500.0, 500.0, 151.0, 447.0, 232.0, 500.0, 248.0, 279.0, 360.0, 235.0, 231.0, 247.0, 254.0, 500.0, 500.0, 500.0, 500.0, 500.0, 205.0, 500.0, 477.0, 450.0, 500.0, 192.0, 500.0, 285.0, 216.0, 168.0, 152.0, 142.0, 153.0, 365.0, 430.0, 260.0, 467.0, 500.0, 500.0, 500.0, 500.0, 500.0, 34.0, 291.0, 500.0, 500.0, 500.0, 489.0, 368.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0099981114782444, "mean_inference_ms": 2.0220664433666564, "mean_action_processing_ms": 0.2347071625340749, "mean_env_wait_ms": 0.10140822264928578, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01798081398010254, "StateBufferConnector_ms": 0.015734195709228516, "ViewRequirementAgentConnector_ms": 0.2027273178100586}, "num_episodes": 2, "episode_return_max": 500.0, "episode_return_min": 12.0, "episode_return_mean": 371.49, "episodes_this_iter": 2}, "num_healthy_workers": 0, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 3296000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 3296000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 28.893314038535816, "num_env_steps_trained_throughput_per_sec": 924.5860492331461, "timesteps_total": 104000, "num_env_steps_sampled_lifetime": 104000, "num_agent_steps_sampled_lifetime": 104000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 104000, "timers": {"training_iteration_time_ms": 35051.545, "restore_workers_time_ms": 0.021, "training_step_time_ms": 33.705, "sample_time_ms": 3.849, "load_time_ms": 0.233, "load_throughput": 137321.187, "learn_time_ms": 14.713, "learn_throughput": 2174.958, "synch_weights_time_ms": 0.048}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 3296000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 3296000, "last_target_update_ts": 103501, "num_target_updates": 206}, "done": false, "training_iteration": 104, "trial_id": "5ce16_00000", "date": "2024-09-27_11-48-17", "timestamp": 1727408897, "time_this_iter_s": 34.612077474594116, "time_total_s": 3394.8931164741516, "pid": 39427, "hostname": "gpu2gate1", "node_ip": "10.64.32.126", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.9828407522030984, "lr": 0.0007583973879008875, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f52e4d75580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3394.8931164741516, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 11.736734693877551, "ram_util_percent": 11.299999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.27823251485824585, "mean_q": 56.07179260253906, "min_q": 6.621916770935059, "max_q": 61.63526916503906, "cur_lr": 0.0007583973879008875}, "td_error": [4.196647644042969, -0.022045135498046875, 0.9217567443847656, 0.3010444641113281, 0.09064483642578125, -0.3598480224609375, 0.2518768310546875, 0.18207550048828125, 0.13839340209960938, -0.34381103515625, 0.18682098388671875, 18.391977310180664, 0.03920745849609375, 0.24074935913085938, 0.08322525024414062, -0.3976707458496094, 0.2754249572753906, 0.5289649963378906, 1.9004974365234375, 0.2859306335449219, -0.5493011474609375, 0.22031021118164062, -0.3903388977050781, -0.008037567138671875, -0.0365753173828125, 0.03621673583984375, -0.4200935363769531, 0.09637069702148438, -0.18811798095703125, -0.2941627502441406, -0.11312484741210938, 0.14065170288085938], "mean_td_error": 0.7933018803596497, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 104000.0, "diff_num_grad_updates_vs_sampler_policy": 21036.5}}, "num_env_steps_sampled": 105000, "num_env_steps_trained": 3328000, "num_agent_steps_sampled": 105000, "num_agent_steps_trained": 3328000, "last_target_update_ts": 104501, "num_target_updates": 208}, "env_runners": {"episode_reward_max": 500.0, "episode_reward_min": 12.0, "episode_reward_mean": 376.32, "episode_len_mean": 376.32, "episode_media": {}, "episodes_timesteps_total": 37632, "policy_reward_min": {"default_policy": 12.0}, "policy_reward_max": {"default_policy": 500.0}, "policy_reward_mean": {"default_policy": 376.32}, "custom_metrics": {}, "hist_stats": {"episode_reward": [105.0, 114.0, 139.0, 393.0, 500.0, 500.0, 500.0, 36.0, 500.0, 500.0, 500.0, 500.0, 500.0, 12.0, 500.0, 500.0, 473.0, 500.0, 500.0, 500.0, 393.0, 185.0, 144.0, 173.0, 500.0, 500.0, 500.0, 458.0, 500.0, 500.0, 500.0, 278.0, 500.0, 500.0, 500.0, 500.0, 500.0, 332.0, 137.0, 297.0, 106.0, 255.0, 500.0, 500.0, 151.0, 447.0, 232.0, 500.0, 248.0, 279.0, 360.0, 235.0, 231.0, 247.0, 254.0, 500.0, 500.0, 500.0, 500.0, 500.0, 205.0, 500.0, 477.0, 450.0, 500.0, 192.0, 500.0, 285.0, 216.0, 168.0, 152.0, 142.0, 153.0, 365.0, 430.0, 260.0, 467.0, 500.0, 500.0, 500.0, 500.0, 500.0, 34.0, 291.0, 500.0, 500.0, 500.0, 489.0, 368.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 140.0, 35.0, 465.0, 134.0], "episode_lengths": [105, 114, 139, 393, 500, 500, 500, 36, 500, 500, 500, 500, 500, 12, 500, 500, 473, 500, 500, 500, 393, 185, 144, 173, 500, 500, 500, 458, 500, 500, 500, 278, 500, 500, 500, 500, 500, 332, 137, 297, 106, 255, 500, 500, 151, 447, 232, 500, 248, 279, 360, 235, 231, 247, 254, 500, 500, 500, 500, 500, 205, 500, 477, 450, 500, 192, 500, 285, 216, 168, 152, 142, 153, 365, 430, 260, 467, 500, 500, 500, 500, 500, 34, 291, 500, 500, 500, 489, 368, 500, 500, 500, 500, 500, 500, 500, 140, 35, 465, 134], "policy_default_policy_reward": [105.0, 114.0, 139.0, 393.0, 500.0, 500.0, 500.0, 36.0, 500.0, 500.0, 500.0, 500.0, 500.0, 12.0, 500.0, 500.0, 473.0, 500.0, 500.0, 500.0, 393.0, 185.0, 144.0, 173.0, 500.0, 500.0, 500.0, 458.0, 500.0, 500.0, 500.0, 278.0, 500.0, 500.0, 500.0, 500.0, 500.0, 332.0, 137.0, 297.0, 106.0, 255.0, 500.0, 500.0, 151.0, 447.0, 232.0, 500.0, 248.0, 279.0, 360.0, 235.0, 231.0, 247.0, 254.0, 500.0, 500.0, 500.0, 500.0, 500.0, 205.0, 500.0, 477.0, 450.0, 500.0, 192.0, 500.0, 285.0, 216.0, 168.0, 152.0, 142.0, 153.0, 365.0, 430.0, 260.0, 467.0, 500.0, 500.0, 500.0, 500.0, 500.0, 34.0, 291.0, 500.0, 500.0, 500.0, 489.0, 368.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 140.0, 35.0, 465.0, 134.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0104452874536987, "mean_inference_ms": 2.0236389734751956, "mean_action_processing_ms": 0.23477794277580424, "mean_env_wait_ms": 0.1014573092727834, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017963886260986328, "StateBufferConnector_ms": 0.015790224075317383, "ViewRequirementAgentConnector_ms": 0.20355224609375}, "num_episodes": 5, "episode_return_max": 500.0, "episode_return_min": 12.0, "episode_return_mean": 376.32, "episodes_this_iter": 5}, "num_healthy_workers": 0, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 105000, "num_agent_steps_trained": 3328000, "num_env_steps_sampled": 105000, "num_env_steps_trained": 3328000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 29.039860246004903, "num_env_steps_trained_throughput_per_sec": 929.2755278721569, "timesteps_total": 105000, "num_env_steps_sampled_lifetime": 105000, "num_agent_steps_sampled_lifetime": 105000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 105000, "timers": {"training_iteration_time_ms": 35137.153, "restore_workers_time_ms": 0.021, "training_step_time_ms": 34.636, "sample_time_ms": 3.946, "load_time_ms": 0.236, "load_throughput": 135491.347, "learn_time_ms": 15.155, "learn_throughput": 2111.567, "synch_weights_time_ms": 0.048}, "counters": {"num_env_steps_sampled": 105000, "num_env_steps_trained": 3328000, "num_agent_steps_sampled": 105000, "num_agent_steps_trained": 3328000, "last_target_update_ts": 104501, "num_target_updates": 208}, "done": false, "training_iteration": 105, "trial_id": "5ce16_00000", "date": "2024-09-27_11-48-52", "timestamp": 1727408932, "time_this_iter_s": 34.437294483184814, "time_total_s": 3429.3304109573364, "pid": 39427, "hostname": "gpu2gate1", "node_ip": "10.64.32.126", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.9828407522030984, "lr": 0.0007583973879008875, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f52e4d75580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3429.3304109573364, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 11.604081632653061, "ram_util_percent": 11.299999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.49065572023391724, "mean_q": 56.87406921386719, "min_q": 11.495837211608887, "max_q": 61.18649673461914, "cur_lr": 0.0007583973879008875}, "td_error": [0.07546615600585938, 0.20333099365234375, -0.2569427490234375, 0.037868499755859375, 0.15057373046875, 0.14629364013671875, 0.10855865478515625, 0.2777214050292969, 0.10882949829101562, -0.3600654602050781, 0.009639739990234375, -0.23661041259765625, 0.0337982177734375, 0.1466217041015625, 2.273531913757324, 0.15459823608398438, 0.23651885986328125, 0.2718009948730469, 0.026103973388671875, 0.30669403076171875, 0.5265159606933594, 0.15644454956054688, 0.5418128967285156, 0.16328811645507812, 0.0660247802734375, 0.12944793701171875, -0.003936767578125, 0.08631134033203125, 0.058551788330078125, 0.12115859985351562, 0.04998779296875, 0.15455245971679688], "mean_td_error": 0.18014034628868103, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 105000.0, "diff_num_grad_updates_vs_sampler_policy": 20919.46875}}, "num_env_steps_sampled": 106000, "num_env_steps_trained": 3360000, "num_agent_steps_sampled": 106000, "num_agent_steps_trained": 3360000, "last_target_update_ts": 105501, "num_target_updates": 210}, "env_runners": {"episode_reward_max": 500.0, "episode_reward_min": 12.0, "episode_reward_mean": 358.75, "episode_len_mean": 358.75, "episode_media": {}, "episodes_timesteps_total": 35875, "policy_reward_min": {"default_policy": 12.0}, "policy_reward_max": {"default_policy": 500.0}, "policy_reward_mean": {"default_policy": 358.75}, "custom_metrics": {}, "hist_stats": {"episode_reward": [500.0, 500.0, 500.0, 500.0, 12.0, 500.0, 500.0, 473.0, 500.0, 500.0, 500.0, 393.0, 185.0, 144.0, 173.0, 500.0, 500.0, 500.0, 458.0, 500.0, 500.0, 500.0, 278.0, 500.0, 500.0, 500.0, 500.0, 500.0, 332.0, 137.0, 297.0, 106.0, 255.0, 500.0, 500.0, 151.0, 447.0, 232.0, 500.0, 248.0, 279.0, 360.0, 235.0, 231.0, 247.0, 254.0, 500.0, 500.0, 500.0, 500.0, 500.0, 205.0, 500.0, 477.0, 450.0, 500.0, 192.0, 500.0, 285.0, 216.0, 168.0, 152.0, 142.0, 153.0, 365.0, 430.0, 260.0, 467.0, 500.0, 500.0, 500.0, 500.0, 500.0, 34.0, 291.0, 500.0, 500.0, 500.0, 489.0, 368.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 140.0, 35.0, 465.0, 134.0, 157.0, 134.0, 141.0, 205.0, 31.0, 108.0, 109.0, 106.0, 39.0], "episode_lengths": [500, 500, 500, 500, 12, 500, 500, 473, 500, 500, 500, 393, 185, 144, 173, 500, 500, 500, 458, 500, 500, 500, 278, 500, 500, 500, 500, 500, 332, 137, 297, 106, 255, 500, 500, 151, 447, 232, 500, 248, 279, 360, 235, 231, 247, 254, 500, 500, 500, 500, 500, 205, 500, 477, 450, 500, 192, 500, 285, 216, 168, 152, 142, 153, 365, 430, 260, 467, 500, 500, 500, 500, 500, 34, 291, 500, 500, 500, 489, 368, 500, 500, 500, 500, 500, 500, 500, 140, 35, 465, 134, 157, 134, 141, 205, 31, 108, 109, 106, 39], "policy_default_policy_reward": [500.0, 500.0, 500.0, 500.0, 12.0, 500.0, 500.0, 473.0, 500.0, 500.0, 500.0, 393.0, 185.0, 144.0, 173.0, 500.0, 500.0, 500.0, 458.0, 500.0, 500.0, 500.0, 278.0, 500.0, 500.0, 500.0, 500.0, 500.0, 332.0, 137.0, 297.0, 106.0, 255.0, 500.0, 500.0, 151.0, 447.0, 232.0, 500.0, 248.0, 279.0, 360.0, 235.0, 231.0, 247.0, 254.0, 500.0, 500.0, 500.0, 500.0, 500.0, 205.0, 500.0, 477.0, 450.0, 500.0, 192.0, 500.0, 285.0, 216.0, 168.0, 152.0, 142.0, 153.0, 365.0, 430.0, 260.0, 467.0, 500.0, 500.0, 500.0, 500.0, 500.0, 34.0, 291.0, 500.0, 500.0, 500.0, 489.0, 368.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 140.0, 35.0, 465.0, 134.0, 157.0, 134.0, 141.0, 205.0, 31.0, 108.0, 109.0, 106.0, 39.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0112804462276517, "mean_inference_ms": 2.026514351120006, "mean_action_processing_ms": 0.23491385495058575, "mean_env_wait_ms": 0.10155138308440259, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018136978149414062, "StateBufferConnector_ms": 0.015961170196533203, "ViewRequirementAgentConnector_ms": 0.20438456535339355}, "num_episodes": 9, "episode_return_max": 500.0, "episode_return_min": 12.0, "episode_return_mean": 358.75, "episodes_this_iter": 9}, "num_healthy_workers": 0, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 106000, "num_agent_steps_trained": 3360000, "num_env_steps_sampled": 106000, "num_env_steps_trained": 3360000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 27.98964797087024, "num_env_steps_trained_throughput_per_sec": 895.6687350678477, "timesteps_total": 106000, "num_env_steps_sampled_lifetime": 106000, "num_agent_steps_sampled_lifetime": 106000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 106000, "timers": {"training_iteration_time_ms": 35407.554, "restore_workers_time_ms": 0.023, "training_step_time_ms": 37.627, "sample_time_ms": 4.4, "load_time_ms": 0.244, "load_throughput": 131225.78, "learn_time_ms": 16.583, "learn_throughput": 1929.719, "synch_weights_time_ms": 0.056}, "counters": {"num_env_steps_sampled": 106000, "num_env_steps_trained": 3360000, "num_agent_steps_sampled": 106000, "num_agent_steps_trained": 3360000, "last_target_update_ts": 105501, "num_target_updates": 210}, "done": false, "training_iteration": 106, "trial_id": "5ce16_00000", "date": "2024-09-27_11-49-28", "timestamp": 1727408968, "time_this_iter_s": 35.72966504096985, "time_total_s": 3465.0600759983063, "pid": 39427, "hostname": "gpu2gate1", "node_ip": "10.64.32.126", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.9828407522030984, "lr": 0.0007583973879008875, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f52e4d75580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3465.0600759983063, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 11.909803921568631, "ram_util_percent": 11.299999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.176283597946167, "mean_q": 51.68129348754883, "min_q": -19.24250602722168, "max_q": 61.1256217956543, "cur_lr": 0.0007583973879008875}, "td_error": [0.09689712524414062, 0.18925094604492188, 0.7011375427246094, 0.6142578125, -0.031005859375, 0.4372367858886719, 0.2974739074707031, 0.06881427764892578, 0.18451690673828125, 0.47576904296875, 1.4007682800292969, 0.22298431396484375, 0.42395782470703125, 0.21734619140625, 0.3760948181152344, 0.26760101318359375, 0.20604324340820312, 0.10433197021484375, 0.18841171264648438, 0.17853927612304688, 0.12602615356445312, 0.16060256958007812, 0.24106979370117188, 0.25292205810546875, 0.2394256591796875, 0.46437835693359375, 0.1531219482421875, 0.7110910415649414, 1.5773687362670898, -7.277068138122559, 0.3697853088378906, 0.4720001220703125], "mean_td_error": 0.1284734606742859, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 106000.0, "diff_num_grad_updates_vs_sampler_policy": 26209.59375}}, "num_env_steps_sampled": 107000, "num_env_steps_trained": 3392000, "num_agent_steps_sampled": 107000, "num_agent_steps_trained": 3392000, "last_target_update_ts": 106501, "num_target_updates": 212}, "env_runners": {"episode_reward_max": 500.0, "episode_reward_min": 31.0, "episode_reward_mean": 338.27, "episode_len_mean": 338.27, "episode_media": {}, "episodes_timesteps_total": 33827, "policy_reward_min": {"default_policy": 31.0}, "policy_reward_max": {"default_policy": 500.0}, "policy_reward_mean": {"default_policy": 338.27}, "custom_metrics": {}, "hist_stats": {"episode_reward": [473.0, 500.0, 500.0, 500.0, 393.0, 185.0, 144.0, 173.0, 500.0, 500.0, 500.0, 458.0, 500.0, 500.0, 500.0, 278.0, 500.0, 500.0, 500.0, 500.0, 500.0, 332.0, 137.0, 297.0, 106.0, 255.0, 500.0, 500.0, 151.0, 447.0, 232.0, 500.0, 248.0, 279.0, 360.0, 235.0, 231.0, 247.0, 254.0, 500.0, 500.0, 500.0, 500.0, 500.0, 205.0, 500.0, 477.0, 450.0, 500.0, 192.0, 500.0, 285.0, 216.0, 168.0, 152.0, 142.0, 153.0, 365.0, 430.0, 260.0, 467.0, 500.0, 500.0, 500.0, 500.0, 500.0, 34.0, 291.0, 500.0, 500.0, 500.0, 489.0, 368.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 140.0, 35.0, 465.0, 134.0, 157.0, 134.0, 141.0, 205.0, 31.0, 108.0, 109.0, 106.0, 39.0, 143.0, 172.0, 31.0, 152.0, 153.0, 161.0, 152.0], "episode_lengths": [473, 500, 500, 500, 393, 185, 144, 173, 500, 500, 500, 458, 500, 500, 500, 278, 500, 500, 500, 500, 500, 332, 137, 297, 106, 255, 500, 500, 151, 447, 232, 500, 248, 279, 360, 235, 231, 247, 254, 500, 500, 500, 500, 500, 205, 500, 477, 450, 500, 192, 500, 285, 216, 168, 152, 142, 153, 365, 430, 260, 467, 500, 500, 500, 500, 500, 34, 291, 500, 500, 500, 489, 368, 500, 500, 500, 500, 500, 500, 500, 140, 35, 465, 134, 157, 134, 141, 205, 31, 108, 109, 106, 39, 143, 172, 31, 152, 153, 161, 152], "policy_default_policy_reward": [473.0, 500.0, 500.0, 500.0, 393.0, 185.0, 144.0, 173.0, 500.0, 500.0, 500.0, 458.0, 500.0, 500.0, 500.0, 278.0, 500.0, 500.0, 500.0, 500.0, 500.0, 332.0, 137.0, 297.0, 106.0, 255.0, 500.0, 500.0, 151.0, 447.0, 232.0, 500.0, 248.0, 279.0, 360.0, 235.0, 231.0, 247.0, 254.0, 500.0, 500.0, 500.0, 500.0, 500.0, 205.0, 500.0, 477.0, 450.0, 500.0, 192.0, 500.0, 285.0, 216.0, 168.0, 152.0, 142.0, 153.0, 365.0, 430.0, 260.0, 467.0, 500.0, 500.0, 500.0, 500.0, 500.0, 34.0, 291.0, 500.0, 500.0, 500.0, 489.0, 368.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 140.0, 35.0, 465.0, 134.0, 157.0, 134.0, 141.0, 205.0, 31.0, 108.0, 109.0, 106.0, 39.0, 143.0, 172.0, 31.0, 152.0, 153.0, 161.0, 152.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0119900515974818, "mean_inference_ms": 2.0287272718246236, "mean_action_processing_ms": 0.235035534881625, "mean_env_wait_ms": 0.10163727082381019, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01807689666748047, "StateBufferConnector_ms": 0.015944957733154297, "ViewRequirementAgentConnector_ms": 0.20356464385986328}, "num_episodes": 7, "episode_return_max": 500.0, "episode_return_min": 31.0, "episode_return_mean": 338.27, "episodes_this_iter": 7}, "num_healthy_workers": 0, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 107000, "num_agent_steps_trained": 3392000, "num_env_steps_sampled": 107000, "num_env_steps_trained": 3392000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 29.89931532964229, "num_env_steps_trained_throughput_per_sec": 956.7780905485533, "timesteps_total": 107000, "num_env_steps_sampled_lifetime": 107000, "num_agent_steps_sampled_lifetime": 107000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 107000, "timers": {"training_iteration_time_ms": 35377.541, "restore_workers_time_ms": 0.018, "training_step_time_ms": 28.915, "sample_time_ms": 3.263, "load_time_ms": 0.2, "load_throughput": 159878.175, "learn_time_ms": 12.726, "learn_throughput": 2514.557, "synch_weights_time_ms": 0.041}, "counters": {"num_env_steps_sampled": 107000, "num_env_steps_trained": 3392000, "num_agent_steps_sampled": 107000, "num_agent_steps_trained": 3392000, "last_target_update_ts": 106501, "num_target_updates": 212}, "done": false, "training_iteration": 107, "trial_id": "5ce16_00000", "date": "2024-09-27_11-50-01", "timestamp": 1727409001, "time_this_iter_s": 33.44749307632446, "time_total_s": 3498.5075690746307, "pid": 39427, "hostname": "gpu2gate1", "node_ip": "10.64.32.126", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.9828407522030984, "lr": 0.0007583973879008875, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f52e4d75580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3498.5075690746307, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 11.963829787234042, "ram_util_percent": 11.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.41026967763900757, "mean_q": 54.13701629638672, "min_q": 6.760804653167725, "max_q": 60.27650451660156, "cur_lr": 0.0007583973879008875}, "td_error": [-0.11886215209960938, 0.6855239868164062, 0.061466217041015625, 0.052486419677734375, 0.0178070068359375, -0.05127716064453125, -0.8965530395507812, -0.7124443054199219, 0.14284515380859375, 0.039203643798828125, 0.27433013916015625, 0.17827606201171875, 0.07041168212890625, -0.06690597534179688, -0.06856536865234375, -1.0920944213867188, -0.21149063110351562, -0.057586669921875, 0.13858795166015625, -0.3503570556640625, 15.671142578125, 0.07726287841796875, 0.5625724792480469, 0.7111358642578125, 0.5383796691894531, -0.282958984375, -0.014606475830078125, -0.7422389984130859, -1.003659725189209, -0.6858139038085938, -0.947174072265625, 0.4260139465332031], "mean_td_error": 0.3857767581939697, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 107000.0, "diff_num_grad_updates_vs_sampler_policy": 16747.09375}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 3424000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 3424000, "last_target_update_ts": 107501, "num_target_updates": 214}, "env_runners": {"episode_reward_max": 500.0, "episode_reward_min": 31.0, "episode_reward_mean": 325.46, "episode_len_mean": 325.46, "episode_media": {}, "episodes_timesteps_total": 32546, "policy_reward_min": {"default_policy": 31.0}, "policy_reward_max": {"default_policy": 500.0}, "policy_reward_mean": {"default_policy": 325.46}, "custom_metrics": {}, "hist_stats": {"episode_reward": [185.0, 144.0, 173.0, 500.0, 500.0, 500.0, 458.0, 500.0, 500.0, 500.0, 278.0, 500.0, 500.0, 500.0, 500.0, 500.0, 332.0, 137.0, 297.0, 106.0, 255.0, 500.0, 500.0, 151.0, 447.0, 232.0, 500.0, 248.0, 279.0, 360.0, 235.0, 231.0, 247.0, 254.0, 500.0, 500.0, 500.0, 500.0, 500.0, 205.0, 500.0, 477.0, 450.0, 500.0, 192.0, 500.0, 285.0, 216.0, 168.0, 152.0, 142.0, 153.0, 365.0, 430.0, 260.0, 467.0, 500.0, 500.0, 500.0, 500.0, 500.0, 34.0, 291.0, 500.0, 500.0, 500.0, 489.0, 368.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 140.0, 35.0, 465.0, 134.0, 157.0, 134.0, 141.0, 205.0, 31.0, 108.0, 109.0, 106.0, 39.0, 143.0, 172.0, 31.0, 152.0, 153.0, 161.0, 152.0, 138.0, 136.0, 164.0, 147.0, 500.0], "episode_lengths": [185, 144, 173, 500, 500, 500, 458, 500, 500, 500, 278, 500, 500, 500, 500, 500, 332, 137, 297, 106, 255, 500, 500, 151, 447, 232, 500, 248, 279, 360, 235, 231, 247, 254, 500, 500, 500, 500, 500, 205, 500, 477, 450, 500, 192, 500, 285, 216, 168, 152, 142, 153, 365, 430, 260, 467, 500, 500, 500, 500, 500, 34, 291, 500, 500, 500, 489, 368, 500, 500, 500, 500, 500, 500, 500, 140, 35, 465, 134, 157, 134, 141, 205, 31, 108, 109, 106, 39, 143, 172, 31, 152, 153, 161, 152, 138, 136, 164, 147, 500], "policy_default_policy_reward": [185.0, 144.0, 173.0, 500.0, 500.0, 500.0, 458.0, 500.0, 500.0, 500.0, 278.0, 500.0, 500.0, 500.0, 500.0, 500.0, 332.0, 137.0, 297.0, 106.0, 255.0, 500.0, 500.0, 151.0, 447.0, 232.0, 500.0, 248.0, 279.0, 360.0, 235.0, 231.0, 247.0, 254.0, 500.0, 500.0, 500.0, 500.0, 500.0, 205.0, 500.0, 477.0, 450.0, 500.0, 192.0, 500.0, 285.0, 216.0, 168.0, 152.0, 142.0, 153.0, 365.0, 430.0, 260.0, 467.0, 500.0, 500.0, 500.0, 500.0, 500.0, 34.0, 291.0, 500.0, 500.0, 500.0, 489.0, 368.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 140.0, 35.0, 465.0, 134.0, 157.0, 134.0, 141.0, 205.0, 31.0, 108.0, 109.0, 106.0, 39.0, 143.0, 172.0, 31.0, 152.0, 153.0, 161.0, 152.0, 138.0, 136.0, 164.0, 147.0, 500.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0124225875764694, "mean_inference_ms": 2.030020091219964, "mean_action_processing_ms": 0.23510627160189565, "mean_env_wait_ms": 0.10169640439001125, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018030881881713867, "StateBufferConnector_ms": 0.01581120491027832, "ViewRequirementAgentConnector_ms": 0.2028040885925293}, "num_episodes": 5, "episode_return_max": 500.0, "episode_return_min": 31.0, "episode_return_mean": 325.46, "episodes_this_iter": 5}, "num_healthy_workers": 0, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 3424000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 3424000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 28.00740351497754, "num_env_steps_trained_throughput_per_sec": 896.2369124792813, "timesteps_total": 108000, "num_env_steps_sampled_lifetime": 108000, "num_agent_steps_sampled_lifetime": 108000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 108000, "timers": {"training_iteration_time_ms": 35497.282, "restore_workers_time_ms": 0.02, "training_step_time_ms": 36.247, "sample_time_ms": 4.256, "load_time_ms": 0.242, "load_throughput": 132143.082, "learn_time_ms": 16.062, "learn_throughput": 1992.23, "synch_weights_time_ms": 0.044}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 3424000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 3424000, "last_target_update_ts": 107501, "num_target_updates": 214}, "done": false, "training_iteration": 108, "trial_id": "5ce16_00000", "date": "2024-09-27_11-50-37", "timestamp": 1727409037, "time_this_iter_s": 35.70684504508972, "time_total_s": 3534.2144141197205, "pid": 39427, "hostname": "gpu2gate1", "node_ip": "10.64.32.126", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.9828407522030984, "lr": 0.0007583973879008875, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f52e4d75580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3534.2144141197205, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 11.725490196078434, "ram_util_percent": 11.299999999999997}}
